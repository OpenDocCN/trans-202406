<html><head></head><body><section data-pdf-bookmark="Chapter 3. A Web Application with Node and Express" data-type="chapter" epub:type="chapter"><div class="chapter" id="a-web-application-with-node-and-express">&#13;
<h1><span class="label">Chapter 3. </span>A Web Application with Node and Express</h1>&#13;
&#13;
&#13;
<p><a data-primary="web application" data-secondary="building" data-type="indexterm" id="ix_ch03-asciidoc0"/><a data-primary="web application building" data-type="indexterm" id="ix_ch03-asciidoc1"/>Before implementing our API, we’re going to build a basic&#13;
server-side web application to serve as the basis for&#13;
the backend of our API. We’ll be using the&#13;
<a href="https://expressjs.com">Express.js framework</a>, a “minimalist web&#13;
framework for Node.js,” meaning that it does not ship with a lot of&#13;
features, but is highly configurable. We’ll be using Express.js as the&#13;
foundation of our API server, but Express can also be used to build&#13;
fully featured server-side web applications.</p>&#13;
&#13;
<p>User interfaces, such as websites and mobile applications, communicate&#13;
with web servers when they need to access data. This data could be&#13;
anything from the HTML required to render a page in a web browser to the&#13;
results of a user’s search. The client interface communicates with the&#13;
server using HTTP. The data request is&#13;
sent from the client via HTTP to the web application that is running on&#13;
the server. The web application then processes the request and returns&#13;
the data to the client, again over HTTP.</p>&#13;
&#13;
<p>In this chapter we’ll build a small server-side web application, which will be the basis for our API. To do this, we’ll use the Express.js framework to build a simple web application that sends a basic request.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Hello World" data-type="sect1"><div class="sect1" id="idm45339512841608">&#13;
<h1>Hello World</h1>&#13;
&#13;
<p><a data-primary="web application building" data-secondary="Hello World" data-type="indexterm" id="idm45339513041800"/>Now that you understand the basics of server-side web applications, let’s&#13;
jump in. Within the <em>src</em> directory of our API project, create a file&#13;
named <em>index.js</em> and add the following:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">const</code> <code class="nx">express</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'express'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">app</code> <code class="o">=</code> <code class="nx">express</code><code class="p">();</code>&#13;
&#13;
<code class="nx">app</code><code class="p">.</code><code class="nx">get</code><code class="p">(</code><code class="s1">'/'</code><code class="p">,</code> <code class="p">(</code><code class="nx">req</code><code class="p">,</code> <code class="nx">res</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">res</code><code class="p">.</code><code class="nx">send</code><code class="p">(</code><code class="s1">'Hello World'</code><code class="p">));</code>&#13;
&#13;
<code class="nx">app</code><code class="p">.</code><code class="nx">listen</code><code class="p">(</code><code class="mi">4000</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Listening on port 4000!'</code><code class="p">));</code></pre>&#13;
&#13;
<p>In this example, first we require the <code>express</code> dependency and&#13;
create the <code>app</code> object, using the imported Express.js module. We then&#13;
use the <code>app</code> object’s <code>get</code> method to instruct our application to send a&#13;
response of “Hello World” when a user accesses the root URL (<code>/</code>). Lastly, we instruct our application to run on port 4000. This will allow us&#13;
to view the application locally at the URL <em>http://localhost:4000</em>.</p>&#13;
&#13;
<p>Now to run the application, type<a data-primary="node src/index.js" data-type="indexterm" id="idm45339511862984"/> <strong><code>node src/index.js</code></strong> in your terminal.&#13;
After doing so, you should see a log in your terminal that reads&#13;
<code>Listening on port 4000!</code>. If that’s the case, you should be able to open a browser window to&#13;
<em>http://localhost:4000</em> and see the result in <a data-type="xref" href="#hello_world">Figure 3-1</a>.</p>&#13;
&#13;
<figure><div class="figure" id="hello_world">&#13;
<img alt="The results of our Hello World server code in the browser" src="assets/jsev_0301.png"/>&#13;
<h6><span class="label">Figure 3-1. </span>The results of our Hello World server code in the browser</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Nodemon" data-type="sect1"><div class="sect1" id="idm45339512768728">&#13;
<h1>Nodemon</h1>&#13;
&#13;
<p><a data-primary="Nodemon" data-type="indexterm" id="idm45339512767128"/><a data-primary="web application building" data-secondary="Nodemon" data-type="indexterm" id="idm45339512766424"/>Now, let’s say that the output of this example doesn’t properly express&#13;
our excitement. We want to change our code so that it adds an&#13;
exclamation mark to our response. Go ahead and do that, changing&#13;
the <code>res.send</code> value to read <code>Hello World!!!</code>. The full line should now&#13;
be:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="nx">app</code><code class="p">.</code><code class="nx">get</code><code class="p">(</code><code class="s1">'/'</code><code class="p">,</code> <code class="p">(</code><code class="nx">req</code><code class="p">,</code> <code class="nx">res</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">res</code><code class="p">.</code><code class="nx">send</code><code class="p">(</code><code class="s1">'Hello World!!!'</code><code class="p">));</code></pre>&#13;
&#13;
<p>If you go to your web browser and refresh the page, you’ll notice that the&#13;
output hasn’t changed. This is because any changes we make to our web&#13;
server require us to restart it. To do so, switch back to your terminal&#13;
and press Ctrl + C to stop the server. Now restart it by again typing<a data-primary="node index.js" data-type="indexterm" id="idm45339512747304"/>&#13;
<strong><code>node index.js</code></strong>. Now, when you navigate back to your browser and refresh the&#13;
page, you should see the updated response.</p>&#13;
&#13;
<p>As you can imagine, stopping and restarting our server for every change can quickly become tedious. Thankfully, we can use the Node&#13;
package <code>nodemon</code> to automatically restart the server on changes. If you&#13;
take a look at the project’s <em>package.json</em> file, you’ll see a <code>dev</code> command&#13;
within the <code>scripts</code> object, which instructs <code>nodemon</code> to watch our&#13;
<em>index.js</em> file:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="s2">"scripts"</code><code class="o">:</code> <code class="p">{</code>&#13;
  <code class="p">...</code>&#13;
  <code class="s2">"dev"</code><code class="o">:</code> <code class="s2">"nodemon src/index.js"</code>&#13;
  <code class="p">...</code>&#13;
<code class="p">}</code></pre>&#13;
<div data-type="note" epub:type="note"><h1>package.json Scripts</h1>&#13;
<p>There are a handful of other helper commands within the <code>scripts</code>&#13;
 object. We will explore those in future chapters.</p>&#13;
</div>&#13;
&#13;
<p>Now, to start the application from the terminal, type:</p>&#13;
&#13;
<pre data-code-language="bash" data-type="programlisting">npm run dev</pre>&#13;
&#13;
<p>Navigating to your browser and refreshing the page, you’ll see that&#13;
things are working as before. To confirm that <code>nodemon</code> automatically&#13;
restarts the server, let’s once again update our <code>res.send</code> value so&#13;
that it reads:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="nx">res</code><code class="p">.</code><code class="nx">send</code><code class="p">(</code><code class="s1">'Hello Web Server!!!'</code><code class="p">)</code></pre>&#13;
&#13;
<p>Now, you should be able to refresh the page in your browser and see the&#13;
update without manually restarting the server.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Extending Port Options" data-type="sect1"><div class="sect1" id="idm45339512768104">&#13;
<h1>Extending Port Options</h1>&#13;
&#13;
<p><a data-primary="web application building" data-secondary="extending port options" data-type="indexterm" id="idm45339511814424"/>Currently our application is served on port 4000. This&#13;
works great for local development, but we will need the flexibility to&#13;
set this to a different port number when deploying the application. Let’s take the steps to update this now. We’ll start by adding a <code>port</code> variable:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">const</code> <code class="nx">port</code> <code class="o">=</code> <code class="nx">process</code><code class="p">.</code><code class="nx">env</code><code class="p">.</code><code class="nx">PORT</code> <code class="o">||</code> <code class="mi">4000</code><code class="p">;</code></pre>&#13;
&#13;
<p>This change will allow us to dynamically set the port in the Node&#13;
environment, but fall back to port 4000 when no port is specified. Now&#13;
let’s adjust our <a data-primary="app.listen" data-type="indexterm" id="idm45339511759416"/><code>app.listen</code> code to work with this change and use a&#13;
template literal to log the correct port:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="nx">app</code><code class="p">.</code><code class="nx">listen</code><code class="p">(</code><code class="nx">port</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code>&#13;
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`Server running at http://localhost:</code><code class="si">${</code><code class="nx">port</code><code class="si">}</code><code class="sb">`</code><code class="p">)</code>&#13;
<code class="p">);</code></pre>&#13;
&#13;
<p>Our final code should now read:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">const</code> <code class="nx">express</code> <code class="o">=</code> <code class="nx">require</code><code class="p">(</code><code class="s1">'express'</code><code class="p">);</code>&#13;
&#13;
<code class="kr">const</code> <code class="nx">app</code> <code class="o">=</code> <code class="nx">express</code><code class="p">();</code>&#13;
<code class="kr">const</code> <code class="nx">port</code> <code class="o">=</code> <code class="nx">process</code><code class="p">.</code><code class="nx">env</code><code class="p">.</code><code class="nx">PORT</code> <code class="o">||</code> <code class="mi">4000</code><code class="p">;</code>&#13;
&#13;
<code class="nx">app</code><code class="p">.</code><code class="nx">get</code><code class="p">(</code><code class="s1">'/'</code><code class="p">,</code> <code class="p">(</code><code class="nx">req</code><code class="p">,</code> <code class="nx">res</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">res</code><code class="p">.</code><code class="nx">send</code><code class="p">(</code><code class="s1">'Hello World!!!'</code><code class="p">));</code>&#13;
&#13;
<code class="nx">app</code><code class="p">.</code><code class="nx">listen</code><code class="p">(</code><code class="nx">port</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code>&#13;
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`Server running at http://localhost:</code><code class="si">${</code><code class="nx">port</code><code class="si">}</code><code class="sb">`</code><code class="p">)</code>&#13;
<code class="p">);</code></pre>&#13;
&#13;
<p>With this, we now have the basics of our web server code up and running.&#13;
To test that everything is working, verify that no errors are present in&#13;
your console and reload your web browser at <em>http://localhost:4000</em>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Conclusion" data-type="sect1"><div class="sect1" id="idm45339511649176">&#13;
<h1>Conclusion</h1>&#13;
&#13;
<p>Server-side web applications are the foundation of API development. In this chapter, we built a basic web application using the Express.js framework. When developing Node-based web applications, you have a wide array of frameworks and tools to choose from. Express.js is a great choice due to its flexibility, community support, and maturity as a project. In the next chapter, we’ll turn our web application into an API.<a data-startref="ix_ch03-asciidoc1" data-type="indexterm" id="idm45339511604760"/><a data-startref="ix_ch03-asciidoc0" data-type="indexterm" id="idm45339511604056"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section></body></html>