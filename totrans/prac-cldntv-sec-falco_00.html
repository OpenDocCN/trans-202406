<html><head></head><body><div id="sbo-rt-content"><section data-type="preface" epub:type="preface" data-pdf-bookmark="Preface"><div class="preface" id="preface">
<h1>Preface</h1>
<p>The advent of modern computing stacks is radically changing how we think about security. In the old data center days, security practitioners thought of software applications as medieval castles: securing them involved building big walls with small, well-guarded openings. Modern cloud-based software looks more like a bustling modern city: people move freely inside it and across its limits to consume and provide services and buy, sell, build, and fix things.</p>
<p>As today’s urban planners know, big walls and guarded entrances alone are not enough to secure a city. A better approach involves widespread, granular visibility: a network of security cameras, for example, plus the ability to view their footage and react to any threats they capture in real time.</p>
<p>This book is about security for modern applications, using the open source tool that the industry has embraced as the “security camera” for the cloud native stack: Falco. Falco is a cloud native runtime security project designed to protect software that runs in the cloud by detecting unexpected behavior, intrusions, and data theft in real time. It’s the de facto threat detection engine for Kubernetes and for cloud infrastructure, deployed by countless users, from single-machine test environments to some of the biggest computing environments on the planet. We’ll teach you how you can protect applications as they run by detecting threats and misconfigurations in workloads and in the cloud infrastructure where they operate.</p>
<p>We have a very practical goal in this book: giving you the knowledge you need to successfully deploy runtime security in your environment, regardless of its scale, using Falco. By the time you’ve finished reading the book, you will have a solid understanding of how Falco works: you’ll be able to install it in any environment, tune its performance, customize it for your needs, collect and interpret its data, and even extend it.</p>
<section data-type="sect1" data-pdf-bookmark="Who Is This Book For?"><div class="sect1" id="who_is_this_book_forquestion_mark">
<h1>Who Is This Book For?</h1>
<p>We wrote this book primarily for security operators and architects who want to implement runtime security and threat detection in production in their modern computing environments. However, we’ve designed it to be approachable even for readers with limited or no experience in the field. For that reason, we only require that you have familiarity with the most important cloud computing services, with containers, and with Kubernetes.</p>
<p>We’ll also cover more advanced topics like deployment at scale, optimization, and rule writing that even expert users will find useful. So, even if you are familiar with runtime security, and perhaps are already using Falco, this book will help you step up your game. The latter part of the book requires basic knowledge of programming languages like Go. Developers who want to extend or customize Falco will find much value here. Finally, we’ve geared the last chapter of the book toward those who are considering becoming Falco contributors—we hope we’ll inspire you to join them!</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Overview"><div class="sect1" id="overview">
<h1>Overview</h1>
<p>The book is divided into four parts, organized in order of increasing complexity, with each successive part building on the previous one. To help you get oriented, let’s take a look at the content of each part.</p>
<section data-type="sect2" data-pdf-bookmark="Part I: The Basics"><div class="sect2" id="part_i_the_basics">
<h2>Part I: The Basics</h2>
<p><a data-type="xref" href="part01.xhtml#i_the_basics">Part I</a> is about what Falco is and does. Here, we will teach you the fundamental concepts behind Falco and guide you through your first local deployment:</p>
<ul>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch01.xhtml#introducing_falco">Chapter 1, “Introducing Falco”</a>, gives an overview of what Falco is, including a high-level view of its functionality and an introductory description of each of its components. The chapter includes a brief history of Falco and a look at the tools that inspired it.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch02.xhtml#getting_started_with_falco">Chapter 2, “Getting Started with Falco <span class="keep-together">on Your Local Machine</span>”</a>, guides you through the process of installing a single Falco instance on your local Linux box. The chapter includes instructions on how to run Falco and generate your first notification output.</p></li>
</ul>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Part II: The Architecture of Falco"><div class="sect2" id="part_ii_the_architecture_of_falco">
<h2>Part II: The Architecture of Falco</h2>
<p><a data-type="xref" href="part02.xhtml#ii_the_architecture_of_falco">Part II</a> will teach you about the intricacies of Falco’s architecture and inner workings:</p>
<ul>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch03.xhtml#understanding_falcoapostr">Chapter 3, “Understanding Falco’s Architecture”</a>, dives into the details of Falco sensors, how data collection happens, and what components are involved in processing it. The architectural understanding you will gain from this chapter is the base for the rest of the book.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch04.xhtml#data_source">Chapter 4, “Data Sources”</a>, is about understanding the two main data sources you can use in Falco: system calls and plugins. We explain what the data produced by these sources is, how it is collected, and how Falco’s collection stack compares with alternative approaches.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch05.xhtml#data_enrichment">Chapter 5, “Data Enrichment”</a>, covers techniques Falco uses to enrich the data it collects. Enrichment consists of adding layers of contextual information to the collected data; for example, container IDs, Kubernetes labels, or cloud provider tags. This chapter explains how to configure Falco to collect enrichment metadata and how to customize it to add your own metadata.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch06.xhtml#fields_and_filters">Chapter 6, “Fields and Filters”</a>, covers one of the most important concepts in Falco—the filtering engine—and the fields at its base. The chapter is structured as a reference for the language syntax (including operators) and the fields.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch07.xhtml#falco_rules">Chapter 7, “Falco Rules”</a>, introduces rules and their syntax, including constructs like lists and macros that you will use routinely when customizing Falco.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch08.xhtml#the_output_framework">Chapter 8, “The Output Framework”</a>, describes the mechanism Falco uses to deliver notifications to output channels and the channels available in Falco, and teaches you how to configure and use them.</p></li>
</ul>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Part III: Running Falco in Production"><div class="sect2" id="part_iii_running_falco_in_production">
<h2>Part III: Running Falco in Production</h2>
<p><a data-type="xref" href="part03.xhtml#iii_running_falco_in_production">Part III</a> is the reference manual for the serious Falco user. This part of the book will teach you everything you need to know to deploy, configure, run, and tune Falco in any environment:</p>
<ul>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch09.xhtml#installing_falco">Chapter 9, “Installing Falco”</a>, presents approaches to installing Falco in production environments, with detailed instructions.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch10.xhtml#configuring_and_running">Chapter 10, “Configuring and Running Falco”</a>, covers how Falco’s configuration system works. This chapter will help you understand and use Falco settings, including command-line options, environment variables, the configuration file, and rules files.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch11.xhtml#using_falco_for_cloud_se">Chapter 11, “Using Falco for Cloud Security”</a>, offers a general overview of cloud security, then goes into the specifics of AWS threat detection using Falco’s CloudTrail plugin. It takes a practical approach and includes clear and complete instructions for setting up cloud security in your environment using Falco.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch12.xhtml#consuming_falco_events">Chapter 12, “Consuming Falco Events”</a>, focuses on what you can do with Falco’s detections. It covers tools that help you work with Falco outputs, like falco-explorer and Falcosidekick, and helps you understand which Falco events are useful to observe and analyze as well as how to process them.</p></li>
</ul>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Part IV: Extending Falco"><div class="sect2" id="part_iv_extending_falco">
<h2>Part IV: Extending Falco</h2>
<p><a data-type="xref" href="part04.xhtml#iv_extending_falco">Part IV</a> is a reference for developers, covering methods for extending Falco:</p>
<ul>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch13.xhtml#writing_falco_rules">Chapter 13, “Writing Falco Rules”</a>, is about customizing and extending Falco’s detections. You will learn how to write new rules and tune existing rules for your needs. In addition to the basics of rule writing, the chapter covers advanced topics like noise reduction, performance optimization, and tagging.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch14.xhtml#falco_development">Chapter 14, “Falco Development”</a>, is about working with Falco’s source code. It begins with an overview of the code base, then dives into two important ways of extending Falco: using the gRPC API and the plugins framework. You will find several examples that you can use as the basis for your coding adventures.</p></li>
<li><p><a data-type="xref" data-xrefstyle="chap-num-title" href="ch15.xhtml#how_to_contribute">Chapter 15, “How to Contribute”</a>, talks about the Falco community and shows you how to contribute to it. It’s ideal reading if, after staying with us for the whole book, you are as excited as we are about Falco!</p></li>
</ul>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Conventions Used in This Book"><div class="sect1" id="conventions_used_in_this_book">
<h1>Conventions Used in This Book</h1>
<p>The following typographical conventions are used in this book:</p>
<dl>
<dt><em>Italic</em></dt>
<dd><p>Indicates new terms, URLs, email addresses, filenames, and file extensions.</p></dd>
<dt><code>Constant width</code></dt>
<dd><p>Used for command-line input and program listings, as well as within paragraphs to refer to commands and program elements such as variable or function names, data types, and environment variables.</p></dd>
<dt><code><strong>Constant width bold</strong></code></dt>
<dd><p>Shows commands or other text that should be typed literally by the user. Also used occasionally in program listings to highlight text of interest.</p></dd>
<dt><code><em>Constant width italic</em></code></dt>
<dd><p>Shows text that should be replaced with user-supplied values or by values determined by context.</p></dd>
</dl> 
<div data-type="tip"><h6>Tip</h6>
<p>This element signifies a tip or suggestion.</p>
</div>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>This element signifies a general note.</p>
</div>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>This element indicates a warning or caution.</p>
</div>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Using Code Examples"><div class="sect1" id="using_code_examples">
<h1>Using Code Examples</h1>
<p>Code examples from <a data-type="xref" href="ch14.xhtml#falco_development">Chapter 14</a> are available for download at <a href="https://oreil.ly/practical-cloud-native-security-falco-code"><em class="hyperlink">https://oreil.ly/practical-cloud-native-security-falco-code</em></a>.</p>
<p>If you have a technical question or a problem using the code examples, please send email to <a class="email" href="mailto:bookquestions@oreilly.com"><em>bookquestions@oreilly.com</em></a>.</p>
<p>This book is here to help you get your job done. In general, if example code is offered with this book, you may use it in your programs and documentation. You do not need to contact us for permission unless you’re reproducing a significant portion of the code. For example, writing a program that uses several chunks of code from this book does not require permission. Selling or distributing a CD-ROM of examples from O’Reilly books does require permission. Answering a question by citing this book and quoting example code does not require permission. Incorporating a significant amount of example code from this book into your product’s documentation does require permission.</p>
<p>We appreciate, but do not require, attribution. An attribution usually includes the title, author, publisher, and ISBN. For example: “<em>Practical Cloud Native Security with Falco</em>, by Loris Degioanni and Leonardo Grasso (O’Reilly). Copyright 2022 O’Reilly Media, Inc., 978-1-098-11857-0.”</p>
<p>If you feel your use of code examples falls outside fair use or the permission given above, feel free to contact us at <a href="mailto:permissions@oreilly.com">permissions@oreilly.com</a>.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="O’Reilly Online Learning"><div class="sect1" id="oapostrophereilly_online_learning">
<h1>O’Reilly Online Learning</h1>
<p>For more than 40 years, O’Reilly Media has provided technology and business training, knowledge, and insight to help companies succeed.</p>
<p>Our unique network of experts and innovators share their knowledge and expertise through books, articles, and our online learning platform. O’Reilly’s online learning platform gives you on-demand access to live training courses, in-depth learning paths, interactive coding environments, and a vast collection of text and video from O’Reilly and 200+ other publishers. For more information, visit <a href="http://oreilly.com/"><em class="hyperlink">http://oreilly.com</em></a>.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="How to Contact Us"><div class="sect1" id="_how_to_contact_us">
<h1>How to Contact Us</h1>
<p>Please address comments and questions concerning this book to the publisher:</p>
<ul class="simplelist">
  <li>O’Reilly Media, Inc.</li>
  <li>1005 Gravenstein Highway North</li>
  <li>Sebastopol, CA 95472</li>
  <li>800-998-9938 (in the United States or Canada)</li>
  <li>707-829-0515 (international or local)</li>
  <li>707-829-0104 (fax)</li>
</ul>
<p>We have a web page for this book, where we list errata, examples, and any additional information. You can access this page at <a href="https://oreil.ly/practical-cloud-native-security-falco"><em class="hyperlink">https://oreil.ly/practical-cloud-native-security-falco</em></a>.</p>
<!--Don't forget to update the link above.-->
<p>Email <a class="email" href="mailto:bookquestions@oreilly.com"><em>bookquestions@oreilly.com</em></a> to comment or ask technical questions about this book.</p>

<p>For news and information about our books and courses, visit <a href="https://oreilly.com"><em class="hyperlink">https://oreilly.com</em></a>.</p>
<p>Find us on LinkedIn: <a href="https://linkedin.com/company/oreilly-media"><em class="hyperlink">https://linkedin.com/company/oreilly-media</em></a></p>
<p>Follow us on Twitter: <a href="https://twitter.com/oreillymedia"><em class="hyperlink">https://twitter.com/oreillymedia</em></a></p>
<p>Watch us on YouTube: <a href="https://www.youtube.com/oreillymedia"><em class="hyperlink">https://www.youtube.com/oreillymedia</em></a></p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Acknowledgments"><div class="sect1" id="acknowledgments">
<h1>Acknowledgments</h1>
<p>We would like to start by thanking, from the bottom of our hearts, the Falco community: the maintainers who spend countless hours running and growing the project with incredible passion; the contributors, big and small, who make Falco better every day; the adopters and champions who give Falco a chance and provide valuable feedback. Falco, clearly, is the product of your love and talent, and it will be an honor for us if this book can showcase your incredible work.</p>
<p>Thanks also to the Cloud Native Computing Foundation, for providing a good home for Falco and supporting its growth.</p>
<p>We would like to thank as well the people who helped us and supported us while writing this book: in particular, our project manager, Tammy Yue, and our O’Reilly editor, Sarah Grey. You have been not only very professional and helpful, but also extremely gracious, constructive, and patient. Working with you has been a true pleasure.</p>
<p>Finally, this book would not have been possible without the support of Sysdig, the company where we both work. We truly appreciate working for an organization that not only understands but actively supports open source and that embraces our belief that the future of security is open.</p>
<section data-type="sect2" data-pdf-bookmark="Leonardo"><div class="sect2" id="leonardo">
<h2>Leonardo</h2>
<p>One day, while I was talking to Loris, he proposed that we should write a book together. So as I’m here, I have to thank him first. Working on this idea with him was one of the most challenging but, at the same time, fun things I’ve done in my life. Shall we do it again? As a first-time author, writing this book has been an incredible new adventure for me that wouldn’t have been possible without the help and love of my family. So, I would like to thank my shining and beloved Ada, who has always supported me and has given me our little Michelangelo. I also want to thank our little boy for waiting in his mommy’s belly until right after his daddy completed writing this book. Together with Ma~ (read “Matilde,” our little kitten who purred next to me while I was writing), they have accompanied me with patience and joy during this journey.</p>
<p>Last but not least, I also have to thank my parents, sister, and uncles with all my heart. They have always believed in me, sustained me, and helped me whenever needed. I couldn’t make it through without them, seriously.</p>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Loris"><div class="sect2" id="loris">
<h2>Loris</h2>
<p>I would like to thank my wife Stacey, the love of my life, for her patience and undeterred support for what I do. Thank you for not letting me starve, drown, or generally injure myself during the production of this book.</p>
<p>I also want to thank my three kids, Josephine, Vincenzo, and August, for bringing happiness to every minute of my life, including the time spent working on this publication. Your frequent questions and interruptions made writing this book more challenging but also much more pleasant. I’m looking forward to reading the books that you will publish when you grow up.</p>
<p>I would like to thank my parents for supporting me at (and before) the beginning of my career. I wouldn’t be writing this preface today without the seeds that you planted many years ago and watered with love and generosity.</p>
<p>This book would have not been possible without my coauthor, Leo. The two of us had to spend a <em>lot</em> of time together to produce this work, and every minute with him was pleasant, constructive, and fun. Leo, I’m looking forward to spending time with you on more fun and ambitious projects in the future.</p>
</div></section>
</div></section>
</div></section></div></body></html>