<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 7. Safe Args: Passing Information"><div class="chapter" id="safe_argscolon_passing_information">
<h1><span class="label">Chapter 7. </span>Safe Args: <em>Passing Information</em></h1>
<figure class="informal"><div class="figure">
<img src="Images/f0257-01.png" alt="image" width="600" height="374"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="fragments" data-secondary="passing data between" id="idm46053740296096"/><strong>Sometimes fragments need extra information to work properly.</strong></p>
<p>If a fragment shows details of a contact, for example, it needs to know which contact to display. But what if this information need extra information to work properly.<strong>comes from another fragment</strong>? In this chapter, you’ll <strong>build on your navigation know-how</strong> by learning <strong>how to pass data between fragments</strong>. You’ll find out <strong>how to add arguments</strong> to navigation destinations so they can receive the information they need. You’ll meet <strong>the Safe Args plug-in</strong>, and learn how to use it to <strong>write type-safe code</strong>. Finally, you’ll discover <strong>how to manipulate the back stack</strong>, and take control of back button behavior. Read on—there’s no going back…</p>
<section data-type="sect1" data-pdf-bookmark="The Secret Message app navigates between fragments"><div class="sect1" id="the_secret_message_app_navigates_between">
<h1>The Secret Message app navigates between fragments</h1>
<p><a data-type="indexterm" data-primary="Secret Message app" id="idm46053740287872"/>In the previous chapter, you learned how to use the Navigation component to navigate between two fragments. You used this knowledge to build the first half of the Secret Message app: an app that takes a message the user enters, and encrypts it.</p>
<p>The current version of the app uses a fragment named <code>WelcomeFragment</code> to display some introductory text. When the user clicks on its Start button, the fragment navigates to a second fragment named <code>MessageFragment</code>.</p>
<p><code>MessageFragment</code> includes an edit text that lets the user enter her message. It also features a Next button, which the user clicks on to encrypt the message.</p>
<p>Here’s a reminder of what the app currently looks like:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0258-01.png" alt="image" width="600" height="437"/>
<h6/>
</div></figure>
<p>In the current version of the app, nothing happens when the user clicks on <code>MessageFragment</code>’s Next button. In this chapter, we’re going to finish building the app so the user’s encrypted message gets displayed in a new fragment.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="MessageFragment needs to pass the message to a new fragment"><div class="sect1" id="messagefragment_needs_to_pass_the_messag">
<h1>MessageFragment needs to pass the message to a new fragment</h1>
<p><a data-type="indexterm" data-primary="EncryptFragment" id="idm46053740278944"/><a data-type="indexterm" data-primary="MessageFragment" data-secondary="EncryptFragment" id="idm46053740277920"/><a data-type="indexterm" data-primary="Safe Args plug-in" id="idm46053740276816"/>We’re going to add a new fragment to the app named <code>EncryptFragment</code>. This fragment will display the user’s encrypted message, and will look like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0259-01.png" alt="image" width="600" height="261"/>
<h6/>
</div></figure>
<p><code>EncryptFragment</code> will get the user’s message from <code>MessageFragment</code>. When the user clicks on <code>MessageFragment</code>’s Next button, the app will navigate to <code>EncryptFragment</code>, and pass it the text. This fragment will then encrypt the text, and display the result:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0259-02.png" alt="image" width="600" height="198"/>
<h6/>
</div></figure>
<p>To make this work, we need to be able to pass data between fragments. The best way of doing this is with a Gradle plug-in called <strong>Safe Args</strong>, which is an extra part of the Navigation component. It gives you a way of passing data between fragments in a way that’s type-safe. This prevents you from accidentally passing the wrong type of data, which might cause runtime errors.</p>
<p>You’ll learn more about using Safe Args as we continue building the Secret Message app. For now, let’s look at the steps we’ll go through.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Here’s what we’re going to do"><div class="sect1" id="hereapostrophes_what_weapostroph-id00091">
<h1>Here’s what we’re going to do</h1>
<p>Here are the steps we’ll go through to build the second half of the Secret Message app:</p>
<ol>
<li><p><strong>Create and display EncryptFragment.</strong></p>
<p>We’ll create a new fragment named <code>EncryptFragment</code>, and navigate to it when the user clicks on the Next button in <code>MessageFragment</code>’s layout.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0260-01.png" alt="image" width="600" height="192"/>
<h6/>
</div></figure></li>
<li><p><strong>Pass the user’s message to EncryptFragment.</strong></p>
<p>We’ll use Safe Args to pass the user’s message from <code>MessageFragment</code> to <code>EncryptFragment</code>. <code>EncryptFragment</code> will then display the encrypted message.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0260-02.png" alt="image" width="600" height="190"/>
<h6/>
</div></figure></li>
<li><p><strong>Modify the app’s back button behavior.</strong></p>
<p>Finally, we’ll update the app so that when the user presses the device back button while <code>EncryptFragment</code> is displayed, the app goes back to <code>WelcomeFragment</code>.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0260-03.png" alt="image" width="600" height="234"/>
<h6/>
</div></figure></li>
</ol>
<figure class="informal"><div class="figure">
<img src="Images/f0260-04.png" alt="image" width="315" height="297"/>
<h6/>
</div></figure>
<p>Let’s get started.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Create EncryptFragment…"><div class="sect1" id="create_encryptfragmenthellip">
<h1>Create EncryptFragment…</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0261-01.png" alt="image" width="304" height="92"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="EncryptFragment" data-secondary="creating" id="idm46053740247728"/>We’re going to use <code>EncryptFragment</code> to display an encrypted version of the user’s message. Create this fragment by highlighting the <em>com.hfad.secretmessage</em> package in the <em>app/src/main/java</em> folder, going to the File menu, and choosing New→Fragment→Fragment (Blank). Name the fragment “EncryptFragment” and give the layout a name of “fragment_encrypt”. Make sure the language is set to Kotlin, then click on the Finish button.</p>
<section data-type="sect2" data-pdf-bookmark="…and update its layout"><div class="sect2" id="hellipand_update_its_layout">
<h2>…and update its layout</h2>
<p>We’re going to update <code>EncryptFragment</code>’s layout so that it includes two text views. The first will display a <code>String</code> resource named <code>encrypt_text</code> (we added this to <em>strings.xml</em> in the previous chapter), and the second will display the encrypted message.</p>
<p>Open the layout file <em>fragment_encrypt.xml</em> and update its contents so it matches the code below:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0261-02.png" alt="image" width="600" height="458"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Update EncryptFragment.kt"><div class="sect1" id="update_encryptfragmentdotkt">
<h1>Update EncryptFragment.kt</h1>
<p><a data-type="indexterm" data-primary="EncryptFragment" data-secondary="code for" id="idm46053740243600"/>We also need to update <code>EncryptFragment</code>’s Kotlin code to make sure that Android Studio hasn’t added any unnecessary extra code to it that might stop it from working in the way we want.</p>
<p>Go to the <em>com.hfad.secretmessage</em> package in the <em>app/src/main/java</em> folder and open the file <em>EncryptFragment.kt</em>. Then replace the code that Android Studio has generated with the code shown here:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0262-02.png" alt="image" width="600" height="353"/>
<h6/>
</div></figure>
<p>The above code is everything that <em>EncryptFragment.kt</em> needs to define a basic fragment. Just like the other fragment code you’ve seen, it extends the <code>Fragment</code> class, and overrides its <code>onCreateView()</code> method. This method inflates the fragment’s layout, and returns its root view.</p>
<p>We’ve now finished writing all the layout and Kotlin code that <code>EncryptFragment</code> needs. Next, we’ll make sure that <code>MessageFragment</code> can navigate to it by adding it to the navigation graph.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0262-03.png" alt="image" width="296" height="265"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Add EncryptFragment to the navigation graph"><div class="sect1" id="add_encryptfragment_to_the_navigation_gr">
<h1>Add EncryptFragment to the navigation graph</h1>
<p><a data-type="indexterm" data-primary="Navigation component" data-secondary="navigation graph" data-tertiary="EncryptFragment" id="idm46053740222576"/>As you already know, the navigation graph holds details of the app’s destinations, and the possible paths you can take to navigate to them.</p>
<p>To add <code>EncryptFragment</code> to the navigation graph, open <em>nav_graph.xml</em>, click on the New Destination button in the design editor, and when prompted, choose the “fragment_encrypt” option. This adds the fragment.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0263-02.png" alt="image" width="174" height="139"/>
<h6/>
</div></figure>
<p>We also need to add a new action so that <code>MessageFragment</code> can navigate to <code>EncryptFragment</code>. Do this by hovering your mouse pointer over <code>MessageFragment</code> and drawing an action arrow from its right edge to <code>EncryptFragment</code>. Make sure the action has an ID of “action_messageFragment_to_encryptFragment” so that it matches the code in this book.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Don’t worry if you find this a bit too fiddly. We’ll show you the full code on the next page so if you prefer, you can update that instead.</span></p>
</div>
<p>After you’ve made these changes, the navigation graph should look something like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0263-04.png" alt="image" width="600" height="349"/>
<h6/>
</div></figure>
<p>Let’s see what the underlying XML looks like.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The updated nav_graph.xml code"><div class="sect1" id="the_updated_navunderscoregraphdotxml_cod">
<h1>The updated nav_graph.xml code</h1>
<p>Each time you update the navigation graph, any changes are added to the underlying XML. The new code looks like this (the changes are in bold):</p>
<figure class="informal"><div class="figure">
<img src="Images/f0264-02.png" alt="image" width="600" height="615"/>
<h6/>
</div></figure>
<p>Let’s use the new action to navigate to <code>EncryptFragment</code>.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="MessageFragment needs to navigate to EncryptFragment"><div class="sect1" id="messagefragment_needs_to_navigate_to_enc">
<h1>MessageFragment needs to navigate to EncryptFragment</h1>
<p><a data-type="indexterm" data-primary="EncryptFragment" data-secondary="navigating from MessageFragment to" id="idm46053740203776"/>We need to make <code>MessageFragment</code> navigate to <code>EncryptFragment</code> when the user clicks its Next button. To enable this, we’ll add an <code>OnClickListener</code> to the button, which will include the navigation code.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0265-02.png" alt="image" width="359" height="115"/>
<h6/>
</div></figure>
<p>As you learned in the previous chapter, you navigate from one fragment to another by getting a navigation controller, and passing it a navigation action. The navigation controller uses this action to display the correct fragment.</p>
<p>You’re already familiar with all the code needed to do this, so update <em>MessageFragment.kt</em> so that it includes the changes shown here (in bold):</p>
<figure class="informal"><div class="figure">
<img src="Images/f0265-03.png" alt="image" width="600" height="418"/>
<h6/>
</div></figure>
<p>Let’s take the app for a test drive and make sure this works.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00092">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<p>When we run the app, <code>MainActivity</code> is launched, and <code>WelcomeFragment</code> is displayed. When we click on its Start button, the app navigates to <code>MessageFragment</code> as before.</p>
<p>When we enter a message in <code>MessageFragment</code>’s edit text view and click on its Next button, the app navigates to <code>EncryptFragment</code>. It doesn’t do anything with the message we entered.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0266-02.png" alt="image" width="600" height="380"/>
<h6/>
</div></figure>
<p><code>EncryptFragment</code> doesn’t display an encrypted message because the code we’ve written so far simply navigates to this fragment. It doesn’t pass the message to the new fragment, so <code>EncryptFragment</code> can’t do anything with it.</p>
<p>To pass the message from <code>MessageFragment</code> to <code>EncryptFragment</code>, we’re going to use Safe Args. As you learned earlier, this is an extra part of the Navigation component that lets you pass arguments to destinations in a type-safe way.</p>
<p>Let’s find out how this is done.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Add Safe Args to the build.gradle files"><div class="sect1" id="add_safe_args_to_the_builddotgradle_file">
<h1>Add Safe Args to the build.gradle files</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0267-01.png" alt="image" width="303" height="90"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="Safe Args plug-in" data-secondary="Secret Message app" id="idm46053740181456"/><a data-type="indexterm" data-primary="Secret Message app" data-secondary="Safe Args plug-in" id="idm46053740179984"/>Before we can start using Safe Args, we need to update the project and app <em>build.gradle</em> files. Let’s do this now.</p>
<section data-type="sect2" data-pdf-bookmark="Add a classpath to the project build.gradle file"><div class="sect2" id="add_a_classpath_to_the_project_builddotg">
<h2>Add a classpath to the <em>project</em> build.gradle file</h2>
<p>You first need to add a new classpath to the project’s <em>build.gradle</em> file specifying that you want to use the Safe Args plug-in. The classpath includes a version number, which needs to match the one that you’re using for the main Navigation component library.</p>
<p>In the Secret Message app, we’re using a variable named <code>nav_version</code> to make sure that these version numbers match, so we’ll reference this in the classpath.</p>
<p>Open the file <em>SecretMessage/build.gradle</em>, and add the classpath (in bold) to the <code>dependencies</code> section:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0267-02.png" alt="image" width="600" height="188"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Add the plug-in to the app build.gradle file"><div class="sect2" id="add_the_plug-in_to_the_app_builddotgradl">
<h2>Add the plug-in to the <u>app</u> build.gradle file</h2>
<p>Next, you need to tell Gradle that you’re using the Safe Args plug-in by adding a line to the app <em>build.gradle</em> file. Open the file <em>SecretMessage/app/build.gradle</em>, and add the line in bold to the <code>plug-ins</code> section:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0267-03.png" alt="image" width="600" height="146"/>
<h6/>
</div></figure>
<p>Once you’ve made these changes, click on the Sync Now option that appears at the top of the code editor. This syncs the changes you’ve made with the rest of your project.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Make sure that you sync your changes each time you update the build.gradle files.</span></p>
</div>
<p>Now that the app includes Safe Args, we can use it to pass a message from <code>MessageFragment</code> to <code>EncryptFragment</code>. We’ll do this next.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="EncryptFragment needs to accept a String argument"><div class="sect1" id="encryptfragment_needs_to_accept_a_string">
<h1>EncryptFragment needs to accept a String argument</h1>
<p><a data-type="indexterm" data-primary="EncryptFragment" data-secondary="String argument for" id="idm46053740158528"/>The first thing we need to do is specify that <code>EncryptFragment</code> can accept the user’s message. We’ll do this by adding a <code>String</code> argument to this fragment in the navigation graph; <code>MessageFragment</code> will then use this argument to pass the user’s message (a <code>String</code>) to <code>EncryptFragment</code>.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0268-01.png" alt="image" width="173" height="139"/>
<h6/>
</div></figure>
<p>To add the argument, open the file <em>nav_graph.xml</em> from the <em>app/src/main/res/nav_graph.xml</em>. Then select <code>EncryptFragment</code> in the navigation graph design editor, go to the Attributes panel, and click on the “+” button that appears next to the Arguments section:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0268-02.png" alt="image" width="600" height="187"/>
<h6/>
</div></figure>
<p>When you click on the “+” button, an Add Argument window appears, which you use to add details about the argument. Here, we want <code>EncryptFragment</code> to accept a <code>String</code> argument for the user’s message, so name the argument “message”, select “String” as its type, and click on the Add button. This creates the new argument, and adds it to the Arguments section of the Attributes panel:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0268-03.png" alt="image" width="600" height="231"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The updated nav_graph.xml code"><div class="sect1" id="the_updated_navunderscoregraphdo-id00093">
<h1>The updated nav_graph.xml code</h1>
<p>When you add an argument to a navigation graph, a new <code>&lt;argument&gt;</code> element gets added to the underlying XML. Here’s the updated code for <em>nav_graph.xml</em> (the new code is in bold):</p>
<figure class="informal"><div class="figure">
<img src="Images/f0269-02.png" alt="image" width="600" height="653"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="MessageFragment needs to pass a message to EncryptFragment"><div class="sect1" id="messagefragment_needs_to_pass_a_message">
<h1>MessageFragment needs to pass a message to EncryptFragment</h1>
<p><a data-type="indexterm" data-primary="actions" data-secondary="connecting fragments with" id="idm46053740138496"/><a data-type="indexterm" data-primary="EncryptFragment" data-secondary="passing message from MessageFragment to" id="idm46053740137264"/><a data-type="indexterm" data-primary="EncryptMessage" id="idm46053740136192"/><a data-type="indexterm" data-primary="MessageFragment" data-secondary="EncryptFragment" id="idm46053740135360"/><a data-type="indexterm" data-primary="Navigation component" data-secondary="navigation controller" data-tertiary="fragment navigation" id="idm46053740134256"/>Now that we’ve added a <code>String</code> argument to <code>EncryptFragment</code>, <code>MessageFragment</code> can use it to pass along the user’s message when it navigates to this fragment.</p>
<p>As you already know, you navigate from one destination to another by passing a navigation action to the navigation controller. The navigation controller then uses this action to display the correct fragment. <code>MessageFragment</code>, for example, uses the following code to navigate to <code>EncryptFragment</code> when its button is clicked:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0270-02.png" alt="image" width="600" height="94"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="You can pass arguments to navigation actions"><div class="sect2" id="you_can_pass_arguments_to_navigation_act">
<h2>You can pass arguments to navigation actions</h2>
<p>If you want to pass an argument to a destination, you do so by passing its value to the navigation action.</p>
<p>When the navigation controller receives an action that includes an argument, it navigates to the appropriate fragment, and passes along the argument’s value. In the Secret Message app, for example, we can get <code>MessageFragment</code> to pass the user’s message to <code>EncryptMessage</code> (via the navigation controller) by including it in the navigation action. It will work like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0270-03.png" alt="image" width="600" height="197"/>
<h6/>
</div></figure>
<p>You can add arguments to navigation actions using a <code><strong>Directions</strong></code> class. Let’s find out what this is.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Safe Args generates Directions classes"><div class="sect1" id="safe_args_generates_directions_classes">
<h1>Safe Args generates <u>Directions</u> classes</h1>
<p><a data-type="indexterm" data-primary="actionMessageFragmentToEncryptFragment() method, Directions" id="idm46053740119920"/><a data-type="indexterm" data-primary="destinations, navigation graph" id="idm46053740118848"/><a data-type="indexterm" data-primary="Directions class, fragment" id="idm46053740118048"/><a data-type="indexterm" data-primary="EncryptFragment" data-secondary="Directions classes" id="idm46053740117248"/><a data-type="indexterm" data-primary="MessageFragment" data-secondary="Directions classes" id="idm46053740116144"/><a data-type="indexterm" data-primary="MessageFragmentDirections class" id="idm46053740115040"/><a data-type="indexterm" data-primary="Safe Args plug-in" data-secondary="Directions class" id="idm46053740114240"/><code>Directions</code> classes are used to pass arguments to destinations. When you enable the Safe Args plug-in, Android Studio uses it to generate a <code>Directions</code> class <strong>for each fragment you can navigate from</strong>. In the Secret Message app, for example, you can navigate from <code>WelcomeFragment</code> and <code>MessageFragment</code> to other destinations, so the Safe Args plug-in generates a <code>Directions</code> class for each of these fragments; it generates a class named <code>WeclomeFragmentDirections</code> for <code>WelcomeFragment</code>, and one named <code>MessageFragmentDirections</code> gets generated for <code>MessageFragment</code>:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0271-02.png" alt="image" width="600" height="94"/>
<h6/>
</div></figure>
<p>Each fragment uses its own <code>Directions</code> class to navigate with. <code>MessageFragment</code>, for example, needs to use the <code>MessageFragmentDirections</code> class if it wants to navigate elsewhere, and pass an argument.</p>
<section data-type="sect2" data-pdf-bookmark="Use a Directions class to add arguments to actions"><div class="sect2" id="use_a_directions_class_to_add_arguments">
<h2>Use a Directions class to add arguments to actions</h2>
<p>Each <code>Directions</code> class includes a generated method for each of the fragment’s actions. <code>MessageFragment</code>, for example, has an action with the ID “action_messageFragment_to_encryptFragment”, so the <code>MessageFragmentDirections</code> class includes a corresponding method named <code>actionMessageFragmentToEncryptFragment()</code>. And because <code>EncryptFragment</code> accepts a <code>String</code>, the generated method includes a <code>String</code> argument.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0271-03.png" alt="image" width="344" height="330"/>
<h6/>
</div></figure>
<p>You use the generated methods to navigate to destinations. To navigate from <code>MessageFragment</code> to <code>EncryptFragment</code> and pass it a <code>String</code> message, for example, you’d add the following code to <code>MessageFragment</code>:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0271-04.png" alt="image" width="600" height="79"/>
<h6/>
</div></figure>
<p>Let’s add this code now.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Update the MessageFragment.kt code"><div class="sect1" id="update_the_messagefragmentdotkt_code">
<h1>Update the MessageFragment.kt code</h1>
<p><a data-type="indexterm" data-primary="MessageFragment" data-secondary="code for" id="idm46053740091840"/>Here’s the updated code for <code>MessageFragment</code>; make sure you add the changes (in bold) to <em>MessageFragment.kt</em>:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0272-02.png" alt="image" width="600" height="521"/>
<h6/>
</div></figure>
<p>That’s everything <code>MessageFragment</code> needs to pass the user’s message to <code>EncryptFragment</code>. Next, we need to make <code>EncryptFragment</code> pick it up and use it.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="EncryptFragment needs to get the argument’s value"><div class="sect1" id="encryptfragment_needs_to_get_the_argumen">
<h1>EncryptFragment needs to get the argument’s value</h1>
<p><a data-type="indexterm" data-primary="Args class" id="idm46053740082640"/><a data-type="indexterm" data-primary="EncryptFragment" data-secondary="retrieving value from MessageFragment" id="idm46053740081616"/><a data-type="indexterm" data-primary="fromBundle() method, Args class" id="idm46053740080544"/><a data-type="indexterm" data-primary="reversed() method, String" id="idm46053740079744"/><a data-type="indexterm" data-primary="Safe Args plug-in" data-secondary="Args class" id="idm46053740078944"/>As you know, <code>MessageFragment</code> uses a <code>String</code> argument to pass the user’s message to <code>EncryptFragment</code>. <code>EncryptFragment</code> needs to retrieve this value so that it can display an encrypted version of it.</p>
<p>Fragments can retrieve arguments using an <code><strong>Args</strong></code> class. When you enable the Safe Args plug-in, Android Studio uses it to generate an <code>Args</code> class <strong>for each fragment that accepts arguments</strong>. In the Secret Message app, for example, <code>EncryptFragment</code> accepts a <code>String</code> argument, so the Safe Args plug-in generates an <code>Args</code> class for it named <code>EncryptFragmentArgs</code>:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0273-02.png" alt="image" width="410" height="115"/>
<h6/>
</div></figure>
<blockquote>
<p><strong>The Safe Args plug-in generates <u>Directions</u> and <u>Args</u> classes. Use the Directions class to pass arguments to a destination. Use the Args class to retrieve them.</strong></p>
</blockquote>
<section data-type="sect2" data-pdf-bookmark="Use an Args class to retrieve arguments"><div class="sect2" id="use_an_args_class_to_retrieve_arguments">
<h2>Use an <u>Args</u> class to retrieve arguments</h2>
<p>Each <code>Args</code> class includes a <code><strong>fromBundle()</strong></code> method that you use to retrieve any arguments that have been passed to the fragment. In the Secret Message app, for example, <code>EncryptFragment</code> accepts a <code>String</code> argument named <code>message</code>, so you can get the value of this argument using:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0273-03.png" alt="image" width="288" height="192"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0273-04.png" alt="image" width="600" height="51"/>
<h6/>
</div></figure>
<p>This assigns a <code>String</code> object (the value of the argument) to <code>message</code>.</p>
</div></section>
<section data-type="sect2" data-pdf-bookmark="We need to encrypt the message"><div class="sect2" id="we_need_to_encrypt_the_message">
<h2>We need to encrypt the message</h2>
<p>Now that we know how to make <code>EncryptFragment</code> retrieve the user’s message, we can encrypt it and display the result.</p>
<p>We’ll encrypt the message using Kotlin’s <code>reversed()</code> method, which simply reverses the order of a <code>String</code>’s letters. The code looks like this:</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">In the real world, you’d want to use a much more advanced encryption technique. This is just an example.</span></p>
</div>
<pre data-type="programlisting"><strong>val encryptedView = view.findViewById&lt;TextView&gt;(R.id.encrypted_message)</strong>
<strong>encryptedView.text = message.reversed()</strong></pre>
<p>We’ll show you the full <code>EncryptFragment</code> code on the next page.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The full code for EncryptFragment.kt"><div class="sect1" id="the_full_code_for_encryptfragmentdotkt">
<h1>The full code for EncryptFragment.kt</h1>
<p><a data-type="indexterm" data-primary="EncryptFragment" data-secondary="code for" id="idm46053740049552"/>Here’s the complete code for <em>EncryptFragment.kt</em>; update its code so that it includes the changes below:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0274-02.png" alt="image" width="600" height="328"/>
<h6/>
</div></figure>
<p>That’s everything that we need to display the encrypted message. We’ll run through what happens when the app runs on the next page.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00094">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: My project doesn’t recognize the <code>Directions</code> and <code>Args</code> classes. Why is that?</strong></p>
<p><strong>A:</strong> It sounds like the Safe Args plug-in hasn’t generated them.</p>
<p>First, make sure you’ve added the Safe Args plug-in to the app’s <em>build.gradle</em> file, and synced the changes. If it’s missing, Android Studio won’t be able to generate the <code>Directions</code> and <code>Args</code> classes.</p>
<p>Next, make sure you’ve added an argument to <code>EncryptFragment</code> in the navigation graph. Safe Args generates an <code>Args</code> class for every destination that accepts arguments, so if it’s missing, the <code>Args</code> class won’t get generated.</p>
<p>If you still get problems, try rebuilding your project by going to the Build menu and choosing the Rebuild Project option.</p>
<p><strong>Q: You said that Safe Args is added to the <em>build.gradle</em> files as a plug-in, while the rest of the Navigation component is included as a dependency. Why is this?</strong></p>
<p><strong>A:</strong> Safe Args is added as a plug-in because it needs to be able to generate the <code>Directions</code> and <code>Args</code> classes. Plug-ins can generate code, but dependencies can’t.</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="What happens when the app runs"><div class="sect1" id="what_happens_when_the_app_runs-id00095">
<h1>What happens when the app runs</h1>
<p>The following things happen when the app runs:</p>
<ol>
<li><p><strong>The app is launched and MainActivity gets created.</strong></p>
<p><code>WelcomeFragment</code> is added to the navigation host and displayed on the device screen.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0275-02.png" alt="image" width="516" height="153"/>
<h6/>
</div></figure></li>
<li><p><strong>When the user clicks on the Start button, its OnClickListener code passes an action to the navigation controller’s navigate() method.</strong></p>
<p>The action describes a navigation path from <code>WelcomeFragment</code> to <code>MessageFragment</code>.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0275-03.png" alt="image" width="550" height="159"/>
<h6/>
</div></figure></li>
<li><p><strong>The navigation controller puts MessageFragment in the navigation host so that it’s displayed on the device screen.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0275-04.png" alt="image" width="600" height="182"/>
<h6/>
</div></figure></li>
<li><p><strong>The user enters a message and clicks the Next button.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0275-05.png" alt="image" width="370" height="177"/>
<h6/>
</div></figure></li>
<li><p><strong>The Next button’s OnClickListener uses the MessageFragmentDirections class to attach the message to an action.</strong></p>
<p>The action (including the message) is passed to the navigation controller.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0276-02.png" alt="image" width="555" height="197"/>
<h6/>
</div></figure></li>
<li><p><strong>The navigation controller passes the message to EncryptFragment.</strong></p>
<p><code>EncryptFragment</code> uses the <code>EncryptFragmentArgs</code> class to retrieve its value.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0276-03.png" alt="image" width="600" height="195"/>
<h6/>
</div></figure></li>
<li><p><strong>The navigation controller replaces MessageFragment with EncryptFragment in MainActivity’s navigation host.</strong></p>
<p><code>EncryptFragment</code> is displayed on the device screen and shows the encrypted message.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0276-04.png" alt="image" width="600" height="194"/>
<h6/>
</div></figure></li>
</ol>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00096">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<p>When we run the app, <code>WelcomeFragment</code> is displayed, and we can navigate to <code>MessageFragment</code> by clicking on the Start button as before.</p>
<p>When we enter a message and click on <code>MessageFragment</code>’s Next button, <code>EncryptFragment</code> is displayed. It shows the encrypted message.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0277-02.png" alt="image" width="600" height="473"/>
<h6/>
</div></figure>
<p>The app works just the way we want.</p>
<p>There’s just one more change we want to make to it. Before we do so, have a go at the following exercise.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Navigation Magnets"><div class="sect1" id="navigation_magnets">
<h1>Navigation Magnets</h1>
<figure class="informal"><div class="figure">
<img src="Images/common02.png" alt="image" width="86" height="144"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Magnets" id="idm46053739995664"/><a data-type="indexterm" data-primary="Navigation component" data-secondary="navigation graph" data-tertiary="exercises" id="idm46053739994544"/>The navigation graph code below defines the navigation path between two fragments: <code>ChooseTypeFragment</code> and <code>DrinksFragment</code>.</p>
<p><code>ChooseTypeFragment</code> features a spinner with the ID <code>choose</code>, and a button with the ID <code>next</code>. When the user clicks on the button, <code>ChooseTypeFragment</code> needs to navigate to <code>DrinksFragment</code>, passing it the user’s selected value from the spinner.</p>
<p>When <code>DrinksFragment</code> is displayed, it needs to display the selected value in a text view in its layout that has the ID <code>choice</code>.</p>
<p>Someone tried to write the code for <code>ChooseTypeFragment</code> and <code>DrinksFragment</code> using fridge magnets, but some of them fell off when we shut the fridge door too quickly. Can you piece the code back together again?</p>
<p><strong>Navigation graph:</strong></p>
<pre data-type="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;navigation 
    
    
    android:id="@+id/nav_graph"
    app:startDestination="@id/chooseTypeFragment"&gt;

    &lt;fragment
        android:id="@+id/chooseTypeFragment"
        android:name="com.hfad.drinksapp.ChooseTypeFragment"
        android:label="fragment_choose_type"
        tools:layout="@layout/fragment_choose_type" &gt;
        &lt;action
            android:id="@+id/action_chooseTypeFragment_to_drinksFragment"
            app:destination="@id/drinksFragment" /&gt;
    &lt;/fragment&gt;
    &lt;fragment
        android:id="@+id/drinksFragment"
        android:name="com.hfad.drinksapp.DrinksFragment"
        android:label="fragment_drinks"
        tools:layout="@layout/fragment_drinks" &gt;
        &lt;argument
            android:name="drinkType"
            app:argType="string" /&gt;
    &lt;/fragment&gt;
&lt;/navigation&gt;</pre>
<p><strong>ChooseTypeFragment:</strong></p>
<pre data-type="programlisting">class ChooseTypeFragment : Fragment() {
    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?,
                              savedInstanceState: Bundle?): View? {
        val view = inflater.inflate(R.layout.fragment_choose_type, container, false)
        val choice = view.findViewById&lt;Spinner&gt;(R.id.choose).selectedItem.toString()
        val nextButton = view.findViewById&lt;Button&gt;(R.id.next)
        nextButton.setOnClickListener {

            val action = .....................................................
                         .....................................................(choice)
            view.findNavController().navigate(action)
        }
        return view
    }
}</pre>
<p><strong>DrinksFragment:</strong></p>
<pre data-type="programlisting">class DrinksFragment : Fragment() {
    override fun onCreateView(inflater: LayoutInflater, container: ViewGroup?,
                              savedInstanceState: Bundle?): View? {
        val view = inflater.inflate(R.layout.fragment_drinks, container, false)
        val choice = ...................................................................
        val choiceView = view.findViewById&lt;TextView&gt;(R.id.choice)
        choiceView.text = choice
        return view
    }
}</pre>
<figure class="informal"><div class="figure">
<img src="Images/f0279-01.png" alt="image" width="600" height="128"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Navigation Magnets Solution"><div class="sect1" id="navigation_magnets_solution">
<h1>Navigation Magnets Solution</h1>
<figure class="informal"><div class="figure">
<img src="Images/common02.png" alt="image" width="86" height="144"/>
<h6/>
</div></figure>
<p>The navigation graph code below defines the navigation path between two fragments: <code>ChooseTypeFragment</code> and <code>DrinksFragment</code>.</p>
<p><code>ChooseTypeFragment</code> features a spinner with the ID <code>choose</code>, and a button with the ID <code>next</code>. When the user clicks on the button, <code>ChooseTypeFragment</code> needs to navigate to <code>DrinksFragment</code>, passing it the user’s selected value from the spinner.</p>
<p>When <code>DrinksFragment</code> is displayed, it needs to display the selected value in a text view in its layout that has the ID <code>choice</code>.</p>
<p>Someone tried to write the code for <code>ChooseTypeFragment</code> and <code>DrinksFragment</code> using fridge magnets, but some of them fell off when we shut the fridge door too quickly. Can you piece the code back together again?</p>
<p><strong>Navigation graph:</strong></p>
<pre data-type="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;navigation 
    
    
    android:id="@+id/nav_graph"
    app:startDestination="@id/chooseTypeFragment"&gt;

    &lt;fragment
        android:id="@+id/chooseTypeFragment"
        android:name="com.hfad.drinksapp.ChooseTypeFragment"
        android:label="fragment_choose_type"
        tools:layout="@layout/fragment_choose_type" &gt;
        &lt;action
            android:id="@+id/action_chooseTypeFragment_to_drinksFragment"
            app:destination="@id/drinksFragment" /&gt;
    &lt;/fragment&gt;
    &lt;fragment
        android:id="@+id/drinksFragment"
        android:name="com.hfad.drinksapp.DrinksFragment"
        android:label="fragment_drinks"
        tools:layout="@layout/fragment_drinks" &gt;
        &lt;argument
            android:name="drinkType"
            app:argType="string" /&gt;
    &lt;/fragment&gt;
&lt;/navigation&gt;</pre>
<p><strong>ChooseTypeFragment:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0281-01.png" alt="image" width="600" height="305"/>
<h6/>
</div></figure>
<p><strong>DrinksFragment:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0281-02.png" alt="image" width="600" height="192"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0281-03.png" alt="image" width="600" height="108"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="What if the user wants to go back?"><div class="sect1" id="what_if_the_user_wants_to_go_backquestio">
<h1>What if the user wants to go back?</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0282-01.png" alt="image" width="304" height="87"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="back behavior, Secret Message app" id="idm46053739956160"/><a data-type="indexterm" data-primary="EncryptFragment" data-secondary="back behavior" id="idm46053739955088"/><a data-type="indexterm" data-primary="Secret Message app" data-secondary="back behavior" id="idm46053739953984"/>There’s just one more thing we need to consider in the Secret Message app: what happens when the user tries to go back through the app’s screens.</p>
<p>As we’re sure you know, you go back in Androidville using the device back button or with a back gesture, and this takes you back through any screens that have been displayed.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0282-02.png" alt="image" width="418" height="220"/>
<h6/>
</div></figure>
<p>As an example, suppose the user launches the Secret Message app and navigates from <code>WelcomeFragment</code> to <code>MessageFragment</code> and then to <code>EncryptFragment</code> like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0282-03.png" alt="image" width="600" height="219"/>
<h6/>
</div></figure>
<p>If she clicks on the back button while <code>EncryptFragment</code> is displayed, the app goes back to the previous fragment—<code>MessageFragment</code>—like so:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0282-04.png" alt="image" width="600" height="212"/>
<h6/>
</div></figure>
<p>But what if you want pressing the back button to take the user back to an earlier fragment?</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="We could change the back behavior"><div class="sect1" id="we_could_change_the_back_behavior">
<h1>We could change the back behavior</h1>
<p><a data-type="indexterm" data-primary="WelcomeFragment" data-secondary="back behavior to return to" id="idm46053739942704"/>Instead of going back to <code>MessageFragment</code> when the user clicks on the back button, it might be better to go straight back to <code>WelcomeFragment</code>. This would let the user start again from the beginning of the app like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0283-02.png" alt="image" width="600" height="688"/>
<h6/>
</div></figure>
<p>To find out how to control this kind of behavior, let’s go behind the scenes and take a look at how Android’s back stack works.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Welcome to the back stack"><div class="sect1" id="welcome_to_the_back_stack">
<h1>Welcome to the back stack</h1>
<p><a data-type="indexterm" data-primary="back stack" id="idm46053739934992"/>When you go from destination to destination in your app, Android keeps track of each place you’ve visited by adding it to the <strong>back stack</strong>. The back stack is a log of all the places you’ve visited in the app. Each time you navigate to a destination, Android adds it to the top of the back stack, and when you press the back button, it pops the most recent destination off the stack, and displays the one underneath.</p>
<section data-type="sect2" data-pdf-bookmark="A back stack scenario"><div class="sect2" id="a_back_stack_scenario">
<h2>A back stack scenario</h2>
<ol>
<li><p><strong>When you start the Secret Message app, WelcomeFragment is displayed.</strong></p>
<p>Android adds <code>WelcomeFragment</code> to the back stack.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0284-02.png" alt="image" width="201" height="68"/>
<h6/>
</div></figure></li>
<li><p><strong>You navigate to MessageFragment.</strong></p>
<p>This destination is added to the top of the back stack, above <code>WelcomeFragment</code>.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0284-03.png" alt="image" width="199" height="111"/>
<h6/>
</div></figure></li>
<li><p><strong>You then navigate to EncryptFragment.</strong></p>
<p><code>EncryptFragment</code> is added to the top of the back stack.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0284-04.png" alt="image" width="202" height="171"/>
<h6/>
</div></figure></li>
<li><p><strong>You click on the Back button, and EncryptFragment pops off the back stack.</strong></p>
<p><code>MessageFragment</code> is displayed, as this is now at the top of the back stack.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0284-05.png" alt="image" width="199" height="111"/>
<h6/>
</div></figure></li>
<li><p><strong>You click on the Back button again.</strong></p>
<p><code>MessageFragment</code> pops off the top of the back stack, and <code>WelcomeFragment</code> is displayed.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0284-06.png" alt="image" width="201" height="68"/>
<h6/>
</div></figure></li>
</ol>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Use the navigation graph to pop fragments off the back stack"><div class="sect1" id="use_the_navigation_graph_to_pop_fragment">
<h1>Use the navigation graph to pop fragments off the back stack</h1>
<p><a data-type="indexterm" data-primary="Navigation component" data-secondary="navigation graph" data-tertiary="pop behavior" id="idm46053739910080"/><a data-type="indexterm" data-primary="pop behavior, navigation graph" id="idm46053739908544"/>You’ve just seen how the back stack and back button operate by default, but if you want, you can pop destinations off the back stack as the user navigates through the app. You do this by specifying <strong>pop behavior</strong> in the navigation graph.</p>
<p>To see how this works, let’s update the navigation graph in the Secret Message app so that when the app navigates from <code>MessageFragment</code> to <code>EncryptFragment</code>, <code>MessageFragment</code> is popped off the back stack. This means that when the user clicks on the back button while <code>EncryptFragment</code> is displayed, <code>WelcomeFragment</code> is displayed instead of <code>MessageFragment</code>.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0285-02.png" alt="image" width="341" height="373"/>
<h6/>
</div></figure>
<p>Open the navigation graph <em>nav_graph.xml</em> (if it’s not already open), and switch to the design editor. Select the action that connects <code>MessageFragment</code> to <code>EncryptFragment</code>. Then, in the Pop Behavior section of the Attributes panel, change the value of the <code>popUpTo</code> property to “welcomeFragment”. This tells Android to pop fragments off the back stack until it reaches <code>WelcomeFragment</code>:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0285-03.png" alt="image" width="600" height="297"/>
<h6/>
</div></figure>
<p>Before we take the app for a test drive, let’s see what the underlying XML looks like.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The updated nav_graph.xml code"><div class="sect1" id="the_updated_navunderscoregraphdo-id00097">
<h1>The updated nav_graph.xml code</h1>
<p><a data-type="indexterm" data-primary="Navigation component" data-secondary="code for" id="idm46053739897568"/>When you add pop behavior to an action, a <code>&lt;popUpTo&gt;</code> element is added to the underlying XML. This specifies how far back fragments should be popped off the back stack to.</p>
<p>Here’s the updated code for <em>nav_graph.xml</em>:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0286-02.png" alt="image" width="600" height="619"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00098">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<p>When we run the app, <code>WelcomeFragment</code> is displayed. We can navigate to <code>MessageFragment</code> and <code>EncryptFragment</code> as before:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0287-02.png" alt="image" width="600" height="251"/>
<h6/>
</div></figure>
<p>When we click on the back button, the app goes back to <code>WelcomeFragment</code>, and bypasses <code>MessageFragment</code>:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0287-03.png" alt="image" width="600" height="273"/>
<h6/>
</div></figure>
<p>Congratulations! You’ve now learned how to build a multi-screen app that passes data between fragments, and interacts with the back stack. These are core skills for building modern Android apps.</p>
<p>You’ll discover more ways in which you can use the Navigation component in the next chapter.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="BE the Safe Args Plug-in"><div class="sect1" id="be_the_safe_args_plug-in">
<h1>BE the Safe Args Plug-in</h1>
<figure class="informal"><div class="figure">
<img src="Images/common04.png" alt="image" width="156" height="199"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Be the . . ." id="idm46053739876960"/><a data-type="indexterm" data-primary="Safe Args plug-in" data-secondary="exercises" id="idm46053739875520"/><strong>The code below shows the navigation graph for a Starbuzz app. Your job is to play like you’re the Safe Args plug-in, and say which Directions and Args classes will get generated from this code.</strong></p>
<pre data-type="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;navigation 
    
    
    android:id="@+id/nav_graph"
    app:startDestination="@id/selectCoffeeFragment"&gt;

    &lt;fragment
        android:id="@+id/selectCoffeeFragment"
        android:name="com.hfad.starbuzz.SelectCoffeeFragment"
        android:label="fragment_select_coffee"
        tools:layout="@layout/fragment_select_coffee" &gt;
        &lt;action
            android:id="@+id/action_selectCoffeeFragment_to_coffeeFragment"
            app:destination="@id/coffeeFragment" /&gt;
    &lt;/fragment&gt;

    &lt;fragment
        android:id="@+id/coffeeFragment"
        android:name="com.hfad.starbuzz.CoffeeFragment"
        android:label="fragment_coffee"
        tools:layout="@layout/fragment_coffee" &gt;
        &lt;argument
            android:name="coffee"
            app:argType="string" /&gt;
    &lt;/fragment&gt;
&lt;/navigation&gt;</pre>
<p><span class="inlineimage"><img src="Images/arr.png" alt="Images" width="101" height="9"/></span> <strong>Answers in <a data-type="xref" href="#be_the_safe_args_plug-in_solution">“BE the Safe Args Plug-in Solution”</a>.</strong></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-id00099">
<h5><span class="inlineimage"><img src="Images/pencil.png" alt="Images" width="149" height="65"/></span> Sharpen your pencil</h5>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Sharpen your pencil" id="idm46053739865904"/><a data-type="indexterm" data-primary="Navigation component" data-secondary="navigation graph" data-tertiary="exercises" id="idm46053739864704"/>The navigation graph below lets the user navigate from <code>TitleFragment</code> to <code>ChooseTypeFragment</code>, and from <code>ChooseTypeFragment</code> to <code>DrinksFragment</code>.</p>
<p>How would you update the code so that when <code>DrinksFragment</code> is displayed and the user presses the back button, the app goes straight back to <code>TitleFragment</code>?</p>
<pre data-type="programlisting">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;navigation 
    
    
    android:id="@+id/nav_graph"
    app:startDestination="@id/titleFragment"&gt;

    &lt;fragment
        android:id="@+id/titleFragment"
        android:name="com.hfad.drinksapp.TitleFragment"
        android:label="fragment_title"
        tools:layout="@layout/fragment_title" &gt;
        &lt;action
            android:id="@+id/action_titleFragment_to_chooseTypeFragment"
            app:destination="@id/chooseTypeFragment" /&gt;
    &lt;/fragment&gt;

    &lt;fragment
        android:id="@+id/chooseTypeFragment"
        android:name="com.hfad.drinksapp.ChooseTypeFragment"
        android:label="fragment_choose_type"
        tools:layout="@layout/fragment_choose_type" &gt;
        &lt;action
            android:id="@+id/action_chooseTypeFragment_to_drinksFragment"
            app:destination="@id/drinksFragment" /&gt;
    &lt;/fragment&gt;

    &lt;fragment
        android:id="@+id/drinksFragment"
        android:name="com.hfad.drinksapp.DrinksFragment"
        android:label="fragment_drinks"
        tools:layout="@layout/fragment_drinks" /&gt;
&lt;/navigation&gt;</pre>
<p><span class="inlineimage"><img src="Images/arr.png" alt="Images" width="101" height="9"/></span> <strong>Answers in <a data-type="xref" href="#sharpen_your_pencil_solution-id00100">“<span class="inlineimage"><img src="Images/pencil.png" alt="Images" width="149" height="65"/></span> Sharpen your pencil Solution”</a>.</strong></p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="BE the Safe Args Plug-in Solution"><div class="sect1" id="be_the_safe_args_plug-in_solution">
<h1>BE the Safe Args Plug-in Solution</h1>
<figure class="informal"><div class="figure">
<img src="Images/common04.png" alt="image" width="156" height="199"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="Safe Args plug-in" data-secondary="safe" id="idm46053739852208"/><strong>The code below shows the navigation graph for a Starbuzz app. Your job is to play like you’re the Safe Args plug-in, and say which Directions and Args classes will get generated from this code.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0290-01.png" alt="image" width="600" height="488"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil_solution-id00100">
<h5><span class="inlineimage"><img src="Images/pencil.png" alt="Images" width="149" height="65"/></span> Sharpen your pencil Solution</h5>
<p>The navigation graph below lets the user navigate from <code>TitleFragment</code> to <code>ChooseTypeFragment</code>, and from <code>ChooseTypeFragment</code> to <code>DrinksFragment</code>.</p>
<p>How would you update the code so that when <code>DrinksFragment</code> is displayed and the user presses the back button, the app goes straight back to <code>TitleFragment</code>?</p>
<figure class="informal"><div class="figure">
<img src="Images/f0291-01.png" alt="image" width="600" height="639"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Your Android Toolbox"><div class="sect1" id="your_android_toolbox-id00101">
<h1>Your Android Toolbox</h1>
<figure class="informal"><div class="figure">
<img src="Images/tools.png" alt="image" width="182" height="129"/>
<h6/>
</div></figure>
<p><strong>You’ve got <a data-type="xref" href="#safe_argscolon_passing_information">Chapter 7</a> under your belt and now you’ve added the Safe Args plug-in and back stack manipulation to your toolbox.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0292-01.png" alt="image" width="233" height="211"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="bullet_points-id00102">
<h5>Bullet Points</h5>
<ul>
<li><p>Safe Args is an extra part of the Navigation component that’s used to pass arguments in a type-safe way. It generates <code>Directions</code> and <code>Args</code> classes.</p></li>
<li><p><code>Directions</code> classes are used to pass arguments to destinations.</p></li>
<li><p>Safe Args generates a <code>Directions</code> class for every destination you can navigate from.</p></li>
<li><p><code>Args</code> classes are used to retrieve arguments that have been passed to destinations.</p></li>
<li><p>Safe Args generates an <code>Args</code> class for every destination that accepts arguments.</p></li>
<li><p>Use pop behavior in the navigation graph to pop destinations off the back stack.</p></li>
</ul>
</div></aside>
</div></section>
</div></section></div></body></html>