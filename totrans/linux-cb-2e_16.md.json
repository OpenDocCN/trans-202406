["```\n127.0.0.1 localhost\n::1 localhost ip6-localhost ip6-loopback\n192.168.43.81 host1\n192.168.43.82 host2\n192.168.43.83 host3\n```", "```\nhost3:~$ ping -c2 host2\nPING host2 (192.168.43.82) 56(84) bytes of data.\n64 bytes from host2 (192.168.43.82): icmp_seq=1 ttl=64 time=3.00 ms\n64 bytes from host2 (192.168.43.82): icmp_seq=2 ttl=64 time=3.81 ms\n\n--- host2 ping statistics ---\n2 packets transmitted, 2 received, 0% packet loss, time 1001ms\nrtt min/avg/max/mdev = 3.001/3.403/3.806/0.402 ms\n\n```", "```\n127.0.0.1 localhost\n::1 localhost ip6-localhost ip6-loopback\n192.168.43.81 host1.sqr3l.nut host1\n192.168.43.82 host2.sqr3l.nut host2\n192.168.43.83 host3.sqr3l.nut host3\n```", "```\n$ ip addr show dev lo\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group\n  default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host\n       valid_lft forever preferred_lft forever\n```", "```\n$ hostname\nhost1\n\n```", "```\n$ hostname -f\nhost1.sqr3l.nut\n\n```", "```\n$ hostname -d\nsqr3l.nut\n\n```", "```\n*192.168.10.15 dev.stashcat.com*\n```", "```\n*12.34.56.78  badsite.com*\n*12.34.56.78  www.badsite.com*\n```", "```\nhosts: files mdns4_minimal [NOTFOUND=return] dns mymachines\n```", "```\n$ sudo nmap --open *192.168.1.0/24*\nStarting Nmap 7.70 ( https://nmap.org ) at 2021-05-23 13:25 PDT\n[...]\nNmap scan report for dns-server.sqr3l.nut (192.168.1.10)\nHost is up (0.12s latency).\nNot shown: 998 filtered ports\nSome closed ports may be reported as filtered due to --defeat-rst-ratelimit\nPORT   STATE SERVICE\n22/tcp open  ssh\n53/tcp open  domain\n[...]\n\nNmap done: 256 IP addresses (3 hosts up) scanned in 81.38 seconds\n```", "```\n$ sudo nmap -sU -p 53,67 *192.168.1.0/24*\nStarting Nmap 7.80 ( https://nmap.org ) at 2021-05-27 18:05 PDT\n\nNmap scan report for dns-server.sqr3l.nut (192.168.1.10)\nHost is up (0.085s latency).\n\nPORT   STATE         SERVICE\n53/udp open          domain\n67/udp open|filtered dhcps\n\nNmap done: 256 IP addresses (3 hosts up) scanned in 13.85 seconds\n\n```", "```\n$ sudo nmap -sU -sT *192.168.1.0/24*\n```", "```\n$ systemctl status dnsmasq.service\n● dnsmasq.service - dnsmasq - A lightweight DHCP and caching DNS server\n     Loaded: loaded (/lib/systemd/system/dnsmasq.service; enabled; vendor\n     preset: enabled)\n     Active: active (running) since Mon 2021-05-24 05:49:36 PDT; 6h ago\n[...]\n$ sudo systemctl stop dnsmasq.service\n\n```", "```\n$ nmcli connection show --active\nNAME       UUID                     TYPE      DEVICE\n*1local*     3e348c97-4c5f-4bbf-967e  wifi      *wlan1*\n*1wired*     0460d735-e14d-3c3f-92c0  ethernet  *eth1*\n```", "```\n$ nmcli con mod \"*1wired*\" \\\n  ipv4.addresses \"*192.168.1.30/24*\" \\\n  ipv4.gateway \"*192.168.1.1*\" \\\n  ipv4.method \"manual\"\n```", "```\n$ sudo systemctl restart NetworkManager.service\n\n```", "```\n$ systemctl status systemd-resolved.service\n```", "```\n$ systemctl status systemd-resolved.service\n\n● systemd-resolved.service - Network Name Resolution\n     Loaded: loaded (/usr/lib/systemd/system/systemd-resolved.service; enabled;\n     vendor preset: enabled)\n     Active: active (running) since Sat 2021-05-22 12:57:34 PDT; 1min 21s ago\n[...]\n```", "```\n$ sudo systemctl stop systemd-resolved.service\n$ sudo systemctl disable systemd-resolved.service\n```", "```\n$ ls -l /etc/resolv.conf\nlrwxrwxrwx 1 root root 39 May 21 20:38 /etc/resolv.conf ->\n   ../run/systemd/resolve/stub-resolv.conf\n\n```", "```\n$ sudo rm /etc/resolv.conf\n$ sudo touch /etc/resolv.conf\n\n```", "```\n$ sudo nano /etc/NetworkManager/NetworkManager.conf\n\n[main]\ndns=none\n```", "```\nsearch *sqr3l.nut*\nnameserver 127.0.0.1\nnameserver ::1\n```", "```\n127.0.0.1 localhost\n::1 localhost ip6-localhost ip6-loopback\n192.168.43.81 dns-server\n192.168.43.82 backups\n192.168.43.83 https\n\n```", "```\n$ sudo mv /etc/dnsmasq.conf /etc/dnsmasq.conf-old\n$ sudo nano /etc/dnsmasq.conf\n\n```", "```\n# global options\nresolv-file=/etc/resolv.conf\ndomain-needed\nbogus-priv\nexpand-hosts\ndomain=*sqr3l.nut*\nlocal=/*sqr3l.nut*/\nlisten-address=127.0.0.1\nlisten-address=*192.168.43.81*\n\n# upstream name servers\nserver=*208.67.222.222*\nserver=*208.67.220.220*\n\n```", "```\n$ dnsmasq --test\ndnsmasq: syntax check OK.\n\n```", "```\n$ sudo systemctl start dnsmasq.service\n$ systemctl status dnsmasq.service\n● dnsmasq.service - dnsmasq - A lightweight DHCP and caching DNS server\n     Loaded: loaded (/lib/systemd/system/dnsmasq.service; enabled; vendor preset:\n     enabled)\n     Active: active (running) since Mon 2021-05-24 17:13:48 PDT; 1min 0s ago\n    Process: 11023 ExecStartPre=/usr/sbin/dnsmasq --test (code=exited,\n     status=0/SUCCESS)\n    Process: 11024 ExecStart=/etc/init.d/dnsmasq systemd-exec (code=exited,\n     status=0/SUCCESS)\n    Process: 11033 ExecStartPost=/etc/init.d/dnsmasq systemd-start-resolvconf\n     (code=exited, status=0/SUCCESS)\n   Main PID: 11032 (dnsmasq)\n      Tasks: 1 (limit: 18759)\n     Memory: 2.5M\n     CGroup: /system.slice/dnsmasq.service\n             └─11032 /usr/sbin/dnsmasq -x /run/dnsmasq/dnsmasq.pid -u dnsmasq -7\n              /etc/dnsmasq.d,.dpkg-dist,.dpkg-old,.dpkg-new --local->\n\nMay 24 17:13:48 dns-server systemd[1]: Starting dnsmasq - A lightweight DHCP and\n caching DNS server...\nMay 24 17:13:48 dns-server dnsmasq[11023]: dnsmasq: syntax check OK.\nMay 24 17:13:48 dns-server systemd[1]: Started dnsmasq - A lightweight DHCP and\n caching DNS server.\n\n```", "```\n$ nslookup *dns-server*\nServer:         127.0.0.1\nAddress:        127.0.0.1#53\n\nName:   *dns-server*\nAddress: *192.168.43.81*\n\n$ nslookup *dns-server.sqr3l.nut*\nServer:         127.0.0.1\nAddress:        127.0.0.1#53\n\nName:   *dns-server.sqr3l.nut*\nAddress: *192.168.43.81*\n\n$ nslookup *192.168.43.81*\n*18.43.168.192*.in-addr.arpa       name = *host1.sqr3l.nut.*\n\n```", "```\n$ sudo ss -lp \"sport = :domain\"\nNetid  State   Local Address:Port    Process\nudp    UNCONN     127.0.0.1:domain   users:((\"dnsmasq\",pid=1531,fd=8))\nudp    UNCONN  *192.168.1.10*:domain   users:((\"dnsmasq\",pid=1531,fd=6))\ntcp    LISTEN     127.0.0.1:domain   users:((\"dnsmasq\",pid=1531,fd=9))\ntcp    LISTEN  *192.168.1.10*:domain   users:((\"dnsmasq\",pid=1531,fd=7))\n\n```", "```\n$ sudo firewall-cmd --permanent --add-service=\\{dns,dhcp\\}\n\n```", "```\n$ dig @*192.168.1.10* oreilly.com\n\n; <<>> DiG 9.16.6 <<>> @*192.168.1.10* oreilly.com\n; (1 server found)\n;; global options: +cmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 29387\n;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1\n\n;; OPT PSEUDOSECTION:\n; EDNS: version: 0, flags:; udp: 4096\n;; QUESTION SECTION:\n;oreilly.com.                   IN      A\n\n;; ANSWER SECTION:\noreilly.com.            240     IN      A       199.27.145.65\noreilly.com.            240     IN      A       199.27.145.64\n\n;; Query time: 108 msec\n;; SERVER: *192.168.1.10*#53(*192.168.1.10*)\n;; WHEN: Mon May 24 17:49:32 PDT 2021\n;; MSG SIZE  rcvd: 72\n```", "```\n$ dig @*dns-server* oreilly.com\n$ dig @*dns-server.sqr3l.nut* oreilly.com\n```", "```\n# DHCP range\ndhcp-range=*192.168.1.25,192.168.1.75,12h*\ndhcp-lease-max=*25*\n\n```", "```\n$ sudo systemctl restart dnsmasq.service\n\n```", "```\n$ nmcli con show --active\nNAME    UUID                     TYPE     DEVICE\n*1net*    de7c00e7-8e4d-45e6-acaf  ethernet eth0\n\n$ nmcli con show *1net* | grep ipv..method\nipv4.method:           auto\nipv6.method:           auto\n\n```", "```\n$ sudo nmcli con down *1net*\nConnection '1net' successfully deactivated (D-Bus active path: /org/freedesktop/\nNetworkManager/ActiveConnection/11\n\n$ sudo nmcli con up *1net*\nConnection successfully activated (D-Bus active path: /org/freedesktop/NetworkMan\nager/ActiveConnection/15)\n```", "```\n$ journalctl -ru dnsmasq\n-- Logs begin at Sun 2021-02-28 14:35:01 PST, end at Mon 2021-05-31 17:36:04\n PDT. --\nMay 31 17:34:56 dns-server dnsmasq-dhcp[8080]: DHCPACK(eth0) 192.168.1.45\n 9c:ef:d5:fe:01:7c client2\nMay 31 17:34:56 dns-server dnsmasq-dhcp[8080]: DHCPREQUEST(eth0) 192.168.1.45\n9c:ef:d5:fe:01:7c\n```", "```\n$ sudo dhclient -v\nInternet Systems Consortium DHCP Client 4.3.6-P1\nCopyright 2004-2018 Internet Systems Consortium.\nAll rights reserved.\nFor info, please visit https://www.isc.org/software/dhcp/\n\nListening on LPF/*eth0/9c:ef:d5:fe:01:7c*\nSending on   LPF/*eth0/9c:ef:d5:fe:01:7c*\nSending on   Socket/fallback\nDHCPREQUEST on *eth0* to 255.255.255.255 port 67 (xid=0xec8923)\nDHCPACK from *192.168.1.10* (xid=0xec8923)\nbound to *192.168.1.27* -- renewal in 1415 seconds.\n\n```", "```\ndhcp-option=3,*192.168.1.1*\n```", "```\ndhcp-option=6,*192.168.1.10*\n```", "```\ndhcp-option=42,*192.168.1.11*\n```", "```\n$ dnsmasq --help dhcp\nKnown DHCP options:\n  1 netmask\n  2 time-offset\n  3 router\n  6 dns-server\n  7 log-server\n  9 lpr-server\n  [...]\n\n```", "```\ndhcp-range=*zone1,192.168.50.20,192.168.50.120*\ndhcp-range=*zone2,192.168.60.20,192.168.60.50,24h*\n\n```", "```\ndhcp-option=*zone1,3,192.168.50.1*\ndhcp-option=*zone2,3,192.168.60.2*\n\n```", "```\ndhcp-option=*zone1,6,192.168.1.10*\ndhcp-option=*zone2,6,192.168.1.10*\n```", "```\ndhcp-option=*zone2,42,192.168.60.15*\n\n```", "```\ndhcp-host=*server2,192.168.3.45*\n```", "```\nsend host-name = gethostname();\n```", "```\nsend host-name = *myhostname*\n```", "```\n$ nmcli connection show --active\nNAME    UUID                                  TYPE      DEVICE\n*wifi1   3e348c97-4c5f-4bbf-967e-7624f3e1e4f0*  wifi      *wlan1*\n```", "```\n$ nmcli connection show *wifi1* | grep send-hostname\nipv4.dhcp-send-hostname:                yes\nipv6.dhcp-send-hostname:                yes\n```", "```\n$ sudo nmcli con mod *wifi1* ipv4.dhcp-send-hostname yes\n$ sudo nmcli con mod *wifi1* ipv6.dhcp-send-hostname yes\n$ sudo nmcli con reload\n```", "```\n/var/log/dnsmasq/dnsmasq.log {\n    missingok\n    compress\n    notifempty\n    rotate 4\n    weekly\n    create\n    }\n```", "```\n$ sudo /etc/logrotate.conf --debug\n[...]\nrotating pattern: /var/log/dnsmasq/dnssmasq.log  weekly (4 rotations)\nempty log files are not rotated, old logs are removed\nswitching euid to 0 and egid to 4\nconsidering log /var/log/dnsmasq/dnssmasq.log\nCreating new state\n  Now: 2021-06-01 13:08\n  Last rotated at 2021-06-01 13:00\n  log does not need rotating (log has been already rotated)\nswitching euid to 0 and egid to 0\n[...]\n```", "```\naddress=/*wildcard.net/192.168.1.35*\n```", "```\n$ sudo systemctl restart dnsmasq.service\n$ nslookup *foo.wildcard.net*\nServer:         127.0.0.1\nAddress:        127.0.0.1#53\n\nName:   *foo.wildcard.net*\nAddress: 192.168.1.35\n```"]