<html><head></head><body><section data-pdf-bookmark="Chapter 20. Electron Deployment" data-type="chapter" epub:type="chapter"><div class="chapter" id="desktop-deployment">&#13;
<h1><span class="label">Chapter 20. </span>Electron Deployment</h1>&#13;
&#13;
&#13;
<p><a data-primary="Electron" data-secondary="deployment" data-type="indexterm" id="ix_ch20-asciidoc0"/>The first time I taught a programming course, I came up with the clever idea of introducing the course topics through a text adventure game. Students would come into the lab, sit down at a desk, and walk through a series of hilarious (to me) prompts and instructions. This was met with mixed reactions, not because of the jokes (well, maybe because of the jokes), but because students had not interacted with a “program” in this way. The students were accustomed to a GUI (graphic user interface), and interacting with a program through text prompts felt <em>wrong</em> to many of them.</p>&#13;
&#13;
<p>Presently, to run our application we need to type a prompt in our terminal application to start the Electron process. In this chapter, we’ll look at how we can bundle our application for distribution. To achieve this, we’ll be using the popular <a href="https://www.electron.build">Electron Builder</a> library, which will help us package and distribute our application to our users.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Electron Builder" data-type="sect1"><div class="sect1" id="idm45339485883272">&#13;
<h1>Electron Builder</h1>&#13;
&#13;
<p><a data-primary="Electron" data-secondary="Electron Builder" data-type="indexterm" id="idm45339485881832"/><a data-primary="Electron Builder" data-type="indexterm" id="idm45339485880856"/>Electron Builder is a library designed to simplify the packaging and distribution of Electron and <a href="https://proton-native.js.org">Proton Native</a> applications. While there are other packaging solutions, Electron Builder  simplifies a number of pain points associated with application distribution, including:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Code signing</p>&#13;
</li>&#13;
<li>&#13;
<p>Multiplatform distribution targets</p>&#13;
</li>&#13;
<li>&#13;
<p>Autoupdates</p>&#13;
</li>&#13;
<li>&#13;
<p>Distribution</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>It offers a great balance between flexibility and features. Additionally, though we won’t be making use of them, there are several Electron Builder boilerplates for <a href="https://oreil.ly/faYta">Webpack</a>, <a href="https://oreil.ly/qli_e">React</a>, <a href="https://oreil.ly/9QY2W">Vue</a>, and <a href="https://oreil.ly/uJo7e">Vanilla JavaScript</a>.</p>&#13;
<div data-type="note" epub:type="note"><h1>Electron Builder Versus Electron Forge</h1>&#13;
<p><a href="https://www.electronforge.io">Electron Forge</a> is<a data-primary="Electron Forge" data-type="indexterm" id="idm45339485869736"/> another popular library that offers many similar features to Electron Builder. A primary advantage of Electron Forge is that it is based on official Electron libraries, while Electron Builder is an independent build tool. This means that users benefit from the growth of the Electron ecosystem. The downside is that Electron Forge is based on a much more rigid application setup. For the purposes of this book, Electron Builder provides the right balance of features and learning opportunities, but I encourage you to take a close look at Electron Forge as well.</p>&#13;
</div>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Configuring Electron Builder" data-type="sect2"><div class="sect2" id="idm45339485868040">&#13;
<h2>Configuring Electron Builder</h2>&#13;
&#13;
<p><a data-primary="Electron Builder" data-secondary="configuring" data-type="indexterm" id="idm45339485866664"/>All of the configuration of Electron Builder will take place in our application’s <span class="keep-together"><em>package.json</em></span> file. In that file we can see that <code>electron-builder</code> is already listed as a development dependency. Within the <em>package.json</em> file we can include a key, called <code>"build"</code>, which will contain all of the instructions to Electron Builder for packaging our app. To begin, we will include two fields:</p>&#13;
<dl>&#13;
<dt><code>appId</code></dt>&#13;
<dd>&#13;
<p>This<a data-primary="appId" data-type="indexterm" id="idm45339485861432"/> is a unique identifier for our application. macOS calls the concept <a href="https://oreil.ly/OOg1O"><code>CFBundle</code>​<span class="keep-together"><code>Identifier</code></span></a> and Windows terms it the <a href="https://oreil.ly/mr9si"><code>AppUser</code>​<span class="keep-together"><code>ModelID</code></span></a>. The standard is to use the reverse DNS format. For example, if we run a company with a domain of <em>jseverywhere.io</em> and build an application named Notedly, the ID would be <code>io.jseverywhere.notedly</code>.</p>&#13;
</dd>&#13;
<dt><code>productName</code></dt>&#13;
<dd>&#13;
<p>This<a data-primary="productName" data-type="indexterm" id="idm45339485854888"/> is the human-readable version of our product’s name, as the <code>package.json</code> <code>name</code> field requires hyphenated or single-word names.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>All together, our beginning build configuration will appear as follows:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="s2">"build"</code><code class="o">:</code> <code class="p">{</code>&#13;
  <code class="s2">"appId"</code><code class="o">:</code> <code class="s2">"io.jseverywhere.notedly"</code><code class="p">,</code>&#13;
  <code class="s2">"productName"</code><code class="o">:</code> <code class="s2">"Notedly"</code>&#13;
<code class="p">},</code></pre>&#13;
&#13;
<p>Electron Builder provides us with many configuration options, several of which we’ll be exploring throughout this chapter. For the complete list, visit the <a href="https://oreil.ly/ESAx-">Electron Builder docs</a>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Build for Our Current Platform" data-type="sect1"><div class="sect1" id="idm45339485844072">&#13;
<h1>Build for Our Current Platform</h1>&#13;
&#13;
<p><a data-primary="Electron" data-secondary="building for current platform" data-type="indexterm" id="idm45339485842728"/>With our minimal configuration in place, we can create our first application build. By default, Electron Builder will produce a build for the system we are developing on. For example, since I am writing this on a MacBook, my build will default to macOS.</p>&#13;
&#13;
<p>Let’s first add two scripts to our <em>package.json</em> file, which will be responsible for application builds. First, a <code>pack</code> script will generate a package directory, without fully packaging the app. This can be useful for testing purposes. Second, a <code>dist</code> script will package the application in distributable format, such as a macOS DMG, Windows installer, or DEB package.</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="s2">"scripts"</code><code class="o">:</code> <code class="p">{</code>&#13;
  <code class="c1">// add the pack and dist scripts to the existing npm scripts list</code>&#13;
  <code class="s2">"pack"</code><code class="o">:</code> <code class="s2">"electron-builder --dir"</code><code class="p">,</code>&#13;
  <code class="s2">"dist"</code><code class="o">:</code> <code class="s2">"electron-builder"</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>With this change, you can run <code>npm run dist</code> in your terminal application, which will package the application in the project’s <em>dist/</em> directory. Navigating to the <em>dist/</em> directory, you can see that Electron Builder has packaged the application for distribution for your operating system.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="App Icons" data-type="sect1"><div class="sect1" id="idm45339485818232">&#13;
<h1>App Icons</h1>&#13;
&#13;
<p><a data-primary="app icons" data-type="indexterm" id="idm45339485793128"/><a data-primary="Electron" data-secondary="app icons" data-type="indexterm" id="idm45339485792424"/>One thing that you have likely noticed is that our application is using the default Electron app icon. This is fine for local development, but for a production application we will want to use our own branding. In our project’s <em>/resources</em> folder, I have included some application icons for both macOS and Windows. To generate these icons from a PNG file, I used the <a href="https://iconverticons.com">iConvert Icons application</a>, which is available for both macOS and Windows.</p>&#13;
&#13;
<p>In our <em>/resources</em> folder you will see the following files:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><em>icon.icns</em>, the macOS application icon</p>&#13;
</li>&#13;
<li>&#13;
<p><em>icon.ico</em>, the Windows application icon</p>&#13;
</li>&#13;
<li>&#13;
<p>An <em>icons</em> directory with a series of different-sized <em>.png</em> files, used by Linux</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Optionally, we could also include background images for the macOS DMG by adding icons with the names of <em>background.png</em> and <em>background@2x.png</em>, for retina screens.</p>&#13;
&#13;
<p>Now within our <em>package.json</em> file, we update the <code>build</code> object to specify the name of the build resource directory:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="s2">"build"</code><code class="o">:</code> <code class="p">{</code>&#13;
  <code class="s2">"appId"</code><code class="o">:</code> <code class="s2">"io.jseverywhere.notedly"</code><code class="p">,</code>&#13;
  <code class="s2">"productName"</code><code class="o">:</code> <code class="s2">"Notedly"</code><code class="p">,</code>&#13;
  <code class="s2">"directories"</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="s2">"buildResources"</code><code class="o">:</code> <code class="s2">"resources"</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">},</code></pre>&#13;
&#13;
<p>Now, when we build the application, Electron Builder will package it with our custom application icons (see <a data-type="xref" href="#dock_icon">Figure 20-1</a>).</p>&#13;
&#13;
<figure><div class="figure" id="dock_icon">&#13;
<img alt="A screenshot of the macOS dock icon" src="assets/jsev_2001.png"/>&#13;
<h6><span class="label">Figure 20-1. </span>Our custom application icon in the macOS dock</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Building for Multiple Platforms" data-type="sect1"><div class="sect1" id="idm45339485731384">&#13;
<h1>Building for Multiple Platforms</h1>&#13;
&#13;
<p><a data-primary="Electron" data-secondary="building for multiple platforms" data-type="indexterm" id="idm45339485729976"/>Currently, we’re only building our application for the operating system that matches our development platform. One of the great advantages of Electron as a platform is that it allows us to use the same code to target multiple platforms, by updating our <code>dist</code> script. To achieve this, Electron Builder makes use of the free and open source <a href="https://oreil.ly/IEIfW"><code>electron-build-service</code></a>. We’ll be using the public instance of this service, but it is possible to self-host it for organizations seeking additional security and privacy.</p>&#13;
&#13;
<p>In our <code>package.json</code> update the <code>dist</code> script to:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="s2">"dist"</code><code class="o">:</code> <code class="s2">"electron-builder -mwl"</code></pre>&#13;
&#13;
<p>This will result in a build that targets macOS, Windows, and Linux. From here we can distribute our application by uploading it as a release to GitHub or anywhere that we can distribute files, such as Amazon S3 or our web server.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Code Signing" data-type="sect1"><div class="sect1" id="idm45339485669912">&#13;
<h1>Code Signing</h1>&#13;
&#13;
<p><a data-primary="code signing" data-type="indexterm" id="idm45339485684456"/><a data-primary="Electron" data-secondary="code signing" data-type="indexterm" id="idm45339485683752"/>Both macOS and Windows include the concept of <em>code signing</em>. Code signing is a boost for the security and trust of users, as it helps signify the trustworthiness of the app. I won’t be walking through the code-signing process, as it is operating system specific and comes at a cost to developers. The Electron Builder documentation offers a <a href="https://oreil.ly/g6wEz">comprehensive article</a> on code signing for various platforms. Additionally, the <a href="https://oreil.ly/Yb4JF">Electron documentation</a> offers several resources and links. If you are building a production application, I encourage you to further research the code-signing options for macOS and Windows.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Conclusion" data-type="sect1"><div class="sect1" id="idm45339485680184">&#13;
<h1>Conclusion</h1>&#13;
&#13;
<p>We’ve covered the tip of the iceberg for deploying an Electron application. In this chapter we used Electron Builder to build our applications. We can then easily upload and distribute them through any web host. Once we have outgrown these needs, we can use Electron Builder to integrate builds into a continuous delivery pipeline; automatically push releases to GitHub, S3, or other distribution platforms; and integrate automatic updates into the application. If you are interested in further exploring the topics of Electron development and app distribution, these are fantastic next steps to take.<a data-startref="ix_ch20-asciidoc0" data-type="indexterm" id="idm45339485678232"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section></body></html>