<html><head></head><body><section data-pdf-bookmark="Chapter 12. Working with HTML" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch12">&#13;
<h1><span class="label">Chapter 12. </span>Working with HTML</h1>&#13;
&#13;
&#13;
<p><a data-primary="Eich, Brendan" data-type="indexterm" id="idm45475150428648"/><a data-primary="JavaScript" data-secondary="history" data-type="indexterm" id="idm45475150427944"/><a data-primary="HTML5" data-type="indexterm" id="ix_html5_ch12"/>In 1995 Netscape tasked software developer Brendan Eich with creating a programming language designed to add interactivity to pages in the Netscape Navigator browser. In response, Eich infamously developed the first version of JavaScript in 10 days. <a data-primary="ECMAScript" data-secondary="adoption of standard" data-type="indexterm" id="idm45475150425848"/>A few years later, JavaScript became a cross-browser standard through the adoption of the ECMAScript standardization.</p>&#13;
&#13;
<p>Despite the early attempt at standardization, web developers battled for years with browsers that had different JavaScript engine interpretations or features. <a data-primary="jQuery" data-type="indexterm" id="idm45475150424184"/>Popular libraries, such as jQuery, effectively allowed us to write simple cross-browser JavaScript. Thankfully, today’s browsers share a near uniform implementation of the language, allowing web developers to write “vanilla” (library-free) JavaScript to interact with an HTML page.</p>&#13;
&#13;
<p><a data-primary="DOM (Document Object Model)" data-type="indexterm" id="idm45475150422888"/>When working with HTML, we are working with the Document Object Model (DOM), which is the data representation of the HTML page. The recipes in this chapter will review how to interact with the DOM of an HTML page by selecting, updating, and removing elements from the page.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Accessing a Given Element and Finding Its Parent and Child Elements" data-type="sect1"><div class="sect1" id="access_a_given_element_and_find_its_pare">&#13;
<h1>Accessing a Given Element and Finding Its Parent and Child Elements</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475150420056">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="elements" data-secondary="parent and child" data-type="indexterm" id="ix_element_par-child"/><a data-primary="accessibility" data-secondary="to HTML elements" data-secondary-sortas="HTML elements" data-type="indexterm" id="idm45475150417432"/><a data-primary="parent and child elements in HTML" data-type="indexterm" id="ix_par_child_elem"/><a data-primary="HTML5" data-secondary="parent and child elements" data-type="indexterm" id="ix_html5_par_child"/><a data-primary="HTML5" data-secondary="accessibility to elements" data-type="indexterm" id="ix_html5_elem_access"/>You want to access a specific web page element, and then find its parent and child elements.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475150412296">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Give the element a unique identifier:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="nt">&lt;div</code> <code class="na">id=</code><code class="s">"demodiv"</code><code class="nt">&gt;</code>&#13;
  <code class="nt">&lt;p&gt;</code>&#13;
    This is text.&#13;
  <code class="nt">&lt;/p&gt;</code>&#13;
<code class="nt">&lt;/div&gt;</code></pre>&#13;
&#13;
<p>Use <code>document.getElementById()</code> to get a reference to the specific element:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">demodiv</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s2">"demodiv"</code><code class="p">);</code></pre>&#13;
&#13;
<p>Find its parent via the <code>parentNode</code> property:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">parent</code> <code class="o">=</code> <code class="nx">demodiv</code><code class="p">.</code><code class="nx">parentNode</code><code class="p">;</code></pre>&#13;
&#13;
<p><a data-primary="childNodes property" data-type="indexterm" id="idm45475150391448"/>Find its children via the <code>childNodes</code> property:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">children</code> <code class="o">=</code> <code class="nx">demodiv</code><code class="p">.</code><code class="nx">childNodes</code><code class="p">;</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475150361240">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><a data-primary="HTML5" data-secondary="document tree organization" data-type="indexterm" id="idm45475150359800"/>A web document is organized like an upside-down tree, with the topmost element at the root and all other elements branching out beneath. Except for the root element (HTML), each element has a parent <code>node</code>, and all of the elements are accessible via the <code>document</code>.</p>&#13;
&#13;
<p><a data-primary="elements" data-seealso="HTML5" data-type="indexterm" id="idm45475150349864"/><a data-primary="DOM (Document Object Model)" data-secondary="nodes (elements)" data-type="indexterm" id="ix_dom_nodes"/><a data-primary="nodes, DOM" data-type="indexterm" id="ix_nodes_dom"/>There are several different techniques available for accessing these document elements, or <em>nodes</em> as they’re called in the DOM. Today, we access these nodes through standardized versions of the DOM, such as DOM Levels 2 and 3. Originally, though, a de facto technique was to access the elements through the browser object model, sometimes referred to as DOM Level 0. DOM Level 0 was invented by the leading browser company of the time, Netscape, and its use has been supported (more or less) in most browsers since. <a data-primary="document object" data-type="indexterm" id="idm45475150325736"/>The key object for accessing web page elements in the DOM Level 0 is the <code>document</code> object.</p>&#13;
&#13;
<p>The most commonly used DOM method is <code>document.getElementById()</code>. It takes one parameter: a case-sensitive string with the element’s identifier. It returns an <code>element</code> object, which is referenced to the element if it exists; otherwise, it returns null.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>There are numerous ways to get one specific web page element, including the use of selectors, covered later in the chapter. But you’ll always want to use the most restrictive method possible, and you can’t get more restrictive than <code>document.getElementById()</code>.</p>&#13;
</div>&#13;
&#13;
<p><a data-primary="node object" data-type="indexterm" id="idm45475150297496"/><a data-primary="element object" data-type="indexterm" id="idm45475150296792"/>The returned <code>element</code> object has a set of methods and properties, including several inherited from the <code>node</code> object. The <code>node</code> methods are primarily associated with traversing the document tree. For instance, to find the parent node for the element, use the following:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">parent</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s2">"demodiv"</code><code class="p">).</code><code class="nx">parentNode</code><code class="p">;</code></pre>&#13;
&#13;
<p><a data-primary="nodeName property" data-type="indexterm" id="idm45475150270376"/>You can find out the type of element for each node through the <code>nodeName</code> property:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">type</code> <code class="o">=</code> <code class="nx">parent</code><code class="p">.</code><code class="nx">nodeName</code><code class="p">;</code></pre>&#13;
&#13;
<p><a data-primary="NodeList" data-type="indexterm" id="idm45475150241128"/><a data-primary="childNodes property" data-type="indexterm" id="idm45475150246392"/>If you want to find out what children an element has, you can traverse a collection of them via a <code>NodeList</code>, obtained using the <code>childNodes</code> property:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">let</code> <code class="nx">outputString</code> <code class="o">=</code> <code class="s1">''</code><code class="p">;</code>&#13;
&#13;
<code class="k">if</code> <code class="p">(</code><code class="nx">demodiv</code><code class="p">.</code><code class="nx">hasChildNodes</code><code class="p">())</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">children</code> <code class="o">=</code> <code class="nx">demodiv</code><code class="p">.</code><code class="nx">childNodes</code><code class="p">;</code>&#13;
  <code class="nx">children</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">child</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
    <code class="nx">outputString</code> <code class="o">+=</code> <code class="sb">`has child </code><code class="si">${</code><code class="nx">child</code><code class="p">.</code><code class="nx">nodeName</code><code class="si">}</code><code class="sb"> `</code><code class="p">;</code>&#13;
  <code class="p">});</code>&#13;
<code class="p">}</code>&#13;
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">outputString</code><code class="p">);</code></pre>&#13;
&#13;
<p>Given the element in the solution, the output would be:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="s2">"has child #text has child P has child #text "</code></pre>&#13;
&#13;
<p>You might be surprised by what appeared as a child node. In this example, whitespace before and after the paragraph element is itself a child node with a <code>nodeName</code> of <code>#text</code>. For the following <code>div</code> element:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="nt">&lt;div</code> <code class="na">id=</code><code class="s">"demodiv"</code> <code class="na">class=</code><code class="s">"demo"</code><code class="nt">&gt;</code>&#13;
  <code class="nt">&lt;p&gt;</code>Some text<code class="nt">&lt;/p&gt;</code>&#13;
  <code class="nt">&lt;p&gt;</code>Some more text<code class="nt">&lt;/p&gt;</code>&#13;
<code class="nt">&lt;/div&gt;</code></pre>&#13;
&#13;
<p>the <code>demodiv</code> element (node) has five children, not two:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">has</code> <code class="nx">child</code> <code class="err">#</code><code class="nx">text</code>&#13;
<code class="nx">has</code> <code class="nx">child</code> <code class="nx">P</code>&#13;
<code class="nx">has</code> <code class="nx">child</code> <code class="err">#</code><code class="nx">text</code>&#13;
<code class="nx">has</code> <code class="nx">child</code> <code class="nx">P</code>&#13;
<code class="nx">has</code> <code class="nx">child</code> <code class="err">#</code><code class="nx">text</code></pre>&#13;
&#13;
<p><a data-primary="errors (Error object)" data-secondary="debugging" data-type="indexterm" id="idm45475150081416"/><a data-primary="debugging" data-type="indexterm" id="idm45475150087800"/>The best way to see how messy the DOM can be is to use a debugger such as the Firefox or Chrome developer tools, access a web page, and then utilize whatever DOM inspection tool the debugger provides. <a data-primary="DevTools (Chrome Developer Tools)" data-type="indexterm" id="idm45475150059128"/>I opened a simple page in Chrome and used the developer tools to display the element tree, as shown in <a data-type="xref" href="#chrome_display_page">Figure 12-1</a>.<a data-primary="" data-startref="ix_html5_elem_access" data-type="indexterm" id="idm45475150057448"/><a data-primary="" data-startref="ix_html5_par_child" data-type="indexterm" id="idm45475150056472"/><a data-primary="" data-startref="ix_par_child_elem" data-type="indexterm" id="idm45475150055528"/><a data-primary="" data-startref="ix_access_html" data-type="indexterm" id="idm45475150054584"/><a data-primary="" data-startref="ix_element_par-child" data-type="indexterm" id="idm45475150053640"/><a data-primary="" data-startref="ix_nodes_dom" data-type="indexterm" id="idm45475150052696"/><a data-primary="" data-startref="ix_dom_nodes" data-type="indexterm" id="idm45475150051752"/></p>&#13;
&#13;
<figure class="no-frame"><div class="figure" id="chrome_display_page">&#13;
<img alt="jsc3 1201" src="assets/jsc3_1201.png"/>&#13;
<h6><span class="label">Figure 12-1. </span>Examining the element tree of a web page using Chrome’s Developer Tools</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Traversing the Results from querySelectorAll() with forEach()" data-type="sect1"><div class="sect1" id="traversing_results_queryselect">&#13;
<h1>Traversing the Results from querySelectorAll() <span class="keep-together">with forEach()</span></h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475150046776">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="forEach() method" data-secondary="results from querySelectorAll() with" data-type="indexterm" id="idm45475150045576"/><a data-primary="querySelectorAll() method" data-type="indexterm" id="idm45475150044632"/><a data-primary="HTML5" data-secondary="results from querySelectorAll() with forEach()" data-type="indexterm" id="idm45475150043992"/>You want to loop over the <code>nodeList</code> returned from a call to <code>querySelectorAll()</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475150041896">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>In modern browsers, you can use <code>forEach()</code>  when working with a <code>NodeList</code> (the collection returned by <code>querySelectorAll()</code>):</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// use querySelectorAll to find all list items on a page</code>&#13;
<code class="kr">const</code> <code class="nx">items</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'li'</code><code class="p">);</code>&#13;
&#13;
<code class="nx">items</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">item</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">item</code><code class="p">.</code><code class="nx">firstChild</code><code class="p">.</code><code class="nx">data</code><code class="p">);</code>&#13;
<code class="p">});</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475150015272">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><code>forEach()</code> is an array method, but <code>querySelectorAll()</code> produces a <code>NodeList</code> which is a different type of object than an array. <a data-primary="NodeList" data-type="indexterm" id="idm45475149988136"/>Thankfully, modern browsers have built-in support for <code>forEach</code>, allowing us to iterate over a <code>NodeList</code> as though it is an array.</p>&#13;
&#13;
<p><a data-primary="IE (Internet Explorer)" data-type="indexterm" id="idm45475149986344"/>Unfortunately, Internet Explorer (IE) does not support using <code>forEach</code> in this way. <a data-primary="polyfills" data-type="indexterm" id="idm45475149985128"/>If you’d like to support IE, the recommended approach is to include a polyfill that uses a standard <code>for</code> loop under the hood:</p>&#13;
&#13;
<pre class="pagebreak-before less_space" data-code-language="javascript" data-type="programlisting"><code class="k">if</code> <code class="p">(</code><code class="nb">window</code><code class="p">.</code><code class="nx">NodeList</code> <code class="o">&amp;&amp;</code> <code class="o">!</code><code class="nx">NodeList</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">forEach</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="nx">NodeList</code><code class="p">.</code><code class="nx">prototype</code><code class="p">.</code><code class="nx">forEach</code> <code class="o">=</code> <code class="kd">function</code><code class="p">(</code><code class="nx">callback</code><code class="p">,</code> <code class="nx">thisArg</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nx">thisArg</code> <code class="o">=</code> <code class="nx">thisArg</code> <code class="o">||</code> <code class="nb">window</code><code class="p">;</code>&#13;
    <code class="k">for</code> <code class="p">(</code><code class="kd">var</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="k">this</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>&#13;
      <code class="nx">callback</code><code class="p">.</code><code class="nx">call</code><code class="p">(</code><code class="nx">thisArg</code><code class="p">,</code> <code class="k">this</code><code class="p">[</code><code class="nx">i</code><code class="p">],</code> <code class="nx">i</code><code class="p">,</code> <code class="k">this</code><code class="p">);</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">};</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>In the polyfill, we check for the existence of <code>NodeList.prototype.forEach</code>. If it does not exist, a <code>forEach</code> method is added to the <code>NodeList</code> prototype that uses a <code>for</code> loop to iterate over the results of a DOM query. By doing so, you can use the <code>forEach</code> syntax freely across your codebase.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Adding Click Functionality to an Element" data-type="sect1"><div class="sect1" id="idm45475149865256">&#13;
<h1>Adding Click Functionality to an Element</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475149864296">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="click functionality, adding" data-type="indexterm" id="ix_click_functionality"/><a data-primary="HTML5" data-secondary="click functionality" data-type="indexterm" id="ix_html5_click_function"/>You need to add JavaScript functionality when a user clicks a button, link, or element on the page.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475149860440">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Add a <code>click</code> event listener for the element:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// define an event handler function</code>&#13;
<code class="kr">const</code> <code class="nx">clickHandler</code> <code class="o">=</code> <code class="p">(</code><code class="nx">event</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nb">window</code><code class="p">.</code><code class="nx">alert</code><code class="p">(</code><code class="s1">'The element has been clicked!'</code><code class="p">);</code>&#13;
<code class="p">};</code>&#13;
&#13;
<code class="c1">// select element</code>&#13;
<code class="kr">const</code> <code class="nx">btn</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'click-button'</code><code class="p">);</code>&#13;
<code class="c1">// add the event listener to the element and call 'clickHandler' function</code>&#13;
<code class="nx">btn</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="nx">clickHandler</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475149856104">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><a data-primary="events" data-secondary="addEventListener()" data-type="indexterm" id="idm45475149816232"/><a data-primary="addEventListener() method" data-type="indexterm" id="idm45475149815032"/>The <code>addEventListener()</code> method allows our JavaScript to listen for a specific type of event and define a function that will be called when the event is triggered. In the previous example, <a data-primary="events" data-secondary="click" data-type="indexterm" id="idm45475149813672"/><a data-primary="click events" data-type="indexterm" id="idm45475149812696"/>I have added a <code>click</code> listener to a button element. When the button is clicked, the <code>clickHandler</code> function will be called, which fires an alert.</p>&#13;
&#13;
<p><a data-primary="elements" data-secondary="button" data-type="indexterm" id="idm45475149810904"/><a data-primary="button element, for click handler" data-type="indexterm" id="idm45475149780360"/>By default, you should use a <code>button</code> element for clickable event handlers, as it is the most accessible solution for handling click events. The <code>button</code> element can be styled to appear as a link if necessary for the application’s design. However, it is appropriate to use an element when the fallback behavior of linking to a page, should the <span class="keep-together">JavaScript</span> fail to load, is the desired behavior. <a data-primary="preventDefault() method" data-type="indexterm" id="idm45475149777768"/>When doing so, the <code>preventDefault</code> event method allows you to override the default link behavior:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">clickHandler</code> <code class="o">=</code> <code class="p">(</code><code class="nx">event</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">event</code><code class="p">.</code><code class="nx">preventDefault</code><code class="p">();</code>&#13;
  <code class="nb">window</code><code class="p">.</code><code class="nx">alert</code><code class="p">(</code><code class="sb">`The </code><code class="si">${</code><code class="nx">event</code><code class="p">.</code><code class="nx">currentTarget</code><code class="p">.</code><code class="nx">nodeName</code><code class="si">}</code><code class="sb"> element has been clicked!`</code><code class="p">);</code>&#13;
<code class="p">};</code>&#13;
&#13;
<code class="kr">const</code> <code class="nx">href</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'click-link'</code><code class="p">);</code>&#13;
<code class="nx">href</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="nx">clickHandler</code><code class="p">);</code></pre>&#13;
<div data-type="tip"><h6>Tip</h6>&#13;
<p><a data-primary="this keyword" data-secondary="arrow function syntax and" data-type="indexterm" id="idm45475149715736"/>In traditional JavaScript functions, the <code>this</code> keyword would be bound to the item being clicked. However, when using JavaScript’s newer arrow function syntax, such as in this example, the value of <code>this</code> is inherited from the parent function, which by default is <code>window</code>.  This can be confusing if you are accustomed to nonarrow syntax functions. If you are interested in reading more, I recommend <a href="https://oreil.ly/wK7Ik">Joe Cardillo’s article on the topic</a>.</p>&#13;
</div>&#13;
&#13;
<p><a data-primary="keyboard navigation" data-type="indexterm" id="idm45475149712120"/>On rare instances, it may be desirable to make a block element, such as a <code>div</code> clickable. I’d recommend doing so sparingly, in favor of the <code>button</code> element whenever possible. However, for these occasions, you will need to ensure that the functionality is accessible for those using screen readers and keyboard navigation. First, in your markup apply a <code>role</code> of <code>button</code> and a <code>tabindex</code> value. The <code>role</code> property will inform screen reader users that this is a clickable element, while the <code>tabindex</code> will make the element keyboard navigable:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="nt">&lt;div</code> <code class="na">tabindex=</code><code class="s">"0"</code> <code class="na">role=</code><code class="s">"button"</code> <code class="na">id=</code><code class="s">"click-div"</code><code class="nt">&gt;</code>Click me<code class="nt">&lt;/div&gt;</code></pre>&#13;
&#13;
<p>In this instance, we use a <code>keydown</code> event handler. This will allow keyboard users to interact with the element:<a data-primary="" data-startref="ix_html5_click_function" data-type="indexterm" id="idm45475149701480"/><a data-primary="" data-startref="ix_click_functionality" data-type="indexterm" id="idm45475149700632"/></p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">clickHandler</code> <code class="o">=</code> <code class="p">(</code><code class="nx">event</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nb">window</code><code class="p">.</code><code class="nx">alert</code><code class="p">(</code><code class="sb">`The </code><code class="si">${</code><code class="nx">event</code><code class="p">.</code><code class="nx">currentTarget</code><code class="p">.</code><code class="nx">nodeName</code><code class="si">}</code><code class="sb"> element has been clicked!`</code><code class="p">);</code>&#13;
<code class="p">};</code>&#13;
&#13;
<code class="kr">const</code> <code class="nx">clickableDiv</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'click-link'</code><code class="p">);</code>&#13;
<code class="nx">clickableDiv</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="nx">clickHandler</code><code class="p">);</code>&#13;
&#13;
<code class="c1">// when using a div add a keydown event listener for keyboard users</code>&#13;
<code class="nx">clickableDiv</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'keydown'</code><code class="p">,</code> <code class="p">(</code><code class="nx">event</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="k">if</code> <code class="p">(</code><code class="nx">event</code><code class="p">.</code><code class="nx">code</code> <code class="o">===</code> <code class="s1">'Space'</code> <code class="o">||</code> <code class="nx">event</code><code class="p">.</code><code class="nx">code</code> <code class="o">===</code> <code class="s1">'Enter'</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nx">clickableDiv</code><code class="p">.</code><code class="nx">click</code><code class="p">();</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">});</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Finding All Elements That Share an Attribute" data-type="sect1"><div class="sect1" id="idm45475149698488">&#13;
<h1>Finding All Elements That Share an Attribute</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475149697608">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="shared attributes, finding elements with" data-type="indexterm" id="idm45475149553816"/><a data-primary="attribute selectors" data-type="indexterm" id="idm45475149553080"/><a data-primary="HTML5" data-secondary="shared attributes, finding elements with" data-type="indexterm" id="idm45475149552408"/>You want to find all elements in a web document that share the same attribute.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475149551048">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="* (universal selector)" data-type="indexterm" id="idm45475149549640"/>Use the <em>universal selector</em> (<code>*</code>) in combination with the attribute selector to find all elements that have an attribute, regardless of its value:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">elems</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'*[class]'</code><code class="p">);</code></pre>&#13;
&#13;
<p>The universal selector can also be used to find all elements with an attribute that’s assigned the same value:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">reds</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'*[class="red"]'</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475149550744">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The solution demonstrates a rather elegant query selector, the <em>universal selector</em> (<code>*</code>). The universal selector evaluates all elements, so it’s the one you want to use when you need to verify <em>something</em> about each element. In the solution, we want to find all of the elements with a given attribute.</p>&#13;
&#13;
<p>To test whether an attribute exists, all you need to do is list the attribute name within square brackets (<em><code>[attrname]</code></em>). In the solution, we’re first testing whether the element contains the <code>class</code> attribute. If it does, it’s returned with the element collection:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">var</code> <code class="nx">elems</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'*[class]'</code><code class="p">);</code></pre>&#13;
&#13;
<p>Next, we’re getting all elements with a <code>class</code> attribute value of <code>red</code>. If you’re not sure of the class name, you can use the substring-matching query selector:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">reds</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'*[class="red"]'</code><code class="p">);</code></pre>&#13;
&#13;
<p>Now any class name that contains the substring <code>red</code> matches.</p>&#13;
&#13;
<p>You could also modify the syntax to find all elements that don’t have a certain value. For instance, to find all <code>div</code> elements that don’t have the target class name, use the <code>:not</code> negation operator:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">notRed</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'div:not(.red)'</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Accessing All Elements of a Specific Type" data-type="sect1"><div class="sect1" id="idm45475149438152">&#13;
<h1>Accessing All Elements of a Specific Type</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475149407880">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="accessibility" data-secondary="to HTML elements" data-secondary-sortas="HTML elements" data-type="indexterm" id="ix_access_html2"/><a data-primary="HTML5" data-secondary="accessibility to elements" data-type="indexterm" id="ix_html5_elem_access2"/><a data-primary="images (img element)" data-secondary="accessing" data-type="indexterm" id="ix_images_access"/>You want to access all <code>img</code> elements in a given document.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475149401992">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="getElementsByTagName() method" data-type="indexterm" id="ix_get_elem_by_tag-name"/>Use the <code>document.getElementsByTagName()</code> method, passing in <code>img</code> as the <span class="keep-together">parameter:</span></p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">imgElements</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementsByTagName</code><code class="p">(</code><code class="s1">'img'</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475149368584">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The <code>document.getElementsByTagName()</code> method returns a collection of nodes (a <code>NodeList</code>) of a given element type, such as the <code>img</code> tag in the solution. The collection can be traversed like an array, and the order of nodes is based on the order of the elements within the document (the first <code>img</code> element in the page is accessible at index 0, etc.):</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">imgElements</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementsByTagName</code><code class="p">(</code><code class="s1">'img'</code><code class="p">);</code>&#13;
<code class="k">for</code> <code class="p">(</code><code class="kd">let</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">imgElements</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code> <code class="o">+=</code> <code class="mi">1</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">img</code> <code class="o">=</code> <code class="nx">imgElements</code><code class="p">[</code><code class="nx">i</code><code class="p">];</code>&#13;
  <code class="p">...</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>As discussed in <a data-type="xref" href="#traversing_results_queryselect">“Traversing the Results from querySelectorAll() <span class="keep-together">with forEach()</span>”</a>, a <code>NodeList</code> collection can be traversed like an array, but it isn’t an <code>Array</code> object. You can’t use <code>Array</code> object methods, such as <code>push()</code> and <code>reverse()</code>, with a <code>NodeList</code>. Its only property is <code>length</code>, and its only method is <code>item()</code>, returning the element at the position given by an index passed in as a <span class="keep-together">parameter</span>:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">img</code> <code class="o">=</code> <code class="nx">imgElements</code><code class="p">.</code><code class="nx">item</code><code class="p">(</code><code class="mi">1</code><code class="p">);</code> <code class="c1">// second image</code></pre>&#13;
&#13;
<p><code>NodeList</code> is an intriguing object because it’s a live collection, which means changes made to the document after the <code>NodeList</code> is retrieved are reflected in the collection. <a data-type="xref" href="#demonstrating_getelementsbytagnamecomma">Example 12-1</a> demonstrates the <code>NodeList</code> live collection functionality, as well as <code>getElementsByTagName</code>.</p>&#13;
&#13;
<p>In the example, three images in the web page are accessed as a <code>NodeList</code> collection using the <code>getElementsByTagName</code> method. The <code>length</code> property, with a value of <code>3</code>, is output to the console. Immediately after, a new paragraph and <code>img</code> elements are created, and the <code>img</code> is appended to the paragraph. To append the paragraph following the others in the page, <code>getElementsByTagName</code> is used again, this time with the paragraph tags (<code>p</code>). <a data-primary="parentNode property" data-type="indexterm" id="idm45475149257752"/>We’re not really interested in the paragraphs, but in the paragraphs’ parent elements, found via the <code>parentNode</code> property on each paragraph.</p>&#13;
&#13;
<p>The new paragraph element is appended to the paragraph’s parent element, and the previously accessed <code>NodeList</code> collection’s length property is again printed out. Now, the value is <code>4</code>, reflecting the addition of the new <code>img</code> element.</p>&#13;
<div data-type="example" id="demonstrating_getelementsbytagnamecomma">&#13;
<h5><span class="label">Example 12-1. </span>Demonstrating <code>getElementsByTagName</code> and the <code>NodeList</code> live collection property</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>&#13;
<code class="nt">&lt;html&gt;</code>&#13;
<code class="nt">&lt;head&gt;</code>&#13;
<code class="nt">&lt;title&gt;</code>NodeList<code class="nt">&lt;/title&gt;</code>&#13;
<code class="nt">&lt;/head&gt;</code>&#13;
<code class="nt">&lt;body&gt;</code>&#13;
  <code class="nt">&lt;p&gt;&lt;img</code> <code class="na">src=</code><code class="s">"firstimage.jpg"</code> <code class="na">alt=</code><code class="s">"image description"</code> <code class="nt">/&gt;&lt;/p&gt;</code>&#13;
  <code class="nt">&lt;p&gt;&lt;img</code> <code class="na">src=</code><code class="s">"secondimage.jpg"</code> <code class="na">alt=</code><code class="s">"image description"</code> <code class="nt">/&gt;&lt;/p&gt;</code>&#13;
  <code class="nt">&lt;p&gt;&lt;img</code> <code class="na">src=</code><code class="s">"thirdimage.jpg"</code> <code class="na">alt=</code><code class="s">"image description"</code> <code class="nt">/&gt;&lt;/p&gt;</code>&#13;
&#13;
<code class="nt">&lt;script&gt;</code>&#13;
  <code class="kr">const</code> <code class="nx">imgs</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementsByTagName</code><code class="p">(</code><code class="s1">'img'</code><code class="p">);</code>&#13;
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">imgs</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>&#13;
  <code class="kr">const</code> <code class="nx">p</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'p'</code><code class="p">);</code>&#13;
  <code class="kr">const</code> <code class="nx">img</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'img'</code><code class="p">);</code>&#13;
  <code class="nx">img</code><code class="p">.</code><code class="nx">src</code> <code class="o">=</code> <code class="s1">'./img/someimg.jpg'</code><code class="p">;</code>&#13;
  <code class="nx">p</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">img</code><code class="p">);</code>&#13;
&#13;
  <code class="kr">const</code> <code class="nx">paras</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementsByTagName</code><code class="p">(</code><code class="s1">'p'</code><code class="p">);</code>&#13;
  <code class="nx">paras</code><code class="p">[</code><code class="mi">0</code><code class="p">].</code><code class="nx">parentNode</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">p</code><code class="p">);</code>&#13;
&#13;
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">imgs</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code>&#13;
<code class="nt">&lt;/script&gt;</code>&#13;
&#13;
<code class="nt">&lt;/body&gt;</code>&#13;
<code class="nt">&lt;/html&gt;</code></pre></div>&#13;
&#13;
<p><a data-type="xref" href="#demonstrating_getelementsbytagnamecomma">Example 12-1</a> will log the following output to the browser console:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="o">&lt;</code><code class="nx">img</code> <code class="nx">src</code><code class="o">=</code><code class="s2">"img/firstimage.jpg"</code> <code class="nx">alt</code><code class="o">=</code><code class="s2">"image description"</code><code class="o">&gt;</code>&#13;
<code class="o">&lt;</code><code class="nx">img</code> <code class="nx">src</code><code class="o">=</code><code class="s2">"img/secondimage.jpg"</code> <code class="nx">alt</code><code class="o">=</code><code class="s2">"image description"</code><code class="o">&gt;</code>&#13;
<code class="o">&lt;</code><code class="nx">img</code> <code class="nx">src</code><code class="o">=</code><code class="s2">"img/thirdimage.jpg"</code> <code class="nx">alt</code><code class="o">=</code><code class="s2">"image description"</code><code class="o">&gt;</code>&#13;
<code class="mi">3</code>&#13;
<code class="mi">4</code></pre>&#13;
&#13;
<p>In addition to using <code>getElementsByTagName()</code> with a specific element type, you can also pass the universal selector (<code>*</code>) as a parameter to the method to get all elements:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">allElems</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementsByTagName</code><code class="p">(</code><code class="s1">'*'</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="idm45475149368120">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>In the code demonstrated in the discussion, the children nodes are traversed using a traditional <code>for</code> loop. In modern browsers, the <code>forEach()</code> method can be used directly with a <code>NodeList</code>, as demonstrated in <a data-type="xref" href="#traversing_results_queryselect">“Traversing the Results from querySelectorAll() <span class="keep-together">with forEach()</span>”</a>.<a data-primary="" data-startref="ix_html5_elem_access2" data-type="indexterm" id="idm45475149082776"/><a data-primary="" data-startref="ix_access_html2" data-type="indexterm" id="idm45475149081800"/><a data-primary="" data-startref="ix_get_elem_by_tag-name" data-type="indexterm" id="idm45475149080856"/><a data-primary="" data-startref="ix_images_access" data-type="indexterm" id="idm45475149079912"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discovering Child Elements Using the Selectors API" data-type="sect1"><div class="sect1" id="idm45475149078840">&#13;
<h1>Discovering Child Elements Using the Selectors API</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475149072792">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Selectors API" data-type="indexterm" id="ix_selectors_api"/><a data-primary="web apps/APIs" data-secondary="Selectors API" data-type="indexterm" id="ix_web_app_selectorsapi"/><a data-primary="images (img element)" data-secondary="discovering child elements" data-type="indexterm" id="ix_image_child_elem"/><a data-primary="child element discovery with Selectors API" data-type="indexterm" id="ix_child_elem_disc"/><a data-primary="HTML5" data-secondary="child element discovery with Selectors API" data-type="indexterm" id="ix_html5_child_disc"/>You want to get a list of all instances of a child element, such as <code>img</code> elements, that are descendants of a parent element, such as <code>article</code> elements, without having to traverse an entire collection of elements.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475149064872">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="strings (String object)" data-secondary="CSS-style selector" data-type="indexterm" id="idm45475149063672"/><a data-primary="CSS-style selector strings" data-type="indexterm" id="idm45475149062696"/>Use the Selectors API and access the <code>img</code> elements contained within <code>article</code> elements using CSS-style selector strings:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">imgs</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'article img'</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475148940552">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><a data-primary="querySelectorAll() method" data-type="indexterm" id="idm45475148939112"/><a data-primary="querySelector() method" data-type="indexterm" id="idm45475148938248"/>There are two selector query API methods. The first, <code>querySelectorAll()</code>, is demonstrated in the solution; the second is <code>querySelector()</code>. The difference between the two is that <code>querySelectorAll()</code> returns all elements that match the selector criteria, while <code>querySelector()</code> only returns the first found result.</p>&#13;
&#13;
<p>The selector syntax is derived from CSS selector syntax, except that rather than style the selected elements, they’re returned to the application. In the example, all <code>img</code> elements that are descendants of <code>article</code> elements are returned. To access all <code>img</code> elements regardless of parent element, use:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">imgs</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'img'</code><code class="p">);</code></pre>&#13;
&#13;
<p>In the solution, you’ll get all <code>img</code> elements that are direct or indirect descendants of an <code>article</code> element. This means that if the <code>img</code> element is contained within a <code>div</code> that’s within an <code>article</code>, the <code>img</code> element will be among those returned:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="nt">&lt;article&gt;</code>&#13;
   <code class="nt">&lt;div&gt;</code>&#13;
      <code class="nt">&lt;img</code> <code class="na">src=</code><code class="s">"..."</code> <code class="nt">/&gt;</code>&#13;
   <code class="nt">&lt;/div&gt;</code>&#13;
<code class="nt">&lt;/article&gt;</code></pre>&#13;
&#13;
<p>If you want only those <code>img</code> elements that are direct children of an <code>article</code> element, use the <span class="keep-together">following</span>:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">imgs</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'article &gt; img'</code><code class="p">);</code></pre>&#13;
&#13;
<p>If you’re interested in accessing all <code>img</code> elements that are immediately followed by a paragraph, use:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">imgs</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'img + p'</code><code class="p">);</code></pre>&#13;
&#13;
<p>If you’re interested in an <code>img</code> element that has an empty <code>alt</code> attribute, use the <span class="keep-together">following:</span></p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">imgs</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'img[alt=""]'</code><code class="p">);</code></pre>&#13;
&#13;
<p>If you’re only interested in <code>img</code> elements that don’t have an empty <code>alt</code> attribute, use:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">imgs</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'img:not([alt=""])'</code><code class="p">);</code></pre>&#13;
&#13;
<p>The negation pseudoselector (<code>:not</code>) is used to find all <code>img</code> elements with <code>alt</code> attributes that are not empty.</p>&#13;
&#13;
<p>Unlike the collection returned with <code>getElementsByTagName()</code> covered earlier, the collection of elements returned from <code>querySelectorAll()</code> is <em>not</em> a “live” collection.  Updates to the page are not reflected in the collection if the updates occur after the collection is retrieved.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Though the Selectors API is a wonderful creation, it shouldn’t be used for every document query. To keep your applications performant, I recommend always using the most restrictive query possible when accessing elements. For example, it’s more efficient (meaning faster for the browser) to use <code>getElementById()</code> to get a specific element given an identifier than using <code>querySelectorAll()</code> for the same element.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="idm45475148939960">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>There are three different CSS selector specifications, labeled as Selectors Level 1, Level 2, and Level 3. <a href="https://oreil.ly/rGfxD">CSS Selectors Level 3</a> contains links to the documents defining the other levels. These documents provide the definitions of, and examples for, the different types of selectors.<a data-primary="" data-startref="ix_html5_child_disc" data-type="indexterm" id="idm45475148729448"/><a data-primary="" data-startref="ix_child_elem_disc" data-type="indexterm" id="idm45475148728472"/><a data-primary="" data-startref="ix_image_child_elem" data-type="indexterm" id="idm45475148727528"/><a data-primary="" data-startref="ix_selectors_api" data-type="indexterm" id="idm45475148726584"/><a data-primary="" data-startref="ix_web_app_selectorsapi" data-type="indexterm" id="idm45475148725640"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Changing an Element’s Class Value" data-type="sect1"><div class="sect1" id="idm45475148724440">&#13;
<h1>Changing an Element’s Class Value</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475148723464">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="CSS (Cascading Style Sheet)" data-secondary="changing properties" data-type="indexterm" id="idm45475148722264"/><a data-primary="properties" data-secondary="CSS" data-type="indexterm" id="idm45475148721320"/><a data-primary="HTML5" data-secondary="class value change to an element" data-type="indexterm" id="idm45475148720376"/><a data-primary="class value change to an HTML element" data-type="indexterm" id="idm45475148719464"/>You want to update the CSS rules applied to an element by changing its class value.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475148718392">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="classlist property" data-type="indexterm" id="idm45475148717224"/>Use the <code>classList</code> property of an element to add, remove, and toggle class values:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">element</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'example-element'</code><code class="p">);</code>&#13;
<code class="c1">// add a new class</code>&#13;
<code class="nx">element</code><code class="p">.</code><code class="nx">classList</code><code class="p">.</code><code class="nx">add</code><code class="p">(</code><code class="s1">'new-class'</code><code class="p">);</code>&#13;
<code class="c1">// remove an existing class</code>&#13;
<code class="nx">element</code><code class="p">.</code><code class="nx">classList</code><code class="p">.</code><code class="nx">remove</code><code class="p">(</code><code class="s1">'existing-class'</code><code class="p">);</code>&#13;
<code class="c1">// if toggle-me is present it is removed, if not it is added</code>&#13;
<code class="nx">element</code><code class="p">.</code><code class="nx">classList</code><code class="p">.</code><code class="nx">toggle</code><code class="p">(</code><code class="s1">'toggle-me'</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475148700408">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Using <code>classList</code> allows you to easily manipulate the class properties of a selected element. This can come in handy for updating or swapping styles without using inline CSS. <a data-primary="contains() method" data-type="indexterm" id="idm45475148665784"/>At times, it may be helpful to check if an element already has a class value applied, which can be accomplished with the <code>contains</code> method:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="k">if</code> <code class="p">(</code><code class="nx">element</code><code class="p">.</code><code class="nx">classList</code><code class="p">.</code><code class="nx">contains</code><code class="p">(</code><code class="s1">'new-class'</code><code class="p">))</code> <code class="p">{</code>&#13;
  <code class="nx">element</code><code class="p">.</code><code class="nx">classList</code><code class="p">.</code><code class="nx">remove</code><code class="p">(</code><code class="s1">'new-class'</code><code class="p">);</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>It is also possible to add, remove, or toggle multiple classes, either by passing them each as individual properties or using a spread operator:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// add multiple classes</code>&#13;
<code class="p">.</code><code class="nx">classList</code><code class="p">.</code><code class="nx">add</code><code class="p">(</code><code class="s2">"my-class"</code><code class="p">,</code> <code class="s2">"another-class"</code><code class="p">);</code>&#13;
&#13;
<code class="c1">// remove multiple classes with a spread operator</code>&#13;
<code class="kr">const</code> <code class="nx">classes</code> <code class="o">=</code> <code class="p">[</code><code class="s2">"my-class"</code><code class="p">,</code> <code class="s2">"another-class"</code><code class="p">];</code>&#13;
<code class="nx">div</code><code class="p">.</code><code class="nx">classList</code><code class="p">.</code><code class="nx">remove</code><code class="p">(...</code><code class="nx">classes</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Setting an Element’s Style Attribute" data-type="sect1"><div class="sect1" id="idm45475148658344">&#13;
<h1>Setting an Element’s Style Attribute</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475148564152">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="style attribute" data-type="indexterm" id="ix_style_attr"/><a data-primary="HTML5" data-secondary="style attribute setting" data-type="indexterm" id="ix_html5_style_attr"/>You want to directly add or replace an inline style on a specific element.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475148560472">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="CSS (Cascading Style Sheet)" data-secondary="attribute selectors" data-type="indexterm" id="ix_css_attr"/><a data-primary="properties" data-secondary="CSS" data-type="indexterm" id="idm45475148557848"/><a data-primary="style property" data-type="indexterm" id="idm45475148556904"/>To change one CSS property as an inline style, modify the property value via the element’s <code>style</code> property:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">elem</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">backgroundColor</code> <code class="o">=</code> <code class="s1">'red'</code><code class="p">;</code></pre>&#13;
&#13;
<p><a data-primary="setAttribute() method" data-type="indexterm" id="ix_setattr_method"/>To modify one or more CSS properties for a single element, you can use <code>setAttribute()</code> and create an entire CSS style rule:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">elem</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s1">'style'</code><code class="p">,</code>&#13;
  <code class="s1">'background-color: red; color: white; border: 1px solid black'</code><code class="p">);</code></pre>&#13;
&#13;
<p>These techniques set an inline style value for the HTML element, which will appear within the HTML itself. To demonstrate further, the following JavaScript sets a style attribute on an element with an ID of <code>card</code>:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">card</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'card'</code><code class="p">);</code>&#13;
<code class="nx">card</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code>&#13;
  <code class="s1">'style'</code><code class="p">,</code>&#13;
  <code class="s1">'background-color: #ecf0f1; color: #2c3e50;'</code>&#13;
<code class="p">);</code></pre>&#13;
&#13;
<p>The resulting HTML output includes the inline style value:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="nt">&lt;div</code> <code class="na">id=</code><code class="s">"card"</code> <code class="na">style=</code><code class="s">"background-color: #ecf0f1; color: #2c3e50;"</code><code class="nt">&gt;</code>&#13;
...&#13;
<code class="nt">&lt;/div&gt;</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475148473368">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>An element’s CSS properties can be modified in JavaScript using one of three approaches. As the solution demonstrates, the simplest approach is to set the property’s value directly using the element’s <code>style</code> property:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">elem</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="s1">'500px'</code><code class="p">;</code></pre>&#13;
&#13;
<p><a data-primary="CamelCase notation" data-type="indexterm" id="idm45475148425480"/>If the CSS property contains a hyphen, such as <code>font-family</code> or <code>background-color</code>, use the <em>CamelCase notation</em> for the property:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">elem</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">fontFamily</code> <code class="o">=</code> <code class="s1">'Courier'</code><code class="p">;</code>&#13;
<code class="nx">elem</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">backgroundColor</code> <code class="o">=</code> <code class="s1">'rgb(255,0,0)'</code><code class="p">;</code></pre>&#13;
&#13;
<p>The CamelCase notation removes the dash and capitalizes the first letter following the dash.</p>&#13;
&#13;
<p>You can also use <code>setAttribute()</code> or <code>cssText</code> to set the <code>style</code> property. This is useful when adding multiple styles:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// using setAttribute</code>&#13;
<code class="nx">elem</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s1">'style'</code><code class="p">,</code><code class="s1">'font-family: Courier; background-color: yellow'</code><code class="p">);</code>&#13;
&#13;
<code class="c1">// alternately apply a value to style.cssText</code>&#13;
<code class="nx">elem</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">cssText</code> <code class="o">=</code> <code class="s1">'font-family: Courier; background-color: yellow'</code><code class="p">;</code></pre>&#13;
&#13;
<p>The <code>setAttribute()</code> method is a way of adding an attribute or replacing the value of an existing attribute for a web page element. The first argument to the method is the attribute name (automatically lowercased if the element is an HTML element) and the new attribute value.</p>&#13;
&#13;
<p>When setting the <code>style</code> attribute, all CSS properties that are changed must be specified at the same time, as setting the attribute erases any previously set values. However, setting the <code>style</code> attribute using <code>setAttribute()</code> does not erase any settings made in a stylesheet, or set by default by the browser.<a data-primary="" data-startref="ix_css_attr" data-type="indexterm" id="idm45475148338680"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Extra: Accessing an Existing Style Setting" data-type="sect2"><div class="sect2" id="idm45475148472776">&#13;
<h2>Extra: Accessing an Existing Style Setting</h2>&#13;
&#13;
<p><a data-primary="getAttribute() method" data-type="indexterm" id="idm45475148336440"/>For the most part, accessing existing attribute values is as easy as setting them. Instead of using <code>setAttribute()</code>, use <code>getAttribute()</code>. For example, to get the value of the class:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">className</code> <code class="o">=</code> <code class="nx">elem</code><code class="p">.</code><code class="nx">getAttribute</code><code class="p">(</code><code class="s1">'class'</code><code class="p">);</code></pre>&#13;
&#13;
<p>Getting access to a style setting, though, is much trickier, because a specific element’s style settings at any one time is a composite of all settings merged into a whole. <a data-primary="computed styles" data-type="indexterm" id="idm45475148300504"/>This <em>computed style</em> for an element is what you’re most likely interested in when you want to see specific style settings for the element at any point in time. <a data-primary="getComputedStyle() method" data-type="indexterm" id="idm45475148297592"/>Happily, there is a method for that, <code>window.getComputedStyle()</code>, which will return the current computed styles applied to the element:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">style</code> <code class="o">=</code> <code class="nb">window</code><code class="p">.</code><code class="nx">getComputedStyle</code><code class="p">(</code><code class="nx">elem</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Advanced" data-type="sect2"><div class="sect2" id="idm45475148337512">&#13;
<h2>Advanced</h2>&#13;
&#13;
<p><a data-primary="createAttribute() method" data-type="indexterm" id="idm45475148255432"/>Rather than using <code>setAttribute()</code> to add or modify the attribute, you can create an attribute and attach it to the element using <code>createAttribute()</code> to create an <code>Attr</code> node, set its value using the <code>nodeValue</code> property, and then use <code>setAttribute()</code> to add the attribute to the element:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">styleAttr</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createAttribute</code><code class="p">(</code><code class="s1">'style'</code><code class="p">);</code>&#13;
<code class="nx">styleAttr</code><code class="p">.</code><code class="nx">nodeValue</code> <code class="o">=</code> <code class="s1">'background-color: red'</code><code class="p">;</code>&#13;
<code class="nx">someElement</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="nx">styleAttr</code><code class="p">);</code></pre>&#13;
&#13;
<p>You can add any number of attributes to an element using either <code>createAttribute()</code> and <code>setAttribute()</code>, or <code>setAttribute()</code> directly. Both approaches are equally efficient, so unless there’s a real need, you’ll most likely want to use the simpler approach of setting the attribute name and value directly using <code>setAttribute()</code>.</p>&#13;
&#13;
<p>When would you use <code>createAttribute()</code>? If the attribute value is going to be another entity reference, as is allowed with XML, you’ll need to use <code>createAttribute()</code> to create an <code>Attr</code> node, as <code>setAttribute()</code> only supports simple strings.<a data-primary="" data-startref="ix_html5_style_attr" data-type="indexterm" id="idm45475148180904"/><a data-primary="" data-startref="ix_style_attr" data-type="indexterm" id="idm45475148180040"/><a data-primary="" data-startref="ix_setattr_method" data-type="indexterm" id="idm45475148179096"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Adding Text to a New Paragraph" data-type="sect1"><div class="sect1" id="add-text-paragraph">&#13;
<h1>Adding Text to a New Paragraph</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475148176728">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="paragraphs" data-secondary="adding text to" data-type="indexterm" id="ix_para_text_add"/><a data-primary="text" data-secondary="adding to paragraphs" data-type="indexterm" id="ix_text_para"/><a data-primary="HTML5" data-secondary="text, adding to paragraph" data-type="indexterm" id="ix_html5_text_para"/>You want to create a new paragraph with text and insert it into the document.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475148171496">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="createTextNode() method" data-type="indexterm" id="idm45475148170328"/>Use the <code>createTextNode</code> method to add text to an element:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">newPara</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'p'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">text</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createTextNode</code><code class="p">(</code><code class="s1">'New paragraph content'</code><code class="p">);</code>&#13;
<code class="nx">newPara</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">text</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475148163016">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><a data-primary="text" data-secondary="working with in Node" data-type="indexterm" id="idm45475148129288"/>The text within an element is, itself, an object within the DOM. <a data-primary="Text node" data-type="indexterm" id="idm45475148128184"/>Its type is a <code>Text</code> node, and it is created using a specialized method, <code>createTextNode()</code>. The method takes one parameter: the string containing the text.</p>&#13;
&#13;
<p><a data-type="xref" href="#demonstrating_various_methods_for_adding">Example 12-2</a> shows a web page with a <code>div</code> element containing four paragraphs. The JavaScript creates a new paragraph from text provided by the user via a prompt. The text could just as easily have come from a server communication or other process.</p>&#13;
&#13;
<p>The provided text is used to create a text node, which is then appended as a child node to the new paragraph. The <code>paragraph</code> element is inserted in the web page before the first paragraph.</p>&#13;
<div data-type="example" id="demonstrating_various_methods_for_adding">&#13;
<h5><span class="label">Example 12-2. </span>Demonstrating various methods for adding content to a web page</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>&#13;
<code class="nt">&lt;html&gt;</code>&#13;
<code class="nt">&lt;head&gt;</code>&#13;
<code class="nt">&lt;title&gt;</code>Adding Paragraphs<code class="nt">&lt;/title&gt;</code>&#13;
<code class="nt">&lt;/head&gt;</code>&#13;
<code class="nt">&lt;body&gt;</code>&#13;
<code class="nt">&lt;div</code> <code class="na">id=</code><code class="s">"target"</code><code class="nt">&gt;</code>&#13;
  <code class="nt">&lt;p&gt;</code>&#13;
    There is a language 'little known,'<code class="nt">&lt;br</code> <code class="nt">/&gt;</code>&#13;
    Lovers claim it as their own.&#13;
  <code class="nt">&lt;/p&gt;</code>&#13;
  <code class="nt">&lt;p&gt;</code>&#13;
    Its symbols smile upon the land, <code class="nt">&lt;br</code> <code class="nt">/&gt;</code>&#13;
    Wrought by nature's wondrous hand;&#13;
  <code class="nt">&lt;/p&gt;</code>&#13;
  <code class="nt">&lt;p&gt;</code>&#13;
    And in their silent beauty speak,<code class="nt">&lt;br</code> <code class="nt">/&gt;</code>&#13;
    Of life and joy, to those who seek.&#13;
  <code class="nt">&lt;/p&gt;</code>&#13;
  <code class="nt">&lt;p&gt;</code>&#13;
    For Love Divine and sunny hours <code class="nt">&lt;br</code> <code class="nt">/&gt;</code>&#13;
    In the language of the flowers.&#13;
  <code class="nt">&lt;/p&gt;</code>&#13;
<code class="nt">&lt;/div&gt;</code>&#13;
<code class="nt">&lt;script&gt;</code>&#13;
  <code class="c1">// use getElementById to access the div element</code>&#13;
  <code class="kr">const</code> <code class="nx">div</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'target'</code><code class="p">);</code>&#13;
&#13;
  <code class="c1">// get paragraph text</code>&#13;
  <code class="kr">const</code> <code class="nx">txt</code> <code class="o">=</code> <code class="nx">prompt</code><code class="p">(</code><code class="s1">'Enter new paragraph text'</code><code class="p">,</code> <code class="s1">''</code><code class="p">);</code>&#13;
&#13;
  <code class="c1">// use getElementsByTagName and the collection index</code>&#13;
  <code class="c1">// to access the first paragraph</code>&#13;
  <code class="kr">const</code> <code class="nx">oldPara</code> <code class="o">=</code> <code class="nx">div</code><code class="p">.</code><code class="nx">getElementsByTagName</code><code class="p">(</code><code class="s1">'p'</code><code class="p">)[</code><code class="mi">0</code><code class="p">];</code>&#13;
&#13;
  <code class="c1">// create a text node</code>&#13;
  <code class="kr">const</code> <code class="nx">txtNode</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createTextNode</code><code class="p">(</code><code class="nx">txt</code><code class="p">);</code>&#13;
&#13;
  <code class="c1">// create a new paragraph</code>&#13;
  <code class="kr">const</code> <code class="nx">para</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'p'</code><code class="p">);</code>&#13;
&#13;
  <code class="c1">// append the text to the paragraph, and insert the new para</code>&#13;
  <code class="nx">para</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">txtNode</code><code class="p">);</code>&#13;
  <code class="nx">div</code><code class="p">.</code><code class="nx">insertBefore</code><code class="p">(</code><code class="nx">para</code><code class="p">,</code> <code class="nx">oldPara</code><code class="p">);</code>&#13;
<code class="nt">&lt;/script&gt;</code>&#13;
<code class="nt">&lt;/body&gt;</code>&#13;
<code class="nt">&lt;/html&gt;</code></pre></div>&#13;
<div data-type="caution"><h6>Caution</h6>&#13;
<p>Inserting user-supplied text directly into a web page without scrubbing the text first is not a good idea. When you leave a door open, all sorts of nasty things can crawl in. <a data-type="xref" href="#demonstrating_various_methods_for_adding">Example 12-2</a> is for demonstration purposes only.<a data-primary="" data-startref="ix_html5_text_para" data-type="indexterm" id="idm45475147959144"/><a data-primary="" data-startref="ix_text_para" data-type="indexterm" id="idm45475147958200"/><a data-primary="" data-startref="ix_para_text_add" data-type="indexterm" id="idm45475147957256"/></p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Inserting a New Element in a Specific DOM Location" data-type="sect1"><div class="sect1" id="new-paragraph">&#13;
<h1>Inserting a New Element in a Specific DOM Location</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475147954632">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="paragraphs" data-secondary="inserting new in div element" data-type="indexterm" id="idm45475147953432"/><a data-primary="elements" data-secondary="DOM" data-type="indexterm" id="idm45475147952488"/><a data-primary="DOM (Document Object Model)" data-secondary="inserting new element in" data-type="indexterm" id="idm45475147951544"/>You want to insert a new paragraph just before the third paragraph within a <code>div</code> <span class="keep-together">element</span>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475147949080">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="getElementsByTagName() method" data-type="indexterm" id="idm45475147947848"/><a data-primary="insertBefore() method" data-type="indexterm" id="idm45475147946952"/><a data-primary="createElement() method" data-type="indexterm" id="idm45475147946280"/>Use some method to access the third paragraph, such as <code>getElementsByTagName()</code>, to get all of the paragraphs for a <code>div</code> element. Then use the <code>createElement()</code> and <code>insertBefore()</code> DOM methods to add the new paragraph just before the existing third paragraph:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// get the target div</code>&#13;
<code class="kr">const</code> <code class="nx">div</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'target'</code><code class="p">);</code>&#13;
&#13;
<code class="c1">// retrieve a collection of paragraphs</code>&#13;
<code class="kr">const</code> <code class="nx">paras</code> <code class="o">=</code> <code class="nx">div</code><code class="p">.</code><code class="nx">getElementsByTagName</code><code class="p">(</code><code class="s1">'p'</code><code class="p">);</code>&#13;
&#13;
<code class="c1">// create the element and append text to it</code>&#13;
<code class="kr">const</code> <code class="nx">newPara</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'p'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">text</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createTextNode</code><code class="p">(</code><code class="s1">'New paragraph content'</code><code class="p">);</code>&#13;
<code class="nx">newPara</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">text</code><code class="p">);</code>&#13;
&#13;
<code class="c1">// if a third para exists, insert the new element before</code>&#13;
<code class="c1">// otherwise, append the paragraph to the end of the div</code>&#13;
<code class="k">if</code> <code class="p">(</code><code class="nx">paras</code><code class="p">[</code><code class="mi">2</code><code class="p">])</code> <code class="p">{</code>&#13;
  <code class="nx">div</code><code class="p">.</code><code class="nx">insertBefore</code><code class="p">(</code><code class="nx">newPara</code><code class="p">,</code> <code class="nx">paras</code><code class="p">[</code><code class="mi">2</code><code class="p">]);</code>&#13;
<code class="p">}</code> <code class="k">else</code> <code class="p">{</code>&#13;
  <code class="nx">div</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">newPara</code><code class="p">);</code>&#13;
<code class="p">}</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475147941576">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The <code>document.createElement()</code> method creates any HTML element, which then can be inserted or appended into the page. In the solution, the new paragraph element is inserted before an existing paragraph using <code>insertBefore()</code>.</p>&#13;
&#13;
<p>Because we’re interested in inserting the new paragraph before the existing third paragraph, we need to retrieve a collection of the <code>div</code> element’s paragraphs, check to make sure a third paragraph exists, and then use <code>insertBefore()</code> to insert the new paragraph before the existing one. <a data-primary="appendChild() method" data-type="indexterm" id="idm45475147821768"/>If the third paragraph doesn’t exist, we can append the element to the end of the <code>div</code> element using <code>appendChild()</code>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Checking If a Checkbox Is Checked" data-type="sect1"><div class="sect1" id="checkbox">&#13;
<h1>Checking If a Checkbox Is Checked</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475147818488">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="checkbox status check" data-type="indexterm" id="idm45475147817288"/><a data-primary="HTML5" data-secondary="checkbox status check" data-type="indexterm" id="idm45475147816584"/>You need to verify that a user has checked a checkbox in your application.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475147815256">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="checked property" data-type="indexterm" id="idm45475147814088"/>Select the checkbox element and validate the status with the <code>checked</code> property. In this example, I am selecting an HTML <code>input</code> checkbox element with an <code>id</code> of <code>check</code> and listening for a click event. When the event is fired, the <code>validate</code> function is run, which looks at the <code>checked</code> property of the element and logs its status to the console:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">checkBox</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'check'</code><code class="p">);</code>&#13;
&#13;
<code class="kr">const</code> <code class="nx">validate</code> <code class="o">=</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="k">if</code> <code class="p">(</code><code class="nx">checkBox</code><code class="p">.</code><code class="nx">checked</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Checkbox is checked'</code><code class="p">)</code>&#13;
  <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>&#13;
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Checkbox is not checked'</code><code class="p">)</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="nx">checkBox</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="nx">validate</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475147728440">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>A common pattern is for a user to be presented with a checkbox to make some sort of acknowledgement, such as accepting terms of service. In these instances, it is common to disable a button unless the user has checked the checkbox. We can modify the previous example to add this functionality:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">checkBox</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'check'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">acceptButton</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'accept'</code><code class="p">);</code>&#13;
&#13;
<code class="kr">const</code> <code class="nx">validate</code> <code class="o">=</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="k">if</code> <code class="p">(</code><code class="nx">checkBox</code><code class="p">.</code><code class="nx">checked</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nx">acceptButton</code><code class="p">.</code><code class="nx">disabled</code> <code class="o">=</code> <code class="kc">false</code><code class="p">;</code>&#13;
  <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>&#13;
    <code class="nx">acceptButton</code><code class="p">.</code><code class="nx">disabled</code> <code class="o">=</code> <code class="kc">true</code><code class="p">;</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="nx">checkBox</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="nx">validate</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Adding Up Values in an HTML Table" data-type="sect1"><div class="sect1" id="adding-values">&#13;
<h1>Adding Up Values in an HTML Table</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475147651944">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="tables" data-secondary="adding up values" data-type="indexterm" id="ix_table_values"/><a data-primary="HTML5" data-secondary="table values, adding up" data-type="indexterm" id="ix_html5_table_values"/>You want to sum all numbers in a table column.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475147647928">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Traverse the table column containing numeric string values, convert the values to numbers, and sum the numbers:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">let</code> <code class="nx">sum</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>&#13;
&#13;
<code class="c1">// use querySelectorAll to find all second table cells</code>&#13;
<code class="kr">const</code> <code class="nx">cells</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'td:nth-of-type(2)'</code><code class="p">);</code>&#13;
&#13;
<code class="c1">// iterate over each</code>&#13;
<code class="nx">cells</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">cell</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">sum</code> <code class="o">+=</code> <code class="nb">Number</code><code class="p">.</code><code class="nb">parseFloat</code><code class="p">(</code><code class="nx">cell</code><code class="p">.</code><code class="nx">firstChild</code><code class="p">.</code><code class="nx">data</code><code class="p">);</code>&#13;
<code class="p">});</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475147641512">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><a data-primary=":nth-of-type() selector" data-primary-sortas="nth-of-type() selector" data-type="indexterm" id="idm45475147562280"/>The <code>:nth-of-type(n)</code> selector matches the specific child (<code>n</code>) of an element. By using <code>td:nth-of-type(2)</code> we are selecting the second <code>td</code> child element. In the example HTML markup, the second <code>td</code> element in the table is a numeric value:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="nt">&lt;td&gt;</code>Washington<code class="nt">&lt;/td&gt;&lt;td&gt;</code>145<code class="nt">&lt;/td&gt;</code></pre>&#13;
&#13;
<p><a data-primary="parseFloat() method" data-type="indexterm" id="idm45475147555880"/><a data-primary="parseInt() function" data-type="indexterm" id="idm45475147555048"/>The <code>parseInt()</code> and <code>parseFloat()</code> methods convert strings to numbers, but <code>parseFloat()</code> is more adaptable when it comes to handling numbers in an HTML table. Unless you’re absolutely certain all of the numbers will be integers, <code>parseFloat()</code> can work with both integers and floating-point numbers.</p>&#13;
&#13;
<p><a data-type="xref" href="#converting_table_values_to_numbers_and_s">Example 12-3</a> demonstrates how to convert and sum up numeric values in an HTML table, and then how to insert a table row with this sum, at the end. The code uses <code>document.querySelectorAll()</code>, which uses a different variation on the CSS selector, <code>td + td</code>, to access the data this time. This selector finds all table cells that are preceded by another table cell.</p>&#13;
<div data-type="example" id="converting_table_values_to_numbers_and_s">&#13;
<h5><span class="label">Example 12-3. </span>Converting table values to numbers and summing the results</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>&#13;
<code class="nt">&lt;html</code> <code class="na">lang=</code><code class="s">"en"</code><code class="nt">&gt;</code>&#13;
<code class="nt">&lt;head&gt;</code>&#13;
  <code class="nt">&lt;meta</code> <code class="na">charset=</code><code class="s">"UTF-8"</code><code class="nt">&gt;</code>&#13;
  <code class="nt">&lt;meta</code> <code class="na">name=</code><code class="s">"viewport"</code> <code class="na">content=</code><code class="s">"width=device-width, initial-scale=1.0"</code><code class="nt">&gt;</code>&#13;
  <code class="nt">&lt;meta</code> <code class="na">http-equiv=</code><code class="s">"X-UA-Compatible"</code> <code class="na">content=</code><code class="s">"ie=edge"</code><code class="nt">&gt;</code>&#13;
  <code class="nt">&lt;title&gt;</code>Adding Up Values in an HTML Table<code class="nt">&lt;/title&gt;</code>&#13;
<code class="nt">&lt;/head&gt;</code>&#13;
<code class="nt">&lt;body&gt;</code>&#13;
  <code class="nt">&lt;h1&gt;</code>Adding Up Values in an HTML Table<code class="nt">&lt;/h1&gt;</code>&#13;
    <code class="nt">&lt;table&gt;</code>&#13;
      <code class="nt">&lt;tbody</code> <code class="na">id=</code><code class="s">"table1"</code><code class="nt">&gt;</code>&#13;
        <code class="nt">&lt;tr&gt;</code>&#13;
            <code class="nt">&lt;td&gt;</code>Washington<code class="nt">&lt;/td&gt;&lt;td&gt;</code>145<code class="nt">&lt;/td&gt;</code>&#13;
        <code class="nt">&lt;/tr&gt;</code>&#13;
        <code class="nt">&lt;tr&gt;</code>&#13;
            <code class="nt">&lt;td&gt;</code>Oregon<code class="nt">&lt;/td&gt;&lt;td&gt;</code>233<code class="nt">&lt;/td&gt;</code>&#13;
        <code class="nt">&lt;/tr&gt;</code>&#13;
        <code class="nt">&lt;tr&gt;</code>&#13;
            <code class="nt">&lt;td&gt;</code>Missouri<code class="nt">&lt;/td&gt;&lt;td&gt;</code>833<code class="nt">&lt;/td&gt;</code>&#13;
        <code class="nt">&lt;/tr&gt;</code>&#13;
      <code class="nt">&lt;tbody&gt;</code>&#13;
    <code class="nt">&lt;/table&gt;</code>&#13;
&#13;
    <code class="nt">&lt;script&gt;</code>&#13;
      <code class="kd">let</code> <code class="nx">sum</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>&#13;
&#13;
      <code class="c1">// use querySelector to find all second table cells</code>&#13;
      <code class="kr">const</code> <code class="nx">cells</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'td:nth-of-type(2)'</code><code class="p">);</code>&#13;
&#13;
      <code class="c1">// iterate over each</code>&#13;
      <code class="nx">cells</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">cell</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
        <code class="nx">sum</code> <code class="o">+=</code> <code class="nb">Number</code><code class="p">.</code><code class="nb">parseFloat</code><code class="p">(</code><code class="nx">cell</code><code class="p">.</code><code class="nx">firstChild</code><code class="p">.</code><code class="nx">data</code><code class="p">);</code>&#13;
      <code class="p">});</code>&#13;
&#13;
      <code class="c1">// now add sum to end of table</code>&#13;
      <code class="kr">const</code> <code class="nx">newRow</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'tr'</code><code class="p">);</code>&#13;
&#13;
      <code class="c1">// first cell</code>&#13;
      <code class="kr">const</code> <code class="nx">firstCell</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'td'</code><code class="p">);</code>&#13;
      <code class="kr">const</code> <code class="nx">firstCellText</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createTextNode</code><code class="p">(</code><code class="s1">'Sum:'</code><code class="p">);</code>&#13;
      <code class="nx">firstCell</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">firstCellText</code><code class="p">);</code>&#13;
      <code class="nx">newRow</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">firstCell</code><code class="p">);</code>&#13;
&#13;
      <code class="c1">// second cell with sum</code>&#13;
      <code class="kr">const</code> <code class="nx">secondCell</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'td'</code><code class="p">);</code>&#13;
      <code class="kr">const</code> <code class="nx">secondCellText</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createTextNode</code><code class="p">(</code><code class="nx">sum</code><code class="p">);</code>&#13;
      <code class="nx">secondCell</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">secondCellText</code><code class="p">);</code>&#13;
      <code class="nx">newRow</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">secondCell</code><code class="p">);</code>&#13;
&#13;
      <code class="c1">// add row to table</code>&#13;
      <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'table1'</code><code class="p">).</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">newRow</code><code class="p">);</code>&#13;
    <code class="nt">&lt;/script&gt;</code>&#13;
<code class="nt">&lt;/body&gt;</code>&#13;
<code class="nt">&lt;/html&gt;</code></pre></div>&#13;
&#13;
<p>Being able to provide a sum or other operation on table data is helpful if you’re working with dynamic updates, such as accessing rows of data from a database. The fetched data may not be able to provide summary values, or you may not want to provide summary data until a web page reader chooses to do so. The users may want to manipulate the table results, and then push a button to perform the summing operation.</p>&#13;
&#13;
<p>Adding rows to a table is straightforward, as long as you remember the steps:</p>&#13;
<ol>&#13;
<li>&#13;
<p>Create a new table row using <code>document.createElement("tr")</code>.</p>&#13;
</li>&#13;
<li>&#13;
<p>Create each table row cell using <code>document.createElement("td")</code>.</p>&#13;
</li>&#13;
<li>&#13;
<p>Create each table row cell’s data using <code>document.createTextNode()</code>, passing in the text of the node (including numbers, which are automatically converted to a string).</p>&#13;
</li>&#13;
<li>&#13;
<p>Append the text node to the table cell.</p>&#13;
</li>&#13;
<li>&#13;
<p>Append the table cell to the table row.</p>&#13;
</li>&#13;
<li>&#13;
<p>Append the table row to the table. Rinse, repeat.</p>&#13;
</li>&#13;
&#13;
</ol>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Extra: forEach and querySelectorAll" data-type="sect2"><div class="sect2" id="idm45475147326872">&#13;
<h2>Extra: forEach and querySelectorAll</h2>&#13;
&#13;
<p><a data-primary="querySelectorAll() method" data-type="indexterm" id="idm45475147524296"/><a data-primary="NodeList" data-type="indexterm" id="idm45475147324792"/><a data-primary="forEach() method" data-secondary="adding values to HTML table" data-type="indexterm" id="idm45475147324088"/>In the preceding example, I’m using the <code>forEach()</code> method to iterate over the results of <code>querySelectorAll()</code>, which returns a <code>NodeList</code>, not an array. Though <code>forEach()</code> is an array method, modern browsers have implemented <code>NodeList.prototype.for​E⁠ach()</code>, which enables it iterating over a <code>NodeList</code> with the <code>forEach()</code> syntax, as discussed in <a data-type="xref" href="#traversing_results_queryselect">“Traversing the Results from querySelectorAll() <span class="keep-together">with forEach()</span>”</a>. The alternative would be a loop:<a data-primary="" data-startref="ix_html5_table_values" data-type="indexterm" id="idm45475147318952"/><a data-primary="" data-startref="ix_table_values" data-type="indexterm" id="idm45475147318008"/></p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">let</code> <code class="nx">sum</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code>&#13;
&#13;
<code class="c1">// use querySelector to find all second table cells</code>&#13;
<code class="kd">let</code> <code class="nx">cells</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s2">"td:nth-of-type(2)"</code><code class="p">);</code>&#13;
&#13;
<code class="k">for</code> <code class="p">(</code><code class="kd">var</code> <code class="nx">i</code> <code class="o">=</code> <code class="mi">0</code><code class="p">;</code> <code class="nx">i</code> <code class="o">&lt;</code> <code class="nx">cells</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="nx">i</code><code class="o">++</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="nx">sum</code><code class="o">+=</code><code class="nb">parseFloat</code><code class="p">(</code><code class="nx">cells</code><code class="p">[</code><code class="nx">i</code><code class="p">].</code><code class="nx">firstChild</code><code class="p">.</code><code class="nx">data</code><code class="p">);</code>&#13;
<code class="p">}</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Extra: Modularization of Globals" data-type="sect2"><div class="sect2" id="idm45475147315880">&#13;
<h2>Extra: Modularization of Globals</h2>&#13;
&#13;
<p><a data-primary="variables" data-secondary="global" data-type="indexterm" id="idm45475147175256"/><a data-primary="global methods" data-secondary="parseFloat()" data-type="indexterm" id="idm45475147174088"/><a data-primary="global methods" data-secondary="parseInt()" data-type="indexterm" id="idm45475147173144"/><a data-primary="global variables" data-type="indexterm" id="idm45475147289352"/><a data-primary="methods" data-secondary="global" data-type="indexterm" id="idm45475147288680"/><a data-primary="modules" data-secondary="of global variables" data-secondary-sortas=" global variables" data-type="indexterm" id="idm45475147287736"/><a data-primary="ECMAScript" data-secondary="modularization" data-type="indexterm" id="idm45475147286520"/>As part of a growing effort to  <em>modularize</em> JavaScript, the <code>parseFloat()</code> and <code>parseInt()</code> methods are now attached to the <code>Number</code> object, as new <em>static</em> methods, as of ECMAScript 2015:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// modular method</code>&#13;
<code class="kr">const</code> <code class="nx">modular</code> <code class="o">=</code> <code class="nb">Number</code><code class="p">.</code><code class="nb">parseInt</code><code class="p">(</code><code class="s1">'123'</code><code class="p">);</code>&#13;
<code class="c1">// global method</code>&#13;
<code class="kr">const</code> <code class="nx">global</code> <code class="o">=</code> <code class="nb">parseInt</code><code class="p">(</code><code class="s1">'123'</code><code class="p">);</code></pre>&#13;
&#13;
<p><a data-primary="polyfills" data-type="indexterm" id="idm45475147281960"/>These modules have reached widespread browser adoption, but can be polyfilled for older browser support, using a tool like Babel or on their own:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="k">if</code> <code class="p">(</code><code class="nb">Number</code><code class="p">.</code><code class="nb">parseInt</code> <code class="o">===</code> <code class="kc">undefined</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="nb">Number</code><code class="p">.</code><code class="nb">parseInt</code> <code class="o">=</code> <code class="nb">window</code><code class="p">.</code><code class="nb">parseInt</code>&#13;
<code class="p">}</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Deleting Rows from an HTML Table" data-type="sect1"><div class="sect1" id="idm45475147262040">&#13;
<h1>Deleting Rows from an HTML Table</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475147258024">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="rows, deleting from table" data-type="indexterm" id="idm45475147256888"/><a data-primary="tables" data-secondary="deleting rows from" data-type="indexterm" id="idm45475147256216"/><a data-primary="deleting rows from table" data-type="indexterm" id="idm45475147255272"/><a data-primary="HTML5" data-secondary="deleting rows from table" data-type="indexterm" id="idm45475147087400"/>You want to remove one or more rows from an HTML table.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475147086040">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="removeChild() method" data-type="indexterm" id="idm45475147084872"/>Use the <code>removeChild()</code> method on an HTML table row, and all of the child elements, including the row cells, are also removed:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">parent</code> <code class="o">=</code> <code class="nx">row</code><code class="p">.</code><code class="nx">parentNode</code><code class="p">;</code>&#13;
<code class="kr">const</code> <code class="nx">oldrow</code> <code class="o">=</code> <code class="nx">parent</code><code class="p">.</code><code class="nx">removeChild</code><code class="p">(</code><code class="nx">parent</code><code class="p">);</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475147018728">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><a data-primary="DOM (Document Object Model)" data-secondary="pruning" data-type="indexterm" id="idm45475147042312"/>When you remove an element from the web document, you’re not only removing the element, you’re removing all of its child elements. In this <em>DOM pruning</em> you get a reference to the removed element if you want to process its contents before it’s completely discarded. The latter is helpful if you want to provide some kind of <em>undo</em> method in case you accidentally select the wrong table row.</p>&#13;
&#13;
<p>To demonstrate the nature of DOM pruning, in <a data-type="xref" href="#adding_and_removing_table_rows_and_assoc">Example 12-4</a>, DOM methods <code>createElement()</code> and <code>createTextNode()</code> are used to create table rows and cells, as well as the text inserted into the cells. <a data-primary="click events" data-type="indexterm" id="idm45475147037656"/><a data-primary="events" data-secondary="click" data-type="indexterm" id="idm45475147036952"/>As each table row is created, an event handler is attached to the row’s <em>click</em> event. If any of the new table rows is clicked, a function is called that removes the row from the table. The removed table row element is then traversed, and the data in its cells is extracted and concatenated to a string, which is printed out.</p>&#13;
<div data-type="example" id="adding_and_removing_table_rows_and_assoc">&#13;
<h5><span class="label">Example 12-4. </span>Adding and removing table rows and associated table cells and data</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>&#13;
<code class="nt">&lt;html</code> <code class="na">lang=</code><code class="s">"en"</code><code class="nt">&gt;</code>&#13;
  <code class="nt">&lt;head&gt;</code>&#13;
    <code class="nt">&lt;meta</code> <code class="na">charset=</code><code class="s">"UTF-8"</code> <code class="nt">/&gt;</code>&#13;
    <code class="nt">&lt;meta</code> <code class="na">name=</code><code class="s">"viewport"</code> <code class="na">content=</code><code class="s">"width=device-width, initial-scale=1.0"</code> <code class="nt">/&gt;</code>&#13;
    <code class="nt">&lt;meta</code> <code class="na">http-equiv=</code><code class="s">"X-UA-Compatible"</code> <code class="na">content=</code><code class="s">"ie=edge"</code> <code class="nt">/&gt;</code>&#13;
    <code class="nt">&lt;title&gt;</code>Deleting Rows from an HTML Table<code class="nt">&lt;/title&gt;</code>&#13;
    <code class="nt">&lt;style&gt;</code>&#13;
      <code class="nt">table</code> <code class="p">{</code>&#13;
        <code class="k">border-collapse</code><code class="o">:</code> <code class="nb">collapse</code><code class="p">;</code>&#13;
      <code class="p">}</code>&#13;
      <code class="nt">td</code><code class="o">,</code>&#13;
      <code class="nt">th</code> <code class="p">{</code>&#13;
        <code class="k">padding</code><code class="o">:</code> <code class="m">5px</code><code class="p">;</code>&#13;
        <code class="k">border</code><code class="o">:</code> <code class="m">1px</code> <code class="nb">solid</code> <code class="m">#ccc</code><code class="p">;</code>&#13;
      <code class="p">}</code>&#13;
      <code class="nt">tr</code><code class="nd">:nth-child</code><code class="o">(</code><code class="nt">2n</code> <code class="o">+</code> <code class="nt">1</code><code class="o">)</code> <code class="p">{</code>&#13;
        <code class="k">background-color</code><code class="o">:</code> <code class="m">#eeffee</code><code class="p">;</code>&#13;
      <code class="p">}</code>&#13;
    <code class="nt">&lt;/style&gt;</code>&#13;
  <code class="nt">&lt;/head&gt;</code>&#13;
  <code class="nt">&lt;body&gt;</code>&#13;
    <code class="nt">&lt;h1&gt;</code>Deleting Rows from an HTML Table<code class="nt">&lt;/h1&gt;</code>&#13;
    <code class="nt">&lt;table</code> <code class="na">id=</code><code class="s">"mixed"</code><code class="nt">&gt;</code>&#13;
      <code class="nt">&lt;tr&gt;</code>&#13;
        <code class="nt">&lt;th&gt;</code>Value One<code class="nt">&lt;/th&gt;</code>&#13;
        <code class="nt">&lt;th&gt;</code>Value two<code class="nt">&lt;/th&gt;</code>&#13;
        <code class="nt">&lt;th&gt;</code>Value three<code class="nt">&lt;/th&gt;</code>&#13;
      <code class="nt">&lt;/tr&gt;</code>&#13;
    <code class="nt">&lt;/table&gt;</code>&#13;
&#13;
    <code class="nt">&lt;div</code> <code class="na">id=</code><code class="s">"result"</code><code class="nt">&gt;&lt;/div&gt;</code>&#13;
    <code class="nt">&lt;script&gt;</code>&#13;
    <code class="c1">// table values</code>&#13;
    <code class="kr">const</code> <code class="nx">values</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">Array</code><code class="p">(</code><code class="mi">3</code><code class="p">);</code>&#13;
    <code class="nx">values</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="mf">123.45</code><code class="p">,</code> <code class="s1">'apple'</code><code class="p">,</code> <code class="kc">true</code><code class="p">];</code>&#13;
    <code class="nx">values</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="mi">65</code><code class="p">,</code> <code class="s1">'banana'</code><code class="p">,</code> <code class="kc">false</code><code class="p">];</code>&#13;
    <code class="nx">values</code><code class="p">[</code><code class="mi">2</code><code class="p">]</code> <code class="o">=</code> <code class="p">[</code><code class="mf">1034.99</code><code class="p">,</code> <code class="s1">'cherry'</code><code class="p">,</code> <code class="kc">false</code><code class="p">];</code>&#13;
&#13;
    <code class="kr">const</code> <code class="nx">mixed</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'mixed'</code><code class="p">);</code>&#13;
    <code class="kr">const</code> <code class="nx">tbody</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'tbody'</code><code class="p">);</code>&#13;
&#13;
    <code class="kd">function</code> <code class="nx">pruneRow</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="c1">// remove row</code>&#13;
    <code class="kr">const</code> <code class="nx">parent</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">parentNode</code><code class="p">;</code>&#13;
    <code class="kr">const</code> <code class="nx">oldRow</code> <code class="o">=</code> <code class="nx">parent</code><code class="p">.</code><code class="nx">removeChild</code><code class="p">(</code><code class="k">this</code><code class="p">);</code>&#13;
&#13;
    <code class="c1">// dataString from removed row data</code>&#13;
    <code class="kd">let</code> <code class="nx">dataString</code> <code class="o">=</code> <code class="s1">''</code><code class="p">;</code>&#13;
    <code class="nx">oldRow</code><code class="p">.</code><code class="nx">childNodes</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">row</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
      <code class="nx">dataString</code> <code class="o">+=</code> <code class="err">`</code><code class="nx">$</code><code class="p">{</code><code class="nx">row</code><code class="p">.</code><code class="nx">firstChild</code><code class="p">.</code><code class="nx">data</code><code class="p">}</code> <code class="err">`</code><code class="p">;</code>&#13;
    <code class="p">});</code>&#13;
&#13;
    <code class="c1">// output message</code>&#13;
    <code class="kr">const</code> <code class="nx">msg</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createTextNode</code><code class="p">(</code><code class="err">`</code><code class="nx">removed</code> <code class="nx">$</code><code class="p">{</code><code class="nx">dataString</code><code class="p">}</code><code class="err">`</code><code class="p">);</code>&#13;
    <code class="kr">const</code> <code class="nx">p</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'p'</code><code class="p">);</code>&#13;
    <code class="nx">p</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">msg</code><code class="p">);</code>&#13;
    <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'result'</code><code class="p">).</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">p</code><code class="p">);</code>&#13;
    <code class="p">}</code>&#13;
&#13;
    <code class="c1">// for each outer array row</code>&#13;
    <code class="nx">values</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">value</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
      <code class="kr">const</code> <code class="nx">tr</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'tr'</code><code class="p">);</code>&#13;
&#13;
      <code class="c1">// for each inner array cell</code>&#13;
      <code class="c1">// create td then text, append</code>&#13;
      <code class="nx">value</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">cell</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
        <code class="kr">const</code> <code class="nx">td</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'td'</code><code class="p">);</code>&#13;
        <code class="kr">const</code> <code class="nx">txt</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createTextNode</code><code class="p">(</code><code class="nx">cell</code><code class="p">);</code>&#13;
        <code class="nx">td</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">txt</code><code class="p">);</code>&#13;
        <code class="nx">tr</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">td</code><code class="p">);</code>&#13;
      <code class="p">});</code>&#13;
&#13;
      <code class="c1">// attache event handler</code>&#13;
      <code class="nx">tr</code><code class="p">.</code><code class="nx">onclick</code> <code class="o">=</code> <code class="nx">pruneRow</code><code class="p">;</code>&#13;
&#13;
      <code class="c1">// append row to table</code>&#13;
      <code class="nx">tbody</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">tr</code><code class="p">);</code>&#13;
      <code class="nx">mixed</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">tbody</code><code class="p">);</code>&#13;
    <code class="p">});</code>&#13;
    <code class="nt">&lt;/script&gt;</code>&#13;
  <code class="nt">&lt;/body&gt;</code>&#13;
<code class="nt">&lt;/html&gt;</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Hiding Page Sections" data-type="sect1"><div class="sect1" id="idm45475147025800">&#13;
<h1>Hiding Page Sections</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475147024920">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="accessibility" data-secondary="removing elements from page view" data-type="indexterm" id="idm45475147023752"/><a data-primary="HTML5" data-secondary="hiding page elements" data-type="indexterm" id="ix_html5_hide_elem"/>You want to hide an existing page element and its children until needed.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475147021160">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="properties" data-secondary="CSS" data-type="indexterm" id="idm45475146703064"/><a data-primary="visibility property" data-type="indexterm" id="idm45475146702088"/><a data-primary="CSS (Cascading Style Sheet)" data-secondary="visibility of properties" data-type="indexterm" id="idm45475146701416"/>You can set the CSS <code>visibility</code> property to hide and show the element:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">msg</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">hidden</code> <code class="o">=</code> <code class="s1">'visible'</code><code class="p">;</code> <code class="c1">// to display</code>&#13;
<code class="nx">msg</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">hidden</code> <code class="o">=</code> <code class="s1">'hidden'</code><code class="p">;</code> <code class="c1">// to hide</code></pre>&#13;
&#13;
<p><a data-primary="display property" data-type="indexterm" id="idm45475146694136"/>Or you can use the CSS <code>display</code> property:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">msg</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">display</code> <code class="o">=</code> <code class="s1">'block'</code><code class="p">;</code> <code class="c1">// to display</code>&#13;
<code class="nx">msg</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">display</code> <code class="o">=</code> <code class="s1">'none'</code><code class="p">;</code> <code class="c1">// to remove from display</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475146605880">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Both the CSS <code>visibility</code> and <code>display</code> properties can be used to hide and show elements. There is one major difference between the two that impacts which one you’ll use.</p>&#13;
&#13;
<p>The <code>visibility</code> property controls the element’s visual rendering, but its presence also affects other elements. When an element is hidden, it still takes up page space. The <code>display</code> property, on the other hand, removes the element completely from the page layout.</p>&#13;
&#13;
<p>The <code>display</code> property can be set to several different values, but four are of particular interest to us:</p>&#13;
<dl>&#13;
<dt><code>none</code></dt>&#13;
<dd>&#13;
<p>When display is set to <code>none</code>, the element is removed completely from display.</p>&#13;
</dd>&#13;
<dt><code>block</code></dt>&#13;
<dd>&#13;
<p>When display is set to <code>block</code>, the element is treated like a <code>block</code> element, with a line break before and after.</p>&#13;
</dd>&#13;
<dt><code>inline-block</code></dt>&#13;
<dd>&#13;
<p>When display is set to <code>inline-block</code>, the contents are formatted like a <code>block</code> element, which is then flowed like inline content.</p>&#13;
</dd>&#13;
<dt><code>inherit</code></dt>&#13;
<dd>&#13;
<p>This is the default display, and specifies that the <code>display</code> property is inherited from the element’s parent.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>There are other values, but these are the ones we’re most likely to use within JavaScript applications.</p>&#13;
&#13;
<p>Unless you’re using absolute positioning with the hidden element, you’ll want to use the CSS <code>display</code> property. Otherwise, the element will affect the page layout, pushing any elements that follow down and to the right, depending on the type of hidden <span class="keep-together">element</span>.</p>&#13;
&#13;
<p>There is another approach to removing an element out of page view, and that is to move it totally offscreen using a negative left value. This could work, especially if you’re creating a slider element that will slide in from the left. It’s also an approach that the accessibility community has suggested using when you have content that you want rendered by assistive technology (AT) devices, but not visually rendered.<a data-primary="" data-startref="ix_html5_hide_elem" data-type="indexterm" id="idm45475146614840"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Creating Hover-Based Pop-Up Info Windows" data-type="sect1"><div class="sect1" id="creating_hover-based_popup_info_windows">&#13;
<h1>Creating Hover-Based Pop-Up Info Windows</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475146612152">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="hover-based pop-up info windows" data-type="indexterm" id="ix_hover_popup_win"/><a data-primary="pop-up info windows" data-type="indexterm" id="ix_popup_win"/><a data-primary="HTML5" data-secondary="hover-based pop-up info windows" data-type="indexterm" id="ix_html5_popup_win"/><a data-primary="images (img element)" data-secondary="hover-based pop-up info windows" data-type="indexterm" id="ix_img_elem_popup"/>You want to create an interaction where a user mouses over a thumbnail image and additional information is displayed.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475146606136">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>This interaction is based on four different functionalities.</p>&#13;
&#13;
<p><a data-primary="events" data-secondary="mouseover or mouseout" data-type="indexterm" id="idm45475146587368"/><a data-primary="mouseout event" data-type="indexterm" id="idm45475146586392"/><a data-primary="mouseover event" data-type="indexterm" id="idm45475146585720"/>First, you need to capture the <code>mouseover</code> and <code>mouseout</code> events for each image thumbnail in order to display or remove the pop-up window, respectively. In the following code, the cross-browser event handlers are attached to all images in the page:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nb">window</code><code class="p">.</code><code class="nx">onload</code> <code class="o">=</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">imgs</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'img'</code><code class="p">);</code>&#13;
  <code class="nx">imgs</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">img</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
    <code class="nx">img</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code>&#13;
      <code class="s1">'mouseover'</code><code class="p">,</code>&#13;
      <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
        <code class="nx">getInfo</code><code class="p">(</code><code class="nx">img</code><code class="p">.</code><code class="nx">id</code><code class="p">);</code>&#13;
      <code class="p">},</code>&#13;
      <code class="kc">false</code>&#13;
    <code class="p">);</code>&#13;
&#13;
    <code class="nx">img</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code>&#13;
      <code class="s1">'mouseout'</code><code class="p">,</code>&#13;
      <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
        <code class="nx">removeWindow</code><code class="p">();</code>&#13;
      <code class="p">},</code>&#13;
      <code class="kc">false</code>&#13;
    <code class="p">);</code>&#13;
  <code class="p">});</code>&#13;
<code class="p">};</code></pre>&#13;
&#13;
<p>Second, you need to access something about the item you’re hovering over in order to know what to use to populate the pop-up bubble. The information can be in the page, or you can use web server communication to get the information:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">getInfo</code><code class="p">(</code><code class="nx">id</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="c1">// get the data</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p><a data-primary="createElement() method" data-type="indexterm" id="idm45475146539336"/><a data-primary="createTextNode() method" data-type="indexterm" id="idm45475146513528"/>Third, you need to either show the pop-up window, if it already exists and is not displayed, or create the window. In the following code, the pop-up window is created just below the object, and just to the right when the web server call returns with the information about the item. <a data-primary="getBoundingClientRect() method" data-type="indexterm" id="idm45475146512488"/><a data-primary="text" data-secondary="working with in Node" data-type="indexterm" id="idm45475146511848"/>The <code>getBoundingClientRect()</code> method is used to <span class="keep-together">determine</span> the location where the pop-up should be placed, and <code>createElement()</code> and <code>createTextNode()</code> are used to create the pop-up:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// compute position for pop-up</code>&#13;
<code class="kd">function</code> <code class="nx">compPos</code><code class="p">(</code><code class="nx">obj</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">rect</code> <code class="o">=</code> <code class="nx">obj</code><code class="p">.</code><code class="nx">getBoundingClientRect</code><code class="p">();</code>&#13;
  <code class="kd">let</code> <code class="nx">height</code><code class="p">;</code>&#13;
  <code class="k">if</code> <code class="p">(</code><code class="nx">rect</code><code class="p">.</code><code class="nx">height</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nx">height</code> <code class="o">=</code> <code class="nx">rect</code><code class="p">.</code><code class="nx">height</code><code class="p">;</code>&#13;
  <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>&#13;
    <code class="nx">height</code> <code class="o">=</code> <code class="nx">rect</code><code class="p">.</code><code class="nx">bottom</code> <code class="o">-</code> <code class="nx">rect</code><code class="p">.</code><code class="nx">top</code><code class="p">;</code>&#13;
  <code class="p">}</code>&#13;
  <code class="kr">const</code> <code class="nx">top</code> <code class="o">=</code> <code class="nx">rect</code><code class="p">.</code><code class="nx">top</code> <code class="o">+</code> <code class="nx">height</code> <code class="o">+</code> <code class="mi">10</code><code class="p">;</code>&#13;
  <code class="k">return</code> <code class="p">[</code><code class="nx">rect</code><code class="p">.</code><code class="nx">left</code><code class="p">,</code> <code class="nx">top</code><code class="p">];</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="kd">function</code> <code class="nx">showWindow</code><code class="p">(</code><code class="nx">id</code><code class="p">,</code> <code class="nx">response</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">img</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="nx">id</code><code class="p">);</code>&#13;
&#13;
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">img</code><code class="p">);</code>&#13;
  <code class="c1">// derive location for pop-up</code>&#13;
  <code class="kr">const</code> <code class="nx">loc</code> <code class="o">=</code> <code class="nx">compPos</code><code class="p">(</code><code class="nx">img</code><code class="p">);</code>&#13;
  <code class="kr">const</code> <code class="nx">left</code> <code class="o">=</code> <code class="sb">`</code><code class="si">${</code><code class="nx">loc</code><code class="p">[</code><code class="mi">0</code><code class="p">]</code><code class="si">}</code><code class="sb">px`</code><code class="p">;</code>&#13;
  <code class="kr">const</code> <code class="nx">top</code> <code class="o">=</code> <code class="sb">`</code><code class="si">${</code><code class="nx">loc</code><code class="p">[</code><code class="mi">1</code><code class="p">]</code><code class="si">}</code><code class="sb">px`</code><code class="p">;</code>&#13;
&#13;
  <code class="c1">// create pop-up</code>&#13;
  <code class="kr">const</code> <code class="nx">div</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'popup'</code><code class="p">);</code>&#13;
  <code class="nx">div</code><code class="p">.</code><code class="nx">id</code> <code class="o">=</code> <code class="s1">'popup'</code><code class="p">;</code>&#13;
  <code class="kr">const</code> <code class="nx">txt</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createTextNode</code><code class="p">(</code><code class="nx">response</code><code class="p">);</code>&#13;
  <code class="nx">div</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">txt</code><code class="p">);</code>&#13;
&#13;
  <code class="c1">// style pop-up</code>&#13;
  <code class="nx">div</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s1">'class'</code><code class="p">,</code> <code class="s1">'popup'</code><code class="p">);</code>&#13;
  <code class="nx">div</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s1">'style'</code><code class="p">,</code> <code class="sb">`position: fixed; left: </code><code class="si">${</code><code class="nx">left</code><code class="si">}</code><code class="sb">; top: </code><code class="si">${</code><code class="nx">top</code><code class="si">}</code><code class="sb">`</code><code class="p">);</code>&#13;
  <code class="nb">document</code><code class="p">.</code><code class="nx">body</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">div</code><code class="p">);</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>Lastly, when the <code>mouseover</code> event fires, you need to either hide the pop-up window or remove it—whichever makes sense in your setup. Since the application created a new pop-up window in the <code>mouseover</code> event, it removes the pop-up in the <code>mouseout</code> event handler:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">removeWindow</code><code class="p">()</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">popup</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'popup'</code><code class="p">);</code>&#13;
  <code class="k">if</code> <code class="p">(</code><code class="nx">popup</code><code class="p">)</code> <code class="nx">popup</code><code class="p">.</code><code class="nx">parentNode</code><code class="p">.</code><code class="nx">removeChild</code><code class="p">(</code><code class="nx">popup</code><code class="p">);</code>&#13;
<code class="p">}</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475146090280">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Creating a pop-up information or help window doesn’t have to be complicated if you keep the action simple and follow the four steps outlined in the solution. If the <span class="keep-together">pop-up</span> provides help for <code>form</code> elements, then you might want to cache the information within the page, and just show and hide pop-up elements as needed. However, if you have pages with hundreds of items, you’ll have better performance if you get the pop-up window information on demand via a web service call.</p>&#13;
&#13;
<p>When I positioned the pop-up in the example, I didn’t place it directly over the object. The reason is that I’m not capturing the mouse position to have the pop-up follow the cursor around, ensuring that I don’t move the cursor directly over the pop-up. But if I statically position the pop-up partially over the object, the web page readers could move their mouse over the pop-up, which triggers the event to hide the pop-up…which then triggers the event to show the pop-up, and so on. This creates a flicker effect, not to mention a lot of network activity.</p>&#13;
&#13;
<p>If, instead, I allowed the mouse events to continue by returning <code>true</code> from either event handler function, when the web page readers move their mouse over the pop-up, the pop-up won’t go away. However, if they move the mouse from the image to the pop-up, and then to the rest of the page, the event to trigger the pop-up event removal won’t fire, and the pop-up is left on the page.</p>&#13;
&#13;
<p>The best approach is to place the pop-up directly under (or to the side, or a specific location in the page) rather than directly over the object.<a data-primary="" data-startref="ix_html5_popup_win" data-type="indexterm" id="idm45475146061144"/><a data-primary="" data-startref="ix_hover_popup_win" data-type="indexterm" id="idm45475146060168"/><a data-primary="" data-startref="ix_popup_win" data-type="indexterm" id="idm45475146059224"/><a data-primary="" data-startref="ix_img_elem_popup" data-type="indexterm" id="idm45475146058280"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Validating Form Data" data-type="sect1"><div class="sect1" id="validating_forms">&#13;
<h1>Validating Form Data</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475146055720">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="data" data-secondary="form" data-type="indexterm" id="ix_data_forms_valid"/><a data-primary="validation" data-secondary="form data" data-type="indexterm" id="ix_valid_form_data"/><a data-primary="forms" data-secondary="validating data" data-type="indexterm" id="ix_forms_valid_data"/><a data-primary="HTML5" data-secondary="validating form data" data-type="indexterm" id="ix_html5_valid_form"/>Your web application gathers data from the users using HTML forms. Before you send that data to the server, though, you want to make sure it’s well formed, complete, and valid while providing feedback to the user.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475146048984">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the HTML5’s built-in form validation attributes, which can be extended with an external library for string validation:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="nt">&lt;form</code> <code class="na">id=</code><code class="s">"example"</code> <code class="na">name=</code><code class="s">"example"</code> <code class="na">action=</code><code class="s">""</code> <code class="na">method=</code><code class="s">"post"</code><code class="nt">&gt;</code>&#13;
  <code class="nt">&lt;fieldset&gt;</code>&#13;
    <code class="nt">&lt;legend&gt;</code>Example Form<code class="nt">&lt;/legend&gt;</code>&#13;
    <code class="nt">&lt;div&gt;</code>&#13;
      <code class="nt">&lt;label</code> <code class="na">for=</code><code class="s">"email"</code><code class="nt">&gt;</code>Email (required):<code class="nt">&lt;/label&gt;</code>&#13;
      <code class="nt">&lt;input</code> <code class="na">type=</code><code class="s">"email"</code> <code class="na">id=</code><code class="s">"email"</code> <code class="na">name=</code><code class="s">"email"</code> <code class="na">value=</code><code class="s">""</code> <code class="na">required</code> <code class="nt">/&gt;</code>&#13;
    <code class="nt">&lt;/div&gt;</code>&#13;
    <code class="nt">&lt;div&gt;</code>&#13;
      <code class="nt">&lt;label</code> <code class="na">for=</code><code class="s">"postal"</code><code class="nt">&gt;</code>Postal Code:<code class="nt">&lt;/label&gt;</code>&#13;
      <code class="nt">&lt;input</code> <code class="na">type=</code><code class="s">"text"</code> <code class="na">pattern=</code><code class="s">"[0-9]*"</code> <code class="na">id=</code><code class="s">"postal"</code> <code class="na">name=</code><code class="s">"url"</code> <code class="na">value=</code><code class="s">""</code> <code class="nt">/&gt;</code>&#13;
    <code class="nt">&lt;/div&gt;</code>&#13;
    <code class="nt">&lt;div</code> <code class="na">id=</code><code class="s">"error"</code><code class="nt">&gt;&lt;/div&gt;</code>&#13;
    <code class="nt">&lt;div&gt;</code>&#13;
      <code class="nt">&lt;input</code> <code class="na">type=</code><code class="s">"submit"</code> <code class="na">value=</code><code class="s">"Submit"</code> <code class="nt">/&gt;</code>&#13;
    <code class="nt">&lt;/div&gt;</code>&#13;
  <code class="nt">&lt;/fieldset&gt;</code>&#13;
<code class="nt">&lt;/form&gt;</code></pre>&#13;
&#13;
<p>You can use a standalone library, such as <a href="https://github.com/validatorjs/validator.js">validator.js</a>, to check for validity as a user types:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="nt">&lt;script </code><code class="na">type=</code><code class="s">"text/javascript"</code><code class="nt">&gt;</code>&#13;
  <code class="kd">function</code> <code class="nx">inputValidator</code><code class="p">(</code><code class="nx">id</code><code class="p">,</code> <code class="nx">value</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="c1">// check email validity</code>&#13;
    <code class="k">if</code> <code class="p">(</code><code class="nx">id</code> <code class="o">===</code> <code class="s1">'email'</code><code class="p">)</code> <code class="p">{</code>&#13;
     <code class="k">return</code> <code class="nx">validator</code><code class="p">.</code><code class="nx">isEmail</code><code class="p">(</code><code class="nx">value</code><code class="p">);</code>&#13;
    <code class="p">}</code>&#13;
&#13;
    <code class="c1">// check US postal code validity</code>&#13;
    <code class="k">if</code> <code class="p">(</code><code class="nx">id</code> <code class="o">===</code> <code class="s1">'postal'</code><code class="p">)</code> <code class="p">{</code>&#13;
     <code class="k">return</code> <code class="nx">validator</code><code class="p">.</code><code class="nx">isPostalCode</code><code class="p">(</code><code class="nx">value</code><code class="p">,</code> <code class="s1">'US'</code><code class="p">);</code>&#13;
    <code class="p">}</code>&#13;
&#13;
    <code class="k">return</code> <code class="kc">false</code><code class="p">;</code>&#13;
  <code class="p">}</code>&#13;
&#13;
  <code class="kr">const</code> <code class="nx">inputs</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s1">'#example input'</code><code class="p">);</code>&#13;
&#13;
  <code class="nx">inputs</code><code class="p">.</code><code class="nx">forEach</code><code class="p">(</code><code class="nx">input</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
    <code class="c1">// fire an event each time an input value changes</code>&#13;
    <code class="nx">input</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'input'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
     <code class="c1">// pass the input value to the validation function</code>&#13;
     <code class="kr">const</code> <code class="nx">valid</code> <code class="o">=</code> <code class="nx">inputValidator</code><code class="p">(</code><code class="nx">input</code><code class="p">.</code><code class="nx">id</code><code class="p">,</code> <code class="nx">input</code><code class="p">.</code><code class="nx">value</code><code class="p">);</code>&#13;
     <code class="c1">// if not valid set the aria-invalid attribute to true</code>&#13;
     <code class="k">if</code> <code class="p">(</code><code class="o">!</code><code class="nx">valid</code> <code class="o">&amp;&amp;</code> <code class="nx">input</code><code class="p">.</code><code class="nx">value</code><code class="p">.</code><code class="nx">length</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="p">)</code> <code class="p">{</code>&#13;
       <code class="k">this</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s1">'aria-invalid'</code><code class="p">,</code> <code class="s1">'true'</code><code class="p">);</code>&#13;
     <code class="p">}</code>&#13;
    <code class="p">});</code>&#13;
  <code class="p">});</code>&#13;
<code class="nt">&lt;/script&gt;</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475145895112">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>By now, we should not be writing our own forms validation routines. Not unless we’re dealing with some really bizarre form behavior and/or data. And by bizarre, I mean so far outside the ordinary that trying to incorporate a JavaScript library would actually be harder than doing it ourselves—a “the form field value must be a string except on Thursdays, when it must be a number—but reverse that in even months” type of validation.</p>&#13;
&#13;
<p><a data-primary="validator.js library" data-type="indexterm" id="idm45475145892792"/>You have a lot of options for libraries, and I’ve only demonstrated one. The <em>validator.js</em> library is a nice, simple, easy-to-use library that provides validation for many different types of strings. It doesn’t require that you modify the form fields, either, which means it’s easier to just drop it in, instead of reworking the form. Any and all styling and placement of error messages is developer dependent, too.</p>&#13;
&#13;
<p><a data-primary="events" data-secondary="input event listener" data-type="indexterm" id="idm45475145773272"/><a data-primary="input event listener" data-type="indexterm" id="idm45475145772072"/>In the solution, the code adds an event listener to each <code>input</code> element. When a user makes any change to the field, the <code>input</code> event listener is fired and calls the <code>inputValidator</code> function, which checks the value against the <em>validator.js</em> library. If the value is invalid, minimal CSS styling is used to add a red border to the input field. When the value is valid, no style is added.</p>&#13;
&#13;
<p><a data-primary="credit card validation library" data-type="indexterm" id="idm45475145769256"/><a data-primary="libraries" data-secondary="credit card validation" data-type="indexterm" id="idm45475145768584"/>Sometimes you need a smaller library specifically for one type of data validation. Credit cards are tricky things, and though you can ensure a correct format, the values contained in them must meet specific rules in order to be considered valid credit card submissions.</p>&#13;
&#13;
<p>In addition to the other validation libraries, you can also incorporate a credit card validation library, such as <a href="https://github.com/jessepollak/payment">Payment</a>, which provides a straightforward validation API. As an example, specify that a field is a credit card number after the form loads:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">cardInput</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'input.cc-num'</code><code class="p">);</code>&#13;
&#13;
<code class="nx">Payment</code><code class="p">.</code><code class="nx">formatCardNumber</code><code class="p">(</code><code class="nx">cardInput</code><code class="p">);</code></pre>&#13;
&#13;
<p>And then when the form is submitted, validate the credit card number:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">var</code> <code class="nx">valid</code> <code class="o">=</code> <code class="nx">Payment</code><code class="p">.</code><code class="nx">fns</code><code class="p">.</code><code class="nx">validateCardNumber</code><code class="p">(</code><code class="nx">cardInput</code><code class="p">.</code><code class="nx">value</code><code class="p">);</code>&#13;
&#13;
<code class="k">if</code> <code class="p">(</code><code class="o">!</code><code class="nx">valid</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="nx">message</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="s1">'You entered an invalid credit card number'</code><code class="p">;</code>&#13;
  <code class="k">return</code> <code class="kc">false</code><code class="p">;</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>The library doesn’t just check format; it also ensures that the value meets a valid card number for all of the major card companies. Depending on how you are processing credit cards, the payment processor may provide similar functionality in the client-side code. For example, the payment processor Stripe’s <a href="https://oreil.ly/GqPVh">Stripe.js</a> includes a credit card validation API.</p>&#13;
&#13;
<p>Lastly, you can pair client and server validation, using the same library or different ones. In the example, we are using <em>validator.js</em> in the browser, but it can also be used to validate inputs on the backend in a Node application.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Extra: HTML5 Form Validation Techniques" data-type="sect2"><div class="sect2" id="idm45475145894520">&#13;
<h2>Extra: HTML5 Form Validation Techniques</h2>&#13;
&#13;
<p>HTML5 offers fairly extensive built-in form validation, which does not require JavaScript, including:</p>&#13;
<dl>&#13;
<dt><code>min</code> and <code>max</code></dt>&#13;
<dd>&#13;
<p>The minimum and maximum values of numeric inputs</p>&#13;
</dd>&#13;
<dt><code>minlength</code> and <code>maxlength</code></dt>&#13;
<dd>&#13;
<p>The minimum and maximum length of string inputs</p>&#13;
</dd>&#13;
<dt><code>pattern</code></dt>&#13;
<dd>&#13;
<p>A regular expression pattern that the entered input must follow</p>&#13;
</dd>&#13;
<dt><code>required</code></dt>&#13;
<dd>&#13;
<p>Required inputs must be completed before the form can be submitted</p>&#13;
</dd>&#13;
<dt><code>type</code></dt>&#13;
<dd>&#13;
<p>Allows developers to specify a content type for an input, such as date, email address, number, password, URL, or some other specific preset type</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>Additionally, CSS pseudoselectors can be used to match <code>:valid</code> and <code>:invalid</code> inputs.</p>&#13;
&#13;
<p>Because of this, for simple forms you may not need JavaScript at all. If you need finite control over the appearance and behavior of form validation, you’re better off using a JavaScript library than depending on the HTML5 and CSS forms validation specifications. If you do, though, make sure to incorporate accessibility features into your forms. I recommend reading <a href="https://oreil.ly/5oL3E">WebAIM’s “Creating Accessible Forms”</a>.<a data-primary="" data-startref="ix_html5_valid_form" data-type="indexterm" id="idm45475145737512"/><a data-primary="" data-startref="ix_valid_form_data" data-type="indexterm" id="idm45475145736536"/><a data-primary="" data-startref="ix_forms_valid_data" data-type="indexterm" id="idm45475145735592"/><a data-primary="" data-startref="ix_data_forms_valid" data-type="indexterm" id="idm45475145734648"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Highlighting Form Errors and Accessibility" data-type="sect1"><div class="sect1" id="idm45475145733576">&#13;
<h1>Highlighting Form Errors and Accessibility</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475145732360">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="accessibility" data-secondary="for forms" data-secondary-sortas="forms" data-type="indexterm" id="ix_access_forms"/><a data-primary="forms" data-secondary="error highlighting" data-type="indexterm" id="ix_form_error2"/><a data-primary="errors (Error object)" data-secondary="in forms" data-secondary-sortas="forms" data-type="indexterm" id="ix_error_forms"/><a data-primary="HTML5" data-secondary="highlighting form errors" data-type="indexterm" id="ix_html5_form_error"/>You want to highlight form field entries that have incorrect data, and you want to ensure the highlighting is effective for all web page users.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475145725208">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="WAI-ARIA (Web Accessibility Initiative-Accessible Rich Internet Applications)" data-type="indexterm" id="ix_wai-aria"/>Use CSS to highlight the incorrectly entered form field, and use WAI-ARIA (Web Accessibility Initiative-Accessible Rich Internet Applications) markup to ensure the highlighting is apparent to all users:</p>&#13;
&#13;
<pre data-code-language="css" data-type="programlisting"><code class="o">[</code><code class="nt">aria-invalid</code><code class="o">]</code> <code class="p">{</code>&#13;
  <code class="k">background-color</code><code class="o">:</code> <code class="m">#f5b2b2</code><code class="p">;</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>For the fields that need to be validated, assign a function to the form field’s <code>oninput</code> event handler that checks whether the field value is valid. If the value is invalid, display information to the user about the error at the same time that you highlight the field:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">validateField</code><code class="p">()</code> <code class="p">{</code>&#13;
  <code class="c1">// check for number</code>&#13;
  <code class="k">if</code> <code class="p">(</code><code class="k">typeof</code> <code class="k">this</code><code class="p">.</code><code class="nx">value</code> <code class="o">!==</code> <code class="s1">'number'</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="k">this</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s1">'aria-invalid'</code><code class="p">,</code> <code class="s1">'true'</code><code class="p">);</code>&#13;
    <code class="nx">generateAlert</code><code class="p">(</code>&#13;
      <code class="s1">'You entered an invalid value. Only numeric values are allowed'</code>&#13;
    <code class="p">);</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'number'</code><code class="p">).</code><code class="nx">oninput</code> <code class="o">=</code> <code class="nx">validateField</code><code class="p">;</code></pre>&#13;
&#13;
<p><a data-primary="event handlers" data-secondary="onblur" data-type="indexterm" id="idm45475145519880"/><a data-primary="onblur event handler" data-type="indexterm" id="idm45475145492264"/>For the fields that need a required value, assign a function to the field’s <code>onblur</code> event handler that checks whether a value has been entered:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">checkMandatory</code><code class="p">()</code> <code class="p">{</code>&#13;
  <code class="c1">// check for data</code>&#13;
  <code class="k">if</code> <code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">value</code><code class="p">.</code><code class="nx">length</code> <code class="o">===</code> <code class="mi">0</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="k">this</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s1">'aria-invalid'</code><code class="p">,</code> <code class="s1">'true'</code><code class="p">);</code>&#13;
    <code class="nx">generateAlert</code><code class="p">(</code><code class="s1">'A value is required in this field'</code><code class="p">);</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'required-field'</code><code class="p">).</code><code class="nx">onblur</code> <code class="o">=</code> <code class="nx">checkMandatory</code><code class="p">;</code></pre>&#13;
&#13;
<p>If any of the validation checks are performed as part of the form submission, make sure to cancel the submission event if the validation fails.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475145425240">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><a data-primary="aria-invalid attribute" data-type="indexterm" id="ix_aria_invalid"/>The WAI-ARIA provides a way of marking certain fields and behaviors so that assistive devices do whatever is the equivalent behavior for people who need these devices. If a person is using a screen reader, setting the <code>aria-invalid</code> attribute to <code>true</code> (or adding it to the element) should trigger an audible warning in the screen reader—comparable to a color indicator doing the same for people who aren’t using assistive technologies.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Read more on WAI-ARIA at the <a href="https://oreil.ly/8wGnc">Web Accessibility Initiative at the W3C</a>. On Windows, I recommend using <a href="http://www.nvaccess.org">NVDA</a>, an open source, freely available screen reader, for testing whether your application is responding as you think it should with a screen reader. For macOS, I recommend using the built-in VoiceOver tool with the Safari browser.</p>&#13;
</div>&#13;
&#13;
<p>In addition, the <code>role</code> attribute can be set to several values of which one, “alert,” triggers a comparable behavior in screen readers (typically saying out the field contents).</p>&#13;
&#13;
<p>Providing these cues are essential when you’re validating form elements. You can validate a form before submission and provide a text description of everything that’s wrong. A better approach, though, is to validate data for each field as the user finishes, so they’re not left with a lot of irritating error messages at the end.</p>&#13;
&#13;
<p>As you validate the field, you can ensure your users know exactly which field has failed by using a visual indicator. It shouldn’t be the only method used to mark an error, but it is an extra courtesy.</p>&#13;
&#13;
<p>If you highlight an incorrect form field entry with colors, avoid those that are hard to differentiate from the background. If the form background is white, and you use a dark yellow, gray, red, blue, green, or other color, there’s enough contrast that it doesn’t matter if the person viewing the page is color-blind or not. In the example, I used a darker pink in the form field.</p>&#13;
&#13;
<p><a data-primary="attribute selectors" data-type="indexterm" id="idm45475145415096"/><a data-primary="CSS (Cascading Style Sheet)" data-secondary="attribute selectors" data-type="indexterm" id="idm45475145414392"/><a data-primary="properties" data-secondary="CSS" data-type="indexterm" id="idm45475145413480"/>I could have set the color directly, but it makes more sense to handle both updates—setting <code>aria-invalid</code> and changing the color—with one CSS setting. Luckily, CSS <em>attribute selectors</em> simplify our task in this regard.</p>&#13;
&#13;
<p>In addition to using color, you also need to provide a text description of the error, so there’s no question in the user’s mind about what the problem is.</p>&#13;
&#13;
<p><a data-primary="alert boxes" data-type="indexterm" id="idm45475145410616"/>How you display the information is also an important consideration. None of us really like to use alert boxes, if we can avoid them. Alert boxes can obscure the form, and the only way to access the form element is to dismiss the alert with its error message. A better approach is to embed the information in the page, near the form. We also want to ensure the error message is available to people who are using assistive technologies, such as a screen reader. <a data-primary="ARIA alert role" data-type="indexterm" id="idm45475145409304"/>This is easily accomplished by assigning an ARIA <code>alert</code> <code>role</code> to the element containing the alert for those using screen readers or other AT devices.</p>&#13;
&#13;
<p>One final bonus to using <code>aria-invalid</code> is it can be used to discover all incorrect fields when the form is submitted. Just search on all elements where the attribute is present and if any are discovered, you know there’s still an invalid form field value that needs correcting.</p>&#13;
&#13;
<p><a data-type="xref" href="#providing_visual_and_other_cues_when_val">Example 12-5</a> demonstrates how to highlight an invalid entry on one of the form elements, and highlight missing data in another. The example also traps the form submit, and checks whether any invalid form field flags are still set. Only if everything is clear is the form submission allowed to proceed.</p>&#13;
<div data-type="example" id="providing_visual_and_other_cues_when_val">&#13;
<h5><span class="label">Example 12-5. </span>Providing visual and other cues when validating form fields</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cp">&lt;!DOCTYPE html&gt;</code>&#13;
<code class="nt">&lt;head&gt;</code>&#13;
<code class="nt">&lt;title&gt;</code>Validating Forms<code class="nt">&lt;/title&gt;</code>&#13;
<code class="nt">&lt;style&gt;</code>&#13;
<code class="o">[</code><code class="nt">aria-invalid</code><code class="o">]</code> <code class="p">{</code>&#13;
   <code class="k">background-color</code><code class="o">:</code> <code class="m">#ffeeee</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="o">[</code><code class="nt">role</code><code class="o">=</code><code class="s2">"alert"</code><code class="o">]</code> <code class="p">{</code>&#13;
  <code class="k">background-color</code><code class="o">:</code> <code class="m">#ffcccc</code><code class="p">;</code>&#13;
  <code class="k">font-weight</code><code class="o">:</code> <code class="nb">bold</code><code class="p">;</code>&#13;
  <code class="k">padding</code><code class="o">:</code> <code class="m">5px</code><code class="p">;</code>&#13;
  <code class="k">border</code><code class="o">:</code> <code class="m">1px</code> <code class="nb">dashed</code> <code class="m">#000</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="nt">div</code> <code class="p">{</code>&#13;
  <code class="k">margin</code><code class="o">:</code> <code class="m">10px</code> <code class="m">0</code><code class="p">;</code>&#13;
  <code class="k">padding</code><code class="o">:</code> <code class="m">5px</code><code class="p">;</code>&#13;
  <code class="k">width</code><code class="o">:</code> <code class="m">400px</code><code class="p">;</code>&#13;
  <code class="k">background-color</code><code class="o">:</code> <code class="m">#ffffff</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
<code class="nt">&lt;/style&gt;</code>&#13;
<code class="nt">&lt;/head&gt;</code>&#13;
<code class="nt">&lt;body&gt;</code>&#13;
&#13;
<code class="nt">&lt;form</code> <code class="na">id=</code><code class="s">"testform"</code><code class="nt">&gt;</code>&#13;
   <code class="nt">&lt;div&gt;&lt;label</code> <code class="na">for=</code><code class="s">"firstfield"</code><code class="nt">&gt;</code>*First Field:<code class="nt">&lt;/label&gt;&lt;br</code> <code class="nt">/&gt;</code>&#13;
      <code class="nt">&lt;input</code> <code class="na">id=</code><code class="s">"firstfield"</code> <code class="na">name=</code><code class="s">"firstfield"</code> <code class="na">type=</code><code class="s">"text"</code> <code class="na">aria-required=</code><code class="s">"true"</code>&#13;
      <code class="na">required</code> <code class="nt">/&gt;</code>&#13;
   <code class="nt">&lt;/div&gt;</code>&#13;
   <code class="nt">&lt;div&gt;&lt;label</code> <code class="na">for=</code><code class="s">"secondfield"</code><code class="nt">&gt;</code>Second Field:<code class="nt">&lt;/label&gt;&lt;br</code> <code class="nt">/&gt;</code>&#13;
      <code class="nt">&lt;input</code> <code class="na">id=</code><code class="s">"secondfield"</code> <code class="na">name=</code><code class="s">"secondfield"</code> <code class="na">type=</code><code class="s">"text"</code> <code class="nt">/&gt;</code>&#13;
   <code class="nt">&lt;/div&gt;</code>&#13;
   <code class="nt">&lt;div&gt;&lt;label</code> <code class="na">for=</code><code class="s">"thirdfield"</code><code class="nt">&gt;</code>Third Field (numeric):<code class="nt">&lt;/label&gt;&lt;br</code> <code class="nt">/&gt;</code>&#13;
      <code class="nt">&lt;input</code> <code class="na">id=</code><code class="s">"thirdfield"</code> <code class="na">name=</code><code class="s">"thirdfield"</code> <code class="na">type=</code><code class="s">"text"</code> <code class="nt">/&gt;</code>&#13;
   <code class="nt">&lt;/div&gt;</code>&#13;
   <code class="nt">&lt;div&gt;&lt;label</code> <code class="na">for=</code><code class="s">"fourthfield"</code><code class="nt">&gt;</code>Fourth Field:<code class="nt">&lt;/label&gt;&lt;br</code> <code class="nt">/&gt;</code>&#13;
      <code class="nt">&lt;input</code> <code class="na">id=</code><code class="s">"fourthfield"</code> <code class="na">name=</code><code class="s">"fourthfield"</code> <code class="na">type=</code><code class="s">"text"</code> <code class="nt">/&gt;</code>&#13;
   <code class="nt">&lt;/div&gt;</code>&#13;
&#13;
   <code class="nt">&lt;input</code> <code class="na">type=</code><code class="s">"submit"</code> <code class="na">value=</code><code class="s">"Send Data"</code> <code class="nt">/&gt;</code>&#13;
<code class="nt">&lt;/form&gt;</code>&#13;
&#13;
<code class="nt">&lt;script&gt;</code>&#13;
&#13;
  <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s2">"thirdfield"</code><code class="p">).</code><code class="nx">onchange</code><code class="o">=</code><code class="nx">validateField</code><code class="p">;</code>&#13;
  <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s2">"firstfield"</code><code class="p">).</code><code class="nx">onblur</code><code class="o">=</code><code class="nx">mandatoryField</code><code class="p">;</code>&#13;
  <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s2">"testform"</code><code class="p">).</code><code class="nx">onsubmit</code><code class="o">=</code><code class="nx">finalCheck</code><code class="p">;</code>&#13;
&#13;
  <code class="kd">function</code> <code class="nx">removeAlert</code><code class="p">()</code> <code class="p">{</code>&#13;
&#13;
    <code class="kd">var</code> <code class="nx">msg</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s2">"msg"</code><code class="p">);</code>&#13;
    <code class="k">if</code> <code class="p">(</code><code class="nx">msg</code><code class="p">)</code> <code class="p">{</code>&#13;
      <code class="nb">document</code><code class="p">.</code><code class="nx">body</code><code class="p">.</code><code class="nx">removeChild</code><code class="p">(</code><code class="nx">msg</code><code class="p">);</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
&#13;
  <code class="kd">function</code> <code class="nx">resetField</code><code class="p">(</code><code class="nx">elem</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nx">elem</code><code class="p">.</code><code class="nx">parentNode</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s2">"style"</code><code class="p">,</code><code class="s2">"background-color: #ffffff"</code><code class="p">);</code>&#13;
    <code class="kd">var</code> <code class="nx">valid</code> <code class="o">=</code> <code class="nx">elem</code><code class="p">.</code><code class="nx">getAttribute</code><code class="p">(</code><code class="s2">"aria-invalid"</code><code class="p">);</code>&#13;
    <code class="k">if</code> <code class="p">(</code><code class="nx">valid</code><code class="p">)</code> <code class="nx">elem</code><code class="p">.</code><code class="nx">removeAttribute</code><code class="p">(</code><code class="s2">"aria-invalid"</code><code class="p">);</code>&#13;
  <code class="p">}</code>&#13;
&#13;
  <code class="kd">function</code> <code class="nx">badField</code><code class="p">(</code><code class="nx">elem</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nx">elem</code><code class="p">.</code><code class="nx">parentNode</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s2">"style"</code><code class="p">,</code> <code class="s2">"background-color: #ffeeee"</code><code class="p">);</code>&#13;
    <code class="nx">elem</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s2">"aria-invalid"</code><code class="p">,</code><code class="s2">"true"</code><code class="p">);</code>&#13;
  <code class="p">}</code>&#13;
&#13;
  <code class="kd">function</code> <code class="nx">generateAlert</code><code class="p">(</code><code class="nx">txt</code><code class="p">)</code> <code class="p">{</code>&#13;
&#13;
    <code class="c1">// create new text and div elements and set</code>&#13;
    <code class="c1">// Aria and class values and id</code>&#13;
    <code class="kd">var</code> <code class="nx">txtNd</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createTextNode</code><code class="p">(</code><code class="nx">txt</code><code class="p">);</code>&#13;
    <code class="nx">msg</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s2">"div"</code><code class="p">);</code>&#13;
    <code class="nx">msg</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s2">"role"</code><code class="p">,</code><code class="s2">"alert"</code><code class="p">);</code>&#13;
    <code class="nx">msg</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s2">"id"</code><code class="p">,</code><code class="s2">"msg"</code><code class="p">);</code>&#13;
    <code class="nx">msg</code><code class="p">.</code><code class="nx">setAttribute</code><code class="p">(</code><code class="s2">"class"</code><code class="p">,</code><code class="s2">"alert"</code><code class="p">);</code>&#13;
&#13;
    <code class="c1">// append text to div, div to document</code>&#13;
    <code class="nx">msg</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">txtNd</code><code class="p">);</code>&#13;
    <code class="nb">document</code><code class="p">.</code><code class="nx">body</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">msg</code><code class="p">);</code>&#13;
  <code class="p">}</code>&#13;
&#13;
  <code class="kd">function</code> <code class="nx">validateField</code><code class="p">()</code> <code class="p">{</code>&#13;
&#13;
    <code class="c1">// remove any existing alert regardless of value</code>&#13;
    <code class="nx">removeAlert</code><code class="p">();</code>&#13;
&#13;
    <code class="c1">// check for number</code>&#13;
    <code class="k">if</code> <code class="p">(</code><code class="o">!</code><code class="nb">isNaN</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">value</code><code class="p">))</code> <code class="p">{</code>&#13;
      <code class="nx">resetField</code><code class="p">(</code><code class="k">this</code><code class="p">);</code>&#13;
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>&#13;
      <code class="nx">badField</code><code class="p">(</code><code class="k">this</code><code class="p">);</code>&#13;
      <code class="nx">generateAlert</code><code class="p">(</code><code class="s2">"You entered an invalid value in Third Field. "</code> <code class="o">+</code>&#13;
                    <code class="s2">"Only numeric values such as 105 or 3.54 are allowed"</code><code class="p">);</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
&#13;
  <code class="kd">function</code> <code class="nx">mandatoryField</code><code class="p">()</code> <code class="p">{</code>&#13;
&#13;
    <code class="c1">// remove any existing alert</code>&#13;
    <code class="nx">removeAlert</code><code class="p">();</code>&#13;
&#13;
    <code class="c1">// check for value</code>&#13;
    <code class="k">if</code> <code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">value</code><code class="p">.</code><code class="nx">length</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="p">)</code> <code class="p">{</code>&#13;
      <code class="nx">resetField</code><code class="p">(</code><code class="k">this</code><code class="p">);</code>&#13;
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>&#13;
      <code class="nx">badField</code><code class="p">(</code><code class="k">this</code><code class="p">);</code>&#13;
      <code class="nx">generateAlert</code><code class="p">(</code><code class="s2">"You must enter a value into First Field"</code><code class="p">);</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
&#13;
  <code class="kd">function</code> <code class="nx">finalCheck</code><code class="p">()</code> <code class="p">{</code>&#13;
&#13;
    <code class="nx">removeAlert</code><code class="p">();</code>&#13;
    <code class="kd">var</code> <code class="nx">fields</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelectorAll</code><code class="p">(</code><code class="s2">"[aria-invalid='true']"</code><code class="p">);</code>&#13;
    <code class="k">if</code> <code class="p">(</code><code class="nx">fields</code><code class="p">.</code><code class="nx">length</code> <code class="o">&gt;</code> <code class="mi">0</code><code class="p">)</code> <code class="p">{</code>&#13;
      <code class="nx">generateAlert</code><code class="p">(</code><code class="s2">"You have incorrect field entries that must be fixed "</code> <code class="o">+</code>&#13;
                     <code class="s2">"before you can submit this form"</code><code class="p">);</code>&#13;
      <code class="k">return</code> <code class="kc">false</code><code class="p">;</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
&#13;
<code class="nt">&lt;/script&gt;</code>&#13;
&#13;
<code class="nt">&lt;/body&gt;</code></pre></div>&#13;
&#13;
<p><a data-primary="ARIA alert role" data-type="indexterm" id="idm45475145395592"/>If either of the validated fields is incorrect in the application, the <code>aria-invalid</code> attribute is set to <code>true</code> in the field, and an ARIA <code>role</code> is set to <code>alert</code> on the error message, as shown in <a data-type="xref" href="#highlighting_an_incorrect_form_field">Figure 12-2</a>. When the error is corrected, the <code>aria-invalid</code> attribute is removed, as is the alert message. Both have the effect of changing the background color for the form field.<a data-primary="" data-startref="ix_aria_invalid" data-type="indexterm" id="idm45475145391784"/></p>&#13;
&#13;
<figure class="no-frame"><div class="figure" id="highlighting_an_incorrect_form_field">&#13;
<img alt="jsc3 1202" src="assets/jsc3_1202.png"/>&#13;
<h6><span class="label">Figure 12-2. </span>Highlighting an incorrect form field</h6>&#13;
</div></figure>&#13;
&#13;
<p>Notice in the code that the element wrapping the targeted form field is set to its correct state when the data entered is correct, so that when a field is corrected it doesn’t show up as inaccurate or missing on the next go-round. I remove the existing message alert regardless of the previous event, as it’s no longer valid with the new event.</p>&#13;
&#13;
<p>You can also disable or even hide the correctly entered form elements as a way to accentuate those with incorrect or missing data. However, I don’t recommend this approach. Your users may find as they fill in the missing information that their answers in other fields are incorrect. If you make it difficult for them to correct the fields, they’re not going to be happy with the experience—or the company, person, or organization providing the form.</p>&#13;
&#13;
<p>Another approach you can take is to only do validation when the form is submitted. Many built-in libraries operate this way. Rather than check each field for mandatory or correct values as your users tab through, you only apply the validation rules when the form is submitted. This allows users who want to fill out the form in a different order to do so without getting irritating validation messages as they tab through.</p>&#13;
&#13;
<p>Using JavaScript to highlight a form field with incorrect and missing data is only one part of the form submission process. You’ll also have to account for JavaScript being turned off, which means you have to provide the same level of feedback when processing the form information on the server, and providing the result on a separate page.</p>&#13;
&#13;
<p>It’s also important to mark if a form field is required ahead of time. Use an asterisk in the form field label, with a note that all form fields with an asterisk are required. <a data-primary="aria-required attribute" data-type="indexterm" id="idm45475144952424"/>Use the <code>aria-required</code> and attribute to ensure this information is communicated to those using assistive devices. I also recommend using the HTML5 <code>required</code> attribute when using <code>aria-required</code>, which provides built-in browser validation.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="idm45475145424328">&#13;
<h2>See Also</h2>&#13;
&#13;
<p>In <a data-type="xref" href="#validating_forms">“Validating Form Data”</a> I cover form validation libraries and modules to simplify form validation. I also touch on using the HTML5 declarative form validation techniques.<a data-primary="" data-startref="ix_html5_form_error" data-type="indexterm" id="idm45475144948056"/><a data-primary="" data-startref="ix_form_error2" data-type="indexterm" id="idm45475144947112"/><a data-primary="" data-startref="ix_error_forms" data-type="indexterm" id="idm45475144946168"/><a data-primary="" data-startref="ix_access_forms" data-type="indexterm" id="idm45475144945224"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Creating an Accessible Automatically Updated Region" data-type="sect1"><div class="sect1" id="live_region">&#13;
<h1>Creating an Accessible Automatically Updated Region</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475144942536">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="live regions" data-type="indexterm" id="ix_live_region"/><a data-primary="accessibility" data-secondary="automatically updated regions" data-type="indexterm" id="ix_access_update_region"/><a data-primary="automatically updated regions" data-type="indexterm" id="ix_auto_update_region"/><a data-primary="HTML5" data-secondary="automatically updated regions" data-type="indexterm" id="ix_html5_auto_update"/>You have a section of a web page that is updated periodically, such as a section that lists recent updates to a file, or one that reflects recent Twitter activity on a subject. You want to ensure that when the page updates, those using a screen reader are notified of the new information.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475144936248">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use WAI-ARIA <em>region</em> attributes on the element being updated:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="nt">&lt;div</code> <code class="na">id=</code><code class="s">"update"</code> <code class="na">role=</code><code class="s">"log"</code> <code class="na">aria-live=</code><code class="s">"polite"</code> <code class="na">aria-atomic=</code><code class="s">"true"</code>&#13;
<code class="na">aria-relevant=</code><code class="s">"additions"</code><code class="nt">&gt;</code>&#13;
<code class="nt">&lt;/div&gt;</code></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475144924440">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>A section of the web page that can be updated after the page is loaded, and without direct user intervention, calls for WAI-ARIA Live Regions. These are probably the simplest ARIA functionality to implement, and they provide immediate, positive results. And there’s no code involved, other than the JavaScript you need to create the page updates.</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="nt">&lt;div</code> <code class="na">id=</code><code class="s">"update"</code> <code class="na">role=</code><code class="s">"log"</code> <code class="na">aria-live=</code><code class="s">"polite"</code> <code class="na">aria-atomic=</code><code class="s">"true"</code>&#13;
<code class="na">aria-relevant=</code><code class="s">"additions"</code><code class="nt">&gt;&lt;/div&gt;</code></pre>&#13;
&#13;
<p><a data-primary="region attributes" data-type="indexterm" id="idm45475144909976"/>From left to right, the <code>role</code> is set to <code>log</code>, which would be used when polling for log updates from a file. Other options include <code>status</code>, for a status update, and a more general <code>region</code> value, for an undetermined purpose.</p>&#13;
&#13;
<p><a data-primary="aria-live region attribute" data-type="indexterm" id="idm45475144907352"/>The <code>aria-live</code> region attribute is set to <code>polite</code>, because the update isn’t a critical update. The <code>polite</code> setting tells the screen reader to voice the update, but not interrupt a current task to do so. If I had used a value of <code>assertive</code>, the screen reader would interrupt whatever it is doing and voice the content. Always use <code>polite</code>, unless the information is critical.</p>&#13;
&#13;
<p><a data-primary="aria-atomic attribute" data-type="indexterm" id="idm45475144872728"/>The <code>aria-atomic</code> is set to <code>false</code>, so that the screen reader only voices new additions, based on whatever is set with <code>aria-relevant</code>. It could get very annoying to have the screen reader voice the entire set with each new addition, as would happen if this value is set to <code>true</code>.</p>&#13;
&#13;
<p><a data-primary="aria-relevant attribute" data-type="indexterm" id="idm45475144869832"/>Lastly, the <code>aria-relevant</code> is set to <code>additions</code>, as we don’t care about the entries being removed from the top. This setting is actually the default setting for this attribute, so, technically, it isn’t needed. In addition, assistive technology devices don’t have to support this attribute. Still, I’d rather list it than not. Other values are <code>removals</code>, <code>text</code>, and <code>all</code> (for all events). You can specify more than one, separated by a space.</p>&#13;
&#13;
<p>This WAI-ARIA–enabled functionality was probably the one that impressed me the most. One of my first uses for fetching remote data, years ago, was to update a web page with information. It was frustrating to test the page with a screen reader (JAWS, at the time) and hear nothing but silence every time the page was updated. I can’t even imagine how frustrating it was for those who needed the functionality.<a data-primary="" data-startref="ix_html5_ch12" data-type="indexterm" id="idm45475144865560"/><a data-primary="" data-startref="ix_html5_auto_update" data-type="indexterm" id="idm45475144864584"/><a data-primary="" data-startref="ix_auto_update_region" data-type="indexterm" id="idm45475144863640"/><a data-primary="" data-startref="ix_wai-aria" data-type="indexterm" id="idm45475144862696"/><a data-primary="" data-startref="ix_access_update_region" data-type="indexterm" id="idm45475144861752"/><a data-primary="" data-startref="ix_live_region" data-type="indexterm" id="idm45475144860808"/></p>&#13;
&#13;
<p>Now we have it, and it’s so easy to use. It’s a win-win.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section></body></html>