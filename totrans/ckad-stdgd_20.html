<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:epub="http://www.idpf.org/2007/ops" lang="en" xml:lang="en" xsi:schemaLocation="http://www.w3.org/2002/06/xhtml2/ http://www.w3.org/MarkUp/SCHEMA/xhtml2.xsd">
  <head>
    <title>Unknown</title>
    <link rel="stylesheet" type="text/css" href="../stylesheet.css"/>
    <link rel="stylesheet" type="text/css" href="../page_styles.css"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  </head>
  <body class="calibre"><div id="sbo-rt-content" class="calibre1"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 20. Security Contexts" class="praise"><div class="dedication" id="security_contexts">
<h1 class="calibre14"><span class="keep-together">Chapter 20. </span>Security Contexts</h1>


<p class="author1">Running a Pod in Kubernetes without implementing more restrictive security measures can pose a security risk. Without these measures, an attacker can potentially gain access to the host system or perform malicious activities, such as accessing files containing sensitive data. A security context defines privilege and access control settings for containers as part of a Pod specification. The following list provides some examples for security-related parameters:</p>

<ul class="printings">
<li class="calibre13">
<p class="author1">The user ID that should be used to run the Pod and/or container</p>
</li>
<li class="calibre13">
<p class="author1">The group ID that should be used for filesystem access</p>
</li>
<li class="calibre13">
<p class="author1">Granting a running process inside the container some privileges of the root user but not all of them</p>
</li>
</ul>

<p class="author1">This chapter will give you an overview of defining security contexts and seeing their runtime effects in practice. Given the wide range of security settings, we won’t be able to discuss all of them. You will find additional use cases and configuration options in the <a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/" class="calibre10">Kubernetes documentation</a>.</p>
<aside data-type="sidebar" epub:type="sidebar" class="calibre48"><div class="sidebar" id="id489">
<h1 class="calibre49">Coverage of Curriculum Objectives</h1>
<p class="author1">This chapter addresses the following curriculum objective:</p>

<ul class="printings">
<li class="calibre13">
<p class="author1">Understand SecurityContext</p>
</li>
</ul>
</div></aside>






<section data-type="sect1" data-pdf-bookmark="Working with Security Contexts" class="praise"><div class="dedication" id="id393">
<h1 class="calibre17">Working with Security Contexts</h1>

<p class="author1">The security context is not a Kubernetes primitive. It is modeled as a set of attributes under the directive <code class="calibre15">securityContext</code> within the Pod specification. Security settings defined on the Pod level apply to all containers running in the Pod. When applied to a single container, it will have no effects on other containers running in the same Pod.</p>

<ul class="printings">
<li class="calibre13">
<p class="author1">You can apply security settings to all containers of a Pod with the attribute <code class="calibre15">spec.securityContext</code>.</p>
</li>
<li class="calibre13">
<p class="author1">For individual containers, you can apply security settings with the attribute <code class="calibre15">spec.containers[].securityContext</code>.</p>
</li>
</ul>

<p class="author1"><a data-type="xref" href="#security_context_levels" class="calibre10">Figure 20-1</a> shows the use of security settings <code class="calibre15">runAsUser</code> and <code class="calibre15">fsGroup</code> applied on the Pod and container level. A later section will describe the runtime effect of those settings by example.</p>

<figure class="calibre35"><div id="security_context_levels" class="figure">
<img src="Images/ckd2_2001.png" alt="ckd2 2001" class="calibre104"/>
<h6 class="calibre32"><span class="keep-together">Figure 20-1. </span>Applying security settings on the Pod and container level</h6>
</div></figure>

<p class="author1">Some security context attributes are available on the Pod <em class="calibre3">and</em> the container level. If you define the same security context on both levels then the value assigned on the container level will take precedence. <a data-type="xref" href="#security_context_override" class="calibre10">Figure 20-2</a> shows an override of a container-level security context value for the container named <code class="calibre15">nginx</code>. For that container, the value 2000 will apply.</p>

<figure class="calibre35"><div id="security_context_override" class="figure">
<img src="Images/ckd2_2002.png" alt="ckd2 2002" class="calibre105"/>
<h6 class="calibre32"><span class="keep-together">Figure 20-2. </span>Overriding a security context attribute on the container level</h6>
</div></figure>

<p class="author1">For more information on the specifics of Pod-level security attributes, see the <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/#podsecuritycontext-v1-core" class="calibre10">PodSecurityContext</a> API. Container-level security attributes can be found in the <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/#securitycontext-v1-core" class="calibre10">SecurityContext</a> API.</p>
<div data-type="tip" class="calibre26"><h1 class="calibre34">Applying a security context to a Deployment’s Pod template</h1>
<p class="author1">The definition of a Deployment applies security context attributes in the same way as a vanilla Pod definition. You’d use the same Pod- and container-level attributes in the Pod template section of the Deployment.</p>
</div>

<p class="author1">Defining security-related parameters with the security context is always limited to a container. The Kubernetes ecosystem offers other ways to improve or govern security for applications, some of which directly tie in with the security context concept. For example, you can use the <a href="https://kubernetes.io/docs/concepts/security/pod-security-admission/" class="calibre10">Pod Security Admission</a> to enforce desired security settings for all Pods within a namespace.</p>








<section data-type="sect2" data-pdf-bookmark="Defining a Security Context on the Pod Level" class="praise"><div class="dedication" id="id394">
<h2 class="calibre33">Defining a Security Context on the Pod Level</h2>

<p class="author1">Container images can define security-relevant instructions to reduce the attack vector for the running container. By default, containers run with root privileges, which provide supreme access to all processes and the container’s filesystem. As a best practice, you should craft the corresponding <code class="calibre15">Dockerfile</code> in a such a way that the container will be run with a user ID other than 0 with the help of the <code class="calibre15">USER</code> instruction. There are many other ways to secure a container on the container level, but we won’t go into any more detail here. Refer to <a href="https://learning.oreilly.com/library/view/container-security/9781492056690/" class="calibre10"><em class="calibre3">Container Security</em></a> by Liz Rice (O’Reilly) for more information.</p>

<p class="author1">To make the functionality of a security-context more transparent, let’s look at a use case. Some images, like the one for the open source reverse-proxy server <a href="https://hub.docker.com/_/nginx" class="calibre10">NGINX</a>, must be run with the root user. Say you wanted to enforce that containers cannot be run as a root user as a sensible security strategy. The YAML manifest shown in <a data-type="xref" href="#security_context_nginx_non_root" class="calibre10">Example 20-1</a> defines the security configuration on the Pod level as a direct child of the <code class="calibre15">spec</code> attribute. If you were to run other containers inside the Pod, then the <code class="calibre15">runAsNonRoot</code> setting apply to them as well.</p>
<div id="security_context_nginx_non_root" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 20-1. </span>Setting a security context on the container level for the NGINX image</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">v1</code><code class="w">
</code><code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">Pod</code><code class="w">
</code><code class="nt">metadata</code><code class="p">:</code><code class="w">
</code><code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx-non-root</code><code class="w">
</code><code class="nt">spec</code><code class="p">:</code><code class="w">
</code><code class="w">  </code><code class="nt">securityContext</code><code class="p">:</code><code class="w">
</code><code class="w">    </code><code class="nt">runAsNonRoot</code><code class="p">:</code><code class="w"> </code><code class="calibre15">true</code><code class="w">        </code><a class="calibre10" id="co_security_contexts_CO1-1" href="#callout_security_contexts_CO1-1"><img src="Images/1.png" alt="1" class="calibre51"/></a><code class="w">
</code><code class="w">  </code><code class="nt">containers</code><code class="p">:</code><code class="w">
</code><code class="w">  </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">image</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx:1.25.3</code><code class="w">
</code><code class="w">    </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">secured-container</code></pre></div>
<dl class="calibre18">
<dt class="calibre52"><a class="calibre10" id="callout_security_contexts_CO1-1" href="#co_security_contexts_CO1-1"><img src="Images/1.png" alt="1" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">Enforces the use of a non-root user to run the container.</p></dd>
</dl>

<p class="author1">Creating the Pod from this manifest will work as expected:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl apply -f container-nginx-root-user.yaml</strong>
pod/nginx-non-root created
</pre>

<p class="author1">Unfortunately, the image is not compatible. The container fails during the startup process with the status <code class="calibre15">CreateContainerConfigError</code>:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl get pod nginx-non-root</strong>
NAME             READY   STATUS                       RESTARTS   AGE
nginx-non-root   0/1     CreateContainerConfigError   0          7s
</pre>

<p class="author1">You will find the root cause for this issue in the event logs:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl describe pod nginx-non-root</strong>
...
Events:
Type     Reason     Age              From               Message
----     ------     ----             ----               -------
Normal   Scheduled  &lt;unknown&gt;        default-scheduler  Successfully assigned \
                                                        default/non-root to \
                                                        minikube
Normal   Pulling    18s              kubelet, minikube  Pulling image \
                                                        "nginx:1.25.3"
Normal   Pulled     14s              kubelet, minikube  Successfully pulled \
                                                        image "nginx:1.25.3"
Warning  Failed     0s (x3 over 14s) kubelet, minikube  Error: container has \
                                                        runAsNonRoot and image \
                                                        will run as root
</pre>

<p class="author1">There are alternative NGINX images available that are not required to run with the root user. One example is <a href="https://hub.docker.com/r/bitnami/nginx" class="calibre10">bitnami/nginx</a>. Upon a closer look at the <code class="calibre15">Dockerfile</code> that produced the image, you will see that the container runs with the user ID 1001. <a data-type="xref" href="#security_context_bitnami_nginx_non_root" class="calibre10">Example 20-2</a> shows the use of the Bitnami image.</p>
<div id="security_context_bitnami_nginx_non_root" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 20-2. </span>Setting a security context on the container level for the Bitnami NGIX image</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">v1</code><code class="w"></code>
<code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">Pod</code><code class="w"></code>
<code class="nt">metadata</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">bitnami-ngnix-non-root</code><code class="w"></code>
<code class="nt">spec</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">securityContext</code><code class="p">:</code><code class="w"></code>
<code class="w">    </code><code class="nt">runAsNonRoot</code><code class="p">:</code><code class="w"> </code><code class="calibre15">true</code><code class="w"></code>
<code class="w">  </code><code class="nt">containers</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">image</code><code class="p">:</code><code class="w"> </code><code class="calibre15">bitnami/nginx:1.25.3</code><code class="w"></code>
<code class="w">    </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">secured-container</code><code class="w"></code></pre></div>

<p class="author1">Starting the container with the <code class="calibre15">runAsNonRoot</code> directive will work just fine:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl apply -f container-bitnami-nginx-root-user.yaml</strong>
pod/bitnami-ngnix-non-root created
</pre>

<p class="author1">The container will indicate the “Running” status:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl get pod nginx-non-root</strong>
NAME                     READY   STATUS    RESTARTS   AGE
bitnami-ngnix-non-root   1/1     Running   0          7s
</pre>

<p class="author1">The container could be executed with the user ID set by the container image that you easily surface by running the following command inside the container:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl exec -it bitnami-ngnix-non-root -- id -u</strong>
1001
</pre>

<p class="author1">The output of the command renders the user ID 1001, a non-root user ID.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Defining a Security Context on the Container Level" class="praise"><div class="dedication" id="id395">
<h2 class="calibre33">Defining a Security Context on the Container Level</h2>

<p class="author1">You can impose many other security restrictions on a container running in Kubernetes. For example, you may want to set the access control for files and directories. Say that, whenever a file is created on the filesystem, the owner of the file should be the arbitrary group ID 3500. The YAML manifest shown in <a data-type="xref" href="#security_context_fs_group" class="calibre10">Example 20-3</a> assigns the security context settings on the container level.</p>
<div id="security_context_fs_group" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 20-3. </span>Setting a security context on the container level</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">v1</code><code class="w"></code>
<code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">Pod</code><code class="w"></code>
<code class="nt">metadata</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">fs-secured</code><code class="w"></code>
<code class="nt">spec</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">containers</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">image</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx:1.25.3</code><code class="w"></code>
<code class="w">    </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">secured-container</code><code class="w"></code>
<code class="w">    </code><code class="nt">securityContext</code><code class="p">:</code><code class="w"></code>
<code class="w">      </code><code class="nt">fsGroup</code><code class="p">:</code><code class="w"> </code><code class="calibre15">3500</code><code class="w"></code>
<code class="w">    </code><code class="nt">volumeMounts</code><code class="p">:</code><code class="w"></code>
<code class="w">    </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">data-volume</code><code class="w"></code>
<code class="w">      </code><code class="nt">mountPath</code><code class="p">:</code><code class="w"> </code><code class="calibre15">/data/app</code><code class="w"></code>
<code class="w">  </code><code class="nt">volumes</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">data-volume</code><code class="w"></code>
<code class="w">    </code><code class="nt">emptyDir</code><code class="p">:</code><code class="w"> </code><code class="calibre15">{}</code><code class="w"></code></pre></div>

<p class="author1">Create the Pod object from the manifest file and inspect the status. The Pod should transition into the “Running” status:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl apply -f pod-file-system-group.yaml</strong>
pod/fs-secured created
<strong class="calibre38">$ kubectl get pods</strong>
NAME         READY   STATUS    RESTARTS   AGE
fs-secured   1/1     Running   0          24s
</pre>

<p class="author1">You can easily verify the effect of setting the filesystem group ID. Open an interactive shell to the container, navigate to the mounted volume, and create a new file:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl exec -it fs-secured -- /bin/sh</strong>
# cd /data/app
# touch logs.txt
# ls -l
-rw-r--r-- 1 root 3500 0 Jul  9 01:41 logs.txt
</pre>

<p class="author1">Inspecting the ownership of the file will show the group ID 3500 automatically assigned to it.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Defining a Security Context on the Pod and Container Level" class="praise"><div class="dedication" id="id396">
<h2 class="calibre33">Defining a Security Context on the Pod and Container Level</h2>

<p class="author1">Finally, let’s demonstrate the override behavior on the container level if you already defined the same attribute on the Pod level. <a data-type="xref" href="#security_context_non_root_user_override" class="calibre10">Example 20-4</a> shows the definition of the <code class="calibre15">runAsNonRoot</code> on both levels.</p>
<div id="security_context_non_root_user_override" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 20-4. </span>Setting a security context on the Pod and container level</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">v1</code><code class="w">
</code><code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">Pod</code><code class="w">
</code><code class="nt">metadata</code><code class="p">:</code><code class="w">
</code><code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">non-root-user-override</code><code class="w">
</code><code class="nt">spec</code><code class="p">:</code><code class="w">
</code><code class="w">  </code><code class="nt">securityContext</code><code class="p">:</code><code class="w">
</code><code class="w">    </code><code class="nt">runAsNonRoot</code><code class="p">:</code><code class="w"> </code><code class="calibre15">true</code><code class="w">            </code><a class="calibre10" id="co_security_contexts_CO2-1" href="#callout_security_contexts_CO2-1"><img src="Images/1.png" alt="1" class="calibre51"/></a><code class="w">
</code><code class="w">  </code><code class="nt">containers</code><code class="p">:</code><code class="w">
</code><code class="w">  </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">image</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx:1.25.3</code><code class="w">
</code><code class="w">    </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">root</code><code class="w">
</code><code class="w">    </code><code class="nt">securityContext</code><code class="p">:</code><code class="w">
</code><code class="w">      </code><code class="nt">runAsNonRoot</code><code class="p">:</code><code class="w"> </code><code class="calibre15">false</code><code class="w">         </code><a class="calibre10" id="co_security_contexts_CO2-2" href="#callout_security_contexts_CO2-2"><img src="Images/2.png" alt="2" class="calibre51"/></a><code class="w">
</code><code class="w">  </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">image</code><code class="p">:</code><code class="w"> </code><code class="calibre15">bitnami/nginx:1.25.3</code><code class="w">
</code><code class="w">    </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">non-root</code></pre></div>
<dl class="calibre18">
<dt class="calibre52"><a class="calibre10" id="callout_security_contexts_CO2-1" href="#co_security_contexts_CO2-1"><img src="Images/1.png" alt="1" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">Assign the default value <code class="calibre15">true</code> to all containers of the Pod.</p></dd>
<dt class="calibre52"><a class="calibre10" id="callout_security_contexts_CO2-2" href="#co_security_contexts_CO2-2"><img src="Images/2.png" alt="2" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">The value <code class="calibre15">false</code> will take precedence even though <code class="calibre15">true</code> has been assigned on the Pod level.</p></dd>
</dl>

<p class="author1">Create the Pod object from the manifest file:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl apply -f pod-non-root-user-override.yaml</strong>
pod/non-root-user-override created
</pre>

<p class="author1">Open an interactive shell to the container and execute the command for rendering the user ID that runs the container:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl exec -it -c root non-root-user-override -- id -u</strong>
0
<strong class="calibre38">$ kubectl exec -it -c non-root non-root-user-override -- id -u</strong>
1001
</pre>

<p class="author1">The container <code class="calibre15">root</code> returns the value 0, which is the user ID for the root user. The container <code class="calibre15">non-root</code> returns the user ID 1001, the ID set by the container image itself.</p>
</div></section>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Summary" class="praise"><div class="dedication" id="id397">
<h1 class="calibre17">Summary</h1>

<p class="author1">It’s important to enforce security best practices for Pods. This chapter covered the security context concept. With the help of a security context, you can control container permissions to access objects such as files, run a container in privileged and unprivileged mode, specify Linux capabilities, and much more.</p>

<p class="author1">The security context can be declared on a Pod level and container level. The Pod level applies the provided security settings to all containers in the Pod. The container level applies only to individual containers. The container-level security settings override the Pod-level security settings if the same attribute value is specified on both levels.</p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Exam Essentials" class="praise"><div class="dedication" id="id398">
<h1 class="calibre17">Exam Essentials</h1>
<dl class="calibre18">
<dt class="calibre19">Experiment with options available to security contexts</dt>
<dd class="calibre20">
<p class="calibre21">The Kubernetes user documentation and API documentation is a good starting point for exploring security context options. You will find that there’s an overlap in the options available via the PodSecurityContext and a SecurityContext APIs. While working through the different use cases solved by a security context option, verify their outcome by running an operation that should either be permitted or disallowed.</p>
</dd>
<dt class="calibre19">Understand the implications of defining a security context on the Pod and container level</dt>
<dd class="calibre20">
<p class="calibre21">You can define a security context on the Pod level with <code class="calibre15">spec.securityContext</code>, and on the container level with <code class="calibre15">spec.containers[].securityContext</code>. If defined on the Pod level, settings can be overridden by specifying them with a different value on the container level. The exam may confront you with existing Pods that set a security context on both levels. Understand which value will take effect.</p>
</dd>
</dl>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Sample Exercises" class="praise"><div class="dedication" id="id399">
<h1 class="calibre17">Sample Exercises</h1>

<p class="author1">Solutions to these exercises are available in <a href="app01_split_016.xhtml#appendix_a_security_contexts" class="calibre10">Appendix A</a>.</p>
<ol class="calibre55">
<li class="calibre56">
<p class="author1">Define a Pod named <code class="calibre15">busybox-security-context</code> that uses the image <code class="calibre15">busybox:1.36.1</code> for a single container running the command <code class="calibre15">sh -c sleep 1h</code>.</p>

<p class="author1">Add an ephemeral Volume of type <code class="calibre15">emptyDir</code>. Mount the Volume to the container at <em class="calibre3">/data/test</em>.</p>

<p class="author1">Define a security context that runs the container with user ID 1000, with group ID 3000, and the filesystem group ID 2000. Ensure that the container should not allow privilege escalation.</p>

<p class="author1">Create the Pod object and ensure that it transitions into the “Running” status.</p>

<p class="author1">Open a shell to the running container and create a new file named <em class="calibre3">logs.txt</em> in the directory <em class="calibre3">/data/test</em>. What’s the file’s user ID and group ID?</p>
</li>
<li class="calibre56">
<p class="author1">Create a Deployment named <code class="calibre15">nginx</code> in the namespace <code class="calibre15">h20</code> with the 3 replicas. The Pod template should use the the image <code class="calibre15">nginx:1.25.3-alpine</code>.</p>

<p class="author1">Using the security context, assign the <code class="calibre15">drop</code> Linux capability for that Pod template. The attribute for the <code class="calibre15">drop</code> capabilities should use the value <code class="calibre15">all</code>.</p>

<p class="author1">Create the Deployment object and inspect its replicas. Does NGINX work as expected?</p>
</li>

</ol>
</div></section>
</div></section></div></body>
</html>