<html><head></head><body><section data-pdf-bookmark="Chapter 10. MySQL in the Cloud" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch10">&#13;
<h1><span class="label">Chapter 10. </span>MySQL in the Cloud</h1>&#13;
&#13;
&#13;
<p>MySQL in the cloud <a data-primary="cloud" data-type="indexterm" id="cloud1"/>is fundamentally the same MySQL that you know and love (or know and tolerate).&#13;
In the cloud, the best practices and techniques detailed in the previous nine chapters are not only true but <em>eminently</em> true because cloud providers charge for every byte and millisecond of work.&#13;
Performance is money in the cloud.&#13;
To recap the previous nine chapters:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Performance is query response time (<a data-type="xref" href="ch01.html#ch01">Chapter 1</a>).</p>&#13;
</li>&#13;
<li>&#13;
<p>Indexes are the key to performance (<a data-type="xref" href="ch02.html#ch02">Chapter 2</a>).</p>&#13;
</li>&#13;
<li>&#13;
<p>Less data is better—for both storing and accessing (<a data-type="xref" href="ch03.html#ch03">Chapter 3</a>).</p>&#13;
</li>&#13;
<li>&#13;
<p>Access patterns allow or inhibit performance (<a data-type="xref" href="ch04.html#ch04">Chapter 4</a>).</p>&#13;
</li>&#13;
<li>&#13;
<p>Sharding is necessary to scale out writes and storage (<a data-type="xref" href="ch05.html#ch05">Chapter 5</a>).</p>&#13;
</li>&#13;
<li>&#13;
<p>Server metrics reveal how the workload affects MySQL (<a data-type="xref" href="ch06.html#ch06">Chapter 6</a>).</p>&#13;
</li>&#13;
<li>&#13;
<p>Replication lag is data loss and must be avoided (<a data-type="xref" href="ch07.html#ch07">Chapter 7</a>).</p>&#13;
</li>&#13;
<li>&#13;
<p>Transactions affect row locking and undo logging (<a data-type="xref" href="ch08.html#ch08">Chapter 8</a>).</p>&#13;
</li>&#13;
<li>&#13;
<p>Other challenges exist—even in the cloud (<a data-type="xref" href="ch09.html#ch09">Chapter 9</a>).</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>If you embrace and apply all those details, MySQL will execute the application workload with remarkable performance regardless of location: in the cloud, on premise, or anywhere.</p>&#13;
&#13;
<p>For the sake of saving you time, I wish it were that simple—optimize the workload and you’re done—but MySQL in the cloud raises unique considerations.&#13;
The goal is to know and mitigate these cloud considerations so that you can focus on MySQL, not the cloud.&#13;
After all, the cloud is nothing special: behind the proverbial curtain, it’s physical servers in a data center running programs like MySQL.</p>&#13;
&#13;
<p>This chapter highlights what to know when using MySQL in the cloud.&#13;
There are four major sections.&#13;
The first cautions against compatibility: when MySQL is not MySQL.&#13;
The second is a quick discussion about varying levels of MySQL administration in the cloud.&#13;
The third discusses network latency and its relationship to storage I/O.&#13;
The fourth is about performance and money.<a data-primary="cloud" data-startref="cloud1" data-type="indexterm" id="idm45829096468784"/></p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Compatibility" data-type="sect1"><div class="sect1" id="cloud-compat">&#13;
<h1>Compatibility</h1>&#13;
&#13;
<p>MySQL in the cloud <a data-primary="cloud" data-secondary="compatibility" data-type="indexterm" id="cloud-combatibility"/>might not be MySQL, or it might be a highly modified (and proprietary) version of MySQL.&#13;
Compatibility of MySQL in the cloud has two sides: code compatibility and feature compatibility.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>By <em>MySQL</em>, I mean MySQL published by Oracle: the official, open source MySQL source code.&#13;
I also mean Percona Server <a data-primary="Percona Server" data-secondary="code compatibility" data-type="indexterm" id="idm45829096462608"/>published by Percona, and MariaDB Server published by the MariaDB Foundation: both are widely used, safe and stable, and considered to be MySQL in general.</p>&#13;
</div>&#13;
&#13;
<p><em>Code compatibility</em> is whether or not MySQL is the same open source code published by Oracle, Percona, or MariaDB.&#13;
The following nine words and phrases are commonly used in product descriptions and documentation to allude to the fact that MySQL is not code-compatible but, rather, something slightly (or significantly) different:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Built on</p>&#13;
</li>&#13;
<li>&#13;
<p>Emulates</p>&#13;
</li>&#13;
<li>&#13;
<p>Compatible</p>&#13;
</li>&#13;
<li>&#13;
<p>Client compatible</p>&#13;
</li>&#13;
<li>&#13;
<p>Protocol compatible</p>&#13;
</li>&#13;
<li>&#13;
<p>Wire compatible</p>&#13;
</li>&#13;
<li>&#13;
<p>Replacement</p>&#13;
</li>&#13;
<li>&#13;
<p>Drop-in replacement</p>&#13;
</li>&#13;
<li>&#13;
<p>Works with existing</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Code compatibility is important because MySQL is complex and subtle, and we entrust it to store invaluable data.&#13;
In this book, I focus discussions to narrow the scope of MySQL complexity, but sections like <a data-type="xref" href="ch06.html#metrics-page-flushing">“Page flushing”</a> and <a data-type="xref" href="ch08.html#row-locking">“Row Locking”</a> hint at how deep the rabbit hole goes.&#13;
When any company alters MySQL source code, the risks are fourfold: data loss, performance regressions, bugs, and incompatibilities.&#13;
The greater the alterations, the greater the risks.&#13;
I have seen the latter three in the cloud; fortunately, I have not seen a cloud provider lose data.</p>&#13;
<div data-type="tip"><h6>Tip</h6>&#13;
<p>If you have any doubts whether or not MySQL in the cloud is code-compatible, ask the cloud provider, “Is it the same open source MySQL published by Oracle?”</p>&#13;
</div>&#13;
&#13;
<p>To present the whole argument, not just the negatives (the risks), cloud providers alter MySQL to provide additional value: improve performance, fix bugs, and add features that customers need.&#13;
Some alterations are valuable and worth the risks.&#13;
But if you use MySQL in the cloud that is not code-compatible, you need to understand the extent of the alterations.&#13;
This is basic due diligence for professional engineers using MySQL in the cloud.</p>&#13;
<blockquote>&#13;
<p>Given enough eyeballs, all bugs are shallow.</p>&#13;
<p data-type="attribution">Eric S. Raymond</p>&#13;
</blockquote>&#13;
&#13;
<p><em>Feature compatibility</em> <a data-primary="feature combatibility" data-type="indexterm" id="idm45829096444448"/>is whether or not MySQL includes features not available outside the cloud provider or the distribution of MySQL.&#13;
For example, Oracle publishes two distributions: MySQL Community Server and MySQL Enterprise Edition.&#13;
The former is open source; the latter includes proprietary features.&#13;
<a href="https://www.oracle.com/cloud">Oracle Cloud Infrastructure (OCI)</a> uses the latter, which is good: more value for the cloud money.&#13;
But it also means that if you rely on features specific to MySQL Enterprise Edition, you cannot directly migrate to another cloud provider or distribution of MySQL.&#13;
The same is true for Percona Server <a data-primary="Percona Server" data-secondary="code compatibility" data-type="indexterm" id="idm45829096442368"/>and MariaDB Server: these distributions of MySQL have unique features, which is good, but it complicates migration to another cloud provider or distribution of MySQL.</p>&#13;
&#13;
<p>Feature compatibility is important for the same reason open source software is important: freedom to change.&#13;
Software—MySQL included—should empower engineers and users, not lock us into specific cloud providers or vendors.&#13;
That reasoning is more philosophical than technical, which is why I’ll present the whole argument again: some features are valuable and worth <em>not</em> changing to keep.&#13;
But if you choose to use a feature that’s not available outside the cloud provider or the distribution of MySQL, you need to document why, so that future engineers can understand what’s at stake (and what needs to be replaced) if they use another cloud provider or distribution of MySQL.&#13;
This, too, is basic due diligence for professional engineers using MySQL in the cloud.<a data-primary="cloud" data-secondary="combatibility" data-startref="cloud-combatibility" data-type="indexterm" id="idm45829096439520"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Management (DBA)" data-type="sect1"><div class="sect1" id="idm45829096467088">&#13;
<h1>Management (DBA)</h1>&#13;
&#13;
<p>We have <a data-primary="cloud" data-secondary="management (DBA)" data-type="indexterm" id="management-DBA_index1"/><a data-primary="management (DBA)" data-type="indexterm" id="management-DBA_index2"/>successfully dodged MySQL administration (DBA work) from the very first pages of this book, so we’re not about to fail now, but MySQL in the cloud raises an issue that you need to know and address: who manages MySQL?&#13;
Ostensibly, the cloud provider manages MySQL, but it’s not that simple because managing MySQL entails many operations.&#13;
Brace yourself: I’m going steer this book dangerously close to DBA work in order to explain.</p>&#13;
&#13;
<p><a data-type="xref" href="#dba-ops">Table 10-1</a> is a partial list of DBA operations and who manages them: you or the cloud.</p>&#13;
<table id="dba-ops">&#13;
<caption><span class="label">Table 10-1. </span>DBA operations</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Operation</th>&#13;
<th>You</th>&#13;
<th>Cloud</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p>Provision</p></td>&#13;
<td/>&#13;
<td><p>✓</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Configure</p></td>&#13;
<td/>&#13;
<td><p>✓</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>MySQL users</p></td>&#13;
<td><p>✓</p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Server metrics</p></td>&#13;
<td><p>✓</p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Query metrics</p></td>&#13;
<td><p>✓</p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Online schema change (OSC)</p></td>&#13;
<td><p>✓</p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Failure recovery</p></td>&#13;
<td/>&#13;
<td><p>✓</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Disaster recovery (DR)</p></td>&#13;
<td><p>✓</p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>High availability (HA)</p></td>&#13;
<td><p>✓</p></td>&#13;
<td><p>†<sup><a data-type="noteref" href="ch10.html#idm45829096411712" id="idm45829096411712-marker">a</a></sup></p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Upgrading</p></td>&#13;
<td/>&#13;
<td><p>✓</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Backup and recovery</p></td>&#13;
<td/>&#13;
<td><p>✓</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Change data capture (CDC)</p></td>&#13;
<td><p>✓</p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Security</p></td>&#13;
<td><p>✓</p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Help</p></td>&#13;
<td><p>✓</p></td>&#13;
<td/>&#13;
</tr>&#13;
<tr>&#13;
<td><p>Cost</p></td>&#13;
<td><p>✓</p></td>&#13;
<td/>&#13;
</tr>&#13;
</tbody>&#13;
<tbody><tr class="footnotes"><td colspan="3"><p data-type="footnote" id="idm45829096411712"><sup><a href="ch10.html#idm45829096411712-marker">a</a></sup> Indicates some management.</p></td></tr></tbody></table>&#13;
&#13;
<p>Let me breeze through the 15 operations in <a data-type="xref" href="#dba-ops">Table 10-1</a> because being aware of the full scope—even at a high level—helps you avoid gaps in MySQL management that will become an issue if not addressed.&#13;
Also known as <em>CYA</em>: cover your administration.</p>&#13;
&#13;
<p>Provisioning MySQL is, of course, what a cloud provider must provide: the lowest level operation of running MySQL on a computer.&#13;
Cloud providers use a decent MySQL configuration, but double check because no default configuration can suit every customer.&#13;
Apart from a root user necessary to give you initial control of the MySQL server, cloud providers do not manage MySQL users.&#13;
Server and query metrics are also your responsibility to collect and report.&#13;
Granted, some cloud providers expose basic sever metrics, but none are even remotely close to the full spectra of metrics detailed in <a data-type="xref" href="ch06.html#ch06">Chapter 6</a>.&#13;
OSCs—running <code>ALTER</code> statements without affecting the workload—are entirely your responsibility, and they tend to be a little more difficult in the cloud for various technical reasons outside the scope of this book.&#13;
Cloud providers do handle failover: when hardware or MySQL dies, the cloud provider will failover to restore availability.&#13;
But cloud providers do not handle <em>disaster recovery</em>: when an entire region fails and availability must be restored by running MySQL from a different geographic location.&#13;
Given the previous two operations, high availability (HA) has mixed management (hence † in the cloud column).&#13;
The full discussion of MySQL high availability in the cloud is too nuanced to cover here; let’s just say that the cloud provides some amount of high availability.&#13;
Cloud providers upgrade MySQL, which is really nice because this operation is tedious at scale.&#13;
Cloud providers backup MySQL, provide long-term backup retention, and provide methods to restore backups—all of which are incredibly important.&#13;
You are responsible for change data capture (CDC), which usually involves another tool or service acting like a replica to dump (or stream) binary logs from MySQL to another data store (often a big data store or data lake).&#13;
Security of MySQL in the cloud is your responsibility—the cloud is <em>not</em> inherently secure.&#13;
Cloud providers help with running MySQL in general, but don’t expect much (or any) help with MySQL performance unless your company pays for that level of support.&#13;
And finally, you must manage costs: the cloud is notorious for costing more than engineers anticipate.</p>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>The three major cloud providers—Amazon, Google, and Microsoft—have a 99.95% or 99.99% availability SLA for MySQL (as a managed service), but read the fine print—the full legal details.&#13;
For example, maintenance windows usually do not count against the SLA.&#13;
Or, the SLA might be voided if MySQL is not properly configured <em>by you</em>.&#13;
There are always details and caveats to cloud provider high availability and SLAs.</p>&#13;
</div>&#13;
&#13;
<p><a data-type="xref" href="#dba-ops">Table 10-1</a> is descriptive, not prescriptive, because different cloud providers and third-party companies provide different levels of MySQL management in the cloud.&#13;
For example, some companies <em>fully</em> manage MySQL in the cloud (or on-premise).&#13;
As an engineer using MySQL, not managing it, you only need to know that all the operations are managed—all the boxes are checked—so that none of them interfere with your work.&#13;
Once you know that, please forget everything you read in this section, else you’ll wind up a MySQL DBA before you know it, twenty years will pass, and the next engineer to join your team will have been a newborn infant when—lo, the many years past—you were dealing with an inexplicable multi-range read performance regression after an innocuous point release upgrade.<a data-primary="management (DBA)" data-startref="management-DBA_index2" data-type="indexterm" id="idm45829096388912"/><a data-primary="cloud" data-secondary="management (DBA)" data-startref="management-DBA_index1" data-type="indexterm" id="idm45829096387936"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Network and Storage…Latency" data-type="sect1"><div class="sect1" id="idm45829096386592">&#13;
<h1>Network and Storage…Latency</h1>&#13;
&#13;
<p>When running MySQL on-premise (in data center space that your company leases), the local network should never be a consideration or concern for you, presuming it was designed and wired by competent professional network engineers.&#13;
Local networks are blazing fast and stable with submillisecond latency.&#13;
The local network should be more boring than the database (recall <a data-type="xref" href="ch06.html#normal-and-stable">“Normal and Stable: The Best Database <span class="keep-together">Is a Boring Database</span>”</a>).</p>&#13;
&#13;
<p>But the cloud is global, and wide-area networks have higher latency and lower stability (greater fluctuations in latency and throughput).&#13;
For example, the network round-trip time (RTT) between San Francisco and New York City is approximately 60 milliseconds, plus or minus 10 milliseconds.&#13;
If you run MySQL in San Francisco (or anywhere on the U.S. west coast) and the application is in New York City (or anywhere on the U.S. east cost), the minimum query response time is approximately 60 milliseconds.&#13;
That is 60 times slower than a local network.<sup><a data-type="noteref" href="ch10.html#idm45829096382992" id="idm45829096382992-marker">1</a></sup>&#13;
You will notice that slowness, but it will not show up in query response time because the delay is outside MySQL.&#13;
For example, a query profile (see <a data-type="xref" href="ch01.html#query-profile">“Query profile”</a>) shows that a query takes 800 microseconds to execute, but your application performance monitoring (APM) shows that the query takes 60.8 milliseconds to execute: 800 µs for MySQL, and 60 ms for network latency from sea to shining sea.</p>&#13;
&#13;
<p>Network latency <a data-primary="cloud" data-secondary="network and storage latency" data-type="indexterm" id="network-and-storage-latency-ch10"/>over long distances is physically limited by the speed of light and exacerbated by intermediate routing.&#13;
Consequently, you cannot overcome this latency; you can only work around it.&#13;
For example, refer to <a data-type="xref" href="ch04.html#enqueue-writes">“Enqueue Writes”</a>: enqueue locally, write remotely—where <em>remotely</em> is any process that incurs high network latency.</p>&#13;
&#13;
<p>Switching back to local networks, it’s a good thing they’re blazing fast and stable because cloud providers typically store MySQL data on <em>network-attached storage</em>: hard drives connected to the server through a local network.&#13;
By contrast, <em>locally-attached storage</em> (or <em>local storage</em>) is hard drives connected directly to the server.&#13;
Cloud providers use network-attached storage for various reasons beyond the scope of this book.&#13;
What’s important to know is that network-attached storage is much slower and less stable than local storage.&#13;
All three major cloud providers—Amazon, Google, and Microsoft—publish “single-digit millisecond latency” for network-attached storage (using SSD),<sup><a data-type="noteref" href="ch10.html#idm45829096375248" id="idm45829096375248-marker">2</a></sup> with one exception: Amazon io2 Block Express has submillisecond latency.&#13;
The bottom line is, when using MySQL in the cloud, expect the storage to have single-digit millisecond latency, which is equivalent to a spinning disk.</p>&#13;
&#13;
<p>Network-attached storage is an order of magnitude slower than local storage (with SSD; don’t use spinning disks), but is it a problem that you should address?&#13;
If you’re migrating MySQL to the cloud from bare metal hardware with high-end local storage <em>and</em> the application heavily and consistently utilizes the local storage IOPS (see <a data-type="xref" href="ch06.html#metrics-iops">“IOPS”</a>), then yes: verify that the increased latency of network-attached storage does not cause a ripple effect of performance degradation (because IOPS incur the latency).&#13;
(Heavy and consistent utilization of IOPS is a hallmark of a write-heavy workload: see <a data-type="xref" href="ch04.html#ap-read-write">“Read/Write”</a>.)&#13;
But if you’re already in the cloud, or starting a new application in the cloud, then no: don’t worry or think about storage latency in the cloud.&#13;
Instead, lay a foundation of highly optimized queries (indexes), data, and access patterns—as covered in Chapters <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch02.html#ch02">2</a>, <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch03.html#ch03">3</a>, and <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch04.html#ch04">4</a>, respectively—and storage latency in the cloud may never be an issue.</p>&#13;
&#13;
<p>If storage latency in the cloud is a problem, then you need to optimize the workload further, shard (<a data-type="xref" href="ch05.html#ch05">Chapter 5</a>), or purchase better (more expensive) cloud storage.&#13;
Remember: Netflix runs in the cloud, as do other very large and successful companies.&#13;
The performance potential for MySQL in the cloud is virtually unlimited.&#13;
The question is: can you afford it?<a data-primary="cloud" data-secondary="network and storage latency" data-startref="network-and-storage-latency-ch10" data-type="indexterm" id="idm45829096363376"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Performance Is Money" data-type="sect1"><div class="sect1" id="cloud-money">&#13;
<h1>Performance Is Money</h1>&#13;
&#13;
<p>Fittingly, <a data-primary="cloud" data-secondary="performance" data-type="indexterm" id="cloud-performance"/><a data-primary="cloud" data-secondary="costs" data-type="indexterm" id="cloud-costs-ch10"/>the beginning of this book—<a data-type="xref" href="ch01.html#a-true-story">“A True Story of False Performance”</a>—mirrors the end.&#13;
But in the cloud, customers sell themselves more RAM to “fix” MySQL performance.&#13;
An engineer at one of the three major cloud providers told me that most MySQL instances are over-provisioned: customers pay for more capacity than the application needs or utilizes.<sup><a data-type="noteref" href="ch10.html#idm45829096356448" id="idm45829096356448-marker">3</a></sup></p>&#13;
&#13;
<p>Has the industry come full circle and now, with the ease of scalability in the cloud, performance is simply a larger instance?&#13;
No, definitely not: <em>performance is query response time</em>; and in the cloud, every byte and millisecond of performance is billed hourly, which makes all the best practices and techniques in this book more important than ever.</p>&#13;
&#13;
<p>If you have used any services in the cloud, then the following information probably won’t surprise you.&#13;
But if you’re new to the cloud, then let me be the first to tell you: cloud pricing is complex, nearly intractable, and frequently underestimated (which means over budget).&#13;
That’s true when engineers make a concerted effort to estimate and control cloud costs; when they don’t, I have seen six-figure surprises: more than $100,000 over budget.&#13;
Following are the three most important things to know to avoid billing surprises when using MySQL in the cloud.</p>&#13;
&#13;
<p>The first thing to know is that <em>the price doubles</em> for each level of the underlying compute (the virtual server that runs MySQL) because the resources (vCPU count and memory size) at each level double.&#13;
For example, if the minimum level of compute is 2 vCPU and 8 GB RAM, the next level up is 4 vCPU and 16 GB RAM—and the price doubles, too.&#13;
There are a few exceptions, but expect doubling.&#13;
As a result, you cannot gradually increase costs; you double costs for each level of compute that you scale up.&#13;
From an engineering point of view, scaling up from 2 vCPU to 8 vCPU is still a very small compute, but the price quadruples.&#13;
To put this in perspective, imagine if your monthly mortgage or rent payment doubled, or your car payment doubled, or your student loan payment doubled.&#13;
You would probably be upset—and rightly so.</p>&#13;
&#13;
<p>The second thing to know is that everything in the cloud costs money.&#13;
Compute costs are just the beginning.&#13;
The following list includes common charges for MySQL in the cloud in addition to compute costs:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Storage type (IOPS)</p>&#13;
</li>&#13;
<li>&#13;
<p>Data storage (size)</p>&#13;
</li>&#13;
<li>&#13;
<p>Backups (size and retention)</p>&#13;
</li>&#13;
<li>&#13;
<p>Logs (size and retention)</p>&#13;
</li>&#13;
<li>&#13;
<p>High availability (replicas)</p>&#13;
</li>&#13;
<li>&#13;
<p>Cross-region data transfer (size)</p>&#13;
</li>&#13;
<li>&#13;
<p>Encryption keys (to encrypt data)</p>&#13;
</li>&#13;
<li>&#13;
<p>Secrets (to store passwords)</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Moreover, those charges are per-instance.&#13;
For example, if you create five read replicas, each replica is billed for data store, backups, and so forth.&#13;
I wish it were simpler, but this is the reality: you need to investigate, understand, and estimate all costs when using MySQL in the cloud.</p>&#13;
<div data-type="warning" epub:type="warning"><h6>Warning</h6>&#13;
<p>Some proprietary versions of MySQL in the cloud (see <a data-type="xref" href="#cloud-compat">“Compatibility”</a>) have additional costs, or a completely different pricing model.</p>&#13;
</div>&#13;
&#13;
<p>The third and final thing to know is that cloud providers offer discounts.&#13;
Don’t pay full price.&#13;
At at minimum, costs can be significantly reduced with a one or three year commitment, rather than paying month to month.&#13;
Other discounts vary by cloud provider: look for (or ask about) reserved instances, committed usage, and volume discounts.&#13;
If your company relies on the cloud, then it has most likely negotiated a contract with the cloud provider.&#13;
Find out if that’s the case and whether any of the contract pricing details affect costs for MySQL in the cloud.&#13;
If you’re lucky, the contract might reduce <em>and</em> simplify costs, which allows you to focus on the fun details of using MySQL.<a data-primary="cloud" data-secondary="costs" data-startref="cloud-costs-ch10" data-type="indexterm" id="idm45829096339248"/><a data-primary="cloud" data-secondary="performance" data-startref="cloud-performance" data-type="indexterm" id="idm45829096338000"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Summary" data-type="sect1"><div class="sect1" id="idm45829096361456">&#13;
<h1>Summary</h1>&#13;
&#13;
<p>This chapter highlighted what to know when using MySQL in the cloud.&#13;
The substantial takeaway points are:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Code and feature compatibility of MySQL varies in the cloud.</p>&#13;
</li>&#13;
<li>&#13;
<p>Your due diligence is to know any code or feature incompatibilities compared to open source MySQL.</p>&#13;
</li>&#13;
<li>&#13;
<p>MySQL can be partially or fully managed, depending on cloud provider or third-party company.</p>&#13;
</li>&#13;
<li>&#13;
<p>Network latency over wide-area networks increases query response time by tens or hundreds of milliseconds.</p>&#13;
</li>&#13;
<li>&#13;
<p>Data for MySQL in the cloud is usually stored on network-attached storage.</p>&#13;
</li>&#13;
<li>&#13;
<p>Network-attached storage has single-digit millisecond latency, which is equivalent to a spinning disk.</p>&#13;
</li>&#13;
<li>&#13;
<p>The cloud charges for everything, and costs can (and often do) go over budget.</p>&#13;
</li>&#13;
<li>&#13;
<p>Cloud providers offer discounts; don’t pay full price.</p>&#13;
</li>&#13;
<li>&#13;
<p>Performance is query response time in the cloud.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>This is the last chapter, but don’t <code>\q</code> yet: there’s one more practice.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Practice: Try MySQL in the Cloud" data-type="sect1"><div class="sect1" id="idm45829096324912">&#13;
<h1>Practice: Try MySQL in the Cloud</h1>&#13;
&#13;
<p>The <a data-primary="cloud" data-type="indexterm" id="cloud2"/>goal of this practice is to try MySQL in the cloud—just to see how it works, no DBA work required.&#13;
On the one hand, I don’t want to provide any of the following five cloud providers free marketing—this book is strictly technical.&#13;
But on the other hand, using MySQL in the cloud is increasingly common, so I want you to be prepared and successful.&#13;
Plus, this is a <em>free trial</em>: the following five cloud providers have a free tier or an initial account credit.&#13;
Don’t pay for anything yet: cloud providers must earn your business and money by proving the value of their services to you.</p>&#13;
&#13;
<p class="pagebreak-before less_space">Try creating and using MySQL with any one (or several) of these cloud providers:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><a href="https://oreil.ly/Z7ZA8">MySQL Database Service</a> by Oracle</p>&#13;
</li>&#13;
<li>&#13;
<p><a href="https://oreil.ly/tn1KY">SkySQL</a> by MariaDB</p>&#13;
</li>&#13;
<li>&#13;
<p><a href="https://oreil.ly/yNPfc">Relational Database Service (RDS)</a> by Amazon</p>&#13;
</li>&#13;
<li>&#13;
<p><a href="https://oreil.ly/Tj3Y1">Azure Database for MySQL</a> by Microsoft</p>&#13;
</li>&#13;
<li>&#13;
<p><a href="https://oreil.ly/pnsVt">Cloud SQL</a> by Google</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>If you find that one is easy to use and potentially valuable, investigate its pricing model and additional costs.&#13;
I specifically use the verb <em>investigate</em> because, as I mention in <a data-type="xref" href="#cloud-money">“Performance Is Money”</a>: cloud pricing is complex, nearly intractable, and frequently underestimated (which means over budget).</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Don’t forget to destroy your MySQL instance in the cloud before the free trial ends or the initial account credit reaches zero.</p>&#13;
</div>&#13;
&#13;
<p>This is the last practice in this book, but I encourage you to keep learning and practicing because MySQL continues to evolve—so does the cloud.&#13;
For this reason, even MySQL experts must continue to learn and practice, and that reminds me of a Zen proverb on which I end this book:</p>&#13;
<blockquote>&#13;
<p>Chop wood. Carry water.<a data-primary="cloud" data-startref="cloud2" data-type="indexterm" id="idm45829096308048"/></p></blockquote>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<div data-type="footnotes"><p data-type="footnote" id="idm45829096382992"><sup><a href="ch10.html#idm45829096382992-marker">1</a></sup> Technically, all networks are equally fast: the speed of light. The problem is physical distance and intermediate routing over long distances.</p><p data-type="footnote" id="idm45829096375248"><sup><a href="ch10.html#idm45829096375248-marker">2</a></sup> See <a href="https://oreil.ly/NIly1">Amazon EBS features</a>, <a href="https://oreil.ly/7Zxaj">block storage performance on Google</a>, and <a href="https://oreil.ly/LMg03">premium storage with Microsoft Azure</a>.</p><p data-type="footnote" id="idm45829096356448"><sup><a href="ch10.html#idm45829096356448-marker">3</a></sup> Due to nondisclosure agreements, I cannot cite the source.</p></div></div></section></body></html>