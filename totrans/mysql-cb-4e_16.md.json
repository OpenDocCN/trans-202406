["```\nCREATE TABLE artist\n(\n  a_id  INT UNSIGNED NOT NULL AUTO_INCREMENT, # artist ID\n  name  VARCHAR(30) NOT NULL,                 # artist name\n  PRIMARY KEY (a_id),\n  UNIQUE (name)\n);\n\nCREATE TABLE painting\n(\n  a_id  INT UNSIGNED NOT NULL,                # artist ID\n  p_id  INT UNSIGNED NOT NULL AUTO_INCREMENT, # painting ID\n  title VARCHAR(100) NOT NULL,                # title of painting\n  state VARCHAR(2) NOT NULL,                  # state where purchased\n  price INT UNSIGNED,                         # purchase price (dollars)\n  INDEX (a_id),\n  PRIMARY KEY (p_id)\n);\n```", "```\nmysql> `SELECT * FROM artist ORDER BY a_id;`\n+------+----------+\n| a_id | name     |\n+------+----------+\n|    1 | Da Vinci |\n|    2 | Monet    |\n|    3 | Van Gogh |\n|    4 | Renoir   |\n+------+----------+\nmysql> `SELECT * FROM painting ORDER BY a_id, p_id;`\n+------+------+-------------------+-------+-------+\n| a_id | p_id | title             | state | price |\n+------+------+-------------------+-------+-------+\n|    1 |    1 | The Last Supper   | IN    |    34 |\n|    1 |    2 | Mona Lisa         | MI    |    87 |\n|    3 |    3 | Starry Night      | KY    |    48 |\n|    3 |    4 | The Potato Eaters | KY    |    67 |\n|    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n+------+------+-------------------+-------+-------+\n```", "```\nmysql> `SELECT * FROM artist INNER JOIN painting ORDER BY artist.a_id;`\n+------+----------+------+------+-------------------+-------+-------+\n| a_id | name     | a_id | p_id | title             | state | price |\n+------+----------+------+------+-------------------+-------+-------+\n|    1 | Da Vinci |    1 |    1 | The Last Supper   | IN    |    34 |\n|    1 | Da Vinci |    3 |    3 | Starry Night      | KY    |    48 |\n|    1 | Da Vinci |    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n|    1 | Da Vinci |    1 |    2 | Mona Lisa         | MI    |    87 |\n|    1 | Da Vinci |    3 |    4 | The Potato Eaters | KY    |    67 |\n|    2 | Monet    |    1 |    2 | Mona Lisa         | MI    |    87 |\n|    2 | Monet    |    3 |    4 | The Potato Eaters | KY    |    67 |\n|    2 | Monet    |    1 |    1 | The Last Supper   | IN    |    34 |\n|    2 | Monet    |    3 |    3 | Starry Night      | KY    |    48 |\n|    2 | Monet    |    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n|    3 | Van Gogh |    1 |    2 | Mona Lisa         | MI    |    87 |\n|    3 | Van Gogh |    3 |    4 | The Potato Eaters | KY    |    67 |\n|    3 | Van Gogh |    1 |    1 | The Last Supper   | IN    |    34 |\n|    3 | Van Gogh |    3 |    3 | Starry Night      | KY    |    48 |\n|    3 | Van Gogh |    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n|    4 | Renoir   |    1 |    1 | The Last Supper   | IN    |    34 |\n|    4 | Renoir   |    3 |    3 | Starry Night      | KY    |    48 |\n|    4 | Renoir   |    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n|    4 | Renoir   |    1 |    2 | Mona Lisa         | MI    |    87 |\n|    4 | Renoir   |    3 |    4 | The Potato Eaters | KY    |    67 |\n+------+----------+------+------+-------------------+-------+-------+\n```", "```\nmysql> `SELECT * FROM artist INNER JOIN painting`\n    -> `WHERE artist.a_id = painting.a_id`\n    -> `ORDER BY artist.a_id;`\n+------+----------+------+------+-------------------+-------+-------+\n| a_id | name     | a_id | p_id | title             | state | price |\n+------+----------+------+------+-------------------+-------+-------+\n|    1 | Da Vinci |    1 |    1 | The Last Supper   | IN    |    34 |\n|    1 | Da Vinci |    1 |    2 | Mona Lisa         | MI    |    87 |\n|    3 | Van Gogh |    3 |    3 | Starry Night      | KY    |    48 |\n|    3 | Van Gogh |    3 |    4 | The Potato Eaters | KY    |    67 |\n|    4 | Renoir   |    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n+------+----------+------+------+-------------------+-------+-------+\n```", "```\nSELECT * FROM artist INNER JOIN painting\nON artist.a_id = painting.a_id\nORDER BY artist.a_id;\n```", "```\nSELECT * FROM artist INNER JOIN painting\nUSING (a_id)\nORDER BY a_id;\n```", "```\nmysql> `SELECT * FROM artist INNER JOIN painting`\n    -> `ON artist.a_id = painting.a_id`\n    -> `WHERE painting.state = 'KY';`\n+------+----------+------+------+-------------------+-------+-------+\n| a_id | name     | a_id | p_id | title             | state | price |\n+------+----------+------+------+-------------------+-------+-------+\n|    3 | Van Gogh |    3 |    3 | Starry Night      | KY    |    48 |\n|    3 | Van Gogh |    3 |    4 | The Potato Eaters | KY    |    67 |\n+------+----------+------+------+-------------------+-------+-------+\n```", "```\nmysql> `SELECT artist.name, painting.title, painting.state, painting.price`\n    -> `FROM artist INNER JOIN painting`\n    -> `ON artist.a_id = painting.a_id`\n    -> `WHERE painting.state = 'KY';`\n+----------+-------------------+-------+-------+\n| name     | title             | state | price |\n+----------+-------------------+-------+-------+\n| Van Gogh | Starry Night      | KY    |    48 |\n| Van Gogh | The Potato Eaters | KY    |    67 |\n+----------+-------------------+-------+-------+\n```", "```\nmysql> `SELECT artist.name, painting.title, states.name, painting.price`\n    -> `FROM artist INNER JOIN painting INNER JOIN states`\n    -> `ON artist.a_id = painting.a_id AND painting.state = states.abbrev`\n    -> `WHERE painting.state = 'KY';`\n+----------+-------------------+----------+-------+\n| name     | title             | name     | price |\n+----------+-------------------+----------+-------+\n| Van Gogh | Starry Night      | Kentucky |    48 |\n| Van Gogh | The Potato Eaters | Kentucky |    67 |\n+----------+-------------------+----------+-------+\n```", "```\n    mysql> `SELECT painting.title`\n        -> `FROM artist INNER JOIN painting ON artist.a_id = painting.a_id`\n        -> `WHERE artist.name = 'Van Gogh';`\n    +-------------------+\n    | title             |\n    +-------------------+\n    | Starry Night      |\n    | The Potato Eaters |\n    +-------------------+\n    ```", "```\n    mysql> `SELECT artist.name`\n        -> `FROM artist INNER JOIN painting ON artist.a_id = painting.a_id`\n        -> `WHERE painting.title = 'Mona Lisa';`\n    +----------+\n    | name     |\n    +----------+\n    | Da Vinci |\n    +----------+\n    ```", "```\n    mysql> `SELECT DISTINCT artist.name`\n        -> `FROM artist INNER JOIN painting ON artist.a_id = painting.a_id`\n        -> `WHERE painting.state IN ('KY','IN');`\n    +----------+\n    | name     |\n    +----------+\n    | Da Vinci |\n    | Van Gogh |\n    +----------+\n    ```", "```\n    mysql> `SELECT artist.name, COUNT(*) AS 'number of paintings'`\n        -> `FROM artist INNER JOIN painting ON artist.a_id = painting.a_id`\n        -> `GROUP BY artist.name;`\n    +----------+---------------------+\n    | name     | number of paintings |\n    +----------+---------------------+\n    | Da Vinci |                   2 |\n    | Renoir   |                   1 |\n    | Van Gogh |                   2 |\n    +----------+---------------------+\n    ```", "```\n    mysql> `SELECT artist.name,`\n        -> `COUNT(*) AS 'number of paintings',`\n        -> `SUM(painting.price) AS 'total price',`\n        -> `AVG(painting.price) AS 'average price'`\n        -> `FROM artist INNER JOIN painting ON artist.a_id = painting.a_id`\n        -> `GROUP BY artist.name;`\n    +----------+---------------------+-------------+---------------+\n    | name     | number of paintings | total price | average price |\n    +----------+---------------------+-------------+---------------+\n    | Da Vinci |                   2 |         121 |       60.5000 |\n    | Renoir   |                   1 |          64 |       64.0000 |\n    | Van Gogh |                   2 |         115 |       57.5000 |\n    +----------+---------------------+-------------+---------------+\n    ```", "```\nmysql> `SELECT * FROM artist INNER JOIN painting ON a_id = a_id;`\nERROR 1052 (23000): Column 'a_id' in on clause is ambiguous\n```", "```\nmysql> `SELECT name, title, state FROM artist INNER JOIN painting`\n    -> `ON artist.a_id = painting.a_id`\n    -> `ORDER BY name;`\n+----------+-------------------+-------+\n| name     | title             | state |\n+----------+-------------------+-------+\n| Da Vinci | The Last Supper   | IN    |\n| Da Vinci | Mona Lisa         | MI    |\n| Renoir   | Les Deux Soeurs   | NE    |\n| Van Gogh | Starry Night      | KY    |\n| Van Gogh | The Potato Eaters | KY    |\n+----------+-------------------+-------+\n```", "```\nSELECT artist.name, painting.title, states.name, painting.price\nFROM artist INNER JOIN painting INNER JOIN states\nON artist.a_id = painting.a_id AND painting.state = states.abbrev;\n\nSELECT a.name, p.title, s.name, p.price\nFROM artist AS a INNER JOIN painting AS p INNER JOIN states AS s\nON a.a_id = p.a_id AND p.state = s.abbrev;\n```", "```\nmysql> `SELECT * FROM artist ORDER BY a_id;`\n+------+----------+\n| a_id | name     |\n+------+----------+\n|    1 | Da Vinci |\n|    2 | Monet    |\n|    3 | Van Gogh |\n|    4 | Renoir   |\n+------+----------+\nmysql> `SELECT * FROM painting ORDER BY a_id, p_id;`\n+------+------+-------------------+-------+-------+\n| a_id | p_id | title             | state | price |\n+------+------+-------------------+-------+-------+\n|    1 |    1 | The Last Supper   | IN    |    34 |\n|    1 |    2 | Mona Lisa         | MI    |    87 |\n|    3 |    3 | Starry Night      | KY    |    48 |\n|    3 |    4 | The Potato Eaters | KY    |    67 |\n|    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n+------+------+-------------------+-------+-------+\n```", "```\nmysql> `SELECT * FROM artist INNER JOIN painting`\n    -> `ON artist.a_id <> painting.a_id`\n    -> `ORDER BY artist.a_id;`\n+------+----------+------+------+-------------------+-------+-------+\n| a_id | name     | a_id | p_id | title             | state | price |\n+------+----------+------+------+-------------------+-------+-------+\n|    1 | Da Vinci |    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n|    1 | Da Vinci |    3 |    4 | The Potato Eaters | KY    |    67 |\n|    1 | Da Vinci |    3 |    3 | Starry Night      | KY    |    48 |\n|    2 | Monet    |    1 |    1 | The Last Supper   | IN    |    34 |\n|    2 | Monet    |    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n|    2 | Monet    |    3 |    4 | The Potato Eaters | KY    |    67 |\n|    2 | Monet    |    3 |    3 | Starry Night      | KY    |    48 |\n|    2 | Monet    |    1 |    2 | Mona Lisa         | MI    |    87 |\n|    3 | Van Gogh |    1 |    2 | Mona Lisa         | MI    |    87 |\n|    3 | Van Gogh |    1 |    1 | The Last Supper   | IN    |    34 |\n|    3 | Van Gogh |    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n|    4 | Renoir   |    3 |    3 | Starry Night      | KY    |    48 |\n|    4 | Renoir   |    1 |    2 | Mona Lisa         | MI    |    87 |\n|    4 | Renoir   |    1 |    1 | The Last Supper   | IN    |    34 |\n|    4 | Renoir   |    3 |    4 | The Potato Eaters | KY    |    67 |\n+------+----------+------+------+-------------------+-------+-------+\n```", "```\nmysql> `SELECT * FROM artist INNER JOIN painting`\n    -> `ON artist.a_id = painting.a_id`\n    -> `ORDER BY artist.a_id;`\n+------+----------+------+------+-------------------+-------+-------+\n| a_id | name     | a_id | p_id | title             | state | price |\n+------+----------+------+------+-------------------+-------+-------+\n|    1 | Da Vinci |    1 |    1 | The Last Supper   | IN    |    34 |\n|    1 | Da Vinci |    1 |    2 | Mona Lisa         | MI    |    87 |\n|    3 | Van Gogh |    3 |    3 | Starry Night      | KY    |    48 |\n|    3 | Van Gogh |    3 |    4 | The Potato Eaters | KY    |    67 |\n|    4 | Renoir   |    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n+------+----------+------+------+-------------------+-------+-------+\n```", "```\nmysql> `SELECT * FROM artist LEFT JOIN painting`\n    -> `ON artist.a_id = painting.a_id`\n    -> `ORDER BY artist.a_id;`\n+------+----------+------+------+-------------------+-------+-------+\n| a_id | name     | a_id | p_id | title             | state | price |\n+------+----------+------+------+-------------------+-------+-------+\n|    1 | Da Vinci |    1 |    1 | The Last Supper   | IN    |    34 |\n|    1 | Da Vinci |    1 |    2 | Mona Lisa         | MI    |    87 |\n|    2 | Monet    | NULL | NULL | NULL              | NULL  |  NULL |\n|    3 | Van Gogh |    3 |    3 | Starry Night      | KY    |    48 |\n|    3 | Van Gogh |    3 |    4 | The Potato Eaters | KY    |    67 |\n|    4 | Renoir   |    4 |    5 | Les Deux Soeurs   | NE    |    64 |\n+------+----------+------+------+-------------------+-------+-------+\n```", "```\nmysql> `SELECT * FROM artist LEFT JOIN painting`\n    -> `ON artist.a_id = painting.a_id`\n    -> `WHERE painting.a_id IS NULL;`\n+------+-------+------+------+-------+-------+-------+\n| a_id | name  | a_id | p_id | title | state | price |\n+------+-------+------+------+-------+-------+-------+\n|    2 | Monet | NULL | NULL | NULL  | NULL  |  NULL |\n+------+-------+------+------+-------+-------+-------+\n```", "```\nmysql> `SELECT artist.* FROM artist LEFT JOIN painting`\n    -> `ON artist.a_id = painting.a_id`\n    -> `WHERE painting.a_id IS NULL;`\n+------+-------+\n| a_id | name  |\n+------+-------+\n|    2 | Monet |\n+------+-------+\n```", "```\nmysql> `SELECT artist.name,`\n    -> `IF(COUNT(painting.a_id)>0,'yes','no') AS 'in collection?'`\n    -> `FROM artist LEFT JOIN painting ON artist.a_id = painting.a_id`\n    -> `GROUP BY artist.name;`\n+----------+----------------+\n| name     | in collection? |\n+----------+----------------+\n| Da Vinci | yes            |\n| Monet    | no             |\n| Renoir   | yes            |\n| Van Gogh | yes            |\n+----------+----------------+\n```", "```\nmysql> `SELECT * FROM artist`\n    -> `WHERE a_id NOT IN (SELECT a_id FROM painting);`\n+------+-------+\n| a_id | name  |\n+------+-------+\n|    2 | Monet |\n+------+-------+\n```", "```\nmysql> `SELECT * FROM sales_region ORDER BY region_id;`\n+-----------+------------------------+\n| region_id | name                   |\n+-----------+------------------------+\n|         1 | London, United Kingdom |\n|         2 | Madrid, Spain          |\n|         3 | Berlin, Germany        |\n|         4 | Athens, Greece         |\n+-----------+------------------------+\n```", "```\nmysql> `SELECT region_id, year, quarter, volume`\n    -> `FROM sales_volume ORDER BY region_id, year, quarter;`\n+-----------+------+---------+--------+\n| region_id | year | quarter | volume |\n+-----------+------+---------+--------+\n|         1 | 2014 |       1 | 100400 |\n|         1 | 2014 |       2 | 120000 |\n|         3 | 2014 |       1 | 280000 |\n|         3 | 2014 |       2 | 250000 |\n|         5 | 2014 |       1 |  18000 |\n|         5 | 2014 |       2 |  32000 |\n+-----------+------+---------+--------+\n```", "```\nmysql> `SELECT sales_region.region_id AS 'unmatched region row IDs'`\n    -> `FROM sales_region LEFT JOIN sales_volume`\n    ->   `ON sales_region.region_id = sales_volume.region_id`\n    -> `WHERE sales_volume.region_id IS NULL;`\n+--------------------------+\n| unmatched region row IDs |\n+--------------------------+\n|                        2 |\n|                        4 |\n+--------------------------+\n```", "```\nmysql> `SELECT sales_volume.region_id AS 'unmatched volume row IDs'`\n    -> `FROM sales_volume LEFT JOIN sales_region`\n    ->   `ON sales_volume.region_id = sales_region.region_id`\n    -> `WHERE sales_region.region_id IS NULL;`\n+--------------------------+\n| unmatched volume row IDs |\n+--------------------------+\n|                        5 |\n|                        5 |\n+--------------------------+\n```", "```\nmysql> `SELECT DISTINCT sales_volume.region_id AS 'unmatched volume row IDs'`\n    -> `FROM sales_volume LEFT JOIN sales_region`\n    ->   `ON sales_volume.region_id = sales_region.region_id`\n    -> `WHERE sales_region.region_id IS NULL`\n+--------------------------+\n| unmatched volume row IDs |\n+--------------------------+\n|                        5 |\n+--------------------------+\n```", "```\nmysql> `SELECT region_id AS 'unmatched region row IDs'`\n    -> `FROM sales_region`\n    -> `WHERE region_id NOT IN (SELECT region_id FROM sales_volume);`\n+--------------------------+\n| unmatched region row IDs |\n+--------------------------+\n|                        2 |\n|                        4 |\n+--------------------------+\nmysql> `SELECT region_id AS 'unmatched volume row IDs'`\n    -> `FROM sales_volume`\n    -> `WHERE region_id NOT IN (SELECT region_id FROM sales_region);`\n+--------------------------+\n| unmatched volume row IDs |\n+--------------------------+\n|                        5 |\n|                        5 |\n+--------------------------+\n```", "```\nDELETE FROM sales_region\nWHERE region_id NOT IN (SELECT region_id FROM sales_volume);\n```", "```\nDELETE FROM sales_volume\nWHERE region_id NOT IN (SELECT region_id FROM sales_region);\n```", "```\nmysql> `SELECT a_id, title FROM painting ORDER BY a_id;`\n+------+-------------------+\n| a_id | title             |\n+------+-------------------+\n|    1 | The Last Supper   |\n|    1 | Mona Lisa         |\n|    3 | Starry Night      |\n|    3 | The Potato Eaters |\n|    4 | Les Deux Soeurs   |\n+------+-------------------+\n```", "```\nmysql> `SELECT title`\n    -> `FROM painting INNER JOIN painting`\n    -> `ON a_id = a_id`\n    -> `WHERE title = 'The Potato Eaters';`\nERROR 1066 (42000): Not unique table/alias: 'painting'\n```", "```\nmysql> `SELECT p2.title`\n    -> `FROM painting AS p1 INNER JOIN painting AS p2`\n    -> `ON p1.a_id = p2.a_id`\n    -> `WHERE p1.title = 'The Potato Eaters';`\n+-------------------+\n| title             |\n+-------------------+\n| Starry Night      |\n| The Potato Eaters |\n+-------------------+\n```", "```\nmysql> `SELECT p2.title`\n    -> `FROM painting AS p1 INNER JOIN painting AS p2`\n    -> `ON p1.a_id = p2.a_id`\n    -> `WHERE p1.title = 'The Potato Eaters' AND p2.title <> p1.title`\n+--------------+\n| title        |\n+--------------+\n| Starry Night |\n+--------------+\n```", "```\nmysql> `SELECT s2.name, s2.statehood`\n    -> `FROM states AS s1 INNER JOIN states AS s2`\n    -> `ON YEAR(s1.statehood) = YEAR(s2.statehood) AND s1.name <> s2.name`\n    -> `WHERE s1.name = 'New York'`\n    -> `ORDER BY s2.name;`\n+----------------+------------+\n| name           | statehood  |\n+----------------+------------+\n| Connecticut    | 1788-01-09 |\n| Georgia        | 1788-01-02 |\n| Maryland       | 1788-04-28 |\n| Massachusetts  | 1788-02-06 |\n| New Hampshire  | 1788-06-21 |\n| South Carolina | 1788-05-23 |\n| Virginia       | 1788-06-25 |\n+----------------+------------+\n```", "```\nmysql> `SELECT YEAR(s1.statehood) AS year,`\n    -> `s1.name AS name1, s1.statehood AS statehood1,`\n    -> `s2.name AS name2, s2.statehood AS statehood2`\n    -> `FROM states AS s1 INNER JOIN states AS s2`\n    -> `ON YEAR(s1.statehood) = YEAR(s2.statehood) AND s1.name <> s2.name`\n    -> `ORDER BY year, name1, name2;`\n+------+----------------+------------+----------------+------------+\n| year | name1          | statehood1 | name2          | statehood2 |\n+------+----------------+------------+----------------+------------+\n| 1787 | Delaware       | 1787-12-07 | New Jersey     | 1787-12-18 |\n| 1787 | Delaware       | 1787-12-07 | Pennsylvania   | 1787-12-12 |\n| 1787 | New Jersey     | 1787-12-18 | Delaware       | 1787-12-07 |\n| 1787 | New Jersey     | 1787-12-18 | Pennsylvania   | 1787-12-12 |\n| 1787 | Pennsylvania   | 1787-12-12 | Delaware       | 1787-12-07 |\n| 1787 | Pennsylvania   | 1787-12-12 | New Jersey     | 1787-12-18 |\n…\n| 1912 | Arizona        | 1912-02-14 | New Mexico     | 1912-01-06 |\n| 1912 | New Mexico     | 1912-01-06 | Arizona        | 1912-02-14 |\n| 1959 | Alaska         | 1959-01-03 | Hawaii         | 1959-08-21 |\n| 1959 | Hawaii         | 1959-08-21 | Alaska         | 1959-01-03 |\n+------+----------------+------------+----------------+------------+\n```", "```\nON YEAR(s1.statehood) = YEAR(s2.statehood) AND s1.name <> s2.name\n```", "```\nON YEAR(s1.statehood) = YEAR(s2.statehood) AND s1.name < s2.name\n```", "```\nmysql> `SELECT YEAR(s1.statehood) AS year,`\n    -> `s1.name AS name1, s1.statehood AS statehood1,`\n    -> `s2.name AS name2, s2.statehood AS statehood2`\n    -> `FROM states AS s1 INNER JOIN states AS s2`\n    -> `ON YEAR(s1.statehood) = YEAR(s2.statehood) AND s1.name < s2.name`\n    -> `ORDER BY year, name1, name2;`\n+------+----------------+------------+----------------+------------+\n| year | name1          | statehood1 | name2          | statehood2 |\n+------+----------------+------------+----------------+------------+\n| 1787 | Delaware       | 1787-12-07 | New Jersey     | 1787-12-18 |\n| 1787 | Delaware       | 1787-12-07 | Pennsylvania   | 1787-12-12 |\n| 1787 | New Jersey     | 1787-12-18 | Pennsylvania   | 1787-12-12 |\n…\n| 1912 | Arizona        | 1912-02-14 | New Mexico     | 1912-01-06 |\n| 1959 | Alaska         | 1959-01-03 | Hawaii         | 1959-08-21 |\n+------+----------------+------------+----------------+------------+\n```", "```\nmysql> `SELECT s1.name, s1.statehood`\n    -> `FROM states AS s1 LEFT JOIN states AS s2`\n    -> `ON YEAR(s1.statehood) = YEAR(s2.statehood) AND s1.name <> s2.name`\n    -> `WHERE s2.name IS NULL`\n    -> `ORDER BY s1.name;`\n+----------------+------------+\n| name           | statehood  |\n+----------------+------------+\n| Alabama        | 1819-12-14 |\n| Arkansas       | 1836-06-15 |\n| California     | 1850-09-09 |\n| Colorado       | 1876-08-01 |\n| Illinois       | 1818-12-03 |\n| Indiana        | 1816-12-11 |\n| Iowa           | 1846-12-28 |\n| Kansas         | 1861-01-29 |\n| Kentucky       | 1792-06-01 |\n…\n| Tennessee      | 1796-06-01 |\n| Utah           | 1896-01-04 |\n| Vermont        | 1791-03-04 |\n| West Virginia  | 1863-06-20 |\n| Wisconsin      | 1848-05-29 |\n+----------------+------------+\n```", "```\nmysql> `SELECT artist.name, painting.title`\n    -> `FROM artist INNER JOIN painting ON artist.a_id = painting.a_id`\n    -> `ORDER BY name, title;`\n+----------+-------------------+\n| name     | title             |\n+----------+-------------------+\n| Da Vinci | Mona Lisa         |\n| Da Vinci | The Last Supper   |\n| Renoir   | Les Deux Soeurs   |\n| Van Gogh | Starry Night      |\n| Van Gogh | The Potato Eaters |\n+----------+-------------------+\n```", "```\nmysql> `SELECT artist.name, painting.title`\n    -> `FROM artist LEFT JOIN painting ON artist.a_id = painting.a_id`\n    -> `ORDER BY name, title;`\n+----------+-------------------+\n| name     | title             |\n+----------+-------------------+\n| Da Vinci | Mona Lisa         |\n| Da Vinci | The Last Supper   |\n| Monet    | NULL              |\n| Renoir   | Les Deux Soeurs   |\n| Van Gogh | Starry Night      |\n| Van Gogh | The Potato Eaters |\n+----------+-------------------+\n```", "```\nmysql> `SELECT artist.name, COUNT(painting.a_id) AS paintings`\n    -> `FROM artist INNER JOIN painting ON artist.a_id = painting.a_id`\n    -> `GROUP BY artist.name;`\n+----------+-----------+\n| name     | paintings |\n+----------+-----------+\n| Da Vinci |         2 |\n| Renoir   |         1 |\n| Van Gogh |         2 |\n+----------+-----------+\n```", "```\nmysql> `SELECT artist.name, COUNT(painting.a_id) AS paintings`\n    -> `FROM artist LEFT JOIN painting ON artist.a_id = painting.a_id`\n    -> `GROUP BY artist.name;`\n+----------+-----------+\n| name     | paintings |\n+----------+-----------+\n| Da Vinci |         2 |\n| Monet    |         0 |\n| Renoir   |         1 |\n| Van Gogh |         2 |\n+----------+-----------+\n```", "```\nmysql> `SELECT artist.name, COUNT(*) AS paintings`\n    -> `FROM artist LEFT JOIN painting ON artist.a_id = painting.a_id`\n    -> `GROUP BY artist.name;`\n```", "```\n+----------+-----------+\n| name     | paintings |\n+----------+-----------+\n| Da Vinci |         2 |\n| Monet    |         1 |\n| Renoir   |         1 |\n| Van Gogh |         2 |\n+----------+-----------+\n```", "```\nmysql> `SELECT artist.name,`\n    -> `COUNT(painting.a_id) AS 'number of paintings',`\n    -> `SUM(painting.price) AS 'total price',`\n    -> `AVG(painting.price) AS 'average price'`\n    -> `FROM artist LEFT JOIN painting ON artist.a_id = painting.a_id`\n    -> `GROUP BY artist.name;`\n+----------+---------------------+-------------+---------------+\n| name     | number of paintings | total price | average price |\n+----------+---------------------+-------------+---------------+\n| Da Vinci |                   2 |         121 |       60.5000 |\n| Monet    |                   0 |        NULL |          NULL |\n| Renoir   |                   1 |          64 |       64.0000 |\n| Van Gogh |                   2 |         115 |       57.5000 |\n+----------+---------------------+-------------+---------------+\n```", "```\nmysql> `SELECT * FROM movies_actors ORDER BY year, movie, actor;`\n+------+----------------------------+---------------+\n| year | movie                      | actor         |\n+------+----------------------------+---------------+\n| 1997 | The Fifth Element          | Bruce Willis  |\n| 1997 | The Fifth Element          | Gary Oldman   |\n| 1997 | The Fifth Element          | Ian Holm      |\n| 1999 | The Phantom Menace         | Ewan McGregor |\n| 1999 | The Phantom Menace         | Liam Neeson   |\n| 2001 | The Fellowship of the Ring | Elijah Wood   |\n| 2001 | The Fellowship of the Ring | Ian Holm      |\n| 2001 | The Fellowship of the Ring | Ian McKellen  |\n| 2001 | The Fellowship of the Ring | Orlando Bloom |\n| 2005 | Kingdom of Heaven          | Liam Neeson   |\n| 2005 | Kingdom of Heaven          | Orlando Bloom |\n| 2010 | Red                        | Bruce Willis  |\n| 2010 | Red                        | Helen Mirren  |\n| 2011 | Unknown                    | Diane Kruger  |\n| 2011 | Unknown                    | Liam Neeson   |\n+------+----------------------------+---------------+\n```", "```\nmysql> `SELECT * FROM movies ORDER BY id;`\n+----+------+----------------------------+\n| id | year | movie                      |\n+----+------+----------------------------+\n|  1 | 1997 | The Fifth Element          |\n|  2 | 1999 | The Phantom Menace         |\n|  3 | 2001 | The Fellowship of the Ring |\n|  4 | 2005 | Kingdom of Heaven          |\n|  5 | 2010 | Red                        |\n|  6 | 2011 | Unknown                    |\n+----+------+----------------------------+\nmysql> `SELECT * FROM actors ORDER BY id;`\n+----+---------------+\n| id | actor         |\n+----+---------------+\n|  1 | Bruce Willis  |\n|  2 | Diane Kruger  |\n|  3 | Elijah Wood   |\n|  4 | Ewan McGregor |\n|  5 | Gary Oldman   |\n|  6 | Helen Mirren  |\n|  7 | Ian Holm      |\n|  8 | Ian McKellen  |\n|  9 | Liam Neeson   |\n| 10 | Orlando Bloom |\n+----+---------------+\n```", "```\nmysql> `SELECT * FROM movies_actors_link ORDER BY movie_id, actor_id;`\n+----------+----------+\n| movie_id | actor_id |\n+----------+----------+\n|        1 |        1 |\n|        1 |        5 |\n|        1 |        7 |\n|        2 |        4 |\n|        2 |        9 |\n|        3 |        3 |\n|        3 |        7 |\n|        3 |        8 |\n|        3 |       10 |\n|        4 |        9 |\n|        4 |       10 |\n|        5 |        1 |\n|        5 |        6 |\n|        6 |        2 |\n|        6 |        9 |\n+----------+----------+\n```", "```\n    mysql> `SELECT m.year, m.movie, a.actor`\n        -> `FROM movies AS m INNER JOIN movies_actors_link AS l`\n        -> `INNER JOIN actors AS a`\n        -> `ON m.id = l.movie_id AND a.id = l.actor_id`\n        -> `ORDER BY m.year, m.movie, a.actor;`\n    +------+----------------------------+---------------+\n    | year | movie                      | actor         |\n    +------+----------------------------+---------------+\n    | 1997 | The Fifth Element          | Bruce Willis  |\n    | 1997 | The Fifth Element          | Gary Oldman   |\n    | 1997 | The Fifth Element          | Ian Holm      |\n    | 1999 | The Phantom Menace         | Ewan McGregor |\n    | 1999 | The Phantom Menace         | Liam Neeson   |\n    | 2001 | The Fellowship of the Ring | Elijah Wood   |\n    | 2001 | The Fellowship of the Ring | Ian Holm      |\n    | 2001 | The Fellowship of the Ring | Ian McKellen  |\n    | 2001 | The Fellowship of the Ring | Orlando Bloom |\n    | 2005 | Kingdom of Heaven          | Liam Neeson   |\n    | 2005 | Kingdom of Heaven          | Orlando Bloom |\n    | 2010 | Red                        | Bruce Willis  |\n    | 2010 | Red                        | Helen Mirren  |\n    | 2011 | Unknown                    | Diane Kruger  |\n    | 2011 | Unknown                    | Liam Neeson   |\n    +------+----------------------------+---------------+\n    ```", "```\n    mysql> `SELECT a.actor`\n        -> `FROM movies AS m INNER JOIN movies_actors_link AS l`\n        -> `INNER JOIN actors AS a`\n        -> `ON m.id = l.movie_id AND a.id = l.actor_id`\n        -> `WHERE m.movie = 'The Fellowship of the Ring'`\n        -> `ORDER BY a.actor;`\n    +---------------+\n    | actor         |\n    +---------------+\n    | Elijah Wood   |\n    | Ian Holm      |\n    | Ian McKellen  |\n    | Orlando Bloom |\n    +---------------+\n    ```", "```\n    mysql> `SELECT m.year, m.movie`\n        -> `FROM movies AS m INNER JOIN movies_actors_link AS l`\n        -> `INNER JOIN actors AS a`\n        -> `ON m.id = l.movie_id AND a.id = l.actor_id` \n        -> `WHERE a.actor = 'Liam Neeson'`\n        -> `ORDER BY m.year, m.movie;`\n    +------+--------------------+\n    | year | movie              |\n    +------+--------------------+\n    | 1999 | The Phantom Menace |\n    | 2005 | Kingdom of Heaven  |\n    | 2011 | Unknown            |\n    +------+--------------------+\n    ```", "```\nmysql> `SET @max_price = (SELECT MAX(price) FROM painting);`\nmysql> `SELECT artist.name, painting.title, painting.price`\n    -> `FROM artist INNER JOIN painting`\n    -> `ON painting.a_id = artist.a_id`\n    -> `WHERE painting.price = @max_price;`\n+----------+-----------+-------+\n| name     | title     | price |\n+----------+-----------+-------+\n| Da Vinci | Mona Lisa |    87 |\n+----------+-----------+-------+\n```", "```\nCREATE TABLE tmp SELECT MAX(price) AS max_price FROM painting;\nSELECT artist.name, painting.title, painting.price\nFROM artist INNER JOIN painting INNER JOIN tmp\nON painting.a_id = artist.a_id\nAND painting.price = tmp.max_price;\n```", "```\nmysql> `CREATE TABLE tmp`\n    -> `SELECT a_id, MAX(price) AS max_price FROM painting GROUP BY a_id;`\nmysql> `SELECT artist.name, painting.title, painting.price`\n    -> `FROM artist INNER JOIN painting INNER JOIN tmp`\n    -> `ON painting.a_id = artist.a_id`\n    -> `AND painting.a_id = tmp.a_id`\n    -> `AND painting.price = tmp.max_price;`\n+----------+-------------------+-------+\n| name     | title             | price |\n+----------+-------------------+-------+\n| Da Vinci | Mona Lisa         |    87 |\n| Van Gogh | The Potato Eaters |    67 |\n| Renoir   | Les Deux Soeurs   |    64 |\n+----------+-------------------+-------+\n```", "```\nWITH tmp AS (SELECT a_id, MAX(price) AS max_price FROM painting GROUP BY a_id) \nSELECT artist.name, painting.title, painting.price \nFROM artist INNER JOIN painting INNER JOIN tmp \nON painting.a_id = artist.a_id AND \npainting.a_id = tmp.a_id AND painting.price = tmp.max_price;\n```", "```\nSELECT artist.name, painting.title, painting.price\nFROM artist INNER JOIN painting INNER JOIN\n(SELECT a_id, MAX(price) AS max_price FROM painting GROUP BY a_id) AS tmp\nON painting.a_id = artist.a_id\nAND painting.a_id = tmp.a_id\nAND painting.price = tmp.max_price;\n```", "```\nmysql> `SELECT p1.a_id, p1.title, p1.price`\n    -> `FROM painting AS p1 LEFT JOIN painting AS p2`\n    -> `ON p1.a_id = p2.a_id AND p1.price < p2.price`\n    -> `WHERE p2.a_id IS NULL;`\n+------+-------------------+-------+\n| a_id | title             | price |\n+------+-------------------+-------+\n|    1 | Mona Lisa         |    87 |\n|    3 | The Potato Eaters |    67 |\n|    4 | Les Deux Soeurs   |    64 |\n+------+-------------------+-------+\n```", "```\nmysql> `SELECT artist.name, p1.title, p1.price`\n    -> `FROM painting AS p1 LEFT JOIN painting AS p2`\n    -> `ON p1.a_id = p2.a_id AND p1.price < p2.price`\n    -> `INNER JOIN artist ON p1.a_id = artist.a_id`\n    -> `WHERE p2.a_id IS NULL;`\n+----------+-------------------+-------+\n| name     | title             | price |\n+----------+-------------------+-------+\n| Da Vinci | Mona Lisa         |    87 |\n| Van Gogh | The Potato Eaters |    67 |\n| Renoir   | Les Deux Soeurs   |    64 |\n+----------+-------------------+-------+\n```", "```\nmysql> `SELECT * FROM driver_log ORDER BY rec_id;`\n+--------+-------+------------+-------+\n| rec_id | name  | trav_date  | miles |\n+--------+-------+------------+-------+\n|      1 | Ben   | 2014-07-30 |   152 |\n|      2 | Suzi  | 2014-07-29 |   391 |\n|      3 | Henry | 2014-07-29 |   300 |\n|      4 | Henry | 2014-07-27 |    96 |\n|      5 | Ben   | 2014-07-29 |   131 |\n|      6 | Henry | 2014-07-26 |   115 |\n|      7 | Suzi  | 2014-08-02 |   502 |\n|      8 | Henry | 2014-08-01 |   197 |\n|      9 | Ben   | 2014-08-02 |    79 |\n|     10 | Henry | 2014-07-30 |   203 |\n+--------+-------+------------+-------+\n```", "```\nmysql> `SELECT trav_date, COUNT(trav_date) AS drivers`\n    -> `FROM driver_log GROUP BY trav_date ORDER BY trav_date;`\n+------------+---------+\n| trav_date  | drivers |\n+------------+---------+\n| 2014-07-26 |       1 |\n| 2014-07-27 |       1 |\n| 2014-07-29 |       3 |\n| 2014-07-30 |       2 |\n| 2014-08-01 |       1 |\n| 2014-08-02 |       2 |\n+------------+---------+\n```", "```\nmysql> `CREATE TABLE dates (d DATE);`\nmysql> `INSERT INTO dates (d)`\n    -> `VALUES('2014-07-26'),('2014-07-27'),('2014-07-28'),`\n    -> `('2014-07-29'),('2014-07-30'),('2014-07-31'),`\n    -> `('2014-08-01'),('2014-08-02');`\n```", "```\nmysql> `SELECT dates.d, COUNT(driver_log.trav_date) AS drivers`\n    -> `FROM dates LEFT JOIN driver_log ON dates.d = driver_log.trav_date`\n    -> `GROUP BY d ORDER BY d;`\n+------------+---------+\n| d          | drivers |\n+------------+---------+\n| 2014-07-26 |       1 |\n| 2014-07-27 |       1 |\n| 2014-07-28 |       0 |\n| 2014-07-29 |       3 |\n| 2014-07-30 |       2 |\n| 2014-07-31 |       0 |\n| 2014-08-01 |       1 |\n| 2014-08-02 |       2 |\n+------------+---------+\n```", "```\nmysql> `SELECT dates.d`\n    -> `FROM dates LEFT JOIN driver_log ON dates.d = driver_log.trav_date`\n    -> `WHERE driver_log.trav_date IS NULL;`\n+------------+\n| d          |\n+------------+\n| 2014-07-28 |\n| 2014-07-31 |\n+------------+\n```", "```\nWITH RECURSIVE dates (d)  AS (\n  SELECT '2014-07-26'\n  UNION ALL\n  SELECT d + INTERVAL 1 day\n  FROM dates\n  WHERE d < '2014-08-02') \nSELECT dates.d, COUNT(driver_log.trav_date) AS drivers\nFROM dates LEFT JOIN driver_log ON dates.d = driver_log.trav_date\nGROUP BY d ORDER BY d;\n```", "```\nCREATE PROCEDURE make_date_list(db_name TEXT, tbl_name TEXT, col_name TEXT,\n                                min_date DATE, max_date DATE)\nBEGIN\n  DECLARE i, days INT;\n  SET i = 0, days = DATEDIFF(max_date,min_date)+1;\n\n  # Make identifiers safe for insertion into SQL statements. Use db_name\n  # and tbl_name to create qualified table name.\n  SET tbl_name = CONCAT(quote_identifier(db_name),'.',\n                        quote_identifier(tbl_name));\n  SET col_name = quote_identifier(col_name);\n  CALL exec_stmt(CONCAT('DROP TABLE IF EXISTS ',tbl_name));\n  CALL exec_stmt(CONCAT('CREATE TABLE ',tbl_name,'(',\n                        col_name,' DATE NOT NULL, PRIMARY KEY(',\n                        col_name,'))'));\n  WHILE i < days DO\n    CALL exec_stmt(CONCAT('INSERT INTO ',tbl_name,'(',col_name,') VALUES(',\n                          QUOTE(min_date),' + INTERVAL ',i,' DAY)'));\n    SET i = i + 1;\n  END WHILE;\nEND;\n```", "```\nCALL make_date_list('cookbook', 'dates', 'd', '2014-07-26', '2014-08-02');\n```", "```\nmysql> `SELECT * FROM driver_log ORDER BY rec_id;`\n+--------+-------+------------+-------+\n| rec_id | name  | trav_date  | miles |\n+--------+-------+------------+-------+\n|      1 | Ben   | 2014-07-30 |   152 |\n|      2 | Suzi  | 2014-07-29 |   391 |\n|      3 | Henry | 2014-07-29 |   300 |\n|      4 | Henry | 2014-07-27 |    96 |\n|      5 | Ben   | 2014-07-29 |   131 |\n|      6 | Henry | 2014-07-26 |   115 |\n|      7 | Suzi  | 2014-08-02 |   502 |\n|      8 | Henry | 2014-08-01 |   197 |\n|      9 | Ben   | 2014-08-02 |    79 |\n|     10 | Henry | 2014-07-30 |   203 |\n+--------+-------+------------+-------+\n```", "```\nmysql> `CREATE TABLE tmp`\n    -> `SELECT name, SUM(miles) AS driver_miles FROM driver_log GROUP BY name;`\n```", "```\nmysql> `SELECT * FROM tmp ORDER BY driver_miles DESC;`\n+-------+--------------+\n| name  | driver_miles |\n+-------+--------------+\n| Henry |          911 |\n| Suzi  |          893 |\n| Ben   |          362 |\n+-------+--------------+\n```", "```\nmysql> `SELECT tmp.driver_miles, driver_log.*`\n    -> `FROM driver_log INNER JOIN tmp ON driver_log.name = tmp.name`\n    -> `ORDER BY tmp.driver_miles DESC, driver_log.trav_date;`\n+--------------+--------+-------+------------+-------+\n| driver_miles | rec_id | name  | trav_date  | miles |\n+--------------+--------+-------+------------+-------+\n|          911 |      6 | Henry | 2014-07-26 |   115 |\n|          911 |      4 | Henry | 2014-07-27 |    96 |\n|          911 |      3 | Henry | 2014-07-29 |   300 |\n|          911 |     10 | Henry | 2014-07-30 |   203 |\n|          911 |      8 | Henry | 2014-08-01 |   197 |\n|          893 |      2 | Suzi  | 2014-07-29 |   391 |\n|          893 |      7 | Suzi  | 2014-08-02 |   502 |\n|          362 |      5 | Ben   | 2014-07-29 |   131 |\n|          362 |      1 | Ben   | 2014-07-30 |   152 |\n|          362 |      9 | Ben   | 2014-08-02 |    79 |\n+--------------+--------+-------+------------+-------+\n```", "```\nWITH tmp AS\n(SELECT name, SUM(miles) AS driver_miles FROM driver_log GROUP BY name)\nSELECT tmp.driver_miles, driver_log.*\nFROM driver_log INNER JOIN tmp ON driver_log.name = tmp.name\nORDER BY tmp.driver_miles DESC, driver_log.trav_date;\n```", "```\nSELECT tmp.driver_miles, driver_log.*\nFROM driver_log INNER JOIN\n(SELECT name, SUM(miles) AS driver_miles\nFROM driver_log GROUP BY name) AS tmp\nON driver_log.name = tmp.name\nORDER BY tmp.driver_miles DESC, driver_log.trav_date;\n```", "```\n    SELECT * FROM city WHERE capital=largest;\n    ```", "```\n    SELECT * FROM states ORDER BY pop DESC LIMIT 10;\n    ```", "```\nmysql> `CREATE` `TEMPORARY` `TABLE` `large_capitals`\n    -> `SELECT` `*` `FROM` `city` `WHERE` `capital``=``largest``;`\nQuery OK, 17 rows affected (0,00 sec)\nRecords: 17  Duplicates: 0  Warnings: 0\n\nmysql> `CREATE` `TEMPORARY` `TABLE` `top10states`\n    -> `SELECT` `*` `FROM` `states` `ORDER` `BY` `pop` `DESC` `LIMIT` `10``;`\nQuery OK, 10 rows affected (0,00 sec)\nRecords: 10  Duplicates: 0  Warnings: 0\n\nmysql> `SELECT` `state``,` `capital``,` `pop` `FROM`\n    -> `large_capitals` `JOIN` `top10states`\n    -> `ON``(``large_capitals``.``state` `=` `top10states``.``name``)``;`\n+---------+----------+----------+ | state   | capital  | pop      |\n+---------+----------+----------+ | Georgia | Atlanta  | 10799566 |\n| Ohio    | Columbus | 11780017 |\n+---------+----------+----------+ 2 rows in set (0,00 sec)\n```", "```\nmysql> `SELECT` `state``,` `capital``,` `pop` `FROM` ![1](Images/1.png)\n    -> `(``SELECT` `*` `FROM` `city` `WHERE` `capital``=``largest``)` `AS` `large_capitals``,` ![2](Images/2.png)\n    -> `(``SELECT` `*` `FROM` `states` `ORDER` `BY` `pop` `DESC` `LIMIT` `10``)` `AS` `top10states` ![3](Images/3.png)\n    -> `WHERE` `large_capitals``.``state` `=` `top10states``.``name``;` ![4](Images/4.png)\n+---------+----------+----------+ | state   | capital  | pop      |\n+---------+----------+----------+ | Georgia | Atlanta  | 10799566 |\n| Ohio    | Columbus | 11780017 |\n+---------+----------+----------+ 2 rows in set (0,00 sec)\n```", "```\nmysql> `WITH`\n    -> `large_capitals` `AS` `(``SELECT` `*` `FROM` `city` `WHERE` `capital``=``largest``)``,`\n    -> `top10states` `AS` `(``SELECT` `*` `FROM` `states` `ORDER` `BY` `pop` `DESC` `LIMIT` `10``)`\n    -> `SELECT` `state``,` `capital``,` `pop` \n    -> `FROM` `large_capitals` `JOIN` `top10states`\n    -> `ON` `(``large_capitals``.``state` `=` `top10states``.``name``)``;`\n+---------+----------+----------+ | state   | capital  | pop      |\n+---------+----------+----------+ | Georgia | Atlanta  | 10799566 |\n| Ohio    | Columbus | 11780017 |\n+---------+----------+----------+ 2 rows in set (0,00 sec)\n```", "```\nmysql> `SELECT artist.name, painting.title, states.name, painting.price`\n    -> `FROM artist INNER JOIN painting INNER JOIN states`\n    -> `ON artist.a_id = painting.a_id AND painting.state = states.abbrev;`\n+----------+-------------------+----------+-------+\n| name     | title             | name     | price |\n+----------+-------------------+----------+-------+\n| Da Vinci | The Last Supper   | Indiana  |    34 |\n| Da Vinci | Mona Lisa         | Michigan |    87 |\n| Van Gogh | Starry Night      | Kentucky |    48 |\n| Van Gogh | The Potato Eaters | Kentucky |    67 |\n| Renoir   | Les Deux Soeurs   | Nebraska |    64 |\n+----------+-------------------+----------+-------+\n```", "```\nwhile (my $ref = $sth->fetchrow_hashref ())\n{\n  *`... process row hash here ...`*\n}\n```", "```\nSELECT artist.name AS painter, painting.title,\n  states.name AS state, painting.price\nFROM artist INNER JOIN painting INNER JOIN states\nON artist.a_id = painting.a_id AND painting.state = states.abbrev;\n```", "```\nwhile (my @val = $sth->fetchrow_array ())\n{\n  print \"painter: $val[0], title: $val[1], \"\n        . \"state: $val[2], price: $val[3]\\n\";\n}\n```"]