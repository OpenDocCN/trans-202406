<html><head></head><body><section data-pdf-bookmark="Chapter 11. Browser Tools" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch11">&#13;
<h1><span class="label">Chapter 11. </span>Browser Tools</h1>&#13;
&#13;
&#13;
<p><a data-primary="browser" data-type="indexterm" id="ix_browser_ch11"/>As a web developer, the browser is the window through which the world accesses your creations. It also provides helpful tooling for developing and testing your sites. It is a worthwhile investment to learn how to use your browser’s development tools so that you may better and more easily debug your code. In this chapter we’ll cover several useful features for debugging, profiling, and analyzing JavaScript.</p>&#13;
&#13;
<p><a data-primary="DevTools (Chrome Developer Tools)" data-type="indexterm" id="ix_dev_tools_ch11"/>For simplicity, all of the examples in this book will make use of Google Chrome’s Developer Tools (DevTools). At the time of writing, <a href="https://oreil.ly/QFZD9">Chrome’s usage makes up over 65%</a> of the global browser share. <a data-primary="Firefox Developer Edition" data-type="indexterm" id="idm45475150605720"/>Most other browsers offer similar functionality. Mozilla’s <a href="https://oreil.ly/lJSel">Firefox Developer Edition</a> is an excellent alternative with useful developer features.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Debugging JavaScript" data-type="sect1"><div class="sect1" id="debugging_javascript_in_console">&#13;
<h1>Debugging JavaScript</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475150602680">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="debugging" data-type="indexterm" id="ix_debug_tool"/><a data-primary="browser" data-secondary="debugging JavaScript" data-type="indexterm" id="ix_browser_debug"/><a data-primary="errors (Error object)" data-secondary="debugging" data-type="indexterm" id="ix_error_debug"/>You need to know the value of a variable at a specific point in your JavaScript code’s execution.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475150597544">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="breakpoint, setting" data-type="indexterm" id="ix_breakpoint_set"/>Use a breakpoint to inspect code values and types. When setting a breakpoint, the browser’s debugger will stop at the point of the breakpoint’s code execution and display each of the current values in scope. It is then possible to step through the code or allow the JavaScript to finish executing. <a data-type="xref" href="#breakpoint_fig">Figure 11-1</a> shows a screenshot of code paused on a breakpoint.</p>&#13;
&#13;
<figure class="no-frame"><div class="figure" id="breakpoint_fig">&#13;
<img alt="A screenshot of the Chrome debugger with a breakpoint set" src="assets/jsc3_1101.png"/>&#13;
<h6><span class="label">Figure 11-1. </span>A screenshot of the Chrome debugger with a breakpoint set</h6>&#13;
</div></figure>&#13;
&#13;
<p>To set a breakpoint on a specific line of JavaScript code in Chrome’s Developer Tools:</p>&#13;
<ol>&#13;
<li>&#13;
<p>Open Chrome’s Developer Tools using Command-Option-C (Macintosh) or Control+Shift+C (Windows or Linux).</p>&#13;
</li>&#13;
<li>&#13;
<p>Click the DevTools  <strong>Sources</strong> tab.</p>&#13;
</li>&#13;
<li>&#13;
<p>Select the JavaScript file from the file list.</p>&#13;
</li>&#13;
<li>&#13;
<p>Click the line number where you would like to set the breakpoint.</p>&#13;
</li>&#13;
<li>&#13;
<p>Execute the code by either interacting with the page or refreshing the browser window.</p>&#13;
</li>&#13;
&#13;
</ol>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475150585384">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>It is common practice to use <code>console.log</code> statements to identify values at specific points in code, but breakpoints offer more information and greater flexibility. As you become familiar with debugging in this manner, you’ll be able to more easily troubleshoot your browser-based JavaScript code.</p>&#13;
&#13;
<p><a data-primary="debugger statement" data-type="indexterm" id="idm45475150582904"/>In addition to setting breakpoints in the browser’s user interface, it is also possible to set them with code by adding a <code>debugger</code> statement. Doing so will pause code execution at the point of the <code>debugger</code> statement.</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">normalize</code><code class="p">(</code><code class="nx">string</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">normalized</code> <code class="o">=</code> <code class="nx">string</code><code class="p">.</code><code class="nx">replace</code><code class="p">(</code><code class="sr">/[^\w]/g</code><code class="p">,</code> <code class="s2">""</code><code class="p">).</code><code class="nx">toLowerCase</code><code class="p">();</code>&#13;
  <code class="kr">debugger</code><code class="p">;</code>&#13;
  <code class="k">return</code> <code class="nx">normalized</code><code class="p">;</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>Once the breakpoint has been reached, you are given several options as to how the JavaScript should be executed:</p>&#13;
<dl>&#13;
<dt>Resume script execution</dt>&#13;
<dd>&#13;
<p>Continue executing the code in full.</p>&#13;
</dd>&#13;
<dt>Step over</dt>&#13;
<dd>&#13;
<p>Execute a function without “stepping into it” to debug.</p>&#13;
</dd>&#13;
<dt>Step into</dt>&#13;
<dd>&#13;
<p>Step into a function to debug it further.</p>&#13;
</dd>&#13;
<dt>Step out of</dt>&#13;
<dd>&#13;
<p>Execute the rest of the current function’s code.</p>&#13;
</dd>&#13;
<dt>Step</dt>&#13;
<dd>&#13;
<p>Step to the next line of code.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>These line-based breakpoints are only one type of breakpoint that can be set. In addition, it is possible to set breakpoints based on DOM changes, conditional values, event listeners, exceptions, and fetch/XHR requests. The use of breakpoints provides greater control over the JavaScript debugging experience.<a data-primary="" data-startref="ix_error_debug" data-type="indexterm" id="idm45475150553720"/><a data-primary="" data-startref="ix_debug_tool" data-type="indexterm" id="idm45475150552856"/><a data-primary="" data-startref="ix_browser_debug" data-type="indexterm" id="idm45475150551912"/><a data-primary="" data-startref="ix_breakpoint_set" data-type="indexterm" id="idm45475150550968"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Analyzing Runtime Performance" data-type="sect1"><div class="sect1" id="analyzing_performance_in_console">&#13;
<h1>Analyzing Runtime Performance</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475150548504">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Performance analysis" data-type="indexterm" id="ix_perf_analysis"/><a data-primary="runtime performance analysis" data-type="indexterm" id="ix_runtime_perf_analysis"/><a data-primary="browser" data-secondary="runtime performance analysis" data-type="indexterm" id="ix_runtime_perf"/>The execution of your JavaScript code seems slow or buggy, but you are unsure of the source of the problem.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475150543656">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the browser developer tool’s Performance analysis to look for bottlenecks and CPU-intensive tasks in your code (<a data-type="xref" href="#jscb_1202">Figure 11-2</a>).</p>&#13;
&#13;
<p>To analyze JavaScript code performance in Chrome’s Developer Tools:</p>&#13;
<ol>&#13;
<li>&#13;
<p>Open Chrome’s Developer Tools using Command-Option-C (Macintosh) or Control+Shift+C (Windows or Linux).</p>&#13;
</li>&#13;
<li>&#13;
<p>Click the DevTools  <strong>Performance</strong> tab.</p>&#13;
</li>&#13;
<li>&#13;
<p>Either click the <strong>Record</strong> button to interact with the page, or click the <strong>Reload</strong> button to see the performance metrics related to a new page load.</p>&#13;
</li>&#13;
&#13;
</ol>&#13;
&#13;
<p>Once Chrome completes the profile of the page,  you will be presented with information that allows you to review potential performance bottlenecks.</p>&#13;
&#13;
<figure class="no-frame"><div class="figure" id="jscb_1202">&#13;
<img alt="A screenshot of the Chrome Performance tab" src="assets/jsc3_1102.png"/>&#13;
<h6><span class="label">Figure 11-2. </span>Chrome’s Performance tab</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475150500472">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The Chrome Performance tooling breaks down the  browser’s rendering process for a page and presents it using a visual timeline, screenshots, and a summary chart (see <a data-type="xref" href="#jscb_1203">Figure 11-3</a>). Using this information allows you to look for places where performance is negatively affected.</p>&#13;
&#13;
<p>As a developer, you may have a high-end machine and a fast internet connection.  One of the most useful features of browser performance tools is the ability to simulate a throttled CPU or internet connection. Doing so may allow you to spot performance issues that users will encounter, but may not be apparent to you.</p>&#13;
&#13;
<figure class="no-frame"><div class="figure" id="jscb_1203">&#13;
<img alt="A screenshot of the developer tools with throttled CPU and network connections enabled" src="assets/jsc3_1103.png"/>&#13;
<h6><span class="label">Figure 11-3. </span>The Chrome Developer Performance tools allow you to throttle CPU and network connections</h6>&#13;
</div></figure>&#13;
&#13;
<p>Reviewing performance data is an important step in ensuring a positive user experience. Good site performance has been shown to improve user retention rates and sales conversions. In <a data-type="xref" href="#lighthouse">“Using Lighthouse to Measure  Best Practices”</a>, we’ll cover how to further review potential performance issues.<a data-primary="" data-startref="ix_runtime_perf" data-type="indexterm" id="idm45475150493416"/><a data-primary="" data-startref="ix_runtime_perf_analysis" data-type="indexterm" id="idm45475150492472"/><a data-primary="" data-startref="ix_perf_analysis" data-type="indexterm" id="idm45475150491512"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Identifying Unused JavaScript" data-type="sect1"><div class="sect1" id="idm45475150490440">&#13;
<h1>Identifying Unused JavaScript</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475150489528">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="browser" data-secondary="identifying unused JavaScript" data-type="indexterm" id="ix_browser_unused_script"/>Your application’s performance is impacted by large JavaScript files.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475150486632">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the Chrome Developer Tool’s Coverage feature to identify unused JavaScript (<a data-type="xref" href="#jscb_1204">Figure 11-4</a>).</p>&#13;
&#13;
<figure class="no-frame"><div class="figure" id="jscb_1204">&#13;
<img alt="A screenshot of the results of Chrome's coverage tool" src="assets/jsc3_1104.png"/>&#13;
<h6><span class="label">Figure 11-4. </span>Chrome’s Coverage tool</h6>&#13;
</div></figure>&#13;
&#13;
<p>To view unused JavaScript, access the Coverage tab:</p>&#13;
<ol>&#13;
<li>&#13;
<p>Open Chrome’s Developer Tools using Command-Option-C (Macintosh) or Control+Shift+C (Windows or Linux).</p>&#13;
</li>&#13;
<li>&#13;
<p>Open the Command Menu using Command-Shift-P (Macintosh) or Control+Shift+P (Windows or Linux) and type <strong><code>coverage</code></strong>.</p>&#13;
</li>&#13;
<li>&#13;
<p>Select <strong>Show Coverage</strong> and press Enter.</p>&#13;
</li>&#13;
<li>&#13;
<p>Either click the <strong>Record</strong> button to interact with the page, or click the <strong>Reload</strong> button to record the coverage results related to a new page load.</p>&#13;
</li>&#13;
<li>&#13;
<p>Click <strong>Stop Instrumenting Coverage And Show Results</strong> when you want to stop recording the results.</p>&#13;
</li>&#13;
&#13;
</ol>&#13;
&#13;
<p class="pagebreak-before less_space">The results will display a report with the following information:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>File URL</p>&#13;
</li>&#13;
<li>&#13;
<p>File type</p>&#13;
</li>&#13;
<li>&#13;
<p>Total bytes</p>&#13;
</li>&#13;
<li>&#13;
<p>Unused bytes</p>&#13;
</li>&#13;
<li>&#13;
<p>Usage visualization</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>You can then use this information to aid in refactoring code to reduce the total amount of unused bytes on a page.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475150467336">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Viewing code usage is helpful for getting a sense of the percentage of unused JavaScript you are serving your users. The task of reducing this unused code is then often left to manual refactoring. However, a JavaScript bundling tool, such as Webpack, can also be used to split code into multiple bundles and perform “tree shaking” to automatically eliminate dead code. These methods are covered in <a data-type="xref" href="ch16.html#mobile-web">“JavaScript and the Mobile Web”</a>.<a data-primary="" data-startref="ix_browser_unused_script" data-type="indexterm" id="idm45475150464760"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using Lighthouse to Measure  Best Practices" data-type="sect1"><div class="sect1" id="lighthouse">&#13;
<h1>Using Lighthouse to Measure  Best Practices</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="idm45475150461912">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Lighthouse" data-type="indexterm" id="ix_lighthouse1"/><a data-primary="browser" data-secondary="Lighthouse for measuring best practices" data-type="indexterm" id="ix_browser_lighthouse"/>You want to measure your web application’s adherence to best practices.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="idm45475150458168">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use Google’s Lighthouse tool, which is built into the Chrome Developer Tools (<a data-type="xref" href="#jscb_1206">Figure 11-5</a>).</p>&#13;
<ol>&#13;
<li>&#13;
<p>Open Chrome’s Developer Tools using Command-Option-C (Macintosh) or Control+Shift+C (Windows or Linux).</p>&#13;
</li>&#13;
<li>&#13;
<p>Click the DevTools <strong>Lighthouse</strong> tab.</p>&#13;
</li>&#13;
<li>&#13;
<p>Select the categories you would like to profile and the device type (mobile or desktop).</p>&#13;
</li>&#13;
<li>&#13;
<p>Click <strong>Generate Report</strong>.</p>&#13;
</li>&#13;
&#13;
</ol>&#13;
&#13;
<p>Lighthouse will then create a report, with a score for each category and specific recommendations for improvement.</p>&#13;
&#13;
<figure class="no-frame"><div class="figure" id="jscb_1206">&#13;
<img alt="Google Lighthouse screenshot" src="assets/jsc3_1105.png"/>&#13;
<h6><span class="label">Figure 11-5. </span>The results of a Google Lighthouse report within Chrome’s Developer Tools</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="idm45475150447784">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Lighthouse is an open source tool, created by Google, to measure the performance and best practices of a website. The tool is built into Chrome’s Developer Tools, but it can also be run as a standalone browser extension, a Node module, or from the command line. The Lighthouse report can be generated in a desktop or mobile view, allowing you to quickly get a sense of mobile performance. Lighthouse generates reports and recommendations for each of the following areas:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Performance</p>&#13;
</li>&#13;
<li>&#13;
<p>Progressive Web Application</p>&#13;
</li>&#13;
<li>&#13;
<p>Best Practices</p>&#13;
</li>&#13;
<li>&#13;
<p>Accessibility</p>&#13;
</li>&#13;
<li>&#13;
<p>SEO</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p class="pagebreak-before less_space">The report output provides actionable feedback with specific problems, and links to documentation and recommended improvements. In <a data-type="xref" href="#jscb_1207">Figure 11-6</a>, you can see performance recommendations for a profiled website, including removing unused JavaScript and reducing the impact of third-party code.  Expanding each of these diagnostics will provide additional details and file specifics.</p>&#13;
&#13;
<figure class="no-frame"><div class="figure" id="jscb_1207">&#13;
<img alt="A screenshot of Lighthouse performance recommendations" src="assets/jsc3_1106.png"/>&#13;
<h6><span class="label">Figure 11-6. </span>Lighthouse performance recommendations</h6>&#13;
</div></figure>&#13;
&#13;
<p>Google’s Lighthouse is a useful tool for gauging the overall health and performance of the websites and applications that you develop. <a data-primary="" data-startref="ix_browser_ch11" data-type="indexterm" id="idm45475150436024"/>Accessing Lighthouse through the browser Developer Tools provides a quick and efficient way to profile a site during development. <a data-primary="" data-startref="ix_browser_lighthouse" data-type="indexterm" id="idm45475150434776"/><a data-primary="" data-startref="ix_lighthouse1" data-type="indexterm" id="idm45475150433832"/><a data-primary="" data-startref="ix_dev_tools_ch11" data-type="indexterm" id="idm45475150432888"/>In addition to the developer tools user interface, the <a href="https://github.com/GoogleChrome/lighthouse">open source</a> command-line tooling and Node module make it possible to build Lighthouse reports into continuous integration and delivery pipelines.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
</div></section></body></html>