<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 4. Constraint Layouts: Draw Up a Blueprint"><div class="chapter" id="constraint_layoutscolon_draw_up_a_bluepr">
<h1><span class="label">Chapter 4. </span>Constraint Layouts: <em>Draw Up a Blueprint</em></h1>
<figure class="informal"><div class="figure">
<img src="Images/f0121-01.png" alt="image" width="600" height="599"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="Android Jetpack" data-secondary="constraint layout" data-see="constraint layout" id="idm46053742101600"/><a data-type="indexterm" data-primary="blueprint tool" data-see="constraint layout" id="idm46053742100384"/><a data-type="indexterm" data-primary="constraint layout" id="idm46053742099408"/><a data-type="indexterm" data-primary="layouts" data-secondary="constraint" data-see="constraint layout" id="idm46053742098640"/><a data-type="indexterm" data-primary="views" data-secondary="constraint layout" data-see="constraint layout" id="idm46053742097264"/><strong>You don’t build a house without a blueprint.</strong></p>
<p>And some layouts use <strong>blueprints</strong> to make sure they <strong>look exactly the way you want</strong>. In this chapter, we’ll introduce you to Android’s <strong>constraint layout</strong>: a <strong>flexible way of designing more complex UIs</strong>. You’ll discover how <strong>constraints</strong> and <strong>bias</strong> let you position and size your views, <strong>irrespective of screen size and orientation</strong>. You’ll find out how to keep views in their place with <strong>guidelines</strong> and <strong>barriers.</strong> Finally, you’ll learn how to pack or spread views with <strong>chains</strong> and <strong>flows</strong>. Let’s get designing…</p>
<section data-type="sect1" data-pdf-bookmark="Nested layouts revisited"><div class="sect1" id="nested_layouts_revisited">
<h1>Nested layouts revisited</h1>
<p><a data-type="indexterm" data-primary="layouts" data-secondary="nested" id="idm46053742088448"/><a data-type="indexterm" data-primary="nested layouts" id="idm46053742086976"/>In the previous chapter, you learned that you can nest layouts to build more complex screens. The following code, for example, uses nested linear layouts to display a text view and edit text in a horizontal row, with an edit text below them:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0122-01.png" alt="image" width="600" height="535"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Nesting layouts comes at a price"><div class="sect1" id="nesting_layouts_comes_at_a_price">
<h1>Nesting layouts comes at a price</h1>
<p><a data-type="indexterm" data-primary="views" data-secondary="hierarchy of views" id="idm46053742081792"/>The down side to nested layouts is that building complex layouts in this way can be inefficient, make your code harder to read and maintain, and can also slow down your app.</p>
<p>When Android displays a layout on the device screen, it first checks the structure of the layout file, and uses this to build a hierarchy of views. For the nested layout shown on the previous page, for example, it builds a hierarchy of views that contains two linear layouts, two edit texts, and a text view:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0123-01.png" alt="image" width="600" height="233"/>
<h6/>
</div></figure>
<p>Android uses the view hierarchy to help it figure out where each view should be placed on the device screen. Each view needs to be measured, laid out, and drawn on the screen, and Android needs to make sure each view has enough space for its contents, and that any weights are taken into account.</p>
<p>If the layout contains nested layouts, the view hierarchy is more complex, and Android may need to make multiple passes in order to figure out how views need to be arranged. If the layouts are deeply nested, this can lead to bottlenecks in your code, and can leave you with a mass of code that’s difficult to read and maintain.</p>
<p>If you have a more complex UI like this, an alternative to using nested layouts is to use a <strong>constraint layout</strong>.</p>
<blockquote>
<p><strong>Each view in the layout needs to be initialized, measured, laid out, and drawn. In deeply nested layouts, this can slow down your app.</strong></p>
</blockquote>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Introducing the constraint layout"><div class="sect1" id="introducing_the_constraint_layout">
<h1>Introducing the constraint layout</h1>
<p><a data-type="indexterm" data-primary="design editor" data-secondary="constraint layout" id="idm46053742071872"/>A constraint layout is more complex than a linear or frame layout, but it’s way more flexible. It’s also much more efficient for complex UIs as it gives you a flatter view hierarchy, which means that Android has less processing to do at runtime.</p>
<section data-type="sect2" data-pdf-bookmark="You design constraint layouts VISUALLY"><div class="sect2" id="you_design_constraint_layouts_visually">
<h2>You design constraint layouts VISUALLY</h2>
<p>Another advantage of using constraint layouts is that they’re specifically designed to work with Android Studio’s design editor. Unlike linear and frame layouts where you usually hack directly in XML, you build constraint layouts <em>visually</em>. You drag and drop views into the design editor’s blueprint, and give it instructions for how each view should be displayed:</p>
<blockquote>
<p><strong>Use a constraint layout to build flexible UIs without nesting layouts.</strong></p>
</blockquote>
<figure class="informal"><div class="figure">
<img src="Images/f0124-01.png" alt="image" width="600" height="631"/>
<h6/>
</div></figure>
<p>Unlike linear and frame layouts, constraint layouts are part of a suite of libraries known as <strong>Android Jetpack</strong>. You may have already heard something about Jetpack, but what is it?</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Constraint layouts are part of Android Jetpack"><div class="sect1" id="constraint_layouts_are_part_of_android_j">
<h1>Constraint layouts are part of <u>Android Jetpack</u></h1>
<p><a data-type="indexterm" data-primary="Android Jetpack" id="idm46053742066080"/><a data-type="indexterm" data-primary="AppCompatActivity class" data-secondary="Jetpack" id="idm46053742061328"/><a data-type="indexterm" data-primary="constraint layout" data-secondary="Jetpack" id="idm46053742060224"/><a data-type="indexterm" data-primary="Jetpack" data-see="Android Jetpack" id="idm46053742059120"/>Android Jetpack is a collection of libraries that help you follow best practice, reduce boilerplate code, and make your coding life easier. It includes constraint layouts, navigation, the Room persistence library (which helps you build databases) and lots, lots more.</p>
<p>Here are some of our favorite Jetpack components; you’ll find out how to use them in later chapters:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0125-01.png" alt="image" width="600" height="339"/>
<h6/>
</div></figure>
<p>Another great thing about Jetpack is that it lets you write code that works consistently across new and old versions of Android. This is great news for your users, as it means that you can include exciting new Android features that will work on older devices.</p>
<p>An example of this is <code>AppCompatActivity</code>, which you’ve already been using to write activity code. We didn’t mention it earlier, but <code>AppCompatActivity</code> is part of Android Jetpack. It adds new features to activities across new and old versions of Android without you having to worry about backward compatibility.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Yes! You’ve already been using part of Android Jetpack without knowing it. You’ll learn more about using Jetpack through the rest of this book.</span></p>
</div>
<p>In this chapter, you’re going to learn how to use constraint layouts. Let’s run through what we’re going to do.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Here’s what we’re going to do"><div class="sect1" id="hereapostrophes_what_weapostroph-id00039">
<h1>Here’s what we’re going to do</h1>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="single and multiple views" id="idm46053742056912"/>We’re going to break learning about constraint layouts into two main parts:</p>
<ol>
<li><p><strong>How to position and size a single view.</strong></p>
<p>You’ll learn how to use constraints and bias to control how and where a single view is shown in its layout.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0126-01.png" alt="image" width="600" height="127"/>
<h6/>
</div></figure></li>
<li><p><strong>How to position and size multiple views.</strong></p>
<p>You’ll then apply your knowledge to multiple views, and learn more advanced techniques using guidelines, barriers, chains, and flows.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0126-02.png" alt="image" width="600" height="195"/>
<h6/>
</div></figure></li>
</ol>
<section data-type="sect2" data-pdf-bookmark="Create a new project"><div class="sect2" id="create_a_new_project-id00040">
<h2>Create a new project</h2>
<p>We’re going to use a new project for the app we’re going to build, so create one now using the same steps you used in the previous chapters. Choose the Empty Activity option, enter a name of “My Constraint Layout” and a package name of “com.hfad.myconstraintlayout”, and accept the default save location. Make sure the language is set to Kotlin and the minimum SDK is API 21 so it will run on most Android devices.</p>
<p>Now that we’ve created the project, let’s make sure that it has been set up to use constraint layouts.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Use Gradle to include Jetpack libraries"><div class="sect1" id="use_gradle_to_include_jetpack_libraries">
<h1>Use Gradle to include Jetpack libraries</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0127-01.png" alt="image" width="270" height="58"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="Android Studio" data-secondary="adding Google repository reference" id="idm46053742034544"/><a data-type="indexterm" data-primary="build.gradle file" id="idm46053742033296"/><a data-type="indexterm" data-primary="constraint layout" data-secondary="Gradle" id="idm46053742032464"/><a data-type="indexterm" data-primary="Google repository, adding reference to" id="idm46053742030832"/><a data-type="indexterm" data-primary="Gradle build system" id="idm46053742030032"/><a data-type="indexterm" data-primary="projects" data-secondary="adding Google repository reference" id="idm46053742029200"/>To make sure that all the Jetpack libraries—including constraint layouts — work across all versions of Android, they’re not included in the main Android SDK. Instead, you have to add any libraries you need using <strong>Gradle</strong>. This is a build tool that’s used to compile code, configure apps, and fetch any extra libraries that your project requires.</p>
<p>Every time you create a new project, Android Studio creates two Gradle files named <strong><em>build.gradle</em></strong>.</p>
<p>The first version of <em>build.gradle</em> lives in the <em>project</em> folder, and specifies the basic settings of your app, such as what version of the Gradle plug-in to use.</p>
<p>The second version of <em>build.gradle</em> lives in the project’s <em>app</em> folder. It’s where the majority of the app’s properties are set, such as the API level.</p>
<blockquote>
<p><strong>Behind the scenes, every Android Studio project uses Gradle as its build tool.</strong></p>
</blockquote>
<section data-type="sect2" data-pdf-bookmark="The project build.gradle needs a Google repository line"><div class="sect2" id="the_project_builddotgradle_needs_a_googl">
<h2>The <u>project</u> build.gradle needs a Google repository line</h2>
<p>Every project needs to know where to find any extra Jetpack libraries it needs, and this is done by adding a reference to the Google repository in the <strong>project</strong>’s <em>build.gradle</em> file. Android Studio usually does this for you, but you can make sure it’s there by opening the file <em>MyConstraintLayout/build.gradle</em>, and looking for the following line (in bold) in the <code>repositories</code> section under <code>allprojects</code>:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0127-02.png" alt="image" width="600" height="136"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="The app build.gradle includes the constraint layout’s library"><div class="sect2" id="the_app_builddotgradle_includes_the_cons">
<h2>The <u>app</u> build.gradle includes the constraint layout’s library</h2>
<p>To use constraint layouts, a reference to its library needs to be included in the <strong>app</strong>’s <em>build.gradle</em> file. Android Studio should have already added this for you, but you can double-check by opening the file <em>MyConstraintLayout/app/build.gradle</em>, and looking for the following line (in bold) in the <code>dependencies</code> section:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0127-04.png" alt="image" width="600" height="166"/>
<h6/>
</div></figure>
<p>If the file doesn’t include this line, add it now, and click on the Sync Now option that appears in the code editor. This syncs any changes you’ve made with the rest of your project, and adds the library.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Let’s add a constraint layout to activity_main.xml"><div class="sect1" id="letapostrophes_add_a_constraint_layout_t">
<h1>Let’s add a constraint layout to activity_main.xml</h1>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="adding to layout file" id="idm46053742006624"/>Now that your project is all set up to use constraint layouts, let’s start using one.</p>
<p>You add a constraint layout to a layout file using an <code><strong>&lt;androidx.constraintlayout.widget.ConstraintLayout&gt;</strong></code> element. We’re going to use one in the layout file <em>activity_main.xml</em>, so open this file in the <em>app/src/main/res/layout</em> folder, and make sure its code looks like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0128-01.png" alt="image" width="600" height="236"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Show the layout in the blueprint"><div class="sect2" id="show_the_layout_in_the_blueprint">
<h2>Show the layout in the blueprint</h2>
<p>We’re going to add views to the layout using the design editor’s blueprint. Switch to the design editor by clicking on the Design option, click on the Select Design Surface button in the editor’s toolbar, and select the Blueprint option. This shows you a blueprint of the layout like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0128-02.png" alt="image" width="391" height="141"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0128-03.png" alt="image" width="542" height="412"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Add a button to the blueprint"><div class="sect1" id="add_a_button_to_the_blueprint">
<h1>Add a button to the blueprint</h1>
<p><a data-type="indexterm" data-primary="Button view" data-secondary="adding to constraint layout" id="idm46053741993920"/><a data-type="indexterm" data-primary="constraint layout" data-secondary="adding button" id="idm46053741992448"/>We’re going to add a button to the layout. To do this, go to the design editor’s palette, find the Button component (it’s usually in the Common section), and drag it to the blueprint. You can place the button anywhere in the blueprint, just so long as it appears in its main area like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0129-02.png" alt="image" width="600" height="579"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Position views using constraints"><div class="sect1" id="position_views_using_constraints">
<h1>Position views using constraints</h1>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="positioning views" id="idm46053741987792"/><a data-type="indexterm" data-primary="horizontal constraints" id="idm46053741986400"/>With a constraint layout, you don’t specify where views should be positioned by dropping them on the blueprint in a particular place. Instead, you specify placement by defining <strong>constraints</strong>. A <strong>constraint</strong> is a connection or attachment that tells the layout where the view should be positioned. You can use a constraint to attach a view to the start edge of the layout, for example, or underneath another view.</p>
<section data-type="sect2" data-pdf-bookmark="We’ll add a horizontal constraint to the button"><div class="sect2" id="weapostrophell_add_a_horizontal_constrai">
<h2>We’ll add a horizontal constraint to the button</h2>
<p>To see how this works, let’s add a constraint to attach the button to the left edge of the layout.</p>
<p>First, make sure the button’s selected by clicking it. When you select a view, a bounding box is drawn around it, and handles are added to its corners and sides. The handles in the corners let you resize the view, and the handles on the sides let you add constraints:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0130-02.png" alt="image" width="600" height="143"/>
<h6/>
</div></figure>
<p>To add a constraint, you click on one of the view’s constraint handles and drag it to whatever you want to attach it to. In this case, we’re going to attach the left edge of the button to the left edge of the layout, so click on the left constraint handle and drag it to the left edge of the blueprint:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0130-03.png" alt="image" width="600" height="123"/>
<h6/>
</div></figure>
<p>This adds the constraint, and pulls the button over to the left:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0130-04.png" alt="image" width="591" height="152"/>
<h6/>
</div></figure>
<p>That’s how you add a horizontal constraint. Let’s see what happens when you add a vertical one.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Add a vertical constraint too"><div class="sect1" id="add_a_vertical_constraint_too">
<h1>Add a vertical constraint too</h1>
<p><a data-type="indexterm" data-primary="vertical constraints" id="idm46053741979056"/>We’ll use a vertical constraint to attach the button to the top of the layout. To do this, click on the button’s top constraint handle, and drag it to the top of the blueprint. This adds the vertical constraint, which pulls the button up.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0131-02.png" alt="image" width="600" height="181"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise">
<h5><span class="inlineimage"><img src="Images/exercise.png" alt="Images" width="125" height="79"/></span> Exercise</h5>
<p>You’ve seen what happens when you add constraints to the button’s left and top edges. What do you think happens when you add opposing constraints to the button’s right and bottom edges as well? Try doing this now, and draw your answers below.</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise_solution">
<h5><span class="inlineimage"><img src="Images/exercise.png" alt="Images" width="125" height="79"/></span> Exercise Solution</h5>
<p>You’ve seen what happens when you add constraints to the button’s left and top edges. What do you think happens when you add opposing constraints to the button’s right and bottom edges as well? Try doing this now, and draw your answers below.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0132-01.png" alt="image" width="600" height="368"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0132-02.png" alt="image" width="600" height="375"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Use opposing constraints to center views"><div class="sect1" id="use_opposing_constraints_to_center_views">
<h1>Use opposing constraints to center views</h1>
<p><a data-type="indexterm" data-primary="centering views, constraint layout" id="idm46053741955920"/>As you’ve learned, you can use constraints to attach a view to the edge of the blueprint. Each constraint works like a spring that pulls the view to the blueprint’s edge.</p>
<p>If you want to position views in the center of the blueprint, you can do so by adding constraints to opposite sides of the view. To center a button horizontally, for example, you add one constraint that pulls the view to the left, and another that pulls it to the right like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0133-02.png" alt="image" width="600" height="117"/>
<h6/>
</div></figure>
<p>The two constraints pull the button in opposite directions, which centers it horizontally like so:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0133-03.png" alt="image" width="600" height="117"/>
<h6/>
</div></figure>
<p>You can also center a view vertically by adding constraints to its top and bottom edges. And if you wanted to center it horizontally and vertically, you’d add constraints to all four edges like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0133-04.png" alt="image" width="600" height="270"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="You can delete constraints you no longer need"><div class="sect1" id="you_can_delete_constraints_you_no_longer">
<h1>You can delete constraints you no longer need</h1>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="deleting constraints" id="idm46053741945408"/>You can remove any constraints you no longer need by selecting them in the blueprint, and deleting them. If you have a button that’s centered in the middle of the blueprint, for example, you delete the constraint that’s attached to its bottom edge:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0134-02.png" alt="image" width="491" height="582"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="watch_itexclamation_mark">
<h5><span class="inlineimage"><img src="Images/watch.png" alt="Images" width="89" height="84"/></span> Watch it!</h5>
<p><strong>Make sure each view has <em>at least</em> one vertical and horizontal constraint.</strong></p>
<p>If the view has no vertical constraints, it will be displayed at the top of the layout when you run the app. If the view has no horizontal ones, it will be displayed next to its start edge.</p>
</div></aside>
<p>Deleting this constraint means that the button is no longer being pulled toward the bottom of the blueprint. The top constraint pulls the button to the top so that it’s only centered horizontally, and not vertically:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0134-03.png" alt="image" width="600" height="258"/>
<h6/>
</div></figure>
<p>Another way of removing constraints you no longer need is to use the constraint widget tool. Let’s see how this works.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Remove constraints with the constraint widget"><div class="sect1" id="remove_constraints_with_the_constraint_w">
<h1>Remove constraints with the constraint widget</h1>
<p><a data-type="indexterm" data-primary="constraint widget tool" id="idm46053741932736"/><a data-type="indexterm" data-primary="margins, view" id="idm46053741931648"/>The constraint widget is displayed in the Attributes panel at the side of the design editor. It appears when you select a view, and displays a diagram featuring the view’s constraints, and the size of any margins.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">You’ll find out more about the Attributes panel a few pages ahead.</span></p>
</div>
<p>To delete a constraint in the constraint widget, select the view in the blueprint you want to remove the constraint from, then click on the constraint’s handle in the constraint widget. The constraint is removed, and the view is repositioned in the blueprint.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0135-03.png" alt="image" width="600" height="181"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="You can use it to add margins too"><div class="sect2" id="you_can_use_it_to_add_margins_too">
<h2>You can use it to add margins too</h2>
<p>You may have noticed that each of the constraints in the constraint widget has a number next to it. This is used to set the margin size for that edge of the view so that there’s space between the view and the layout’s edge. To change the size of a view’s left and top margins to 24dp, for example, you’d update their values in the diagram to 24:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0135-04.png" alt="image" width="500" height="231"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0135-05.png" alt="image" width="328" height="258"/>
<h6/>
</div></figure>
<p>You can set a default size for any new margins using the Default Margins button in the design editor’s toolbar. Setting this to 24dp, for example, means that any new constraints that get added will automatically include a margin of 24dp.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0135-06.png" alt="image" width="490" height="146"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Changes to the blueprint appear in the XML"><div class="sect1" id="changes_to_the_blueprint_appear_in_the_x">
<h1>Changes to the blueprint appear in the XML</h1>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="code for" id="idm46053741915680"/>When you add views to a blueprint, and specify constraints and margins, they get added to the layout’s underlying XML. To see this, switch to the layout’s code view. Your code should look something like this (but don’t worry if it’s slightly different):</p>
<figure class="informal"><div class="figure">
<img src="Images/f0136-02.png" alt="image" width="600" height="296"/>
<h6/>
</div></figure>
<p>As you can see, the XML now includes a button. Does its code look familiar to you? If so, nice catch—it includes attributes that you learned about in <a data-type="xref" href="ch03.xhtml#layoutscolon_being_a_layout">Chapter 3</a>.</p>
<p>The button’s width, height, and margins are specified in exactly the same way as before, and if you want to, you can change their values in the XML instead of using the design editor.</p>
<p>The only unfamiliar code is the two lines that specify the view’s constraints on its start and top edges:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0136-03.png" alt="image" width="600" height="58"/>
<h6/>
</div></figure>
<p>Similar code is generated if you add constraints to the button’s remaining edges.</p>
<p>Now that you’ve had a glimpse of what constraint layout XML looks like switch back to the design editor, and we’ll look at some more techniques you can use to position views.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Views can have bias"><div class="sect1" id="views_can_have_bias">
<h1>Views can have bias</h1>
<p><a data-type="indexterm" data-primary="bias, views with" id="idm46053741905776"/><a data-type="indexterm" data-primary="constraint layout" data-secondary="views with bias" id="idm46053741904736"/>As you learned earlier, you can add constraints to opposite sides of a view. This centers the view by default, but you can also control its position relative to each side by changing its <strong>bias</strong>. This tells Android what the proportionate length of each constraint should be on either side of the view.</p>
<p>To see this in action, let’s change the button’s horizontal bias so that it’s positioned off-center. First, make sure that the button includes constraints on its left and right sides like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0137-02.png" alt="image" width="600" height="128"/>
<h6/>
</div></figure>
<p>Then select the button so the constraint widget is displayed.</p>
<p>Underneath the widget’s diagram of the view, you should see a slider with a number in it. This is a percentage of the view’s horizontal bias.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0137-03.png" alt="image" width="600" height="251"/>
<h6/>
</div></figure>
<p>To change the bias, simply move the slider. If, say, you move the slider to the left so that the number changes to 30, it moves the button in the blueprint to the left as well:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0137-04.png" alt="image" width="600" height="121"/>
<h6/>
</div></figure>
<p>The view maintains this relative position irrespective of screen size and orientation. Let’s try this out by taking the app for a test drive.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00041">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<p>When we run the app, a button appears off-center toward the top of the screen. It maintains the same relative position when we rotate the device.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0138-02.png" alt="image" width="600" height="414"/>
<h6/>
</div></figure>
<p>You’ve now learned various techniques to control a view’s position on the screen. Next up, how to change its size.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00042">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: You said that all the Jetpack components (including constraint layouts) have separate libraries that aren’t part of the main Android release. Why is this?</strong></p>
<p><strong>A:</strong> It’s so you can use new versions and features of these components in older versions of Android.</p>
<p><strong>Q: When you added the constraint layout library to the app’s <em>build.gradle</em> file, you said that you were using a particular version. Can I use a different one?</strong></p>
<p><strong>A:</strong> All of the features and code we’ve used in this chapter work with that version of the constraints layout library. Libraries are always getting fresh updates, but bear in mind that using a different version might break some of the code.</p>
<p><strong>Q: How will I know if there’s a new version?</strong></p>
<p><strong>A:</strong> The <em>build.gradle</em> files usually spot when a new version is available, and let you know.</p>
<p><strong>Q: Is there a way of making the design editor add constraints for me automatically?</strong></p>
<p><strong>A:</strong> There’s an “Enable Autoconnection to Parent” button in the design editor toolbar, which you can use to automatically add constraints between each new view and the edge of the blueprint.</p>
<p>There’s also an Infer Constraints button, which guesses what constraints are needed based on the position of views in the layout.</p>
<p>We’ve had mixed results with these options, but feel free to try them out.</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="You can change a view’s size"><div class="sect1" id="you_can_change_a_viewapostrophes_size">
<h1>You can change a view’s size</h1>
<p><a data-type="indexterm" data-primary="layout_weight attribute, view" id="idm46053741879296"/>As you might expect, you can change a view’s size in a constraint layout by updating its <code>layout_width</code> and <code>layout_height</code> attributes. You can do this in the layout’s XML, or in the design editor’s Attributes panel.</p>
<p>The Attributes panel is displayed to the side of the blueprint. When you select a view, it shows you all the attributes that have already been declared (such as <code>layout_width</code> and <code>layout_height</code>), and lets you set ones that haven’t.</p>
<section data-type="sect2" data-pdf-bookmark="Make the view just big enough"><div class="sect2" id="make_the_view_just_big_enough">
<h2>Make the view just big enough</h2>
<p>Just like with linear and frame layouts, you make a view just large enough to display its contents by setting its <code>layout_width</code> and <code>layout_height</code> properties to <code>wrap_content</code>. If the view is a button, for example, it makes the button just large enough to hold its text:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0139-02.png" alt="image" width="600" height="133"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Match the view’s constraints"><div class="sect2" id="match_the_viewapostrophes_constraints">
<h2>Match the view’s constraints</h2>
<p>If you’ve added constraints to opposite sides of your view, you can make the view match the size of its constraints. You do this by setting its <code>layout_width</code> and/or <code>layout_height</code> to 0dp: set <code>layout_width</code> to 0dp to make the view match its horizontal constraints, and set <code>layout_height</code> to 0dp to make it match its vertical ones.</p>
<p>In the example below, we’ve set the button’s <code>layout_width</code> to 0dp so that the button matches its horizontal constraints:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0139-03.png" alt="image" width="600" height="203"/>
<h6/>
</div></figure>
<p>Now that you’ve seen how to resize a view, try experimenting with the different techniques, then have a go at the exercise on the next page.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="BE the Constraint"><div class="sect1" id="be_the_constraint">
<h1>BE the Constraint</h1>
<figure class="informal"><div class="figure">
<img src="Images/common04.png" alt="image" width="156" height="199"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="exercise" id="idm46053741857344"/><a data-type="indexterm" data-primary="exercises" data-secondary="Be the . . ." id="idm46053741856304"/><strong>Your job is to play like you’re the constraint layout and draw the constraints that are needed to produce each layout. You also need to specify the layout_width, layout_height, and bias (when needed) for each view. We’ve completed the first one for you.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0140-01.png" alt="image" width="600" height="552"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0141-01.png" alt="image" width="480" height="800"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="BE the Constraint Solution"><div class="sect1" id="be_the_constraint_solution">
<h1>BE the Constraint Solution</h1>
<figure class="informal"><div class="figure">
<img src="Images/common04.png" alt="image" width="156" height="199"/>
<h6/>
</div></figure>
<p><strong>Your job is to play like you’re the constraint layout and draw the constraints that are needed to produce each layout. You also need to specify the layout_width, layout_height, and bias (when needed) for each view. We’ve completed the first one for you.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0142-01.png" alt="image" width="600" height="505"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0143-01.png" alt="image" width="600" height="711"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Most layouts need multiple views"><div class="sect1" id="most_layouts_need_multiple_views">
<h1>Most layouts need multiple views</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0144-01.png" alt="image" width="270" height="58"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="connecting multiple views" id="idm46053741839520"/><a data-type="indexterm" data-primary="views" data-secondary="connecting multiple views" id="idm46053741838080"/>So far you’ve seen how to position and size a single view in a constraint layout. Most of the time, however, your layout will need to contain multiple views that are laid out relative to one another.</p>
<p>To see how this works, first make sure that your constraint layout includes a single button with two constraints: one that connects its top edge to the top of the blueprint, and another that connects its left edge to the blueprint’s left side. Its <code>layout_width</code> and <code>layout_height</code> properties should be set to <code>wrap_content</code>, and the margins for these edges should be set to 24dp.</p>
<p>After you’ve made these changes, the button should be positioned in the blueprint’s top-left corner like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0144-02.png" alt="image" width="600" height="136"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Add a second button to the blueprint"><div class="sect2" id="add_a_second_button_to_the_blueprint">
<h2>Add a second button to the blueprint</h2>
<p>Next, add a second button to the blueprint by dragging one from the palette, and placing it somewhere underneath the first button like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0144-03.png" alt="image" width="600" height="315"/>
<h6/>
</div></figure>
<p>The blueprint now includes two buttons. Let’s find out how to position them relative to one another.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="You can connect views to other views"><div class="sect1" id="you_can_connect_views_to_other_views">
<h1>You can connect views to other views</h1>
<p>As you already know, constraints let you attach a view to the edge of its blueprint. You can also use constraints to connect two views together, and this is used to specify how they should be displayed relative to one another.</p>
<p>To see how this works, select the second button in the blueprint, then draw a constraint that goes from the second button’s top edge to the first button’s bottom edge like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0145-02.png" alt="image" width="518" height="331"/>
<h6/>
</div></figure>
<p>When the constraint is added, it pulls the button up so that it’s connected to the first, and displayed underneath it:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0145-03.png" alt="image" width="600" height="230"/>
<h6/>
</div></figure>
<p>The constraint means that the second button will always be positioned under the first, irrespective of the first button’s position on the device screen.</p>
<p>Once you’ve positioned two views in this way, the next thing you might want to do is make sure that they’re aligned. Let’s find out how to do this.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="You can align views too"><div class="sect1" id="you_can_align_views_too">
<h1>You can align views too</h1>
<p><a data-type="indexterm" data-primary="aligning views" id="idm46053741819520"/><a data-type="indexterm" data-primary="constraint layout" data-secondary="aligning views" id="idm46053741816688"/><a data-type="indexterm" data-primary="views" data-secondary="aligning" id="idm46053741815584"/>The simplest way of aligning two views is to use the Align button in the design editor’s toolbar.</p>
<p>To see how this works, let’s left-align the two buttons in the blueprint so that their left edges line up. First, select both buttons by holding down the Shift key as you click on each one. Then click on the Align button to open up a set of alignment options like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0146-02.png" alt="image" width="600" height="363"/>
<h6/>
</div></figure>
<p>Click on the Left Edges option to left-align the two buttons. This adds a constraint to the blueprint that connects their left edges together like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0146-03.png" alt="image" width="562" height="287"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Align views using guidelines"><div class="sect1" id="align_views_using_guidelines">
<h1>Align views using guidelines</h1>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="guidelines" id="idm46053741807792"/><a data-type="indexterm" data-primary="guidelines, constraint layout" id="idm46053741806208"/>Another technique you can use to align views is a <strong>guideline</strong>. This is a fixed line you add to the blueprint that you can use to constrain views. It’s only visible in the design editor, so users don’t see it when they run the app.</p>
<p>Let’s explore how guidelines work by adding one to the blueprint. Click on the Guidelines button in the design editor’s toolbar, and choose the option to add a vertical guideline. This places a vertical guideline in the blueprint:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0147-02.png" alt="image" width="600" height="168"/>
<h6/>
</div></figure>
<p>Once the guideline has been added, you can move it elsewhere by dragging it. You can set it to be either a fixed distance from the blueprint’s edge, or a fixed percentage:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0147-03.png" alt="image" width="600" height="219"/>
<h6/>
</div></figure>
<p>You can then use constraints to attach views to the guideline like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0147-04.png" alt="image" width="600" height="157"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Guidelines have a fixed position"><div class="sect1" id="guidelines_have_a_fixed_position">
<h1>Guidelines have a fixed position</h1>
<p>Guidelines are either positioned a fixed distance from the blueprint’s edge, or a fixed percentage between the two. They stay in that position when the app runs, so they’re a useful way of aligning views.</p>
<p>In some situations, you need something that’s a little more flexible. As an example, suppose you have a layout that includes two multi-line edit texts, side by side, with a button underneath like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0148-02.png" alt="image" width="600" height="281"/>
<h6/>
</div></figure>
<p>The edit texts expand vertically as the user enters text. You want the button to move as the views change size so that it’s always positioned beneath them like so:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0148-03.png" alt="image" width="600" height="249"/>
<h6/>
</div></figure>
<p>So how can you build this sort of layout?</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Create a movable barrier"><div class="sect1" id="create_a_movable_barrier">
<h1>Create a movable barrier</h1>
<p><a data-type="indexterm" data-primary="barriers, constraint layout" id="idm46053741790528"/><a data-type="indexterm" data-primary="constraint layout" data-secondary="barriers" id="idm46053741787056"/>To create layouts like this, you can use a <strong>barrier</strong>. This is like a guideline, except that it doesn’t have a fixed position. Instead, it forms a barrier against views, and moves when they change size. This repositions any views that are constrained to the barrier.</p>
<p>In the example on the previous page, the two edit texts are placed above a horizontal barrier, and the button is constrained beneath it. As the edit texts expand, the barrier moves down and repositions the button:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0149-02.png" alt="image" width="600" height="207"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Let’s build a layout that uses a barrier"><div class="sect2" id="letapostrophes_build_a_layout_that_uses">
<h2>Let’s build a layout that uses a barrier</h2>
<p>To see how barriers work, let’s create this example.</p>
<p>First, delete any views, and make sure the blueprint includes a vertical guideline positioned at 50%. Then drag two multi-line edit texts from the palette, and position them on either side of the guideline.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">You can usually find these in the “Text” part of the palette, listed as “Multiline Text.”</span></p>
</div>
<p>Next, add vertical constraints to constrain each view to the top of the blueprint, and horizontal constraints to position each one between the blueprint’s edge and the guideline.</p>
<p>Finally, change the <code>layout_width</code> of each edit text to 0dp so that it matches its horizontal constraints, and set their <code>layout_height</code>s to “wrap_content” so that the views can expand.</p>
<p>When you’re done, the blueprint should look something like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0149-04.png" alt="image" width="600" height="180"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Add a horizontal barrier"><div class="sect1" id="add_a_horizontal_barrier">
<h1>Add a horizontal barrier</h1>
<p><a data-type="indexterm" data-primary="barrierDirection attribute" id="idm46053741777056"/><a data-type="indexterm" data-primary="horizontal barrier, constraint layout" id="idm46053741771120"/>We need to add a horizontal barrier to the blueprint. To do this, click on the Guidelines button in the design editor toolbar, and choose the option to add a horizontal barrier:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0150-02.png" alt="image" width="600" height="153"/>
<h6/>
</div></figure>
<p>This creates the horizontal barrier.</p>
<section data-type="sect2" data-pdf-bookmark="Place the barrier beneath the views"><div class="sect2" id="place_the_barrier_beneath_the_views">
<h2>Place the barrier beneath the views</h2>
<p>We want the barrier to move down as the two edit text views expand. To do this, go to the layout’s component tree panel, and drag the two edit text components onto the barrier:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0150-03.png" alt="image" width="600" height="170"/>
<h6/>
</div></figure>
<p>This doesn’t change the position of the edit text views in the blueprint: it simply tells the barrier that it needs to move with these views.</p>
<p>Next, we need to position the barrier so that it’s at the bottom of the two views. Select the barrier in the component tree, and use the Attributes panel to change its <code>barrierDirection</code> attribute to “bottom.” This positions the barrier below the two edit texts so that the blueprint looks like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0150-04.png" alt="image" width="600" height="129"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Constrain a button under the barrier"><div class="sect1" id="constrain_a_button_under_the_barrier">
<h1>Constrain a button under the barrier</h1>
<p><a data-type="indexterm" data-primary="layout_constraintTop_toBottomOf attribute" id="idm46053741758592"/>Now that the layout’s barrier is in place, let’s add the button, and constrain it to the barrier so that it moves down as the edit text views expand.</p>
<p>First drag a button from the palette to the blueprint, and place it somewhere underneath the barrier. Then center it horizontally by adding two horizontal constraints that connect the button’s sides to the edges of the blueprint like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0151-02.png" alt="image" width="600" height="139"/>
<h6/>
</div></figure>
<p>Next, you need to attach the top of the button to the barrier. You can try doing this by drawing the constraint directly in the blueprint. If, like us, you find this a bit too fiddly, select the button, search for its <code>layout_constraintTop_toBottomOf</code> attribute in the Attributes panel, and change its value to the barrier’s ID (in our case, this is <code>@id/barrier</code>).</p>
<figure class="informal"><div class="figure">
<img src="Images/f0151-03.png" alt="image" width="469" height="120"/>
<h6/>
</div></figure>
<p>After you make this change, the blueprint should look something like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0151-04.png" alt="image" width="600" height="355"/>
<h6/>
</div></figure>
<p>As barriers can be quite tricky to work with at first, we’ll show you our complete XML over the next couple pages, and then take the app for a test drive.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The full code for activity_main.xml"><div class="sect1" id="the_full_code_for_activityunder-id00043">
<h1>The full code for activity_main.xml</h1>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="code for" id="idm46053741746480"/>Here’s our complete code for <em>activity_main.xml</em>; if you want your blueprint to look like ours, replace the contents of this file so that it matches the code shown here:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0152-02.png" alt="image" width="600" height="708"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0153-02.png" alt="image" width="600" height="453"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00044">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<p>When we run the app, a button is displayed beneath two edit text views. The button moves down when we type into each edit text, and the views expand.</p>
<p>As you can see, adding a barrier is a bit more complicated than drawing constraints and aligning views, but we think it’s worth the extra effort.</p>
<p>So what’s next?</p>
<figure class="informal"><div class="figure">
<img src="Images/f0153-03.png" alt="image" width="600" height="281"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Use a chain to control a linear group of views"><div class="sect1" id="use_a_chain_to_control_a_linear_group_of">
<h1>Use a chain to control a linear group of views</h1>
<p><a data-type="indexterm" data-primary="chains, constraint layout" id="idm46053741732304"/><a data-type="indexterm" data-primary="constraint layout" data-secondary="chains" id="idm46053741731120"/><a data-type="indexterm" data-primary="horizontal chain, constraint layout" id="idm46053741730016"/>You’ve now learned how to connect and align views, and use guidelines and constraints. But what if you want to create a row or column of views, and evenly space them out?</p>
<p>In this sort of situation, you can use a <strong>chain</strong>. This is a linear group of views that are linked together with bidirectional constraints. The chain controls each view’s position, so you can use it to evenly space the views out, or pack them in the center of the blueprint.</p>
<section data-type="sect2" data-pdf-bookmark="We’re going to create a horizontal chain"><div class="sect2" id="weapostrophere_going_to_create_a_horizon">
<h2>We’re going to create a horizontal chain</h2>
<p>To see how this works, we’re going to create a chain that controls the position of three buttons. The buttons will be lined up in a horizontal row, and evenly spaced between each side of the blueprint like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0154-02.png" alt="image" width="600" height="241"/>
<h6/>
</div></figure>
<p>When the app runs, the buttons will maintain their relative positions, regardless of screen size or orientation:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0154-03.png" alt="image" width="600" height="319"/>
<h6/>
</div></figure>
<p>Let’s find out how to create a chain.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The chain will use three buttons"><div class="sect1" id="the_chain_will_use_three_buttons">
<h1>The chain will use three buttons</h1>
<p><a data-type="indexterm" data-primary="aligning views" id="idm46053741719936"/><a data-type="indexterm" data-primary="constraint layout" data-secondary="deleting constraints" id="idm46053741718816"/><a data-type="indexterm" data-primary="views" data-secondary="aligning" id="idm46053741717712"/>Before we create the chain, first remove all of the constraints that have been added to the blueprint so far. The quickest way of doing this is with the Clear All Constraints button in the design editor’s toolbar, so click on this button now.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0155-02.png" alt="image" width="363" height="112"/>
<h6/>
</div></figure>
<p>You also need to get rid of any guidelines, barriers, and edit text views. Do this by selecting each one, and deleting it.</p>
<p>Then add two more buttons to the blueprint so there are three in total, and use the “Orientation for Preview” button in the design editor’s toolbar to change the blueprint’s orientation to landscape. This will make it easier to see the chain.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0155-03.png" alt="image" width="328" height="115"/>
<h6/>
</div></figure>
<p>When you’ve added the buttons, the blueprint should look something like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0155-04.png" alt="image" width="600" height="147"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Align the views we’re going to chain"><div class="sect2" id="align_the_views_weapostrophere_going_to">
<h2>Align the views we’re going to chain</h2>
<p>Chains work best when views are aligned. First, add a constraint that connects the first button to the top of the blueprint, and set its margin to 64. Then select all three buttons, and use the Align button in the design editor’s toolbar to align their top edges. The blueprint should look like this.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0155-05.png" alt="image" width="600" height="196"/>
<h6/>
</div></figure>
<p>Now that the buttons are nicely aligned, let’s go ahead and create the chain.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Create the horizontal chain"><div class="sect1" id="create_the_horizontal_chain">
<h1>Create the horizontal chain</h1>
<p>To create the chain, select all three buttons, then right-click on one of them. From the menu that appears, choose the Chains option, followed by Create Horizontal Chain.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0156-02.png" alt="image" width="600" height="215"/>
<h6/>
</div></figure>
<p>When the horizontal chain is created, it joins the buttons together, and fastens the first and last view to the blueprint’s vertical edges. The chain should look something like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0156-03.png" alt="image" width="600" height="242"/>
<h6/>
</div></figure>
<p>By default, views in a chain are evenly spaced out between the blueprint’s edges. You can change this behavior by right-clicking on one of the chain’s views, selecting the Chains option from the menu that appears, and then choosing Horizontal Chain Style.</p>
<p>Possible chain style options include spread, spread inside, and packed. See if you can work out what these options do by having a go at the following exercise.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise-id00045">
<h5><span class="inlineimage"><img src="Images/exercise.png" alt="Images" width="125" height="79"/></span> Exercise</h5>
<p>Right-click on one of the buttons in the horizontal chain, select the Chains option from the menu that appears, and then choose Horizontal Chain Style. What happens to the views when you choose each option?</p>
<p>Draw the blueprint for each option below, and describe how it arranges the views.</p>
<p><strong>Spread:</strong></p>
<p><strong>Spread inside:</strong></p>
<p><strong>Packed:</strong></p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="exercise_solution-id00046">
<h5><span class="inlineimage"><img src="Images/exercise.png" alt="Images" width="125" height="79"/></span> Exercise Solution</h5>
<p>Right-click on one of the buttons in the horizontal chain, select the Chains option from the menu that appears, and then choose Horizontal Chain Style. What happens to the views when you choose each option?</p>
<p>Draw the blueprint for each option below, and describe how it arranges the views.</p>
<p><strong>Spread:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0158-01.png" alt="image" width="600" height="176"/>
<h6/>
</div></figure>
<p><strong>Spread inside:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0158-02.png" alt="image" width="600" height="175"/>
<h6/>
</div></figure>
<p><strong>Packed:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0158-03.png" alt="image" width="600" height="174"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="There are different styles of chain"><div class="sect1" id="there_are_different_styles_of_chain">
<h1>There are different styles of chain</h1>
<p><a data-type="indexterm" data-primary="packed chain style, constraint layout" id="idm46053741678288"/><a data-type="indexterm" data-primary="spread chain style, constraint layout" id="idm46053741677280"/><a data-type="indexterm" data-primary="spread inside chain style, constraint layout" id="idm46053741676480"/>As you have discovered, you can choose different chain styles to change how a chain arranges its views.</p>
<section data-type="sect2" data-pdf-bookmark="Spread spaces out views between the blueprint’s edges"><div class="sect2" id="spread_spaces_out_views_between_the_blue">
<h2>Spread spaces out views between the blueprint’s edges</h2>
<p>The default style is <strong>spread</strong>. This is used to evenly distribute the views between the blueprint’s edges like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0159-02.png" alt="image" width="600" height="187"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Spread inside moves the first and last view to the edges"><div class="sect2" id="spread_inside_moves_the_first_and_last_v">
<h2>Spread inside moves the first and last view to the edges</h2>
<p>The <strong>spread inside</strong> style is similar to spread, except that it moves the first and last view to the blueprint’s edges. It then evenly spaces out any remaining views like so:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0159-03.png" alt="image" width="600" height="192"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Packed moves the views together"><div class="sect2" id="packed_moves_the_views_together">
<h2>Packed moves the views together</h2>
<p>The <strong>packed</strong> style is used to pack views together. It then centers the entire group of views like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0159-04.png" alt="image" width="600" height="178"/>
<h6/>
</div></figure>
<p>Now that you’ve seen what these options do, let’s take the app for a test drive.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00047">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<p>When we use the spread style of chain and run the app, the buttons are evenly spread in the device screen. This is irrespective of screen orientation.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0160-02.png" alt="image" width="600" height="315"/>
<h6/>
</div></figure>
<blockquote>
<p><strong>Always test layouts on a variety of device sizes and orientations to make sure they look and behave how you want.</strong></p>
</blockquote>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00048">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: Can I make views a fixed size?</strong></p>
<p><strong>A:</strong> Yes. It’s not generally recommended because it means they can’t grow or shrink to fit the size of their contents, or the size of the screen.</p>
<p>If you definitely do need a fixed size view, you can either update its attributes, or use its corner handles to resize it in the blueprint.</p>
<p><strong>Q: Can I attach a chain to a guideline?</strong></p>
<p><strong>A:</strong> Yes, you can.</p>
<p><strong>Q: What happens if I make a view invisible?</strong></p>
<p><strong>A:</strong> It depends how you do it.</p>
<p>If you set a view’s <code>visibility</code> attribute to <code>invisible</code>, the view won’t appear on the screen, and there’ll be an empty space in its place.</p>
<p>If you set it to <code>gone</code>, the view takes up no space on the screen, and things like chains will act as though it’s not there.</p>
</div></aside>
<p><a data-type="indexterm" data-primary="vertical chain, constraint layout" id="idm46053741644944"/><strong>She’s right.</strong></p>
<p>Constraint layouts can include both horizontal and vertical chains, and a single view can belong to both types. You can use this to arrange views in a grid.</p>
<p>The blueprint below, for example, shows six buttons arranged in a grid. Each row is a horizontal chain, and the leftmost buttons form a vertical chain:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0161-02.png" alt="image" width="600" height="607"/>
<h6/>
</div></figure>
<p>Another way in which you can create grids is to use a <strong>flow</strong>. Let’s find out what this is, and how to use it.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="A flow is like a multi-line chain"><div class="sect1" id="a_flow_is_like_a_multi-line_chain">
<h1>A flow is like a multi-line chain</h1>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="flows" id="idm46053741641728"/><a data-type="indexterm" data-primary="flows, constraint layout" id="idm46053741638256"/>A flow is like a chain that can span multiple rows. It’s invaluable when, say, you want to display lots of views in a row, but they might not fit on the screen for some screen sizes or orientations.</p>
<p>As an example, suppose you have a chain that displays six buttons in a horizontal row. When the orientation is landscape, they are displayed like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0162-02.png" alt="image" width="600" height="180"/>
<h6/>
</div></figure>
<p>But when the orientation is changed to portrait, there’s not enough room to display all of the views:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0162-03.png" alt="image" width="600" height="202"/>
<h6/>
</div></figure>
<p>If you replace the chain with a flow, any views that can’t fit on the first row will flow onto a second row like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0162-04.png" alt="image" width="600" height="228"/>
<h6/>
</div></figure>
<p>Let’s see how flows work by building the above layout.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="How to add a flow"><div class="sect1" id="how_to_add_a_flow">
<h1>How to add a flow</h1>
<p><a data-type="indexterm" data-primary="flow_wrapMode attribute" id="idm46053741629312"/><a data-type="indexterm" data-primary="guidelines, constraint layout" id="idm46053741626496"/>First, remove any constraints by clicking on the Clear All Constraints button in the design editor’s toolbar. Then add extra buttons to the blueprint so there are six in total like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0163-02.png" alt="image" width="600" height="97"/>
<h6/>
</div></figure>
<p>Next, select all of the buttons, click on the Guidelines button in the design editor’s toolbar, and choose the Flow option. This adds the flow component.</p>
<p>We now need to tweak the flow component’s settings to make it behave the way we want. To do this, select the flow in the component tree, then use the blueprint or constraint widget to add constraints to connect its sides and top to the edges of the blueprint. Change its <code>layout_width</code> attribute to “0dp” so that it matches its constraints. Finally, search for its <code>flow_wrapMode</code> attribute in the Attributes panel, and set this to “chain”.</p>
<p>When you’ve made all of these changes, the blueprint should look something like this when the orientation is landscape:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0163-03.png" alt="image" width="600" height="193"/>
<h6/>
</div></figure>
<p>If you change the orientation to portrait, the blueprint should look like this instead:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0163-04.png" alt="image" width="600" height="179"/>
<h6/>
</div></figure>
<p>Once you’ve created a flow, you can tweak the way in which it displays its views. Let’s see how.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="You can control the flow’s appearance"><div class="sect1" id="you_can_control_the_flowapostrophes_appe">
<h1>You can control the flow’s appearance</h1>
<p><a data-type="indexterm" data-primary="flow_horizontalStyle attribute" id="idm46053741618144"/><a data-type="indexterm" data-primary="flow_wrapMode attribute" id="idm46053741613264"/>The main way in which you can alter the flow’s appearance is with its <code><strong>flow_wrapMode</strong></code> attribute.</p>
<section data-type="sect2" data-pdf-bookmark="Use “chain” to create a multi-line chain"><div class="sect2" id="use_quotation_markchainquotation_mark_to">
<h2>Use “chain” to create a multi-line chain</h2>
<p>If you set the <code>flow_wrapMode</code> attribute to <code>chain</code>, the flow behaves like a flexible chain that lets its views flow onto extra rows.</p>
<p>With this option, you can make further changes to the flow’s appearance by changing the value of its <code>flow_horizontalStyle</code> attribute. Possible options for this attribute are spread, spread inside, and packed. These have exactly the same effect as when you used them with chains. The packed option, for example, packs the views together like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0164-02.png" alt="image" width="600" height="193"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Use “aligned” to line up the views"><div class="sect2" id="use_quotation_markalignedquotation_mark">
<h2>Use “aligned” to line up the views</h2>
<p>If you set the <code>flow_wrapMode</code> attribute to <code>aligned</code>, the views flow onto extra rows, and they are lined up like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0164-03.png" alt="image" width="600" height="207"/>
<h6/>
</div></figure>
<p>You can also set the <code>flow_wrapMode</code> attribute to <code>none</code> or leave it unset. This makes the flow behave like a normal chain so that its views don’t flow onto a second row.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The full code for activity_main.xml"><div class="sect1" id="the_full_code_for_activityunders-id00049">
<h1>The full code for activity_main.xml</h1>
<p><a data-type="indexterm" data-primary="constraint layout" data-secondary="code for" id="idm46053741599104"/>Flows can sometimes be a little tricky to get right, so here’s our full code for <em>activity_main.xml</em>; if you want to, replace the code for this file so it matches the code shown here:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0165-02.png" alt="image" width="600" height="722"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0166-02.png" alt="image" width="600" height="494"/>
<h6/>
</div></figure>
<p>Let’s take the app for a test drive.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00050">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<p>When we use the chain style of flow and run the app, the buttons are evenly spread in the device screen when the orientation is landscape.</p>
<p>When we change the orientation to portrait, any buttons that don’t fit onto the first row flow onto the second.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0167-02.png" alt="image" width="600" height="598"/>
<h6/>
</div></figure>
<p>Congratulations! You’ve now learned how to design super-flexible screens using constraint layouts. As well as looking and behaving the way you want, they don’t use nested layouts, so they’re extremely efficient.</p>
<blockquote>
<p><strong>Before you move on to the next chapter, why not put your new skills into practice, and try experimenting with some of the techniques you’ve learned?</strong></p>
</blockquote>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Your Android Toolbox"><div class="sect1" id="your_android_toolbox-id00051">
<h1>Your Android Toolbox</h1>
<figure class="informal"><div class="figure">
<img src="Images/tools.png" alt="image" width="182" height="129"/>
<h6/>
</div></figure>
<p><strong>You’ve got <a data-type="xref" href="#constraint_layoutscolon_draw_up_a_bluepr">Chapter 4</a> under your belt and now you’ve added constraint layouts to your toolbox.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0168-01.png" alt="image" width="263" height="251"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="bullet_points-id00052">
<h5>Bullet Points</h5>
<ul>
<li><p>Constraint layouts are designed to work with Android Studio’s design editor.</p></li>
<li><p>Position views by adding constraints. Each view needs at least one horizontal and one vertical constraint.</p></li>
<li><p>Center views by adding constraints to opposite sides of the view. Change the view’s bias to update its position between the constraints.</p></li>
<li><p>You can change a view’s size to match its constraints if the view has constraints on opposing sides.</p></li>
<li><p>You can align views to one another, or use a guideline or barrier.</p></li>
<li><p>A guideline is positioned a fixed distance or percentage from the blueprint’s edge.</p></li>
<li><p>A barrier moves as and when its views change size.</p></li>
<li><p>Use a chain to control a linear group of views. Chains can be horizontal or vertical.</p></li>
<li><p>Horizontal and vertical chains can work together to display views in a grid.</p></li>
<li><p>The spread chain style spreads its views out evenly.</p></li>
<li><p>The spread inside chain style moves its outer views to the edges, and the inner views are spread out evenly.</p></li>
<li><p>The packed chain style packs views together in the center.</p></li>
<li><p>A flow is like a multi-line chain.</p></li>
</ul>
</div></aside>
</div></section>
</div></section></div></body></html>