<html><head></head><body><section class="pagenumrestart" data-pdf-bookmark="Chapter 1. Getting Started with Kubernetes" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch_getting_started">&#13;
<h1><span class="label">Chapter 1. </span>Getting Started with Kubernetes</h1>&#13;
&#13;
&#13;
<p>In this first chapter we present recipes that will help you get started with Kubernetes. We show you how to use Kubernetes without installing it and introduce components such as the command-line interface (CLI) and the dashboard, which allow you to interact with a cluster, as well as Minikube, an all-in-one solution you can run on your laptop.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="1.1 Installing the Kubernetes CLI, kubectl" data-type="sect1"><div class="sect1" id="get_kubectl">&#13;
<h1>1.1 Installing the Kubernetes CLI, kubectl</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id145">&#13;
<h2>Problem</h2>&#13;
&#13;
<p>You want to install the Kubernetes command-line interface so you can interact with your Kubernetes cluster.<a data-primary="CLI (command-line interface)" data-secondary="installing Kubernetes CLI" data-seealso="kubectl" data-type="indexterm" id="id444"/><a data-primary="kubectl" data-secondary="installing" data-type="indexterm" id="id445"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id146">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>The easiest option is to download the latest official release. <a data-primary="Linux" data-secondary="installing Kubernetes CLI or kubectl" data-type="indexterm" id="id446"/><a data-primary="macOS" data-secondary="installing kubectl" data-type="indexterm" id="id447"/>For example, on a Linux system, to get the latest stable version, enter the following:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>wget https://dl.k8s.io/release/$(wget -qO - https://dl.k8s.io/release/&#13;
stable.txt)/bin/linux/amd64/kubectl</strong>&#13;
&#13;
$ <strong>sudo install -m 755 kubectl /usr/local/bin/kubectl</strong>&#13;
</pre>&#13;
&#13;
<p>Using the <a href="https://brew.sh">Homebrew package manager</a>, Linux and macOS users can also install <code>kubectl</code>:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>brew install kubectl</strong></pre>&#13;
&#13;
<p class="pagebreak-before">After <a data-primary="kubectl" data-secondary="listing its version" data-type="indexterm" id="id448"/>installation, make sure you have a working <code>kubectl</code> by listing its version:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectl version --client</strong>&#13;
Client Version: v1.28.0&#13;
Kustomize Version: v5.0.4-0.20230...&#13;
</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id147">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><code>kubectl</code> is the official Kubernetes CLI and is available as open source software, which means you could build the <code>kubectl</code> binary yourself if you needed. See <a data-type="xref" href="ch15.html#compiling_source">Recipe 15.1</a> to learn about compiling the Kubernetes source code locally.</p>&#13;
&#13;
<p>It’s<a data-primary="kubectl" data-secondary="installing" data-tertiary="using gcloud" data-type="indexterm" id="id449"/><a data-primary="gcloud CLI" data-secondary="installing kubectl with" data-type="indexterm" id="id450"/><a data-primary="Google Kubernetes Engine (GKE)" data-secondary="installing kubectl using gcloud" data-type="indexterm" id="id451"/> useful to note that Google Kubernetes Engine users (see <a data-type="xref" href="ch02.html#gke_start">Recipe 2.11</a>) can install <code>kubectl</code> using <code>gcloud</code>:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>gcloud components install kubectl</strong>&#13;
</pre>&#13;
&#13;
<p>Also note that in the latest versions of Minikube (see <a data-type="xref" href="#minikube_install">Recipe 1.2</a>), you can invoke <code>kubectl</code> as a subcommand of <code>minikube</code> to run a <code>kubectl</code> binary <a data-primary="kubectl" data-secondary="invoking as subcommand of minikube" data-type="indexterm" id="id452"/><a data-primary="Minikube" data-secondary="invoking kubectl as subcommand of minikube" data-type="indexterm" id="id453"/>that matches the cluster version:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>minikube kubectl -- version --client</strong>&#13;
Client Version: version.Info{Major:"1", Minor:"27", GitVersion:"v1.27.4", ...}&#13;
Kustomize Version: v5.0.1&#13;
</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id454">&#13;
<h2>See Also</h2>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Documentation on <a href="https://oreil.ly/DgK8a">installing <code>kubectl</code></a></p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="1.2 Installing Minikube to Run a Local &#10;Kubernetes Instance" data-type="sect1"><div class="sect1" id="minikube_install">&#13;
<h1>1.2 Installing Minikube to Run a Local &#13;
<span class="keep-together">Kubernetes Instance</span></h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id148">&#13;
<h2>Problem</h2>&#13;
&#13;
<p>You want to use Kubernetes for testing or development or for training purposes on your local machine.<a data-primary="Minikube" data-secondary="installing to run local instance of Kubernetes" data-type="indexterm" id="id455"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id149">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a href="https://oreil.ly/97IFg">Minikube</a> is a tool that lets you easily use Kubernetes on your local machine.</p>&#13;
&#13;
<p class="pagebreak-after">To install the Minikube CLI locally, you can get the latest prebuilt release or build from source.<a data-primary="CLI (command-line interface)" data-secondary="installing Minikube CLI locally" data-type="indexterm" id="id456"/><a data-primary="Linux" data-secondary="installing Minikube locally" data-type="indexterm" id="id457"/> To install the latest release of <code>minikube</code> on a Linux-based machine,  &#13;
<span class="keep-together">do this:</span></p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>wget https://storage.googleapis.com/minikube/releases/latest/&#13;
minikube-linux-amd64 -O minikube&#13;
</strong>&#13;
&#13;
$ <strong>sudo install -m 755 minikube /usr/local/bin/minikube</strong></pre>&#13;
&#13;
<p>This will put the <code>minikube</code> binary in your path and make it accessible from &#13;
<span class="keep-together">everywhere.</span></p>&#13;
&#13;
<p>Once it’s installed, you can verify the Minikube version with the following command:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>minikube version</strong>&#13;
minikube version: <strong>v1.31.2</strong>&#13;
commit: fd7ecd...</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id1">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Minikube can be deployed as a virtual machine, a container, or bare metal. This is configured using the <code>--driver</code> flag while creating a cluster on Minikube. When this flag is not specified, Minikube will automatically select the best available runtime environment.<a data-primary="--driver flag, installing Minikube with" data-primary-sortas="driver" data-type="indexterm" id="id458"/></p>&#13;
&#13;
<p>A <em>hypervisor</em> is a software or hardware component that creates and manages virtual machines. <a data-primary="virtual machine (VM), Minikube deployed as" data-type="indexterm" id="id459"/><a data-primary="hypervisors" data-type="indexterm" id="id460"/>It is responsible for allocating and managing the physical resources (CPU, memory, storage, network) of a host system and allowing multiple virtual machines (VMs) to run concurrently on the same physical hardware.<a data-primary="Windows" data-secondary="Hyper-V on" data-type="indexterm" id="id461"/> Minikube supports a range of hypervisors, such as <a href="https://oreil.ly/-tbK7">VirtualBox</a>, <a href="https://oreil.ly/djLvh">Hyperkit</a>, <a href="https://oreil.ly/xQ-mj">Docker Desktop</a>, <a href="https://oreil.ly/5EAe0">Hyper-V</a>, and so on. The <a href="https://oreil.ly/Y1jpt">drivers</a> page gives an overview of the supported runtimes.</p>&#13;
&#13;
<p>Minikube can also use a container runtime to create a cluster on a host machine.<a data-primary="containers" data-secondary="Minikube deployed as container" data-type="indexterm" id="id462"/><a data-primary="Linux" data-secondary="Minikube using containers to run cluster locally" data-type="indexterm" id="id463"/> This driver is available only on a Linux-based host, where it’s possible to run Linux containers natively without having to use a VM. While a container-based runtime does not offer the same level of isolation as a virtual machine, it does offer the best performance and resource utilization.<a data-primary="Docker Engine" data-secondary="Minikube support for" data-type="indexterm" id="id464"/> At the time of writing, Minikube has support for <a href="https://oreil.ly/7gZPf">Docker Engine</a> and <a href="https://oreil.ly/y6N3t">Podman</a> (experimental).</p>&#13;
&#13;
<p>Other tools that can be used for running local Kubernetes clusters using Linux containers are as <a data-primary="Docker Desktop" data-secondary="running local clusters using Linux containers" data-type="indexterm" id="id465"/>follows:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Kubernetes in Docker Desktop (see <a data-type="xref" href="#install_docker_desktop_kubernetes">Recipe 1.6</a>)</p>&#13;
</li>&#13;
<li>&#13;
<p>kind (see <a data-type="xref" href="#install_kind">Recipe 1.5</a>)</p>&#13;
</li>&#13;
<li>&#13;
<p><a href="https://k3d.io">k3d</a></p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="less_space pagebreak-before" data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id466">&#13;
<h2>See Also</h2>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><a href="https://oreil.ly/2b1fA">Minikube Get Started! guide</a></p>&#13;
</li>&#13;
<li>&#13;
<p><a href="https://oreil.ly/HAZgT">Minikube drivers</a></p>&#13;
</li>&#13;
<li>&#13;
<p><code>minikube</code> source on <a href="https://oreil.ly/HmCEJ">GitHub</a></p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="1.3 Using Minikube Locally for Development" data-type="sect1"><div class="sect1" id="minikube_manage">&#13;
<h1>1.3 Using Minikube Locally for Development</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id150">&#13;
<h2>Problem</h2>&#13;
&#13;
<p>You want to use Minikube locally for testing and development of your Kubernetes application.<a data-primary="Kubernetes" data-secondary="running locally using Minikube" data-type="indexterm" id="id467"/><a data-primary="Minikube" data-secondary="using locally for development" data-type="indexterm" id="id468"/> You have installed and started <code>minikube</code> (see <a data-type="xref" href="#minikube_install">Recipe 1.2</a>) and want to know a few extra commands to simplify your development experience.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id469">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the <code>minikube start</code> command to create a Kubernetes cluster locally:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>minikube start</strong></pre>&#13;
&#13;
<p>By default the cluster will be allocated 2 GB of RAM. If you don’t like the defaults, you can override parameters such as the memory and number of CPUs, as well as picking a certain Kubernetes version for the Minikube VM—​for example:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>minikube start --cpus=4 --memory=4096 --kubernetes-version=v1.27.0</strong>&#13;
</pre>&#13;
&#13;
<p>Additionally, you can specify the number of cluster nodes by overriding the default value of one node:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>minikube start --cpus=2 --memory=4096 --nodes=2</strong>&#13;
</pre>&#13;
&#13;
<p>To inspect the status of the Minikube cluster, do this:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>minikube status</strong>&#13;
minikube&#13;
type: Control Plane&#13;
host: Running&#13;
kubelet: Running&#13;
apiserver: Running&#13;
kubeconfig: Configured&#13;
&#13;
minikube-m02&#13;
type: Worker&#13;
host: Running&#13;
kubelet: Running&#13;
</pre>&#13;
&#13;
<p class="pagebreak-before">Similarly, to inspect the status of the Kubernetes cluster running inside Minikube, &#13;
<span class="keep-together">do this:</span></p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectl cluster-info</strong>&#13;
Kubernetes control plane is running at https://192.168.64.72:8443&#13;
CoreDNS is running at https://192.168.64.72:8443/api/v1/namespaces/&#13;
kube-system/services/kube-dns:dns/proxy&#13;
&#13;
To further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.&#13;
</pre>&#13;
&#13;
<p>The Kubernetes cluster created with Minikube utilizes resources of the host machine, so you need to make sure your host has the resources available. More importantly, when you are done, do not forget to stop it with <code>minikube stop</code> to release the system resources.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id2">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The Minikube CLI offers commands that make your life easier. <a data-primary="CLI (command-line interface)" data-secondary="useful commands of Minikube CLI" data-type="indexterm" id="id470"/><a data-primary="Minikube" data-secondary="CLI commands" data-type="indexterm" id="id471"/><a data-primary="start command (Minikube CLI)" data-type="indexterm" id="id472"/><a data-primary="status command (Minikube CLI)" data-type="indexterm" id="id473"/><a data-primary="stop command (Minikube CLI)" data-type="indexterm" id="id474"/><a data-primary="delete command (Minikube CLI)" data-type="indexterm" id="id475"/><a data-primary="addons command (Minikube CLI)" data-type="indexterm" id="id476"/>The CLI has built-in help that you can use to discover the subcommands on your own—​here’s a snippet:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>minikube</strong>&#13;
...&#13;
Basic Commands:&#13;
  start            Starts a local Kubernetes cluster&#13;
  status           Gets the status of a local Kubernetes cluster&#13;
  stop             Stops a running local Kubernetes cluster&#13;
  delete           Deletes a local Kubernetes cluster&#13;
...&#13;
Configuration and Management Commands:&#13;
  addons           Enable or disable a minikube addon&#13;
...&#13;
</pre>&#13;
&#13;
<p>Aside from <code>start</code>, <code>stop</code>, and <code>delete</code>, you should become familiar with the <code>ip</code>, <code>ssh</code>, <code>tunnel</code>, <code>dashboard</code>, and <code>docker-env</code> commands.</p>&#13;
<div data-type="tip"><h6>Tip</h6>&#13;
<p>If for any reason your Minikube becomes unstable or you want to start fresh, you can remove it with <code>minikube stop</code> and <code>minikube delete</code>. Then <code>minikube start</code> will give you a fresh installation.</p>&#13;
</div>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="1.4 Starting Your First Application on Minikube" data-type="sect1"><div class="sect1" id="first_app_minikube">&#13;
<h1>1.4 Starting Your First Application on Minikube</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id151">&#13;
<h2>Problem</h2>&#13;
&#13;
<p>You’ve started Minikube (see <a data-type="xref" href="#minikube_manage">Recipe 1.3</a>), and now you want to launch your first application on Kubernetes.<a data-primary="Minikube" data-secondary="starting your first application on" data-type="indexterm" id="id477"/><a data-primary="Ghost microblogging platform" data-secondary="starting using kubectl" data-type="indexterm" id="id478"/><a data-primary="kubectl" data-secondary="commands to start Ghost on Minikube" data-type="indexterm" id="id479"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id3">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>As an example, you can start the <a href="https://ghost.org">Ghost</a> microblogging platform on Minikube using two <code>kubectl</code> commands:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectl run ghost --image=ghost:5.59.4 --env="NODE_ENV=development"</strong>&#13;
$ <strong>kubectl expose pod ghost --port=2368 --type=NodePort</strong>&#13;
</pre>&#13;
&#13;
<p>Monitor the pod manually to see when it starts running:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectl get pods</strong>&#13;
NAME                     READY     STATUS    RESTARTS   AGE&#13;
ghost-8449997474-kn86m   1/1       Running   0          24s&#13;
</pre>&#13;
&#13;
<p>Now you can use the <code>minikube service</code> command to automatically <a data-primary="service command (Minikube)" data-type="indexterm" id="id480"/>load the application service URL in the web browser:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>minikube service ghost</strong>&#13;
</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id4">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The <code>kubectl run</code> command is called a <em>generator</em>; it is a convenience command to create a <code>Pod</code> object (see <a data-type="xref" href="ch04.html#pod_manifest">Recipe 4.4</a>). <a data-primary="generators" data-type="indexterm" id="id481"/><a data-primary="run command (kubectl)" data-type="indexterm" id="id482"/><a data-primary="expose command (kubectl)" data-type="indexterm" id="id483"/>The <code>kubectl expose</code> command is also a generator, a convenience command to create a <code>Service</code> object (see <a data-type="xref" href="ch05.html#simple_service">Recipe 5.1</a>) that routes network traffic to the containers started by your deployment.</p>&#13;
&#13;
<p>When you do<a data-primary="pods" data-secondary="removing Ghost pod from Minikube" data-type="indexterm" id="id484"/><a data-primary="Ghost microblogging platform" data-secondary="removing from Minikube cluster" data-type="indexterm" id="id485"/> not need the application anymore, you can remove the <code>Pod</code> to release the cluster resources:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectl delete pod ghost</strong></pre>&#13;
&#13;
<p>Additionally, you should delete the <code>ghost</code> service that was created by the <code>kubectl expose</code> command:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectl delete svc ghost</strong></pre>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="1.5 Using kind to Run Kubernetes Locally" data-type="sect1"><div class="sect1" id="install_kind">&#13;
<h1>1.5 Using kind to Run Kubernetes Locally</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id152">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a href="https://kind.sigs.k8s.io">kind</a> is an alternative way to run Kubernetes locally. <a data-primary="Kubernetes" data-secondary="running locally using kind" data-type="indexterm" id="id486"/>It was originally designed for testing Kubernetes but is now also often used as a way to try Kubernetes-native solutions on a laptop with minimal fuss. <a data-primary="kind" data-secondary="using to run Kubernetes locally" data-type="indexterm" id="id487"/>You want to use kind locally for testing and developing your Kubernetes application.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="less_space pagebreak-before" data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id153">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>The minimum requirements for using kind are Go and a Docker runtime.<a data-primary="Go language" data-secondary="requirement for using kind" data-type="indexterm" id="id488"/> kind is <a href="https://oreil.ly/1MxZo">easy to install</a> on any platform, for example using <code>brew</code>:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>brew install kind</strong></pre>&#13;
&#13;
<p>Then, creating a cluster is as simple as doing this:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kind create cluster</strong></pre>&#13;
&#13;
<p>Deleting it is just as easy:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kind delete cluster</strong></pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id489">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Because kind was originally developed for testing Kubernetes, one of its <a href="https://oreil.ly/jNTNx">core design principles</a> is that it should lend itself well to automation. You might want to consider using kind if you plan on automatically deploying Kubernetes clusters for testing purposes.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id490">&#13;
<h2>See Also</h2>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>The official kind <a href="https://oreil.ly/aXjcY">Quick Start guide</a></p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="1.6 Using Kubernetes in Docker Desktop" data-type="sect1"><div class="sect1" id="install_docker_desktop_kubernetes">&#13;
<h1>1.6 Using Kubernetes in Docker Desktop</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id154">&#13;
<h2>Problem</h2>&#13;
&#13;
<p>Docker Desktop is an offering built on top of Docker Engine that provides a number of useful developer tools, including a built-in version<a data-primary="Docker Desktop" data-secondary="using Kubernetes in" data-type="indexterm" id="ix_DkrDesk"/><a data-primary="Kubernetes" data-secondary="using in Docker Desktop" data-type="indexterm" id="ix_KubDckDsk"/> of Kubernetes and an associated load balancer to route traffic into the cluster. This means you can install a single tool and have access to pretty much everything you need to get started locally. You want to use Docker Desktop locally for testing and developing your Kubernetes application.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id155">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a href="https://oreil.ly/HKVaR">Install Docker Desktop</a> and make sure to enable Kubernetes during the installation process.</p>&#13;
&#13;
<p>You can activate and deactivate Kubernetes from Docker Desktop’s settings panel, as shown in <a data-type="xref" href="#docker_desktop_settings">Figure 1-1</a>. You might want to do this if you’re using Docker Desktop for its Docker Engine but aren’t using Kubernetes, as this will save resources on your computer. As shown here, the settings panel also shows you which version of Kubernetes is provided by Docker Desktop, which can be useful when debugging as certain solutions might have requirements on the minimum or maximum version of Kubernetes that they can run on.<a data-primary="versions" data-secondary="Kubernetes version embedded in Docker Desktop" data-type="indexterm" id="id491"/></p>&#13;
&#13;
<figure><div class="figure" id="docker_desktop_settings">&#13;
<img alt="Snapshot of the Docker Desktop Kubernetes settings panel" src="assets/kcb2_0101.png"/>&#13;
<h6><span class="label">Figure 1-1. </span>Snapshot of the Docker Desktop Kubernetes settings panel</h6>&#13;
</div></figure>&#13;
&#13;
<p>It is worth noting that the version of Kubernetes embedded into Docker Desktop lags behind the latest Kubernetes release by a few versions, whereas Minikube tends to be more up to date.<a data-primary="kubectl" data-secondary="switching contexts using Docker Desktop toolbar menu" data-type="indexterm" id="id492"/><a data-primary="contexts" data-secondary="Docker Desktop context switcher for kubectl" data-type="indexterm" id="id493"/></p>&#13;
&#13;
<p>As shown in <a data-type="xref" href="#docker_desktop_context">Figure 1-2</a>, the Docker Desktop toolbar menu lets you easily switch <code>kubectl</code> contexts between different local clusters, which means you can have Minikube and Docker Desktop’s Kubernetes running at the same time but switch between them (not that we recommend doing this). For information on how to do this directly from <code>kubectl</code>, see <a data-type="xref" href="#switch_contexts">Recipe 1.7</a>.</p>&#13;
&#13;
<figure><div class="figure" id="docker_desktop_context">&#13;
<img alt="Snapshot of the Docker Desktop context switcher for kubectl" src="assets/kcb2_0102.png"/>&#13;
<h6><span class="label">Figure 1-2. </span>Snapshot of the Docker Desktop context switcher for <code>kubectl</code></h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id156">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Although it is a quick and easy way to get started with Kubernetes, be aware that Docker Desktop is not open source, and that the free version is restricted for use by individuals, small businesses, students and educators, and non-commercial open source developers.</p>&#13;
&#13;
<p>Docker Engine, on the other hand, which can be used to run Minikube, has an Apache 2.0 license, as does Minikube itself.<a data-primary="Kubernetes" data-secondary="using in Docker Desktop" data-startref="ix_KubDckDsk" data-type="indexterm" id="id494"/><a data-primary="Docker Desktop" data-secondary="using Kubernetes in" data-startref="ix_DkrDesk" data-type="indexterm" id="id495"/></p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="1.7 Switching kubectl Contexts" data-type="sect1"><div class="sect1" id="switch_contexts">&#13;
<h1>1.7 Switching kubectl Contexts</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id157">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><code>kubectl</code> is always configured to speak to a given Kubernetes cluster by default, and this configuration is part of something called the <em>context</em>. If you’ve forgotten which cluster <code>kubectl</code> is set to, want to switch between clusters, or want to change other context-related parameters, then this recipe is for you.<a data-primary="kubectl" data-secondary="switching contexts directly from" data-type="indexterm" id="id496"/><a data-primary="contexts" data-secondary="switching kubectl contexts" data-type="indexterm" id="id497"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="less_space pagebreak-before" data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id158">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>To view the contexts available to <code>kubectl</code>, use the <code>kubectl config get-contexts</code> command:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectl config get-contexts</strong>&#13;
CURRENT   NAME             CLUSTER          AUTHINFO         NAMESPACE&#13;
          docker-desktop   docker-desktop   docker-desktop&#13;
          kind-kind        kind-kind        kind-kind&#13;
*         minikube         minikube         minikube         default&#13;
</pre>&#13;
&#13;
<p>As you can see from the output, in this case there are three Kubernetes clusters available to <code>kubectl</code>, and the current context is set to speak to the <code>minikube</code> cluster.</p>&#13;
&#13;
<p>To switch to the <code>kind-kind</code> cluster, execute <a data-primary="kind" data-secondary="switching kubectl context to" data-type="indexterm" id="id498"/>the following command:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectl config use-context kind-kind</strong>&#13;
Switched to context "kind-kind".&#13;
</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id499">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>If you want to use your local <code>kubectl</code> to access a remote cluster, you can do so by editing the kubeconfig file. Learn more about the kubeconfig file in the <a href="https://oreil.ly/jMZ3h">official documentation</a>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="1.8 Switching Contexts and Namespaces Using &#10;kubectx and kubens" data-type="sect1"><div class="sect1" id="id339">&#13;
<h1>1.8 Switching Contexts and Namespaces Using &#13;
<span class="keep-together">kubectx and kubens</span></h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id159">&#13;
<h2>Problem</h2>&#13;
&#13;
<p>You want to find an easier way to switch contexts (i.e., clusters) and namespaces with <code>kubectl</code>, as the commands for switching contexts are long and quite hard to remember.<a data-primary="contexts" data-secondary="switching using kubectx and kubens" data-type="indexterm" id="id500"/></p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id5">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><code>kubectx</code> and <code>kubens</code> are a couple of popular open source scripts that make it much easier to switch contexts for <code>kubectl</code> and to switch namespaces so that you don’t have to explicitly set the namespace name for every command.<a data-primary="kubectx" data-type="indexterm" id="id501"/></p>&#13;
&#13;
<p>There are plenty of available installation options. If you’re able to use <code>brew</code>, then you can try this:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>brew install kubectx</strong></pre>&#13;
&#13;
<p class="pagebreak-before">You can then easily list the available <code>kubectl</code> contexts like so:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectx</strong>&#13;
docker-desktop&#13;
<b>kind-kind</b>&#13;
minikube&#13;
</pre>&#13;
&#13;
<p>and switch contexts just as easily:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectx minikube</strong>&#13;
Switched to context "minikube".&#13;
</pre>&#13;
&#13;
<p>Similarly, <code>kubens</code> lets you easily list and<a data-primary="namespaces" data-secondary="switching for kubectl using kubens" data-type="indexterm" id="id502"/><a data-primary="kubens" data-type="indexterm" id="id503"/> switch namespaces:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubens</strong>&#13;
<b>default</b>&#13;
kube-node-lease&#13;
kube-public&#13;
kube-system&#13;
test&#13;
</pre>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubens test</strong>&#13;
<b>default</b>&#13;
Context "minikube" modified.&#13;
Active namespace is "test".&#13;
</pre>&#13;
&#13;
<p>All commands from then onward will be performed in the context of the chosen namespace:</p>&#13;
<pre data-type="programlisting">&#13;
$ <strong>kubectl get pods</strong>&#13;
<b>default</b>&#13;
No resources found in test namespace.&#13;
</pre>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="See Also" data-type="sect2"><div class="sect2" id="id504">&#13;
<h2>See Also</h2>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>The <a href="https://oreil.ly/QBH3N">repository for the <code>kubectl</code> and <code>kubens</code> tools</a></p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
</div></section>&#13;
</div></section></body></html>