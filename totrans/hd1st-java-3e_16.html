<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 14. A Very Graphic Story: Getting Gui"><div class="chapter" id="a_very_graphic_story_getting_gui">
<h1><span class="label">Chapter 14. </span>A Very Graphic Story: Getting Gui</h1>
<figure class="informal"><div class="figure"><img src="Images/f0461-01.png" alt="image" width="707" height="621"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="GUI" id="idm46038389856032"/><strong>Face it, you need to make GUIs</strong>. If you’re building applications that other people are going to use, you <em>need</em> a graphical interface. If you’re building programs for yourself, you <em>want</em> a graphical interface.  Even if you believe that the rest of your natural life will be spent writing server-side code, where the client user interface is a web page, sooner or later you’ll need to write tools, and you’ll want a graphical interface.  Sure, command-line apps are retro, but not in a good way. They’re weak, inflexible, and unfriendly. We’ll spend two chapters working on GUIs and learn key Java language features along the way including <strong>Event Handling</strong> and <strong>Inner Classes</strong> and <strong>lambdas</strong>. In this chapter, we’ll put a button on the screen, and make it do something when you click it. We’ll paint on the screen, we’ll display a JPEG image, and we’ll even do some (crude) animation.</p>
<section data-type="sect1" data-pdf-bookmark="It all starts with a window"><div class="sect1" id="it_all_starts_with_a_window">
<h1>It all starts with a window</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0462-02.png" alt="image" width="515" height="540"/>
<h6/>
</div></figure>
<p><strong>She’s asked a couple of really good questions.</strong> In a few pages we’ll address these questions with an extra-special “No Dumb Questions.”</p>
<p><a data-type="indexterm" data-primary="frames, GUI" id="idm46038390141616"/><a data-type="indexterm" data-primary="GUI" data-secondary="components" id="idm46038389839696"/><a data-type="indexterm" data-primary="GUI" data-secondary="Swing" id="idm46038389839056"/><a data-type="indexterm" data-primary="JFrame" id="idm46038389838416"/><a data-type="indexterm" data-primary="Swing" id="idm46038389837904"/>A JFrame is the object that represents a window on the screen. It’s where you put all the interface things like buttons, check boxes, text fields, and so on. It can have an honest-to-goodness menu bar with menu items. And it has all the little windowing icons for whatever platform you’re on, for minimizing, maximizing, and closing the window.</p>
<p>The JFrame looks different depending on the platform you’re on. This is a JFrame on an old Mac OS X:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0462-01.png" alt="image" width="602" height="329"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Put widgets in the window"><div class="sect2" id="put_widgets_in_the_window">
<h2>Put widgets in the window</h2>
<p>Once you have a JFrame, you can put things (“widgets”) in it by adding them to the JFrame. There are a ton of Swing components you can add; look for them in the javax.swing package. The most common include JButton, JRadioButton, JCheckBox, JLabel, JList, JScrollPane, JSlider, JTextArea, JTextField, and JTable. Most are really simple to use, but some (like JTable) can be a bit more complicated.</p>
<p><strong>Making a GUI is easy:</strong></p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="images" width="20" height="21"/></span> Make a frame (a JFrame)</p>
<p><code><strong>JFrame frame = new JFrame();</strong></code></p></li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="images" width="20" height="21"/></span> Make a widget (button, text field, etc.)</p>
<p><code><strong>JButton button = new JButton("click me");</strong></code></p></li>
<li><p><span class="inlineimage"><img src="Images/3.png" alt="images" width="20" height="21"/></span> Add the widget to the frame</p>
<p><code><strong>frame.getContentPane().add(button);</strong></code></p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#636466;">You don’t add things to the frame <u>directly</u>. Think of the frame as the trim around the window, and you add things to the window <u>pane</u>.</span></p>
</div></li>
<li><p><span class="inlineimage"><img src="Images/4.png" alt="images" width="20" height="20"/></span> Display it (give it a size and make it visible)</p>
<pre data-type="programlisting"><strong>frame.setSize(300,300);</strong>
<strong>frame.setVisible(true);</strong></pre></li>
</ul>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Your first GUI: a button on a frame"><div class="sect1" id="your_first_gui_a_button_on_a_frame">
<h1>Your first GUI: a button on a frame</h1>
<p><a data-type="indexterm" data-primary="buttons, GUI" id="idm46038389816576"/><a data-type="indexterm" data-primary="GUI" data-secondary="buttons" data-see="buttons, GUI" id="idm46038389803536"/></p>
<figure class="informal"><div class="figure"><img src="Images/f0463-01.png" alt="image" width="932" height="596"/>
<h6/>
</div></figure>
<p><strong>Let’s see what happens when we run it:</strong></p>
<p><code>%java SimpleGui1</code></p>
<figure class="informal"><div class="figure">
<img src="Images/f0463-02.png" alt="image" width="438" height="439"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#636466;"><strong>Whoa! That’s a Really Big Button.</strong></span></p>
</div>
<p>The button fills all the available space in the frame. Later we’ll learn to control where (and how big) the button is on the frame.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="But nothing happens when I click it..."><div class="sect1" id="but_nothing_happens_when_i_click_ithelli">
<h1>But nothing happens when I click it...</h1>
<p><a data-type="indexterm" data-primary="buttons, GUI" data-secondary="response and timing" id="idm46038389794320"/><a data-type="indexterm" data-primary="JavaFX" id="idm46038389793168"/><a data-type="indexterm" data-primary="Swing" id="idm46038389792336"/>That’s not exactly true. When you press the button, it shows that “pressed” or “pushed in” look (which changes depending on the platform look and feel, but it always does <em>something</em> to show when it’s being pressed).</p>
<p>The real question is, “How do I get the button to do something specific when the user clicks it?”</p>
<p><strong>We need two things:</strong></p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="images" width="20" height="21"/></span> A <strong><em>method</em></strong> to be called when the user clicks (the thing you want to happen as a result of the button click).</p></li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="images" width="20" height="21"/></span> A way to <strong><em>know</em></strong> when to trigger that method. In other words, a way to know when the user clicks the button!</p></li>
</ul>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000038">
<figure class="informal"><div class="figure">
<img src="Images/f0464-01.png" alt="image" width="598" height="269"/>
<h6/>
</div></figure>
<p><strong>When the user clicks, we want to know.</strong></p>
<p><strong>We’re interested in the user-takes-action-on-a-button <u>event</u>.</strong></p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00037">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: I heard that nobody uses Swing anymore.</strong></p>
<p><strong>A:</strong> There are other options, like JavaFX. But there are no clear winners in the endless and ongoing “Which approach should I use to make GUIs in Java?” debate. The good news is that if you learn a little Swing, that knowledge will help you whichever way you end up going. For example, if you want to do Android development, your Swing knowledge will make learning to code Android apps easier.</p>
<p><strong>Q: Will a button look like a Windows button when you run on Windows?</strong></p>
<p><strong>A:</strong> If you want it to. You can choose from a few “look and feels”—classes in the core library that control what the interface looks like. In most cases you can choose between at least two different looks. The  screens in this book use a number of “look and feels,” including the default system look and feel (for macOS), the OS X <strong><em>Aqua</em></strong> look and feel, or the <strong><em>Metal</em></strong> (cross platform) look and feel.</p>
<p><strong>Q: Isn’t Aqua really old?</strong></p>
<p><strong>A:</strong> Yes, but we like it.</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Getting a user event"><div class="sect1" id="getting_a_user_event">
<h1>Getting a user event</h1>
<p><a data-type="indexterm" data-primary="event handling" id="idm46038389774496"/><a data-type="indexterm" data-primary="GUI" data-secondary="event handling" id="idm46038389773872"/>Imagine you want the text on the button to change from <em>click me</em> to <em>I’ve been clicked</em> when the user presses the button. First we can write a method that changes the text of the button (a quick look through the API will show you the method):</p>
<pre data-type="programlisting"><strong>public void changeIt() {</strong>
  <strong>button.setText("I’ve been clicked!");</strong>
<strong>}</strong></pre>
<p>But <em>now</em> what? How will we <em>know</em> when this method should run? <strong><em>How will we know when the button is clicked?</em></strong></p>
<p>In Java, the process of getting and handling a user event is called <em>event-handling</em>. There are many different event types in Java, although most involve GUI user actions. If the user clicks a button, that’s an event. An event that says “The user wants the action of this button to happen.” If it’s a “Slow the Tempo” button, the user wants the slow-the-music-tempo action to occur. If it’s a Send button on a chat client, the user wants the send-my-message action to happen. So the most straightforward event is when the user clicked the button, indicating they want an action to occur.</p>
<p>With buttons, you usually don’t care about any intermediate events like button-is-being-pressed and button-is-being-released. What you want to say to the button is, “I don’t care how the user plays with the button, how long they hold the mouse over it, how many times they change their mind and roll off before letting go, etc. <em><strong>Just tell me when the user means business!</strong></em> In other words, don’t call me unless the user clicks in a way that indicates he wants the darn button to do what it says it’ll do!”</p>
<p><strong>First, the button needs to know that we care.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0465-02.png" alt="image" width="379" height="330"/>
<h6/>
</div></figure>
<p><strong>Second, the button needs a way to call us back when a button-clicked event occurs.</strong></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-id00007">
<h5>Brain Power</h5>
<figure class="informal"><div class="figure">
<img src="Images/brain.png" alt="image" width="80" height="71"/>
<h6/>
</div></figure>
<p>1. How could you tell a button object that you care about its events? That you’re a concerned listener?</p>
<p>2. How will the button call you back? Assume that there’s no way for you to tell the button the name of your unique method (changeIt()). So what else can we use to reassure the button that we have a specific method it can call when the event happens? [hint: think Pet]</p>
</div></aside>
<p><a data-type="indexterm" data-primary="event handling" data-secondary="listener interface" id="idm46038389745056"/><a data-type="indexterm" data-primary="GUI" data-secondary="listener interface" id="idm46038389974240"/><a data-type="indexterm" data-primary="listener interface, event handling" id="idm46038389973072"/><a data-type="indexterm" data-primary="methods" data-secondary="listener interface" id="idm46038389742000"/><a data-type="indexterm" data-primary="source, event" id="idm46038389741136"/><strong>If you care about the button’s events, <span style="background-color:#000000;color:#FFFFFF"><strong>implement an interface</strong></span> that says, “I’m <span style="background-color:#000000;color:#FFFFFF"><strong>listening</strong></span> for your events.”</strong></p>
<p>A <strong>listener interface</strong> is the bridge between the <strong>listener</strong> (you) and <strong>event source</strong> (the button).</p>
<p>The Swing GUI components are event sources. In Java terms, an event source is an object that can turn user actions (click a mouse, type a key, close a window) into events. And like virtually everything else in Java, an event is represented as an object. An object of some event class. If you scan through the java.awt.event package in the API, you’ll see a bunch of event classes (easy to spot—they all have <strong><em>Event</em></strong> in the name). You’ll find MouseEvent, KeyEvent, WindowEvent, ActionEvent, and several others.</p>
<p>An event <em><strong>source</strong></em> (like a button) creates an <em><strong>event object</strong></em> when the user does something that matters (like <em>click</em> the button). Most of the code you write (and all the code in this book) will <em>receive</em> events rather than <em>create</em> events. In other words, you’ll spend most of your time as an event <em>listener</em> rather than an event <em>source</em>.</p>
<p>Every event type has a matching listener interface. If you want MouseEvents, implement the MouseListener interface. Want WindowEvents? Implement WindowListener. You get the idea. And remember your interface rules—to implement an interface you <em>declare</em> that you implement it (class Dog implements Pet), which means you must <em>write implementation methods</em> for every method in the interface.</p>
<p>Some interfaces have more than one method because the event itself comes in different flavors. If you implement MouseListener, for example, you can get events for mousePressed, mouseReleased, mouseMoved, etc. Each of those mouse events has a separate method in the interface, even though they all take a MouseEvent. If you implement MouseListener, the mousePressed() method is called when the user (you guessed it) presses the mouse. And when the user lets go, the mouseReleased() method is called. So for mouse events, there’s only one event <em>object</em>, MouseEvent, but several different event <em>methods</em>, representing the different <em>types</em> of mouse events.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#636466;"><strong>When you implement a listener interface, you give the button a way to call you back. The interface is where the call-back method is declared.</strong></span></p>
</div>
<figure class="informal"><div class="figure">
<img src="Images/f0466-01.png" alt="image" width="345" height="681"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="ActionEvent" id="idm46038390186992"/><a data-type="indexterm" data-primary="actionPerformed()" id="idm46038389720240"/><a data-type="indexterm" data-primary="addActionListener()" id="idm46038389719728"/><a data-type="indexterm" data-primary="event source" id="idm46038389719216"/><a data-type="indexterm" data-primary="listener" id="idm46038389718592"/><strong>How the listener and source communicate:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0467-01.png" alt="image" width="1100" height="992"/>
<h6/>
</div></figure>
<p><strong>The Listener</strong></p>
<p>If your class wants to know about a button’s ActionEvents, you implement the ActionListener interface. The button needs to know you’re interested, so you register with the button by calling its addActionListener(this) and passing an ActionListener reference to it. In our first example, <em>you</em> are the ActionListener so you pass <em>this</em>, but it’s more common to create a specific class to do listen to events. The button needs a way to call you back when the event happens,  so it calls the method in the listener interface.  As an ActionListener, you <em>must</em> implement the interface’s sole method, actionPerformed().  The compiler guarantees it.</p>
<p><strong>The Event Source</strong></p>
<p>A button is a source of ActionEvents, so it has to know which objects are interested listeners. The button has an addActionListener() method to give interested objects (listeners) a way to <em>tell</em> the button they’re interested.</p>
<p>When the button’s addActionListener() runs (because  a potential listener invoked it), the button takes the parameter (a reference to the listener object) and stores it in a list. When the user clicks the button, the button “fires” the event by calling the actionPerformed() method on each listener in the list.</p>
<p><strong>Getting a button’s ActionEvent</strong></p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="images" width="20" height="21"/></span> Implement the ActionListener interface</p></li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="images" width="20" height="21"/></span> Register with the button (tell it you want to listen for events)</p></li>
<li><p><span class="inlineimage"><img src="Images/3.png" alt="images" width="20" height="21"/></span> Define the event-handling method (implement the actionPerformed() method from the ActionListener interface)</p></li>
</ul>
<figure class="informal"><div class="figure">
<img src="Images/f0468-01.png" alt="image" width="1014" height="802"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Listeners, Sources, and Events"><div class="sect1" id="listenerscomma_sourcescomma_and_events">
<h1>Listeners, Sources, and Events</h1>
<p>For most of your stellar Java career, <em>you</em> will not be the <em>source</em> of events.</p>
<p>(No matter how much you fancy yourself the center of your social universe.)</p>
<p>Get used to it. <strong><em>Your job is to be a good listener.</em></strong></p>
<p>(Which, if you do it sincerely, <em>can</em> improve your social life.)</p>
<figure class="informal"><div class="figure">
<img src="Images/f0469-01.png" alt="image" width="928" height="797"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00038">
<h5>there are no Dumb Questions</h5>
<p><a data-type="indexterm" data-primary="event object" id="idm46038389687328"/><strong>Q: Why can’t I be a source of events?</strong></p>
<p><strong>A:</strong> You CAN. We just said that <em>most</em> of the time you’ll be the receiver and not the originator of the event (at least in the <em>early</em> days of your brilliant Java career). Most of the events you might care about are “fired” by classes in the Java API, and all you have to do is be a listener for them. You might, however, design a program where you need a custom event, say, StockMarketEvent thrown when your stock market watcher app finds something it deems important. In that case, you’d make the StockWatcher object be an event source, and you’d do the same things a button  (or any other source) does—make a listener interface for your custom event, provide a registration method (addStockListener()), and when somebody calls it, add the caller (a listener) to the list of listeners. Then, when a stock event happens, instantiate a StockEvent object (another class you’ll write) and send it to the listeners in your list by calling their stockChanged(StockEvent ev) method. And don’t forget that for every <em>event type</em> there must be a <em>matching listener interface</em> (so you’ll create a StockListener interface with a stockChanged()  method).</p>
<p><strong>Q: I don’t see the importance of the event object that’s passed to the event call-back methods. If somebody calls my mousePressed method, what other info would I need?</strong></p>
<p><strong>A:</strong> A lot of the time, for most designs, you don’t need the event object. It’s nothing more than a little data carrier, to send along more info about the event. But sometimes you might need to query the event for specific details about the event. For example, if your mousePressed() method is called, you know the mouse was pressed. But what if you want to know exactly where the mouse was pressed? In other words, what if you want to know the X and Y screen coordinates for where the mouse was pressed?</p>
<p>Or sometimes you might want to register the <em>same</em> listener with <em>multiple</em> objects. An on-screen calculator, for example, has 10 numeric keys, and since they all do the same thing, you might not want to make a separate listener for every single key. Instead, you might register a single listener with each of the 10 keys, and when you get an event (because your event call-back method is called), you can call a method on the event object to find out <em>who</em> the real event source was. In other words, <em>which key sent this event</em>.</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-id00036">
<h5>Sharpen your pencil</h5>
<figure class="informal"><div class="figure">
<img src="Images/pencil.png" alt="image" width="122" height="80"/>
<h6/>
</div></figure>
<p>Each of these widgets (user interface objects) is the source of one or more events. Match the widgets with the events they might cause. Some widgets might be a source of more than one event, and some events can be generated by more than one widget.</p>
<table class="border">
<tbody>
<tr>
<td><strong>Widgets</strong></td>
<td><strong>Event methods</strong></td>
</tr>
<tr>
<td>check box</td>
<td>windowClosing()</td>
</tr>
<tr>
<td>text field</td>
<td>actionPerformed()</td>
</tr>
<tr>
<td>scrolling list</td>
<td>itemStateChanged()</td>
</tr>
<tr>
<td>button</td>
<td>mousePressed()</td>
</tr>
<tr>
<td>dialog box</td>
<td>keyTyped()</td>
</tr>
<tr>
<td>radio button</td>
<td>mouseExited()</td>
</tr>
<tr>
<td>menu item</td>
<td>focusGained()</td>
</tr>
</tbody>
</table>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000039">
<p><strong>How do you KNOW if an object is an event source?</strong></p>
<p><strong>Look in the API.</strong></p>
<p><strong>OK. Look for what?</strong></p>
<p><strong>A method that starts with “add,” ends with “Listener,”  and takes a listener interface argument. If you see:</strong></p>
<p><code>addKeyListener(KeyListener k)</code></p>
<p><strong>you know that a class with this method is a source of KeyEvents. There’s a naming pattern.</strong></p>
</div></aside>
<p><img class="inlineimage" src="Images/arr.png" alt="image" width="60" height="12"/> <strong>Yours to solve.</strong></p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Getting back to graphics..."><div class="sect1" id="getting_back_to_graphicshellip">
<h1>Getting back to graphics...</h1>
<p><a data-type="indexterm" data-primary="drawing 2D graphics" id="idm46038389641168"/><a data-type="indexterm" data-primary="graphics" data-seealso="GUI" id="idm46038389640240"/><a data-type="indexterm" data-primary="GUI" data-secondary="building graphics" id="idm46038389639136"/><a data-type="indexterm" data-primary="GUI" data-secondary="components" id="idm46038389638032"/><a data-type="indexterm" data-primary="images on GUI widget" id="idm46038389636928"/><a data-type="indexterm" data-primary="widgets" id="idm46038389636096"/><a data-type="indexterm" data-primary="widgets" data-secondary="drawing 2D graphics" id="idm46038389635264"/>Now that we know a little about how events work (we’ll learn more later), let’s get back to putting stuff on the screen. We’ll spend a few minutes playing with some fun ways to get graphic, before returning to event handling.</p>
<p><strong>Three ways to put things on your GUI:</strong></p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="images" width="20" height="21"/></span> <strong>Put widgets on a frame</strong></p>
<p>Add buttons, menus, radio buttons, etc.</p>
<p><code><strong>frame.getContentPane().add(myButton);</strong></code></p>
<p>The javax.swing package has more than a dozen widget types.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0471-01.png" alt="image" width="216" height="215"/>
<h6/>
</div></figure>
</li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="images" width="20" height="21"/></span> <strong>Draw 2D graphics on a widget</strong></p>
<p>Use a graphics object to paint shapes.</p>
<p><code><strong>graphics.fillOval(70,70,100,100);</strong></code></p>
<p>You can paint a lot more than boxes and circles; the Java2D API is full of fun, sophisticated graphics methods.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0471-02.png" alt="image" width="552" height="357"/>
<h6/>
</div></figure>
</li>
<li><p><span class="inlineimage"><img src="Images/3.png" alt="images" width="20" height="21"/></span> <strong>Put a JPEG on a widget</strong></p>
<p>You can put your own images on a widget.</p>
<p><code><strong>graphics.drawImage(myPic,10,10,this);</strong></code></p>
<figure class="informal"><div class="figure">
<img src="Images/f0471-03.png" alt="image" width="400" height="331"/>
<h6/>
</div></figure>
</li>
</ul>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Make your own drawing widget"><div class="sect1" id="make_your_own_drawing_widget">
<h1>Make your own drawing widget</h1>
<p><a data-type="indexterm" data-primary="drawing 2D graphics" id="idm46038389614880"/><a data-type="indexterm" data-primary="JPanel.paintComponent()" id="idm46038389613984"/>If you want to put your own graphics on the screen, your best bet is to make your own paintable widget. You plop that widget on the frame, just like a button or any other widget, but when it shows up, it will have your images on it. You can even make those images move, in an animation, or make the colors on the screen change every time you click a button.</p>
<p>It’s a piece of cake.</p>
<p><strong>Make a subclass of JPanel and override one method, paintComponent().</strong></p>
<p>All of your graphics code goes inside the paintComponent() method. Think of the paintComponent() method as the method called by the system to say, “Hey widget, time to paint yourself.” If you want to draw a circle, the paintComponent() method will have code for drawing a circle. When the frame holding your drawing panel is displayed, paintComponent() is called and your circle appears. If the user iconifies/minimizes the window, the JVM knows the frame needs “repair” when it gets de-iconified, so it calls paintComponent() again. Anytime the JVM thinks the display needs refreshing, your paintComponent() method will be called.</p>
<p>One more thing, <strong><em>you never call this method yourself!</em></strong> The argument to this method (a Graphics object) is the actual drawing canvas that gets slapped onto the <em>real</em> display. You can’t get this by yourself; it must be handed to you by the system. You’ll see later, however, that you <em>can</em> ask the system to refresh the display (repaint()), which ultimately leads to paintComponent() being called.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0472-01.png" alt="image" width="396" height="438"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0472-02.png" alt="image" width="884" height="427"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Fun things to do in paintComponent()"><div class="sect1" id="fun_things_to_do_in_paintcomponentleft_p">
<h1>Fun things to do in paintComponent()</h1>
<p><a data-type="indexterm" data-primary="images on GUI widget" id="idm46038389602928"/><a data-type="indexterm" data-primary="JPEG on widget" id="idm46038389601872"/><a data-type="indexterm" data-primary="widgets" data-secondary="images on" id="idm46038389601040"/>Let’s look at a few more things you can do in paintComponent(). The most fun, though, is when you start experimenting yourself. Try playing with the numbers, and check the API for class Graphics (later we’ll see that there’s even <em>more</em> you can do besides what’s in the Graphics class).</p>
<p><strong>Display a JPEG</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0473-01.png" alt="image" width="844" height="443"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0473-02.png" alt="image" width="204" height="203"/>
<h6/>
</div></figure>
<p><strong>Paint a randomly colored circle on a black background</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0473-03.png" alt="image" width="229" height="207"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0473-04.png" alt="image" width="1002" height="467"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Behind every good Graphics reference is a Graphics2D object"><div class="sect1" id="behind_every_good_graphics_reference_is">
<h1>Behind every good Graphics reference is a Graphics<u>2D</u> object</h1>
<p><a data-type="indexterm" data-primary="classes" data-secondary="Graphics2D" id="idm46038389593024"/><a data-type="indexterm" data-primary="Graphics superclass" id="idm46038389591824"/><a data-type="indexterm" data-primary="polymorphism" data-secondary="Graphics superclass" id="idm46038389590992"/><a data-type="indexterm" data-primary="superclass" data-secondary="Graphics" id="idm46038389589888"/>The argument to paintComponent() is declared as type Graphics (java.awt.Graphics).</p>
<p><strong><code>public void paintComponent(<u>Graphics</u> g) { }</code></strong></p>
<p>So the parameter “g” IS-A Graphics object. This means it <em>could</em> be a <em>subclass</em> of Graphics (because of polymorphism). And in fact, it <em>is</em>.</p>
<p><strong><em>The object referenced by the “g” parameter is actually an instance of the</em></strong> Graphics2D <strong><em>class.</em></strong></p>
<p>Why do you care? Because there are things you can do with a Graphics2D reference that you can’t do with a Graphics reference. A Graphics2D object can do more than a Graphics object, and it really is a Graphics2D object lurking behind the Graphics reference.</p>
<p>Remember your polymorphism. The compiler decides which methods you can call based on the reference type, not the object type. If you have a Dog object referenced by an Animal reference variable:</p>
<p><code><strong>Animal a = new Dog();</strong></code></p>
<p>You CANNOT say:</p>
<p><code><strong>a.bark();</strong></code></p>
<p>Even though you know it’s really a Dog back there. The compiler looks at “a,” sees that it’s of type Animal, and finds that there’s no remote control button for bark() in the Animal class. But you can still get the object back to the Dog it really <em>is</em> by saying:</p>
<pre data-type="programlisting"><strong>Dog d = (Dog) a;</strong>
<strong>d.bark();</strong></pre>
<p>So the bottom line with the Graphics object is this:</p>
<p><strong>If you need to use a method from the Graphics2D class, you can’t <em>use</em> the paintComponent parameter (“g”) straight from the method. But you can <em>cast</em> it with a new Graphics2D variable:</strong></p>
<p><code><strong>Graphics2D g2d = (Graphics2D) g;</strong></code></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000040">
<p><strong>Methods you can call on a <code>Graphics</code> reference:</strong></p>
<p>drawImage()</p>
<p>drawLine()</p>
<p>drawPolygon</p>
<p>drawRect()</p>
<p>drawOval()</p>
<p>fillRect()</p>
<p>fillRoundRect()</p>
<p>setColor()</p>
<p><strong>To cast the <code>Graphics2D</code> <em>object</em> to a <code>Graphics2D</code> <em>reference</em>:</strong></p>
<p><code><strong>Graphics2D g2d = (Graphics2D) g;</strong></code></p>
<p><strong>Methods you can call on a <code>Graphics<u>2D</u></code> reference:</strong></p>
<p>fill3DRect()</p>
<p>draw3DRect()</p>
<p>rotate()</p>
<p>scale()</p>
<p>shear()</p>
<p>transform()</p>
<p>setRenderingHints()</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#636466;">(These are not complete method lists; check the API for more)</span></p>
</div>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Because life’s too short to paint the circle a solid color when there’s a gradient blend waiting for you"><div class="sect1" id="because_lifeapostrophes_too_short_to_pai">
<h1>Because life’s too short to paint the circle a solid color when there’s a gradient blend waiting for you</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0475-01.png" alt="image" width="288" height="287"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0475-02.png" alt="image" width="1003" height="500"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0475-03.png" alt="image" width="939" height="397"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="gradient blend, graphics object" id="idm46038389560416"/><strong>Bullet Points</strong></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="events">
<h5>Events</h5>
<ul>
<li><p>To make a GUI, start with a window, usually a JFrame:</p>
<p><code><strong>JFrame frame = new JFrame();</strong></code></p></li>
<li><p>You can add widgets (buttons, text fields, etc.) to the JFrame using:</p>
<p><code><strong>frame.getContentPane().add(button);</strong></code></p></li>
<li><p>Unlike most other components, the JFrame doesn’t let you add to it directly, so you must add to the JFrame’s content pane.</p></li>
<li><p>To make the window (JFrame) display, you must give it a size and tell it to be visible:</p>
<pre data-type="programlisting"><strong>frame.setSize(300,300);</strong>
<strong>frame.setVisible(true);</strong></pre></li>
<li><p>To know when the user clicks a button (or takes some other action on the user interface) you need to listen for a GUI event.</p></li>
<li><p>To listen for an event, you must register your interest with an event source. An event source is the thing (button, check box, etc.) that “fires” an event based on user interaction.</p></li>
<li><p>The listener interface gives the event source a way to call you back, because the interface defines the method(s) the event source will call when an event happens.</p></li>
<li><p>To register for events with a source, call the source’s registration method. Registration methods always take the form of <strong><em>add&lt;EventType&gt;Listener</em></strong>. To register for a button’s ActionEvents, for example, call:</p>
<p><code><strong>button.addActionListener(this);</strong></code></p></li>
<li><p>Implement the listener interface by implementing all of the interface’s event-handling methods. Put your event-handling code in the listener call-back method. For ActionEvents, the method is:</p>
<pre data-type="programlisting"><strong>public void actionPerformed(ActionEvent</strong>
                            <strong>event) {</strong>
  <strong>button.setText("you clicked!");</strong>
<strong>}</strong></pre></li>
<li><p>The event object passed into the event-handler method carries information about the event, including the source of the event.</p></li>
</ul>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="graphics">
<h5>Graphics</h5>
<ul>
<li><p>You can draw 2D graphics directly on to a widget.</p></li>
<li><p>You can draw a .gif or .jpeg directly on to a widget.</p></li>
<li><p>To draw your own graphics (including a .gif or .jpeg), make a subclass of JPanel and override the paintComponent() method.</p></li>
<li><p>The paintComponent() method is called by the GUI system. YOU NEVER CALL IT YOURSELF. The argument to paintComponent() is a Graphics object that gives you a surface to draw on, which will end up on the screen. You cannot construct that object yourself.</p></li>
<li><p>Typical methods to call on a Graphics object (the paintComponent parameter) are:</p>
<pre data-type="programlisting"><strong>g.setColor(Color.blue);</strong>
<strong>g.fillRect(20, 50, 100, 120);</strong></pre></li>
<li><p>To draw a .jpg, construct an Image using:</p>
<p><code><strong>Image image = new ImageIcon("catzilla.jpg").getImage();</strong></code></p>
<p>and draw the image using:</p>
<p><code><strong>g.drawImage(image,3,4,this);</strong></code></p></li>
<li><p>The object referenced by the Graphics parameter to paintComponent() is actually an instance of the Graphics2D class. The Graphics 2D class has a variety of methods including:</p>
<p>fill3DRect(), draw3DRect(), rotate(), scale(), shear(), transform()</p></li>
<li><p>To invoke the Graphics2D methods, you must cast the parameter from a Graphics object to a Graphics2D object:</p>
<p><code><strong>Graphics2D g2d = (Graphics2D) g;</strong></code></p></li>
</ul>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="We can get an event. We can paint graphics. But can we paint graphics when we get an event?"><div class="sect1" id="we_can_get_an_eventdot_we_can_paint_grap">
<h1>We can get an event. We can paint graphics. But can we paint graphics <em>when</em> we get an event?</h1>
<p><a data-type="indexterm" data-primary="event handling" data-secondary="getting graphics" id="idm46038389531792"/>Let’s hook up an event to a change in our drawing panel. We’ll make the circle change colors each time you click the button. Here’s how the program flows:</p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1-circle.png" alt="images" width="23" height="22"/></span> The frame is built with the two widgets (your drawing panel and a button). A listener is created and registered with the button. Then the frame is displayed, and it just waits for the user to click.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0477-01.png" alt="image" width="331" height="373"/>
<h6/>
</div></figure>
</li>
<li><p><span class="inlineimage"><img src="Images/2-circle.png" alt="images" width="23" height="23"/></span> The user clicks the button, and the button creates an event object and calls the listener’s event handler.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0477-02.png" alt="image" width="315" height="225"/>
<h6/>
</div></figure>
</li>
<li><p><span class="inlineimage"><img src="Images/3-circle.png" alt="images" width="20" height="20"/></span> The event handler calls repaint() on the frame. The system calls paintComponent() on the drawing panel.</p></li>
<li><p><span class="inlineimage"><img src="Images/4-circle.png" alt="images" width="20" height="20"/></span> Voilà! A new color is painted because paintComponent() runs again, filling the circle with a random color.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0477-03.png" alt="image" width="242" height="242"/>
<h6/>
</div></figure>
</li>
</ul>
<figure class="informal"><div class="figure">
<img src="Images/f0478-01.png" alt="image" width="471" height="474"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="GUI layouts: putting more than one widget on a frame"><div class="sect1" id="gui_layouts_putting_more_than_one_widget">
<h1>GUI layouts: putting more than one widget on a frame</h1>
<p><a data-type="indexterm" data-primary="BorderLayout manager" id="idm46038389513056"/><a data-type="indexterm" data-primary="GUI" data-secondary="BorderLayout" id="idm46038389512256"/><a data-type="indexterm" data-primary="layout managers" data-secondary="BorderLayout" id="idm46038389511120"/>We cover GUI layouts in the <em>next</em> chapter, but we’ll do a quickie lesson here to get you going. By default, a frame has five regions you can add to. You can add only <em>one</em> thing to each region of a frame, but don’t panic! That one thing might be a panel that holds three other things including a panel that holds two more things and...you get the idea. In fact, we were “cheating” when we added a button to the frame using:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0478-02.png" alt="image" width="967" height="551"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-id00037">
<h5>Sharpen your pencil</h5>
<figure class="informal"><div class="figure">
<img src="Images/pencil.png" alt="image" width="122" height="80"/>
<h6/>
</div></figure>
<p>Given the pictures in <a data-type="xref" href="#we_can_get_an_eventdot_we_can_paint_grap">“We can get an event. We can paint graphics. But can we paint graphics <em>when</em> we get an event?”</a>, write the code that adds the button and the panel to the frame.</p>
<p><img class="inlineimage" src="Images/arr.png" alt="image" width="60" height="12"/> <strong>Yours to solve.</strong></p>
</div></aside>
<p><strong>The circle changes color each time you click the button.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0479-01.png" alt="image" width="313" height="387"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0479-02.png" alt="image" width="946" height="760"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0479-03.png" alt="image" width="882" height="173"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Let’s try it with TWO buttons"><div class="sect1" id="letapostrophes_try_it_with_two_buttons">
<h1>Let’s try it with TWO buttons</h1>
<p>The south button will act as it does now, simply calling repaint on the frame. The second button (which we’ll stick in the east region) will change the text on a label. (A label is just text on the screen.)</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="So now we need FOUR widgets"><div class="sect1" id="so_now_we_need_four_widgets">
<h1>So now we need FOUR widgets</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0480-01.png" alt="image" width="571" height="392"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="And we need to get TWO events"><div class="sect1" id="and_we_need_to_get_two_events">
<h1>And we need to get TWO events</h1>
<p>Uh-oh.</p>
<p>Is that even possible? How do you get <em>two</em> events when you have only <em>one</em> actionPerformed() method?</p>
<figure class="informal"><div class="figure">
<img src="Images/f0480-02.png" alt="image" width="811" height="492"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="How do you get action events for two different buttons when each button needs to do something different?"><div class="sect2" id="how_do_you_get_action_events_for_two_dif">
<h2>How do you get action events for two different buttons when each button needs to do something different?</h2>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000041">
<ul style="list-style-type:none">
<li><p><a data-type="indexterm" data-primary="ActionEvent" id="idm46038389487072"/><a data-type="indexterm" data-primary="ActionListener" id="idm46038389487584"/><a data-type="indexterm" data-primary="actionPerformed()" id="idm46038389483264"/><a data-type="indexterm" data-primary="buttons, GUI" data-secondary="ActionEvent" id="idm46038389482432"/><a data-type="indexterm" data-primary="listener" id="idm46038389481328"/><a data-type="indexterm" data-primary="OO (object-oriented) development" data-secondary="event handling" id="idm46038389480496"/><span class="inlineimage"><img src="Images/1.png" alt="images" width="20" height="21"/></span> <strong><em>Option One</em> Implement <u>two</u> actionPerformed() methods</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0481-01.png" alt="image" width="778" height="240"/>
<h6/>
</div></figure>
</li>
</ul>
<p><strong>Flaw: You can’t!</strong> You can’t implement the same method twice in a Java class. It won’t compile.  And even if you <em>could</em>, how would the event source know <em>which</em> of the two methods to call?</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000042">
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/2.png" alt="images" width="20" height="21"/></span> <strong><em>Option Two</em> Register the same listener with <u>both</u> buttons.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0481-02.png" alt="image" width="710" height="441"/>
<h6/>
</div></figure>
</li>
</ul>
<p><strong>Flaw: this does work, but in most cases it’s not very OO.</strong> One event handler doing many different things means that you have a single method doing many different things. If you need to change how <em>one</em> source is handled, you have to mess with <em>everybody’s</em> event handler. Sometimes it <em>is</em> a good solution, but usually it hurts maintainability and extensibility.</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000043">
<ul style="list-style-type:none">
<li><p><a data-type="indexterm" data-primary="ActionListener" id="idm46038389462048"/><a data-type="indexterm" data-primary="actionPerformed()" id="idm46038389460976"/><a data-type="indexterm" data-primary="listener" data-secondary="ActionListener" id="idm46038389460144"/><span class="inlineimage"><img src="Images/3.png" alt="images" width="20" height="21"/></span> <strong><em>Option Three</em> Create two <u>separate</u> ActionListener classes</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0482-01.png" alt="image" width="717" height="518"/>
<h6/>
</div></figure>
</li>
</ul>
<p><strong>Flaw: these classes won’t have access to the variables they need to act on, “frame” and “label.”</strong> You could fix it, but you’d have to give each of the listener classes a reference to the main GUI class, so that inside the actionPerformed() methods the listener could use the GUI class reference to access the variables of the GUI class.  But that’s breaking encapsulation, so we’d probably need to make getter methods for the GUI widgets (getFrame(), getLabel(), etc.).  And you’d probably need to add a constructor to the listener class so that you can pass the GUI reference to the listener at the time the listener is instantiated. And, well, it gets messier and more complicated.</p>
<p><strong><em>There has got to be a better way!</em></strong></p>
</div></aside>
<figure class="informal"><div class="figure">
<img src="Images/f0483-01.png" alt="image" width="802" height="811"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Inner class to the rescue!"><div class="sect1" id="inner_class_to_the_rescueexclamation_mar">
<h1>Inner class to the rescue!</h1>
<p><a data-type="indexterm" data-primary="GUI" data-secondary="inner classes" id="idm46038389702224"/><a data-type="indexterm" data-primary="inner classes" id="idm46038389454464"/><a data-type="indexterm" data-primary="inner classes" data-secondary="relationship to outer class" id="idm46038389446944"/><a data-type="indexterm" data-primary="outer class, relationship to inner class" id="idm46038389445968"/>You <em>can</em> have one class nested inside another. It’s easy. Just make sure that the definition for the inner class is <em>inside</em> the curly braces of the outer class.</p>
<p><strong>Simple inner class:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0484-01.png" alt="image" width="528" height="238"/>
<h6/>
</div></figure>
<p>An inner class gets a special pass to use the outer class’s stuff. <em>Even the private stuff.</em> And the inner class can use those private variables and methods of the outer class as if the variables and members were defined in the inner class. That’s what’s so handy about inner classes—they have most of the benefits of a normal class, but with special access rights.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000044">
<p>An inner class can use all the methods and variables of the outer class, <span style="color:#bababa">even the private ones</span>.</p>
<p>The inner class gets to use those variables and methods just as if the methods and variables were declared within the inner class.</p>
</div></aside>
<p><strong>Inner class using an outer class variable</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0484-02.png" alt="image" width="515" height="267"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="An inner class instance must be tied to an outer class instance*"><div class="sect1" id="an_inner_class_instance_must_be_tied_to">
<h1>An <u>inner</u> class instance must be tied to an <u>outer</u> class instance*</h1>
<p><a data-type="indexterm" data-primary="instances, inner and outer class" id="idm46038389433488"/>Remember, when we talk about an inner <em>class</em> accessing something in the outer class, we’re really talking about an <em>instance</em> of the inner class accessing something in an <em>instance</em> of the outer class. But <em>which</em> instance?</p>
<p>Can <em>any</em> arbitrary instance of the inner class access the methods and variables of <em>any</em> instance of the outer class? <strong>No!</strong></p>
<p><em>An <strong>inner</strong> object must be tied to a specific <strong>outer</strong> object on the heap.</em></p>
<figure class="informal"><div class="figure">
<img src="Images/f0485-03.png" alt="image" width="587" height="695"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000045">
<p><strong>An inner object shares a special bond with an outer object.</strong> <span class="inlineimage"><img src="Images/f0485-01b.png" alt="images" width="29" height="32"/></span></p>
</div></aside>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="images" width="20" height="21"/></span> Make an instance of the <u>outer</u> class</p>
<figure class="informal"><div class="figure">
<img src="Images/f0485-01.png" alt="image" width="133" height="134"/>
<h6/>
</div></figure>
</li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="images" width="20" height="21"/></span> Make an instance of the <u>inner</u> class, by using the instance of the outer class.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0485-02.png" alt="image" width="132" height="137"/>
<h6/>
</div></figure>
</li>
<li><p><span class="inlineimage"><img src="Images/3.png" alt="images" width="20" height="21"/></span> The outer and inner objects are now intimately linked.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0485-04.png" alt="image" width="426" height="198"/>
<h6/>
</div></figure>
</li>
</ul>
<p>* There’s an exception to this, for a very special case—an inner class defined within a static method. But we’re not going there, and you might go your entire Java life without ever encountering one of these.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="How to make an instance of an inner class"><div class="sect1" id="how_to_make_an_instance_of_an_inner_clas">
<h1>How to make an instance of an inner class</h1>
<p>If you instantiate an inner class from code <em>within</em> an outer class, the instance of the outer class is the one that the inner object will “bond” with. For example, if code within a method instantiates the inner class, the inner object will bond to the instance whose method is running.</p>
<p>Code in an outer class can instantiate one of its own inner classes, in exactly the same way it instantiates any other class...<strong><code>new MyInner()</code></strong>.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0486-01.png" alt="image" width="630" height="434"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0486-02.png" alt="image" width="280" height="240"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0486-03.png" alt="image" width="285" height="412"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sidebar">
<h5>Sidebar</h5>
<p>You <em>can</em> instantiate an inner instance from code running <em>outside</em> the outer class, but you have to use a special syntax. Chances are you’ll go through your entire Java life and never need to make an inner class from outside, but just in case you’re interested...</p>
<pre data-type="programlisting"><strong>class Foo {</strong>
  <strong>public static void main (String[] args) {</strong>
    <strong>MyOuter outerObj = new MyOuter();</strong>
    <strong>MyOuter.MyInner innerObj = outerObj.new MyInner();</strong>
  <strong>}</strong>
<strong>}</strong></pre>
</div></aside>
<p><a data-type="indexterm" data-primary="buttons, GUI" data-secondary="inner class two-button code" id="idm46038389397040"/><a data-type="indexterm" data-primary="inner classes" data-secondary="two-button code" id="idm46038389395968"/><strong>Now we can get the two-button code working</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0487-01.png" alt="image" width="1011" height="1134"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0487-02.png" alt="image" width="492" height="394"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Java Exposed"><div class="sect2" id="java_exposed-id00003">
<h2>Java Exposed</h2>
<figure class="informal"><div class="figure">
<img src="Images/f0488-01.png" alt="image" width="150" height="128"/>
<h6/>
</div></figure>
<p><strong>This week’s interview: Instance of an Inner Class</strong></p>
<p><strong>HeadFirst:</strong> What makes inner classes important?</p>
<p><strong>Inner object:</strong> Where do I start? We give you a chance to implement the same interface more than once in a class. Remember, you can’t implement a method more than once in a normal Java class. But using <em>inner</em> classes, each inner class can implement the <em>same</em> interface, so you can have all these <em>different</em> implementations of the very same interface methods.</p>
<p><strong>HeadFirst:</strong> <em>Why would you ever</em> want to implement the same method twice?</p>
<p><strong>Inner object:</strong> <em>Let’s revisit GUI event handlers. Think about it...if you want</em> three <em>buttons to each have a different event behavior, then use</em> three inner classes, all implementing ActionListener—which means each class gets to implement its own actionPerformed method.</p>
<p><strong>HeadFirst:</strong> So are event handlers the only reason to use inner classes?</p>
<p><strong>Inner object:</strong> <em>Oh, gosh no. Event handlers are just an obvious example. Anytime you need a separate class but still want that class to behave as if it were part of</em> another <em>class, an inner class is the best—and sometimes</em> only—way to do it.</p>
<p><strong>HeadFirst:</strong> <em>I’m still confused here. If you want the inner class to</em> behave <em>like it belongs to the outer class, why have a separate class in the first place? Why wouldn’t the inner class code just be</em> in the outer class in the first place?</p>
<p><strong>Inner object:</strong> <em>I just</em> gave <em>you one scenario, where you need more than one implementation of an interface. But even when you’re not using interfaces, you might need two different</em> classes <em>because those classes represent two different</em> things. It’s good OO.</p>
<p><strong>HeadFirst:</strong> <em>Whoa. Hold on here. I thought a big part of OO design is about reuse and maintenance. You know, the idea that if you have two separate classes, they can each be modified and used independently, as opposed to stuffing it all into one class yada yada yada. But with an</em> inner <em>class, you’re still just working with one</em> real class in the end, right? The enclosing class is the only one that’s reusable and separate from everybody else. Inner classes aren’t exactly reusable. In fact, I’ve heard them called “Reuseless—useless over and over again.”</p>
<p><strong>Inner object:</strong> Yes, it’s true that the inner class is not <em>as</em> reusable, in fact sometimes not reusable at all, because it’s intimately tied to the instance variables and methods of the outer class. But it—</p>
<p><strong>HeadFirst:</strong> —which only proves my point! If they’re not reusable, why bother with a separate class? I mean, other than the interface issue, which sounds like a workaround to me.</p>
<p><strong>Inner object:</strong> As I was saying, you need to think about IS-A and polymorphism.</p>
<p><strong>HeadFirst:</strong> OK. And I’m thinking about them because...</p>
<p><strong>Inner object:</strong> <em>Because the outer and inner classes might need to pass</em> different <em>IS-A tests! Let’s start with the polymorphic GUI listener example. What’s the declared argument type for the button’s listener registration method? In other words, if you go to the API and check, what kind of</em> thing (class or interface type) do you have to pass to the addActionListener() method?</p>
<p><strong>HeadFirst:</strong> You have to pass a listener. Something that implements a particular listener interface, in this case ActionListener. Yeah, we know all this. What’s your point?</p>
<p><strong>Inner object:</strong> <em>My point is that polymorphically, you have a method that takes only one particular</em> type<em>. Something that passes the IS-A test for ActionListener. But—and here’s the big thing—what if your class needs to be an IS-A of something that’s a</em> class type rather than an interface?</p>
<p><strong>HeadFirst:</strong> <em>Wouldn’t you have your class just</em> extend the class you need to be a part of? Isn’t that the whole point of how subclassing works? If B is a subclass of A, then anywhere an A is expected a B can be used. The whole pass-a-Dog-where-an-Animal-is-the-declared-type thing.</p>
<p><strong>Inner object:</strong> Yes! Bingo! So now what happens if you need to pass the IS-A test for two different classes? Classes that aren’t in the same inheritance hierarchy?</p>
<p><strong>HeadFirst:</strong> <em>Oh, well you just...hmmm. I think I’m getting it. You can always</em> implement <em>more than one interface, but you can</em> extend <em>only</em> one <em>class. You can be only one kind of IS-A when it comes to</em> class types.</p>
<p><strong>Inner object:</strong> <em>Well done! Yes, you can’t be both a Dog and a Button. But if you’re a Dog that needs to sometimes be a Button (in order to pass yourself to methods that take a Button), the Dog class (which extends Animal so it can’t extend Button) can have an</em> inner class that acts on the Dog’s behalf as a Button, by extending Button, and thus wherever a Button is required, the Dog can pass his inner Button instead of himself. In other words, instead of saying x.takeButton(this), the Dog object calls x.takeButton(new MyInnerButton()).</p>
<p><strong>HeadFirst:</strong> Can I get a clear example?</p>
<p><strong>Inner object:</strong> Remember the drawing panel we used, where we made our own subclass of JPanel? Right now, that class is a separate, non-inner, class. And that’s fine, because the class doesn’t need special access to the instance variables of the main GUI. But what if it did? What if we’re doing an animation on that panel, and it’s getting its coordinates from the main application (say, based on something the user does elsewhere in the GUI). In that case, if we make the drawing panel an inner class, the drawing panel class gets to be a subclass of JPanel, while the outer class is still free to be a subclass of something else.</p>
<p><strong>HeadFirst:</strong> Yes, I see! And the drawing panel isn’t reusable enough to be a separate class anyway, since what it’s actually painting is specific to this one GUI application.</p>
<p><strong>Inner object:</strong> Yes! You’ve got it!</p>
<p><strong>HeadFirst:</strong> <em>Good. Then we can move on to the nature of the</em> relationship between you and the outer instance.</p>
<p><strong>Inner object:</strong> What is it with you people? Not enough sordid gossip in a serious topic like polymorphism?</p>
<p><strong>HeadFirst:</strong> Hey, you have no idea how much the public is willing to pay for some good old tabloid dirt. So, someone creates you, and you become instantly bonded to the outer object, is that right?</p>
<p><strong>Inner object:</strong> Yes, that’s right.</p>
<p><strong>HeadFirst:</strong> What about the outer object? Can it be associated with any other inner objects?</p>
<p><strong>Inner object:</strong> <em>So now we have it. This is what you</em> really <em>wanted. Yes, yes. My so-called</em> “mate” can have as many inner objects as it wants.</p>
<p><strong>HeadFirst:</strong> Is that like, serial monogamy? Or can it have them all at the same time?</p>
<p><strong>Inner object:</strong> All at the same time. There. Satisfied?</p>
<p><strong>HeadFirst:</strong> <em>Well, it does make sense. And let’s not forget, it was</em> you extolling the virtues of “multiple implementations of the same interface.” So it makes sense that if the outer class has three buttons, it would need three different inner classes (and thus three different inner class objects) to handle the events.</p>
<p><strong>Inner objects:</strong> You got it!</p>
<p><strong>HeadFirst:</strong> One more question. I’ve heard that when lambdas came along, you were almost put out of a job?</p>
<p><strong>Inner objects:</strong> Ouch, that really hurts! Okay, full disclosure, there are many cases for which a lambda is an easier to read, more concise way to do what I do. But inner classes have been around for a long time, and you’re sure to encounter us in older code. Plus, those pesky lambdas aren’t better at everything..</p>
<figure class="informal"><div class="figure">
<img src="Images/f0489-01.png" alt="image" width="434" height="564"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0490-01.png" alt="image" width="746" height="397"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Lambdas to the rescue! (again)"><div class="sect1" id="lambdas_to_the_rescueexclamation_mark_le">
<h1>Lambdas to the rescue! (again)</h1>
<p><a data-type="indexterm" data-primary="inner classes" data-secondary="lambda expressions with" id="idm46038389343808"/><a data-type="indexterm" data-primary="lambda expressions" data-secondary="replacing inner class with" id="idm46038389342944"/>He’s not wrong! One way to interpret the two highlighted lines of code would be:</p>
<p>“When the <code>labelButton</code> <em>ActionListener gets an event,</em> <code>setText("Ouch");</code>”</p>
<p>Not only are those two ideas separated from each other in the code, the inner class takes FIVE lines of code to invoke the setText method. And of course, everything we’ve said about the labelButton code is also true about the colorButton code.</p>
<p>Remember a few pages back we said that in order to implement the ActionListener interface you had provide code for its actionPerformed method? Hmmm...does that ring any bells?</p>
<figure class="informal"><div class="figure">
<img src="Images/f0490-02.png" alt="image" width="900" height="924"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="ActionListener is a Functional Interface"><div class="sect1" id="actionlistener_is_a_functional_interface">
<h1>ActionListener is a Functional Interface</h1>
<p><a data-type="indexterm" data-primary="ActionListener" id="idm46038389335072"/><a data-type="indexterm" data-primary="interfaces" data-secondary="functional interface" id="idm46038389334144"/><a data-type="indexterm" data-primary="listener" data-secondary="ActionListener" id="idm46038389333040"/><strong>Remember that a lambda provides an implementation for a functional interface’s <em>one and only</em> abstract method.</strong></p>
<p>Since ActionListener is a functional interface, you can replace the inner classes we saw on the previous page with lambda expressions.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0491-01.png" alt="image" width="1015" height="750"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Lambdas, clearer and more concise"><div class="sect1" id="lambdascomma_clearer_and_more_concise">
<h1>Lambdas, clearer and more concise</h1>
<p>Well, maybe not quite yet, but once you get used to reading lambdas, we’re pretty sure you’ll agree that they make your code clearer.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Using an inner class for animation"><div class="sect1" id="using_an_inner_class_for_animation">
<h1>Using an inner class for animation</h1>
<p><a data-type="indexterm" data-primary="animation" id="idm46038389325472"/><a data-type="indexterm" data-primary="repainting objects, GUI" id="idm46038389323936"/>We saw why inner classes are handy for event listeners, because you get to implement the same event-handling method more than once. But now we’ll look at how useful an inner class is when used as a subclass of something the outer class doesn’t extend. In other words, when the outer class and inner class are in different inheritance trees!</p>
<p>Our goal is to make a simple animation, where the circle moves across the screen from the upper left down to the lower right.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0492-01.png" alt="image" width="479" height="238"/>
<h6/>
</div></figure>
<p><strong>How simple animation works</strong></p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="images" width="20" height="21"/></span> Paint an object at a particular x and y coordinate.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0492-02.png" alt="image" width="356" height="93"/>
<h6/>
</div></figure>
</li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="images" width="20" height="21"/></span> Repaint the object at a <u>different</u> x and y coordinate.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0492-03.png" alt="image" width="382" height="155"/>
<h6/>
</div></figure>
</li>
<li><p><span class="inlineimage"><img src="Images/3.png" alt="images" width="20" height="21"/></span> Repeat the previous step with changing x and y values for as long as the animation is supposed to continue.</p></li>
</ul>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00039">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: Why are we learning about animation here? I doubt if I’m going to be making games.</strong></p>
<p><strong>A:</strong> You might not be making games, but you might be creating simulations where things change over time to show the results of a process. Or you might be building a visualization tool that, for example, updates a graphic to show how much memory a program is using or to show you how much traffic is coming through your load-balancing server. Anything that needs to take a set of continuously changing numbers and translate them into something useful for getting information out of the numbers.</p>
<p>Doesn’t that all sound business-like? That’s just the “official justification,” of course. The real reason we’re covering it here is just because it’s a simple way to demonstrate another use of inner classes. (And because we just <em>like</em> animation.)</p>
</div></aside>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Sharpen Your Pencil" id="idm46038392172640"/><strong>What we <u>really</u> want is something like...</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0493-01.png" alt="image" width="907" height="249"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-id00038">
<h5>Sharpen your pencil</h5>
<figure class="informal"><div class="figure">
<img src="Images/pencil.png" alt="image" width="122" height="80"/>
<h6/>
</div></figure>
<p><img class="inlineimage" src="Images/arr.png" alt="image" width="60" height="12"/> <strong>Answers in <a data-type="xref" href="#pg494zz">???</a>.</strong></p>
<p><strong>But where do we get the new x and y coordinates?</strong></p>
<p><strong>And who calls repaint()?</strong></p>
<p>See if you can <strong>design a simple solution</strong> to get the ball to animate from the top left of the drawing panel down to the bottom right.  Our answer is on the next page, so don’t turn this page until you’re done!</p>
<p>Big Huge Hint: make the drawing panel an inner class.</p>
<p>Another Hint: don’t put any kind of repeat loop in the paintComponent() method.</p>
<p><strong>Write your ideas (or the code) here:</strong></p>
</div></aside>
<p id="pg494zz"><strong>The complete simple animation code</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0494-01.png" alt="image" width="970" height="982"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="JPanel.paintComponent()" id="idm46038389286784"/><strong>Did it work?</strong></p>
<p>You might not have got the smooth animation that you expected.</p>
<p>What did we do wrong?</p>
<p>There’s one little flaw in the paintComponent() method.</p>
<p><strong>We need to <u>erase</u> what was already there! Or we might get trails.</strong></p>
<p>To fix it, all we have to do is fill in the entire panel with the background color, before painting the circle each time. The code below adds two lines at the start of the method: one to set the color to white (the background color of the drawing panel) and the other to fill the entire panel rectangle with that color. In English, the code below says, “Fill a rectangle starting at x and y of 0 (0 pixels from the left and 0 pixels from the top) and make it as wide and as high as the panel is currently.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0495-01.png" alt="image" width="416" height="254"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0495-02.png" alt="image" width="589" height="166"/>
<h6/>
</div></figure>
<p><img class="inlineimage" src="Images/arr.png" alt="image" width="60" height="12"/> <strong>Yours to solve.</strong></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil_left_parenthesisopti">
<h5>Sharpen your pencil (optional, just for fun)</h5>
<figure class="informal"><div class="figure">
<img src="Images/f0495-03.png" alt="image" width="122" height="123"/>
<h6/>
</div></figure>
<p>What changes would you make to the x and y coordinates to produce the animations below?</p>
<p>(Assume the first example moves in 3-pixel increments.)</p>
<figure class="informal"><div class="figure">
<img src="Images/f0495-04.png" alt="image" width="942" height="361"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Code Kitchen"><div class="sect1" id="code_kitchen-id00001">
<h1>Code Kitchen</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0496-01.png" alt="image" width="1200" height="402"/>
<h6/>
</div></figure>
<blockquote>
<p><a data-type="indexterm" data-primary="Code Kitchens" data-secondary="music with graphics" id="idm46038389260592"/><a data-type="indexterm" data-primary="music video" id="idm46038389259312"/><strong>Let’s make a music video. We’ll use Java-generated random graphics that keep time with the music beats.</strong></p>
<p><strong>Along the way we’ll register (and listen for) a new kind of non-GUI event, triggered by the music itself.</strong></p>
</blockquote>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#636466;">Remember, this part is all optional. But we think it’s good for you. And you’ll like it. And you can use it to impress people.</span></p>
<p><span style="color:#636466;">(OK, sure, it might work only on people who are really easy to impress, but still....)</span></p>
</div>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Listening for a non-GUI event"><div class="sect1" id="listening_for_a_non-gui_event">
<h1>Listening for a non-GUI event</h1>
<p><a data-type="indexterm" data-primary="ControllerEvent" id="idm46038389266208"/><a data-type="indexterm" data-primary="event handling" data-secondary="MIDIEvents" id="idm46038389251648"/><a data-type="indexterm" data-primary="listener" data-secondary="non-GUI event" id="idm46038389250544"/><a data-type="indexterm" data-primary="MIDIEvents" id="idm46038389249440"/>OK, maybe not a music video, but we <em>will</em> make a program that draws random graphics on the screen with the beat of the music. In a nutshell, the program listens for the beat of the music and draws a random graphic rectangle with each beat.</p>
<p>That brings up some new issues for us. So far, we’ve listened for only GUI events, but now we need to listen for a particular kind of MIDI event. Turns out, listening for a non-GUI event is just like listening for GUI events: you implement a listener interface, register the listener with an event source, and then sit back and wait for the event source to call your event-handler method (the method defined in the listener interface).</p>
<p>The simplest way to listen for the beat of the music would be to register and listen for the actual MIDI events so that whenever the sequencer gets the event, our code will get it too and can draw the graphic. But...there’s a problem. A bug, actually, that won’t let us listen for the MIDI events <em>we’re</em> making (the ones for NOTE ON).</p>
<p>So we have to do a little workaround. There is another type of MIDI event we can listen for, called a ControllerEvent. Our solution is to register for ControllerEvents and then make sure that for every NOTE ON event, there’s a matching ControllerEvent fired at the same “beat.” How do we make sure the ControllerEvent is fired at the same time? We add it to the track just like the other events! In other words, our music sequence goes like this:</p>
<p>BEAT 1 - NOTE ON, CONTROLLER EVENT</p>
<p>BEAT 2 - NOTE OFF</p>
<p>BEAT 3 - NOTE ON, CONTROLLER EVENT</p>
<p>BEAT 4 - NOTE OFF</p>
<p>and so on.</p>
<p>Before we dive into the full program, though, let’s make it a little easier to make and add MIDI messages/events since in <em>this</em> program, we’re gonna make a lot of them.</p>
<p><strong>What the music art program needs to do:</strong></p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="images" width="20" height="21"/></span> Make a series of MIDI messages/events to play random notes on a piano (or whatever instrument you choose).</p></li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="images" width="20" height="21"/></span> Register a listener for the events.</p></li>
<li><p><span class="inlineimage"><img src="Images/3.png" alt="images" width="20" height="21"/></span> Start the sequencer playing.</p></li>
<li><p><span class="inlineimage"><img src="Images/4.png" alt="images" width="20" height="20"/></span> Each time the listener’s event handler method is called, draw a random rectangle on the drawing panel, and call repaint.</p></li>
</ul>
<p><strong>We’ll build it in three iterations:</strong></p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="images" width="20" height="21"/></span> Version One: Code that simplifies making and adding MIDI events, since we’ll be making a lot of them.</p></li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="images" width="20" height="21"/></span> Version Two: Register and listen for the events, but without graphics. Prints a message at the command line with each beat.</p></li>
<li><p><span class="inlineimage"><img src="Images/3.png" alt="images" width="20" height="21"/></span> Version Three: The real deal. Adds graphics to version two.</p></li>
</ul>
</div></section>
<section data-type="sect1" data-pdf-bookmark="An easier way to make messages/events"><div class="sect1" id="an_easier_way_to_make_messagessoliduseve">
<h1>An easier way to make messages/events</h1>
<p><a data-type="indexterm" data-primary="event handling" data-secondary="static methods" id="idm46038389219568"/><a data-type="indexterm" data-primary="Message, MIDIEvent" id="idm46038389209984"/><a data-type="indexterm" data-primary="ShortMessage.setMessage()" id="idm46038389209248"/><a data-type="indexterm" data-primary="static methods" data-secondary="event handling" id="idm46038389208512"/>Right now, making and adding messages and events to a track is tedious. For each message, we have to make the message instance (in this case, ShortMessage), call setMessage(), make a MidiEvent for the message, and add the event to the track. In the previous chapter’s code, we went through each step for every message. That means eight lines of code just to make a note play and then stop playing! Four lines to add a NOTE ON event, and four lines to add a NOTE OFF event.</p>
<pre data-type="programlisting"><strong>ShortMessage msg1 = new ShortMessage();</strong>
<strong>msg1.setMessage(NOTE_ON, 1, 44, 100);</strong>
<strong>MidiEvent noteOn = new MidiEvent(msg1, 1);</strong>
<strong>track.add(noteOn);</strong>

<strong>ShortMessage msg2 = new ShortMessage();</strong>
<strong>msg2.setMessage(NOTE_OFF, 1, 44, 100);</strong>
<strong>MidiEvent noteOff = new MidiEvent(msg2, 16);</strong>
<strong>track.add(noteOff);</strong></pre>
<p><strong>Things that have to happen for each event:</strong></p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="images" width="20" height="21"/></span> Make a message instance</p>
<p><code><strong>ShortMessage msg = new ShortMessage();</strong></code></p></li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="images" width="20" height="21"/></span> Call setMessage() with the instructions</p>
<p><code><strong>msg.setMessage(NOTE_ON, 1, instrument, 0);</strong></code></p></li>
<li><p><span class="inlineimage"><img src="Images/3.png" alt="images" width="20" height="21"/></span> Make a MidiEvent instance for the message</p>
<p><code><strong>MidiEvent noteOn = new MidiEvent(msg, 1);</strong></code></p></li>
<li><p><span class="inlineimage"><img src="Images/4.png" alt="images" width="20" height="20"/></span> Add the event to the track</p>
<p><code><strong>track.add(noteOn);</strong></code></p></li>
</ul>
<p><strong>Let’s build a static utility method that makes a message and returns a MidiEvent</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0498-02.png" alt="image" width="982" height="436"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Version One: using the new static makeEvent() method"><div class="sect1" id="version_one_using_the_new_static_makeeve">
<h1>Version One: using the new static makeEvent() method</h1>
<p><a data-type="indexterm" data-primary="makeEvent()" id="idm46038389174832"/>There’s no event handling or graphics here, just a sequence of 15 notes that go up the scale. The point of this code is simply to learn how to use our new makeEvent() method. The code for the next two versions is much smaller and simpler thanks to this method.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0499-01.png" alt="image" width="1030" height="954"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Version Two: registering and getting ControllerEvents"><div class="sect1" id="version_two_registering_and_getting_cont">
<h1>Version Two: registering and getting ControllerEvents</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0500-01.png" alt="image" width="1006" height="1094"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><a data-type="indexterm" data-primary="ControllerEvent" id="idm46038389169728"/><span style="color:#636466;"><strong>Code that’s different from the previous version is highlighted in gray (and we’ve moved the code out of the main() method into its own go() method).</strong></span></p>
</div>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Version Three: drawing graphics in time with the music"><div class="sect1" id="version_three_drawing_graphics_in_time_w">
<h1>Version Three: drawing graphics in time with the music</h1>
<p><a data-type="indexterm" data-primary="drawing 2D graphics" id="idm46038389165840"/><a data-type="indexterm" data-primary="inner classes" data-secondary="drawing 2D graphics" id="idm46038389165216"/>This final version builds on Version Two by adding the GUI parts. We build a frame and add a drawing panel to it, and each time we get an event, we draw a new rectangle and repaint the screen. The only other change from Version Two is that the notes play randomly as opposed to simply moving up the scale.</p>
<p>The most important change to the code (besides building a simple GUI) is that we make the drawing panel implement the ControllerEventListener rather than the program itself. So when the drawing panel (an inner class) gets the event, it knows how to take care of itself by drawing the rectangle.</p>
<p>Complete code for this version is on the next page.</p>
<p><strong>The drawing panel inner class:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0501-01.png" alt="image" width="907" height="685"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Sharpen Your Pencil" id="idm46038389160144"/><img class="inlineimage" src="Images/arr.png" alt="image" width="60" height="12"/> <strong>Yours to solve.</strong></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-id00039">
<h5>Sharpen your pencil</h5>
<figure class="informal"><div class="figure">
<img src="Images/pencil.png" alt="image" width="122" height="80"/>
<h6/>
</div></figure>
<p>This is the complete code listing for Version Three. It builds directly on Version Two. Try to annotate it yourself, without looking at the previous pages.</p>
</div></aside>
<pre data-type="programlisting"><strong>import javax.sound.midi.*;</strong>
<strong>import javax.swing.*;</strong>
<strong>import java.awt.*;</strong>
<strong>import java.util.Random;</strong>

<strong>import static javax.sound.midi.ShortMessage.*;</strong>

<strong>public class MiniMusicPlayer3 {</strong>
  <strong>private MyDrawPanel panel;</strong>
  <strong>private Random random = new Random();</strong>

  <strong>public static void main(String[] args) {</strong>
    <strong>MiniMusicPlayer3 mini = new MiniMusicPlayer3();</strong>
    <strong>mini.go();</strong>
  <strong>}</strong>

  <strong>public void setUpGui() {</strong>
    <strong>JFrame frame = new JFrame("My First Music Video");</strong>
    <strong>panel = new MyDrawPanel();</strong>
    <strong>frame.setContentPane(panel);</strong>
    <strong>frame.setBounds(30, 30, 300, 300);</strong>
    <strong>frame.setVisible(true);</strong>
  <strong>}</strong>

  <strong>public void go() {</strong>
    <strong>setUpGui();</strong>

    <strong>try {</strong>
      <strong>Sequencer sequencer = MidiSystem.getSequencer();</strong>
      <strong>sequencer.open();</strong>
      <strong>sequencer.addControllerEventListener(panel, new int[]{127});</strong>
      <strong>Sequence seq = new Sequence(Sequence.PPQ, 4);</strong>
      <strong>Track track = seq.createTrack();</strong>

      <strong>int note;</strong>
      <strong>for (int i = 0; i &lt; 60; i += 4) {</strong>
        <strong>note = random.nextInt(50) + 1;</strong>
        <strong>track.add(makeEvent(NOTE_ON, 1, note, 100, i));</strong>
        <strong>track.add(makeEvent(CONTROL_CHANGE, 1, 127, 0, i));</strong>
        <strong>track.add(makeEvent(NOTE_OFF, 1, note, 100, i + 2));</strong>
      <strong>}</strong>

      <strong>sequencer.setSequence(seq);</strong>
      <strong>sequencer.start();</strong>
      <strong>sequencer.setTempoInBPM(120);</strong>
    <strong>} catch (Exception ex) {</strong>
      <strong>ex.printStackTrace();</strong>
    <strong>}</strong>
  <strong>}</strong>
<strong>public static MidiEvent makeEvent(int cmd, int chnl, int one, int two, int tick) {</strong>
    <strong>MidiEvent event = null;</strong>
    <strong>try {</strong>
      <strong>ShortMessage msg = new ShortMessage();</strong>
      <strong>msg.setMessage(cmd, chnl, one, two);</strong>
      <strong>event = new MidiEvent(msg, tick);</strong>
    <strong>} catch (Exception e) {</strong>
      <strong>e.printStackTrace();</strong>
    <strong>}</strong>
    <strong>return event;</strong>
<strong>}</strong>

<strong>class MyDrawPanel extends JPanel implements ControllerEventListener {</strong>
    <strong>private boolean msg = false;</strong>

    <strong>public void controlChange(ShortMessage event) {</strong>
      <strong>msg = true;</strong>
      <strong>repaint();</strong>
    <strong>}</strong>

    <strong>public void paintComponent(Graphics g) {</strong>
      <strong>if (msg) {</strong>
        <strong>int r = random.nextInt(250);</strong>
        <strong>int gr = random.nextInt(250);</strong>
        <strong>int b = random.nextInt(250);</strong>

        <strong>g.setColor(new Color(r, gr, b));</strong>

        <strong>int height = random.nextInt(120) + 10;</strong>
        <strong>int width = random.nextInt(120) + 10;</strong>

        <strong>int xPos = random.nextInt(40) + 10;</strong>
        <strong>int yPos = random.nextInt(40) + 10;</strong>

        <strong>g.fillRect(xPos, yPos, width, height);</strong>
        <strong>msg = false;</strong>
      <strong>}</strong>
    <strong>}</strong>
  <strong>}</strong>

<strong>}</strong></pre>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Exercise"><div class="sect1" id="exercise-id000023">
<h1>Exercise</h1>
<figure class="informal"><div class="figure">
<img src="Images/exercise.png" alt="image" width="150" height="126"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Who Am I?" id="idm46038389104016"/>A bunch of Java hotshots, in full costume, are playing the party game “Who am I?”  They give you a clue, and you try to guess who they are, based on what they say. Assume they always tell the truth about themselves.  If they happen to say something that could be true for more than one guy, then write down all for whom that sentence applies. Fill in the blanks next to the sentence with the names of one or more attendees.</p>
<section data-type="sect2" data-pdf-bookmark="Who Am I?"><div class="sect2" id="who_am_iquestion_mark-id000023">
<h2>Who Am I?</h2>
<figure class="informal"><div class="figure">
<img src="Images/f0504-02.png" alt="image" width="204" height="164"/>
<h6/>
</div></figure>
<p><strong>Tonight’s attendees:</strong></p>
<p><strong>Any of the charming personalities from this chapter just might show up!</strong></p>
<table class="border">
<tbody>
<tr>
<td><strong>I got the whole GUI, in my hands.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>Every event type has one of these.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>The listener’s key method.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>This method gives JFrame its size.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>You add code to this method but never call it.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>When the user actually does something, it’s an _____ .</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>Most of these are event sources.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>I carry data back to the listener.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>An addXxxListener( ) method says an object is an _____ .</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>How a listener signs up.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>The method where all the graphics code goes.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>I’m typically bound to an instance.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>The “g” in (Graphics g) is really of this class.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>The method that gets paintComponent( ) rolling.</strong></td>
<td>______________________</td>
</tr>
<tr>
<td><strong>The package where most of the Swingers reside.</strong></td>
<td>______________________</td>
</tr>
</tbody>
</table>
<p><img class="inlineimage" src="Images/arr.png" alt="image" width="60" height="12"/> <strong>Answers in <a data-type="xref" href="#who_am_iquestion_mark_left_parenthesisfr">“Who am I?”</a>.</strong></p>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Be the..." id="idm46038389069472"/></p>
</div></section>
<section data-type="sect2" data-pdf-bookmark="BE the Compiler"><div class="sect2" id="be_the_compiler-id00003">
<h2>BE the Compiler</h2>
<figure class="informal"><div class="figure">
<img src="Images/f0505-02.png" alt="image" width="226" height="261"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#636466;">The Java file on this page represents a complete source file. Your job is to play compiler and determine whether this file will compile.  If it won’t compile, how would you fix it, and if it does compile, what would it do?</span></p>
</div>

<pre data-type="programlisting">import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

class InnerButton {
  private JButton button;

  public static void main(String[] args) {
    InnerButton gui = new InnerButton();
    gui.go();
  }

  public void go() {
    JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(
            JFrame.EXIT_ON_CLOSE);

    button = new JButton("A");
    button.addActionListener();

    frame.getContentPane().add(
            BorderLayout.SOUTH, button);
    frame.setSize(200, 100);
    frame.setVisible(true);
  }

  class ButtonListener extends ActionListener {
    public void actionPerformed(ActionEvent e) {
      if (button.getText().equals("A")) {
        button.setText("B");
      } else {
        button.setText("A");
      }
    }
  }
}</pre>
<p><img class="inlineimage" src="Images/arr.png" alt="image" width="60" height="12"/> <strong>Answers in <a data-type="xref" href="#be_the_compiler-id00003">“BE the Compiler”</a>.</strong></p>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Pool Puzzle"><div class="sect2" id="pool_puzzle-id00006">
<h2>Pool Puzzle</h2>
<p><a data-type="indexterm" data-primary="puzzles" data-secondary="Pool Puzzle" id="idm46038389059760"/></p>
<figure class="informal"><div class="figure"><img src="Images/f0506-01.png" alt="image" width="138" height="93"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0506-02.png" alt="image" width="156" height="145"/>
<h6/>
</div></figure>
<p>Your <em><strong>job</strong></em> is to take code snippets from the pool and place them into the blank lines in the code. You <strong>may</strong> use the same snippet more than once, and you won’t need to use all the snippets. Your <strong><em>goal</em></strong> is to make a class that will compile and run and produce the output listed.</p>
<p><strong>Output</strong></p>
<p>The Amazing, Shrinking, Blue Rectangle. This program will produce a blue rectangle that will shrink and shrink and disappear into a field of white.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0506-03.png" alt="image" width="463" height="276"/>
<h6/>
</div></figure>
<p><strong>Note:  Each snippet from the pool can be used more than once!</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0506-04.png" alt="image" width="901" height="445"/>
<h6/>
</div></figure>
<pre data-type="programlisting">import javax.swing.*;
import java.awt.*;
import java.util.concurrent.TimeUnit;
public class Animate {
    int x = 1;
    int y = 1;
    public static void main(String[] args) {
       Animate gui = new Animate ();
       gui.go();
   }
   public void go() {
       JFrame _________ = new JFrame();
       frame.setDefaultCloseOperation(
                     JFrame.EXIT_ON_CLOSE);
       ______________________________________;      
       _________.getContentPane().add(drawP);
       __________________________;
       _________.setVisible(true);
       for (int i=0; i&lt;124; _______________) {
       _____________________;
       _____________________;
       try {
        TimeUnit.MILLISECONDS.sleep(50);
       } catch(Exception ex) { }
       }
   }
   class MyDrawP extends JPanel {
       public void paintComponent (Graphics
                                  _________) {
          __________________________________;
          __________________________________;
          __________________________________;
          __________________________________;
       }
   }
}</pre>
<p><img class="inlineimage" src="Images/arr.png" alt="image" width="60" height="12"/> <strong>Answers in <a data-type="xref" href="#pool_puzzle_left_parenthesisfrom_page_50">“Pool Puzzle”</a>.</strong></p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Exercise Solutions"><div class="sect1" id="exercise_solutions-id00007">
<h1>Exercise Solutions</h1>
<figure class="informal"><div class="figure">
<img src="Images/exercise.png" alt="image" width="150" height="126"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Who am I?"><div class="sect2" id="who_am_iquestion_mark_left_parenthesisfr">
<h2>Who am I?</h2>
<p>(from <a data-type="xref" href="#exercise-id000023">“Exercise”</a>)</p>
<table class="border">
<tbody>
<tr>
<td><strong>I got the whole GUI, in my hands.</strong></td>
<td>JFrame</td>
</tr>
<tr>
<td><strong>Every event type has one of these.</strong></td>
<td>listener interface</td>
</tr>
<tr>
<td><strong>The listener’s key method.</strong></td>
<td>actionPerformed( )</td>
</tr>
<tr>
<td><strong>This method gives JFrame its size.</strong></td>
<td>setSize( )</td>
</tr>
<tr>
<td><strong>You add code to this method but never call it.</strong></td>
<td>paintComponent( )</td>
</tr>
<tr>
<td><strong>When the user actually does something, it’s an ____ .</strong></td>
<td>event</td>
</tr>
<tr>
<td><strong>Most of these are event sources.</strong></td>
<td>swing components</td>
</tr>
<tr>
<td><strong>I carry data back to the listener.</strong></td>
<td>event object</td>
</tr>
<tr>
<td><strong>An addXxxListener( ) method says an object is an ___ .</strong></td>
<td>event source</td>
</tr>
<tr>
<td><strong>How a listener signs up.</strong></td>
<td>addXxxListener( )</td>
</tr>
<tr>
<td><strong>The method where all the graphics code goes.</strong></td>
<td>paintComponent( )</td>
</tr>
<tr>
<td><strong>I’m typically bound to an instance.</strong></td>
<td>inner class</td>
</tr>
<tr>
<td><strong>The “g” in (Graphics g) is really of this class.</strong></td>
<td>Graphics2D</td>
</tr>
<tr>
<td><strong>The method that gets  paintComponent( ) rolling.</strong></td>
<td>repaint( )</td>
</tr>
<tr>
<td><strong>The package where most of the Swingers reside.</strong></td>
<td>javax.swing</td>
</tr>
</tbody>
</table>
</div></section>
<section data-type="sect2" data-pdf-bookmark="BE the Compiler"><div class="sect2" id="be_the_compiler_left_parenthesis-id00002">
<h2>BE the Compiler</h2>
<p>(from <a data-type="xref" href="#be_the_compiler-id00003">“BE the Compiler”</a>)</p>
<figure class="informal"><div class="figure">
<img src="Images/f0507-01.png" alt="image" width="466" height="986"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Pool Puzzle"><div class="sect2" id="pool_puzzle_left_parenthesisfrom_page_50">
<h2>Pool Puzzle</h2>
<p>(from <a data-type="xref" href="#pool_puzzle-id00006">“Pool Puzzle”</a>)</p>
<p/>
<figure class="informal"><div class="figure"><img src="Images/f0506-01.png" alt="image" width="138" height="93"/>
<h6/>
</div></figure>
<pre data-type="programlisting">import javax.swing.*;
import java.awt.*;
import java.util.concurrent.TimeUnit;

public class Animate {
  int x = 1;
  int y = 1;
  public static void main(String[] args) {
    Animate gui = new Animate ();
    gui.go();
  }
  public void go() {
    JFrame <strong>frame</strong> = new JFrame();
    frame.setDefaultCloseOperation(
            JFrame.EXIT_ON_CLOSE);
    <strong>MyDrawP drawP = new MyDrawP()</strong>;      
    <strong>frame</strong>.getContentPane().add(drawP);
    <strong>frame.setSize(500, 270)</strong>;
    <strong>frame</strong>.setVisible(true);
    for (int i = 0; i &lt; 124; <strong>i++,y++,x++</strong> ) {
      <strong>x++</strong>;
      <strong>drawP.repaint()</strong>;
      try {
        TimeUnit.MILLISECONDS.sleep(50);
      } catch(Exception ex) { }
    }
  }
  class MyDrawP extends JPanel {
    public void paintComponent(Graphics <strong>g</strong> ) {
      <strong>g.setColor(Color.white);</strong>
      <strong>g.fillRect(0, 0, 500, 250);</strong>
      <strong>g.setColor(Color.blue);</strong>
      <strong>g.fillRect(x, y, 500-x*2, 250-y*2);</strong>
    }
  }
}</pre>
<p>The Amazing, Shrinking, Blue Rectangle.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0508-01.png" alt="image" width="462" height="283"/>
<h6/>
</div></figure>
</div></section>
</div></section>
</div></section></div></body></html>