["```\nnpm install nodemailer\n```", "```\nconst nodemailer = require('nodemailer')\n\nconst mailTransport = nodemailer.createTransport({\n\n  auth: {\n    user: credentials.sendgrid.user,\n    pass: credentials.sendgrid.password,\n  }\n})\n```", "```\n{\n  \"cookieSecret\": \"your cookie secret goes here\",\n  \"sendgrid\": {\n    \"user\": \"your sendgrid username\",\n    \"password\": \"your sendgrid password\"\n  }\n}\n```", "```\ntry {\n  const result = await mailTransport.sendMail({\n    from: '\"Meadowlark Travel\" <info@meadowlarktravel.com>',\n    to: 'joecustomer@gmail.com',\n    subject: 'Your Meadowlark Travel Tour',\n    text: 'Thank you for booking your trip with Meadowlark Travel.  ' +\n      'We look forward to your visit!',\n  })\n  console.log('mail sent successfully: ', result)\n} catch(err) {\n  console.log('could not send mail: ' + err.message)\n}\n```", "```\ntry {\n  const result = await mailTransport.sendMail({\n    from: '\"Meadowlark Travel\" <info@meadowlarktravel.com>',\n    to: 'joe@gmail.com, \"Jane Customer\" <jane@yahoo.com>, ' +\n      'fred@hotmail.com',\n    subject: 'Your Meadowlark Travel Tour',\n    text: 'Thank you for booking your trip with Meadowlark Travel.  ' +\n      'We look forward to your visit!',\n  })\n  console.log('mail sent successfully: ', result)\n} catch(err) {\n  console.log('could not send mail: ' + err.message)\n}\n```", "```\n// largeRecipientList is an array of email addresses\nconst recipientLimit = 100\nconst batches = largeRecipientList.reduce((batches, r) => {\n  const lastBatch = batches[batches.length - 1]\n  if(lastBatch.length < recipientLimit)\n    lastBatch.push(r)\n  else\n    batches.push([r])\n  return batches\n}, [[]])\ntry {\n  const results = await Promise.all(batches.map(batch =>\n    mailTransport.sendMail({\n      from: '\"Meadowlark Travel\", <info@meadowlarktravel.com>',\n      to: batch.join(', '),\n      subject: 'Special price on Hood River travel package!',\n      text: 'Book your trip to scenic Hood River now!',\n    })\n  ))\n  console.log(results)\n} catch(err) {\n  console.log('at least one email batch failed: ' + err.message)\n}\n```", "```\nconst result = await mailTransport.sendMail({\n  from: '\"Meadowlark Travel\" <info@meadowlarktravel.com>',\n  to: 'joe@gmail.com, \"Jane Customer\" <jane@yahoo.com>, ' +\n    'fred@hotmail.com',\n  subject: 'Your Meadowlark Travel Tour',\n  html: '<h1>Meadowlark Travel</h1>\\n<p>Thanks for book your trip with ' +\n    'Meadowlark Travel.  <b>We look forward to your visit!</b>',\n  text: 'Thank you for booking your trip with Meadowlark Travel.  ' +\n    'We look forward to your visit!',\n})\n```", "```\n<img src=\"//meadowlarktravel.com/email/logo.png\"\n  alt=\"Meadowlark Travel Logo\">\n```", "```\n<p>Thank you for booking your trip with Meadowlark Travel,\n  {{cart.billing.name}}!</p>\n<p>Your reservation number is {{cart.number}}, and an email has been\nsent to {{cart.billing.email}} for your records.</p>\n```", "```\n<table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" id=\"backgroundTable\">\n  <tr>\n    <td valign=\"top\">\n      <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\" align=\"center\">\n        <tr>\n          <td width=\"200\" valign=\"top\"><img class=\"image_fix\"\n            src=\"//placehold.it/100x100\"\n            alt=\"Meadowlark Travel\" title=\"Meadowlark Travel\"\n            width=\"180\" height=\"220\" /></td>\n        </tr>\n        <tr>\n          <td width=\"200\" valign=\"top\"><p>\n            Thank you for booking your trip with Meadowlark Travel,\n            {{cart.billing.name}}.</p><p>Your reservation number\n            is {{cart.number}}.</p></td>\n        </tr>\n        <tr>\n          <td width=\"200\" valign=\"top\">Problems with your reservation?\n          Contact Meadowlark Travel at\n          <span class=\"mobile_link\">555-555-0123</span>.</td>\n        </tr>\n      </table>\n    </td>\n  </tr>\n</table>\n```", "```\napp.post('/cart/checkout', (req, res, next) => {\n  const cart = req.session.cart\n  if(!cart) next(new Error('Cart does not exist.'))\n  const name = req.body.name || '', email = req.body.email || ''\n  // input validation\n  if(!email.match(VALID_EMAIL_REGEX))\n    return res.next(new Error('Invalid email address.'))\n  // assign a random cart ID; normally we would use a database ID here\n  cart.number = Math.random().toString().replace(/^0\\.0*/, '')\n  cart.billing = {\n    name: name,\n    email: email,\n  }\n  res.render('email/cart-thank-you', { layout: null, cart: cart },\n    (err,html) => {\n        console.log('rendered email: ', html)\n        if(err) console.log('error in email template')\n        mailTransport.sendMail({\n          from: '\"Meadowlark Travel\": info@meadowlarktravel.com',\n          to: cart.billing.email,\n          subject: 'Thank You for Book your Trip with Meadowlark Travel',\n          html: html,\n          text: htmlToFormattedText(html),\n        })\n          .then(info => {\n            console.log('sent! ', info)\n            res.render('cart-thank-you', { cart: cart })\n          })\n          .catch(err => {\n            console.error('Unable to send confirmation: ' + err.message)\n          })\n    }\n  )\n})\n```", "```\nconst nodemailer = require('nodemailer')\nconst htmlToFormattedText = require('html-to-formatted-text')\n\nmodule.exports = credentials => {\n\n  const mailTransport = nodemailer.createTransport({\n    host: 'smtp.sendgrid.net',\n    auth: {\n      user: credentials.sendgrid.user,\n      pass: credentials.sendgrid.password,\n    },\n  })\n\n  const from = '\"Meadowlark Travel\" <info@meadowlarktravel.com>'\n  const errorRecipient = 'youremail@gmail.com'\n\n  return {\n    send: (to, subject, html) =>\n      mailTransport.sendMail({\n        from,\n        to,\n        subject,\n        html,\n        text: htmlToFormattedText(html),\n      }),\n  }\n\n}\n```", "```\nconst emailService = require('./lib/email')(credentials)\n\nemailService.send(email, \"Hood River tours on sale today!\",\n  \"Get 'em while they're hot!\")\n```"]