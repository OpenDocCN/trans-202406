<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" class="pagenumrestart" data-pdf-bookmark="Chapter 1. Installing MySQL"><div class="chapter" id="CH1_INSTALL">
<h1><span class="label">Chapter 1. </span>Installing MySQL</h1>


<p>Let’s begin our learning path by installing MySQL and accessing it for the first time.</p>

<p>Note that we do not rely on a single version of MySQL for this book.<a data-type="indexterm" data-primary="MySQL" data-secondary="about book versions" id="idm46177504942504"/><a data-type="indexterm" data-primary="RHEL (Red Hat Enterprise Linux)" id="idm46177504941448"/><a data-type="indexterm" data-primary="Red Hat Enterprise Linux (RHEL)" id="idm46177504940712"/> Instead, we have drawn on our collective knowledge of MySQL in the real world. The book’s core is focused on Linux operating systems (mostly Ubuntu/Debian and CentOS/RHEL or its derivatives) and on MySQL 5.7 and MySQL 8.0, because those are what we consider the “current” versions capable of production workloads. The MySQL 5.7 and 8.0 series are still under development, which means that newer versions with bug fixes and new features will continue to be released.</p>

<p>With MySQL becoming the <a href="https://oreil.ly/pPG4q">most popular</a> open source database (Oracle, which ranks first, is not open source), the demand for having a fast installation process has increased. You can think of installing MySQL from scratch as similar to baking a cake: the source code is the recipe. But even with the source code available, the recipe for building software is not easy to follow. It takes time to compile, and usually, it is necessary to install additional development libraries that expose production environments to risk. Say you want a chocolate cake; even if you have the instructions for how to make it yourself, you may not want to mess up your kitchen, or you may not have the time to bake it, so you go to a bakery and buy one instead. <a data-type="indexterm" data-primary="MySQL" data-secondary="installation" data-see="installation of MySQL" id="idm46177504937608"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="about distribution packages" id="idm46177504936360"/><a data-type="indexterm" data-primary="distribution packages for MySQL" id="idm46177504935352"/>For MySQL, when you want it ready to use without the effort involved in compiling it, you can use the <em>distribution packages</em>.</p>

<p>Distribution packages for MySQL are available for diverse platforms, including Linux distributions, Windows, and macOS. These packages provide a flexible and fast way to start using MySQL. Returning to the chocolate cake example, suppose you want to change something. Maybe you want a white chocolate cake. For MySQL, we have what are called forks, which include some different options. We’ll look at a few of these in the next section.</p>






<section data-type="sect1" data-pdf-bookmark="MySQL Forks"><div class="sect1" id="MySQL_Fork">
<h1>MySQL Forks</h1>

<p>In software engineering, a <em>fork</em> occurs when someone copies the <a data-type="indexterm" data-primary="installation of MySQL" data-secondary="forks" data-tertiary="about forks" id="idm46177504929944"/><a data-type="indexterm" data-primary="forks of MySQL" data-secondary="about forks" id="idm46177504928696"/>source code and starts their own path of independent development and support. The fork can follow a track close to that of the original version, as the Percona distribution of MySQL does, or drift away, like MariaDB. Because the MySQL source code is open and free, new projects can fork the code without permission from its original creator. Let’s take a look at a few of the most notable forks.</p>








<section data-type="sect2" data-pdf-bookmark="MySQL Community Edition"><div class="sect2" id="idm46177504927080">
<h2>MySQL Community Edition</h2>

<p>MySQL Community Edition, <a data-type="indexterm" data-primary="installation of MySQL" data-secondary="forks" data-tertiary="MySQL Community Edition" id="idm46177504925560"/><a data-type="indexterm" data-primary="forks of MySQL" data-secondary="MySQL Community Edition" id="idm46177504924312"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="about" id="idm46177504923368"/><a data-type="indexterm" data-primary="vanilla distribution of MySQL" data-see="MySQL Community Edition" id="idm46177504922424"/><a data-type="indexterm" data-primary="upstream distribution of MySQL" data-see="MySQL Community Edition" id="idm46177504921416"/>also known as the <em>upstream</em> or <em>vanilla</em> version of MySQL, is the open source version distributed by Oracle. This version drives the development of the InnoDB engine and new features, and it is the first one to receive updates, new features, and bug fixes.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Percona Server for MySQL"><div class="sect2" id="idm46177504919096">
<h2>Percona Server for MySQL</h2>

<p>The Percona distribution of MySQL<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="forks" data-tertiary="Percona distribution" id="idm46177504917800"/><a data-type="indexterm" data-primary="forks of MySQL" data-secondary="Percona distribution" id="idm46177504916552"/><a data-type="indexterm" data-primary="Percona Server for MySQL" data-secondary="about" id="idm46177504915608"/> is a free, open source, drop-in replacement for MySQL Community Edition. The development closely follows that version, focusing on improving performance and the overall MySQL ecosystem. Percona Server also includes additional enhancements like the MyRocks engine, an Audit Log plugin, and a PAM Authentication plugin. Percona was cofounded by <a href="https://oreil.ly/MfiKb">Peter Zaitsev</a> and <a href="https://oreil.ly/283nR">Vadim Tkachenko</a>.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="MariaDB Server"><div class="sect2" id="idm46177504912472">
<h2>MariaDB Server</h2>

<p>Created by <a href="https://oreil.ly/PRoMh">Michael “Monty” Widenius</a> and<a data-type="indexterm" data-primary="Widenius, Michael “Monty”" id="idm46177504910392"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="forks" data-tertiary="MariaDB Server" id="idm46177504909624"/><a data-type="indexterm" data-primary="forks of MySQL" data-secondary="MariaDB Server" id="idm46177504908408"/><a data-type="indexterm" data-primary="MariaDB" data-secondary="about" id="idm46177504907464"/> distributed by the MariaDB Foundation, MariaDB Server is by far the fork that has drifted the furthest away from vanilla MySQL. In recent years it has developed new features and engines such as MariaDB ColumnStore, and it was the first database to integrate Galera 4 clustering 
<span class="keep-together">functionality.</span></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="MySQL Enterprise Edition"><div class="sect2" id="idm46177504905304">
<h2>MySQL Enterprise Edition</h2>

<p>MySQL Enterprise Edition is currently the <a data-type="indexterm" data-primary="installation of MySQL" data-secondary="forks" data-tertiary="MySQL Enterprise Edition" id="idm46177504904008"/><a data-type="indexterm" data-primary="forks of MySQL" data-secondary="MySQL Enterprise Edition" id="idm46177504902696"/><a data-type="indexterm" data-primary="MySQL Enterprise Edition" data-secondary="about" id="idm46177504901736"/>only version with a commercial license (which means you need to pay to use it, like a Windows license). Also distributed by Oracle, it contains all the functionality of the Community Edition plus exclusive features for security, backup, and high availability.</p>
</div></section>





</div></section>













<section data-type="sect1" class="less_space pagebreak-before" data-pdf-bookmark="Installation Choices and Platforms"><div class="sect1" id="idm46177504900120">
<h1>Installation Choices and Platforms</h1>

<p>First, you must choose the MySQL version compatible with your<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="operating system compatibility" id="idm46177504898056"/><a data-type="indexterm" data-primary="operating systems" data-secondary="compatibility" id="idm46177504896984"/><a data-type="indexterm" data-primary="web links in book" data-secondary="operating system compatibility" id="idm46177504896040"/><a data-type="indexterm" data-primary="Percona Server for MySQL" data-secondary="operating system compatibility" id="idm46177504895080"/><a data-type="indexterm" data-primary="MariaDB" data-secondary="operating system compatibility" id="idm46177505286248"/> operating system (OS). You can verify compatibility with the <a href="https://oreil.ly/DTRSR">MySQL website</a>. The same support policies are available for <a href="https://oreil.ly/1ahne">Percona Server</a> and <a href="https://oreil.ly/7SYE4">MariaDB</a>.</p>

<p>We often hear the question: is it possible to install MySQL on an OS that is not supported? Most of the time, the answer is yes. It is possible to install MySQL on Windows 7, for example, but the risks of hitting a bug or facing unpredictable behavior (like memory leaks or underperformance) are high. Because of these risks, we do not recommend doing this for production environments.</p>

<p>The next step is to decide whether to<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="General Availability versus development" id="idm46177505281736"/><a data-type="indexterm" data-primary="General Availability release of MySQL" id="idm46177505280792"/><a data-type="indexterm" data-primary="development release of MySQL" id="idm46177505280104"/> install a <em>development</em> or <em>General Availability</em> (GA) release. Development releases have the newest features, but we do not recommend them for production because they are not stable. GA releases, also called <em>production</em> or <em>stable</em> releases, are meant for production use.</p>
<div data-type="tip"><h6>Tip</h6>
<p>We highly recommend using the most recent GA release because this will include the latest stable bug fixes and performance improvements.</p>
</div>

<p>The last thing to decide is which distribution format<a data-type="indexterm" data-primary="distribution packages for MySQL" data-secondary="format for installation" id="idm46177505275576"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="about distribution packages" data-tertiary="format for installation" id="idm46177505274632"/><a data-type="indexterm" data-primary="binary distributions of MySQL" id="idm46177505273448"/> to install for the operating system. For most use cases, a binary distribution fits. Binary distributions are available in native format for many platforms, such as <em>.rpm</em> packages for Linux or <em>.dmg</em> packages for macOS. The distributions are also available in generic formats, such as <em>.zip</em> archives or compressed <em>.tar</em> files (<em>tarballs</em>). On Windows, you can use the MySQL Installer to install a binary distribution.</p>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>Watch out for whether the version is 32-bit or 64-bit.<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="about distribution packages" data-tertiary="32-bit versus 64-bit" id="idm46177505269400"/><a data-type="indexterm" data-primary="32-bit versus 64-bit installations" id="idm46177505268136"/> The rule of thumb is to pick the 64-bit version. Unless you are working with an ancient OS, you should <em>not</em> select the 32-bit version. This is because 32-bit processors can handle only a limited amount of RAM (4 GB or less), whereas 64-bit processors are capable of addressing much more memory.</p>
</div>

<p>The installation process consists of four major steps, outlined in the following sections. It’s essential to follow these correctly and to set the minimum security requirements for the MySQL database.</p>








<section data-type="sect2" data-pdf-bookmark="1. Download the Distribution that You Want to Install"><div class="sect2" id="idm46177505265608">
<h2>1. Download the Distribution that You Want to Install</h2>

<p>Each distribution has its owner and, by consequence, its source.<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="about steps of" id="idm46177505264248"/><a data-type="indexterm" data-primary="distribution packages for MySQL" data-secondary="downloading" id="idm46177505263192"/><a data-type="indexterm" data-primary="Linux" data-secondary="distribution download" id="idm46177505262232"/> Some Linux distributions provide default packages in their repositories. For example, on CentOS 8, the MySQL vanilla distribution is available from the default repositories. When the OS has default packages available, it is unnecessary to download MySQL from a website or configure a repository yourself, which facilitates the installation process.</p>

<p>We will demonstrate how to install the repositories and download the files without the need to go to the website during the installation process. However, if you do want to download MySQL yourself, you can use the following links:<a data-type="indexterm" data-primary="online resources" data-see="web links in book" id="idm46177505260168"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="installation download link" id="idm46177505259192"/><a data-type="indexterm" data-primary="Percona Server for MySQL" data-secondary="installation" data-tertiary="download link" id="idm46177505258232"/><a data-type="indexterm" data-primary="MariaDB" data-secondary="installation" data-tertiary="download link" id="idm46177505257000"/><a data-type="indexterm" data-primary="web links in book" data-secondary="MySQL distribution downloads" id="idm46177505255784"/></p>

<ul>
<li>
<p><a href="https://oreil.ly/sBR5i">MySQL Community Server</a></p>
</li>
<li>
<p><a href="https://oreil.ly/R9oO4">Percona Server for MySQL</a></p>
</li>
<li>
<p><a href="https://oreil.ly/a78XW">MariaDB Server</a></p>
</li>
</ul>
</div></section>













<section data-type="sect2" data-pdf-bookmark="2. Install the Distribution"><div class="sect2" id="idm46177505250104">
<h2>2. Install the Distribution</h2>

<p>Installing consists of the elementary steps to <a data-type="indexterm" data-primary="distribution packages for MySQL" data-secondary="installing" data-seealso="installation of MySQL" id="idm46177505248696"/>make MySQL functional and bring it online, but not securing MySQL. For example, at this point, the MySQL root user can connect without a password, which is quite hazardous since the root user has privileges to perform every action, including dropping a database.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="3. Perform Any Necessary Post-Installation Setup"><div class="sect2" id="idm46177505246728">
<h2>3. Perform Any Necessary Post-Installation Setup</h2>

<p>This step is about making sure the MySQL server is working correctly. It is essential to make sure that your server is secure, and the first step for this is executing the <em>mysql_secure_installation</em> script. You’ll change the password for the root user, disable access for the root user from a remote server, and remove the test database.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="4. Run Benchmarks"><div class="sect2" id="idm46177505244376">
<h2>4. Run Benchmarks</h2>

<p>Some DBAs run benchmarks for each <a data-type="indexterm" data-primary="sysbench for MySQL benchmarking" id="idm46177504780888"/><a data-type="indexterm" data-primary="benchmarking" id="idm46177504780120"/>deployment to measure whether the performance is suitable for the project they are using it for. The most common tool for this is <a href="https://oreil.ly/ioyXF"><code>sysbench</code></a>. It’s essential to highlight here that <code>sysbench</code> performs a <em>synthetic workload</em>, whereas when the application is running, we call it the <em>real workload</em>. Synthetic workloads usually provide reports about the maximum server performance, but they can’t reproduce the real-world workload (with its inherent locks, different query execution times, stored procedures, triggers, and so on).</p>

<p>In the next section we’ll walk through the details of the installation process for a few of the most commonly used platforms.</p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Installing MySQL on Linux"><div class="sect1" id="MYSQL-INSTALL-LINUX">
<h1>Installing MySQL on Linux</h1>

<p>The Linux ecosystem is diverse and has many variants, including Red Hat Enterprise Linux (RHEL),<a data-type="indexterm" data-primary="RHEL (Red Hat Enterprise Linux)" data-seealso="CentOS 7 Linux; CentOS 8 Linux" id="idm46177504774264"/><a data-type="indexterm" data-primary="Red Hat Enterprise Linux (RHEL)" data-seealso="CentOS 7 Linux; CentOS 8 Linux" id="idm46177504773304"/> CentOS, Ubuntu, Debian, and others. This section focuses on only the most popular ones—otherwise, this book would be entirely about the installation process!</p>








<section data-type="sect2" data-pdf-bookmark="Installing MySQL on CentOS 7"><div class="sect2" id="idm46177504771896">
<h2>Installing MySQL on CentOS 7</h2>

<p><em>CentOS</em>, short for Community Enterprise Linux Operating System,<a data-type="indexterm" data-primary="CentOS 7 Linux" data-secondary="about" id="idm46177504770104"/><a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 7 Linux" data-tertiary="about" id="idm46177504769048"/> was founded in 2004, and Red Hat acquired it in 2014. CentOS is the community version of Red Hat, so they’re pretty much identical, but CentOS is free, and support comes from the community instead of Red Hat itself. CentOS 7 was released in 2014, and its end-of-life date is in 2024.</p>










<section data-type="sect3" data-pdf-bookmark="Installing MySQL 8.0"><div class="sect3" id="MYSQL8_CENTOS7">
<h3>Installing MySQL 8.0</h3>

<p>To install MySQL 8.0 on CentOS 7 using the <em>yum</em> repository, complete the following steps.<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Linux" data-tertiary="CentOS 7, MySQL 8" id="ch01-lin"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="Linux installation" data-tertiary="CentOS 7, MySQL 8" id="ch01-lin2"/><a data-type="indexterm" data-primary="CentOS 7 Linux" data-secondary="MySQL 8.0 installation" id="ch01-c7m8"/><a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 7 Linux" data-tertiary="MySQL 8.0 installation" id="ch01-c7m82"/></p>












<section data-type="sect4" data-pdf-bookmark="Log in to Linux server"><div class="sect4" id="idm46177504759048">
<h4>Log in to Linux server</h4>

<p>Usually, for security reasons, users log into Linux servers as nonprivileged users. Here is an example of a user logging into Linux from a macOS terminal using a private key:</p>

<pre data-type="programlisting">$ <strong>ssh -i key.pem centos@3.227.11.227</strong></pre>

<p>After you’ve successfully connected, you’ll see something like this in the terminal:</p>

<pre data-type="programlisting">[centos@ip-172-30-150-91 ~]$</pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="LOGGING_BECOME_ROOT">
<h4>Become root in Linux</h4>

<p>Once you’re connected to the server, <a data-type="indexterm" data-primary="Linux" data-secondary="becoming root" id="idm46177504753176"/><a data-type="indexterm" data-primary="root in Linux" id="idm46177504752200"/><a data-type="indexterm" data-primary="users" data-secondary="root in Linux" id="idm46177504751528"/>you need to become root:</p>

<pre data-type="programlisting">$ <strong>sudo su - root</strong></pre>

<p>You will then see a prompt like the following in your terminal:</p>

<pre data-type="programlisting">[root@ip-172-30-150-91 ~]#</pre>

<p>Becoming root is important because to install MySQL it is necessary to perform tasks such as creating the MySQL user in Linux, configuring directories, and setting permissions. It is also possible to use the <code>sudo</code> command for all examples we will show that should be executed by the root user. However, if you forget to prefix a command with <code>sudo</code>, the installation process will be incomplete.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>This chapter will use the Linux root user in the majority of the examples (represented by the prompt <code>#</code> in the code lines). <a data-type="indexterm" data-primary="# (Linux comment)" data-primary-sortas="#Linux" id="idm46177504744648"/><a data-type="indexterm" data-primary="comments" data-secondary="Linux" id="idm46177504743640"/><a data-type="indexterm" data-primary="Linux" data-secondary="comment marker" id="idm46177504742696"/><a data-type="indexterm" data-primary="# (root user)" data-primary-sortas="#root user" id="idm46177504741752"/><a data-type="indexterm" data-primary="Linux" data-secondary="becoming root" data-tertiary="# indicating root in book" data-tertiary-sortas="#indicating" id="idm46177504740808"/><a data-type="indexterm" data-primary="users" data-secondary="root in Linux" data-tertiary="# in book" id="idm46177504739304"/>Another advantage of the <code>#</code> representation is that this is also the comment character in Linux. If you blindly copy/paste lines from the book, you won’t run any real commands in the shell.</p>
</div>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Configure the yum repository"><div class="sect4" id="idm46177504737272">
<h4>Configure the yum repository</h4>

<p>Execute the following command to configure the MySQL <em>yum</em> repository:<a data-type="indexterm" data-primary="MySQL" data-secondary="repositories" data-tertiary="yum" id="idm46177504735496"/><a data-type="indexterm" data-primary="yum repository for MySQL" id="idm46177504734216"/></p>

<pre data-type="programlisting"># <strong>rpm -Uvh https://repo.mysql.com/mysql80-community-release-el7.rpm</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install MySQL 8.0 Community Server"><div class="sect4" id="idm46177504732296">
<h4>Install MySQL 8.0 Community Server</h4>

<p>Because the MySQL <em>yum</em> repository has repositories for multiple MySQL versions (5.7 and 8.0 major versions), first we have to disable all repositories:</p>

<pre data-type="programlisting"># <strong>sed -i &amp;#39;s/enabled=1/enabled=0/&amp;#39;
/etc/yum.repos.d/mysql-community.repo</strong></pre>

<p>Next, we need to enable the MySQL 8.0 repository and execute the following command to install MySQL 8.0:</p>

<pre data-type="programlisting"># <strong>yum --enablerepo=mysql80-community install mysql-community-server</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Start the MySQL service"><div class="sect4" id="idm46177504727464">
<h4>Start the MySQL service</h4>

<p>Now, start the MySQL service with the <code>systemctl</code> command:<a data-type="indexterm" data-primary="MySQL" data-secondary="systemctl commands" data-see="systemctl" id="idm46177504725432"/><a data-type="indexterm" data-primary="systemctl" data-secondary="starting MySQL 8.0 service" data-tertiary="CentOS 7 Linux" id="idm46177504724152"/></p>

<pre data-type="programlisting"># <strong>systemctl start mysqld</strong></pre>

<p>It is also possible to start the MySQL process manually, which can be useful to troubleshoot initialization problems when MySQL is refusing to start. To start manually, indicate the location of the <em>my.cnf</em> file and which user can manipulate the database files and the process:</p>

<pre data-type="programlisting"># <strong>mysqld --defaults-file=/etc/my.cnf --user=mysql</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Discover the default password for the root user"><div class="sect4" id="DISCOVER_MYSQL_PASSWORD">
<h4>Discover the default password for the root user</h4>

<p>When you install MySQL 8.0, MySQL creates a temporary<a data-type="indexterm" data-primary="root in Linux" data-secondary="MySQL temporary password" id="idm46177504892248"/><a data-type="indexterm" data-primary="users" data-secondary="root in Linux" data-tertiary="MySQL temporary password" id="idm46177504891304"/><a data-type="indexterm" data-primary="passwords" data-secondary="root account" data-tertiary="MySQL temporary password" id="idm46177504890072"/><a data-type="indexterm" data-primary="Linux" data-secondary="becoming root" data-tertiary="MySQL temporary password" id="idm46177504888840"/> password for the root user account. To identify the password of the root user account, execute the following command:</p>

<pre data-type="programlisting"># <strong>grep "A temporary password" /var/log/mysqld.log</strong></pre>

<p>The command provides output like the following:</p>

<pre data-type="programlisting">2020-05-31T15:04:12.256877Z 6 [Note] [MY-010454] [Server] A temporary
password is generated for root@localhost: #z?hhCCyj2aj</pre>
</div></section>













<section data-type="sect4" class="less_space pagebreak-before" data-pdf-bookmark="Secure the MySQL installation"><div class="sect4" id="MYSQL_SECURE_INSTALL">
<h4>Secure the MySQL installation</h4>

<p>MySQL provides a shell script that you can run on <a data-type="indexterm" data-primary="installation of MySQL" data-secondary="security shell script" id="idm46177504882760"/><a data-type="indexterm" data-primary="security" data-secondary="MySQL shell script" id="idm46177504881784"/><a data-type="indexterm" data-primary="root in Linux" data-secondary="MySQL security shell script" id="idm46177504880840"/><a data-type="indexterm" data-primary="users" data-secondary="root in Linux" data-tertiary="MySQL security shell script" id="idm46177504879832"/><a data-type="indexterm" data-primary="passwords" data-secondary="root account" data-tertiary="MySQL security shell script" id="idm46177504878600"/><a data-type="indexterm" data-primary="Linux" data-secondary="becoming root" data-tertiary="MySQL security shell script" id="idm46177504877368"/>Unix systems, <em>mysql_secure_installation</em>, that enables you to improve the security of your server installation in the following ways:</p>

<ul>
<li>
<p>You can set a password for the root account.</p>
</li>
<li>
<p>You can disable root access from outside the localhost.</p>
</li>
<li>
<p>You can remove anonymous user accounts.</p>
</li>
<li>
<p>You can remove the test database, which by default can be accessed by anonymous users.</p>
</li>
</ul>

<p>Execute the command <code>mysql_secure_installation</code> to secure the MySQL server:</p>

<pre data-type="programlisting"># <strong>mysql_secure_installation</strong></pre>

<p>It will prompt you for the current password of the root account:</p>

<pre data-type="programlisting">Enter the password for user root:</pre>

<p>Enter the temporary password obtained in the previous step and press Enter. The following message will appear:</p>

<pre data-type="programlisting">The existing password for the user account root has expired. Please
set a new password.

New password:
Re-enter new password:</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>This section will cover only the basics of changing the root password to grant access to the MySQL server. We will show more details about granting privileges and creating a password policy in <a data-type="xref" href="ch08.xhtml#CH8_USER_MANAGEMENT">Chapter 8</a>.</p>
</div>

<p>You will need to enter the new password for the root account twice. More recent MySQL versions come with a validation policy, which means that the new password needs to respect minimal requirements to be accepted. The default requirements are that passwords must be at least eight characters long and include:</p>

<ul>
<li>
<p>At least one numeric character</p>
</li>
<li>
<p>At least one lowercase character</p>
</li>
<li>
<p>At least one uppercase character</p>
</li>
<li>
<p>At least one special (nonalphanumeric) character</p>
</li>
</ul>

<p class="less_space pagebreak-before">Next, it will prompt you with some yes/no questions about whether you want to make some initial setup changes. To ensure maximum protection, we recommend removing anonymous users, disabling remote root login, and removing the test database (i.e., answering <em>yes</em> for all options):</p>

<pre data-type="programlisting">Remove anonymous users? (Press y|Y for Yes, any other key for No) : <strong>y</strong>

Disallow root login remotely? (Press y|Y for Yes, any other key for No) : <strong>y</strong>

Remove test database and access to it? (Press y|Y for Yes, any other key
for No) : <strong>y</strong>

Reload privilege tables now? (Press y|Y for Yes, any other key for No) : <strong>y</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Connect to MySQL"><div class="sect4" id="idm46177504884344">
<h4>Connect to MySQL</h4>

<p>This step is optional, but we use it to verify that we executed all the steps correctly. Use this command to connect to the MySQL server:</p>

<pre data-type="programlisting"># <strong>mysql -u root -p</strong></pre>

<p>It will prompt for the password of the root user. Type the password and press Enter:</p>

<pre data-type="programlisting">Enter password:</pre>

<p>If successful, it will show the MySQL command line:</p>

<pre data-type="programlisting">mysql&gt;</pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Start MySQL 8.0 upon server start (optional)"><div class="sect4" id="idm46177504850904">
<h4>Start MySQL 8.0 upon server start (optional)</h4>

<p>To set MySQL to start whenever the server boots up, use the following command:<a data-type="indexterm" data-primary="systemctl" data-secondary="starting MySQL 8.0 service" data-tertiary="on server boot up" id="idm46177504849416"/><a data-type="indexterm" data-startref="ch01-lin" id="idm46177504848104"/><a data-type="indexterm" data-startref="ch01-lin2" id="idm46177504847432"/><a data-type="indexterm" data-startref="ch01-c7m8" id="idm46177504846760"/><a data-type="indexterm" data-startref="ch01-c7m82" id="idm46177504846088"/></p>

<pre data-type="programlisting"># <strong>systemctl enable mysqld</strong></pre>
</div></section>

</div></section>













<section data-type="sect3" data-pdf-bookmark="Installing MariaDB 10.5"><div class="sect3" id="idm46177504766680">
<h3>Installing MariaDB 10.5</h3>

<p>To install MariaDB 10.5 on CentOS 7, you’ll need to execute similar steps as for the vanilla MySQL distribution.<a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 7 Linux" data-tertiary="MariaDB installation" id="ch01-mdb"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Linux" data-tertiary="CentOS 7, MariaDB" id="ch01-mdb2"/><a data-type="indexterm" data-primary="CentOS 7 Linux" data-secondary="MariaDB installation" id="ch01-mdb3"/><a data-type="indexterm" data-primary="MariaDB" data-secondary="installation" data-tertiary="CentOS 7 installation" id="ch01-mdb4"/></p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177504836712">
<h4>Become root in Linux</h4>

<p>First, we need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the MariaDB repository"><div class="sect4" id="idm46177504834328">
<h4>Install the MariaDB repository</h4>

<p>The following set of commands will download the MariaDB repo and configure it for the next step. <a data-type="indexterm" data-primary="yum repository for MySQL" data-secondary="-y option" id="idm46177504832920"/>Note that in the <code>yum</code> commands, we are using the <code>-y</code> option. This option tells Linux to assume the answer is <em>yes</em> for all subsequent questions:</p>

<pre data-type="programlisting"># <strong>yum install wget -y</strong>
# <strong>wget https://downloads.mariadb.com/MariaDB/mariadb_repo_setup</strong>
# <strong>chmod +x mariadb_repo_setup</strong>
# <strong>./mariadb_repo_setup</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install MariaDB"><div class="sect4" id="idm46177504827800">
<h4>Install MariaDB</h4>

<p>With the repository configured, the next command will install the latest stable version of MariaDB and its dependencies:</p>

<pre data-type="programlisting"># <strong>yum install MariaDB-server -y</strong></pre>

<p>The end of the output will be similar to this:</p>

<pre data-type="programlisting">Installed:
  MariaDB-compat.x86_64 0:10.5.8-1.el7.centos                                                                                         MariaDB-server.x86_64 0:10.5.8-1.el7.centos

Dependency Installed:
  MariaDB-client.x86_64 0:10.5.8-1.el7.centos MariaDB-common.x86_64
  0:10.5.8-1.el7.centos boost-program-options.x86_64 0:1.53.0-28.el7
  galera-4.x86_64 0:26.4.6-1.el7.centos        libaio.x86_64
  0:0.3.109-13.el7               lsof.x86_64 0:4.87-6.el7
  pcre2.x86_64 0:10.23-2.el7                  perl.x86_64
  4:5.16.3-299.el7_9              perl-Carp.noarch 0:1.26-244.el7
  ...

Replaced:
  mariadb-libs.x86_64 1:5.5.64-1.el7

Complete!</pre>

<p>The <em>Complete!</em> at the end of the log indicates a successful installation.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Start MariaDB"><div class="sect4" id="idm46177492451560">
<h4>Start MariaDB</h4>

<p>With MariaDB installed, initialize the service with the <code>systemctl</code> command:<a data-type="indexterm" data-primary="systemctl" data-secondary="starting MariaDB service" id="idm46177492449416"/><a data-type="indexterm" data-primary="MariaDB" data-secondary="installation" data-tertiary="starting service" id="idm46177492448392"/></p>

<pre data-type="programlisting"># <strong>systemctl start mariadb.service</strong></pre>

<p>You can use this command to verify its status:<a data-type="indexterm" data-primary="MariaDB" data-secondary="installation" data-tertiary="verifying status" id="idm46177492445816"/><a data-type="indexterm" data-primary="systemctl" data-secondary="status of service" data-tertiary="CentOS 7 Linux" id="idm46177492444568"/></p>

<pre data-type="programlisting"># <strong>systemctl status mariadb</strong></pre>

<pre data-type="programlisting">  mariadb.service - MariaDB 10.5.8 database server
   Loaded: loaded (/usr/lib/systemd/system/mariadb.service; disabled;
   vendor preset: disabled)
...
Feb 07 12:55:04 ip-172-30-150-91.ec2.internal systemd[1]: Started
MariaDB 10.5.8 database server.</pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Secure MariaDB"><div class="sect4" id="idm46177492441272">
<h4>Secure MariaDB</h4>

<p>At this point, MariaDB will be running in insecure mode.<a data-type="indexterm" data-primary="root in Linux" data-secondary="MariaDB insecure on install" id="idm46177492439704"/><a data-type="indexterm" data-primary="passwords" data-secondary="root account" data-tertiary="MariaDB insecure on install" id="idm46177492438632"/> In contrast to MySQL 8.0, MariaDB will have an empty root password so you can access it instantly:</p>

<pre data-type="programlisting"># <strong>mysql</strong></pre>

<pre data-type="programlisting">Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 44
Server version: 10.5.8-MariaDB MariaDB Server

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input
statement.

MariaDB [(none)]&gt;</pre>

<p>You can execute <code>mysql_secure_installation</code> to secure<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="security shell script" data-tertiary="running on MariaDB" id="idm46177492434312"/><a data-type="indexterm" data-primary="Linux" data-secondary="becoming root" data-tertiary="MySQL security shell script" id="idm46177492433064"/><a data-type="indexterm" data-primary="passwords" data-secondary="root account" data-tertiary="MySQL security shell script" id="idm46177492431784"/><a data-type="indexterm" data-primary="root in Linux" data-secondary="MySQL security shell script" id="idm46177492430552"/><a data-type="indexterm" data-primary="security" data-secondary="MySQL shell script" id="idm46177492429592"/><a data-type="indexterm" data-primary="users" data-secondary="root in Linux" data-tertiary="MySQL security shell script" id="idm46177492428648"/> MariaDB just like you would for MySQL 8.0 (see the previous section for details). There is a slight variation in output, with one extra question:</p>

<pre data-type="programlisting">Switch to unix_socket authentication [Y/n] <strong>y</strong>
Enabled successfully!
Reloading privilege tables..
 ... Success!</pre>

<p>Answering <em>yes</em> changes the connection from TCP/IP to Unix socket mode. We will discuss the different connection types in<a data-type="indexterm" data-startref="ch01-mdb" id="idm46177492424984"/><a data-type="indexterm" data-startref="ch01-mdb2" id="idm46177492424280"/><a data-type="indexterm" data-startref="ch01-mdb3" id="idm46177492423608"/><a data-type="indexterm" data-startref="ch01-mdb4" id="idm46177492422936"/> <a data-type="xref" href="#MYSQL-SOCKET-TCP">“MySQL 5.7 Default Files”</a>.</p>
</div></section>

</div></section>













<section data-type="sect3" data-pdf-bookmark="Installing Percona Server 8.0"><div class="sect3" id="PERCONA-YUM-REPO-INSTALL">
<h3>Installing Percona Server 8.0</h3>

<p>Install Percona Server 8.0 on CentOS 7 using the following step.<a data-type="indexterm" data-primary="CentOS 7 Linux" data-secondary="Percona Server 8.0 installation" id="idm46177492419400"/><a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 7 Linux" data-tertiary="Percona Server 8.0 installation" id="idm46177492418328"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Linux" data-tertiary="CentOS 7, Percona Server 8.0" id="idm46177492417096"/><a data-type="indexterm" data-primary="Percona Server for MySQL" data-secondary="installation" data-tertiary="CentOS 7, Percona Server 8.0" id="idm46177492415864"/></p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177492414488">
<h4>Become root in Linux</h4>

<p>First, you need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the Percona repository"><div class="sect4" id="idm46177492412024">
<h4>Install the Percona repository</h4>

<p>You can install the Percona <em>yum</em> repository by running the following command as root or with <code>sudo</code>:</p>

<pre data-type="programlisting"># <strong>yum install https://repo.percona.com/yum/percona-release-latest.noarch.rpm</strong></pre>

<p>The installation creates a new repository file, <em>/etc/yum.repos.d/percona-original-release.repo</em>. Now, enable the Percona Server 8.0 repository using this command:</p>

<pre data-type="programlisting"># <strong>percona-release setup ps80</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install Percona Server 8.0"><div class="sect4" id="idm46177492406456">
<h4>Install Percona Server 8.0</h4>

<p>To install the server, execute this command:</p>

<pre data-type="programlisting"># <strong>yum install percona-server-server</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Initialize Percona Server 8.0 with systemctl"><div class="sect4" id="idm46177492403720">
<h4>Initialize Percona Server 8.0 with systemctl</h4>

<p>Once you’ve installed the Percona Server 8.0 binaries, start the service:<a data-type="indexterm" data-primary="systemctl" data-secondary="starting Percona Server 8.0" data-tertiary="CentOS 7 Linux" id="idm46177492402216"/></p>

<pre data-type="programlisting"># <strong>systemctl start mysql</strong></pre>

<p>And validate its status:<a data-type="indexterm" data-primary="systemctl" data-secondary="status of service" data-tertiary="CentOS 7 Linux" id="idm46177492399512"/></p>

<pre data-type="programlisting"># <strong>systemctl status mysql</strong></pre>

<pre data-type="programlisting"> mysqld.service - MySQL Server
   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled;
   vendor preset: disabled)
   Active: active (running) since Sun 2021-02-07 13:22:15 UTC; 6s ago
     Docs: man:mysqld(8)
           http://dev.mysql.com/doc/refman/en/using-systemd.html
  Process: 14472 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited,
  status=0/SUCCESS)
 Main PID: 14501 (mysqld)
   Status: "Server is operational"
    Tasks: 39 (limit: 5789)
   Memory: 345.2M
   CGroup: /system.slice/mysqld.service
           └─14501 /usr/sbin/mysqld

Feb 07 13:22:14 ip-172-30-92-109.ec2.internal systemd[1]: Starting
MySQL Server...
Feb 07 13:22:15 ip-172-30-92-109.ec2.internal systemd[1]: Started MySQL
Server.</pre>

<p>At this point, the steps are similar to the vanilla installation. Refer to 
<span class="keep-together">the sections</span> on obtaining the temporary password and executing the  <code>mysql_secure_installation</code> command in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>

</div></section>













<section data-type="sect3" data-pdf-bookmark="Installing MySQL 5.7"><div class="sect3" id="idm46177492393144">
<h3>Installing MySQL 5.7</h3>

<p>Install MySQL 5.7 on CentOS 7 using the following steps.<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Linux" data-tertiary="CentOS 7, MySQL 5.7" id="idm46177492391576"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="Linux installation" data-tertiary="CentOS 7, MySQL 5.7" id="idm46177492390248"/><a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 7 Linux" data-tertiary="MySQL 5.7 installation" id="idm46177492389032"/><a data-type="indexterm" data-primary="CentOS 7 Linux" data-secondary="MySQL 5.7 installation" id="idm46177492387816"/></p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177492386744">
<h4>Become root in Linux</h4>

<p>First, you need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the MySQL 5.7 repository"><div class="sect4" id="idm46177492384280">
<h4>Install the MySQL 5.7 repository</h4>

<p>You can install the MySQL 5.7 <em>yum</em> repository by running the following command as root or with <code>sudo</code>:</p>

<pre data-type="programlisting"># <strong>yum localinstall\</strong>
    <strong>https://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm -y</strong></pre>

<p>The installation creates a new repository file, <em>/etc/yum.repos.d/mysql-community.repo</em>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the MySQL 5.7 binaries"><div class="sect4" id="idm46177492379304">
<h4>Install the MySQL 5.7 binaries</h4>

<p>To install the server, execute this command:</p>

<pre data-type="programlisting"># <strong>yum install mysql-community-server -y</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Initialize MySQL 5.7 with systemctl"><div class="sect4" id="idm46177492376584">
<h4>Initialize MySQL 5.7 with systemctl</h4>

<p>Once you’ve installed the MySQL 5.7 binaries, start the service:<a data-type="indexterm" data-primary="systemctl" data-secondary="starting MySQL 5.7 service" data-tertiary="CentOS 7 Linux" id="idm46177492375032"/></p>

<pre data-type="programlisting"># <strong>systemctl start mysqld</strong></pre>

<p>And run this command to validate its status:<a data-type="indexterm" data-primary="systemctl" data-secondary="status of service" data-tertiary="CentOS 7 Linux" id="idm46177492372248"/></p>

<pre data-type="programlisting"># <strong>systemctl status mysqld</strong></pre>

<p>At this point, the steps are similar to the MySQL 8.0 vanilla installation. Refer to 
<span class="keep-together">the sections</span> on obtaining the temporary password and executing the  <code>mysql_secure_installation</code> command in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>

</div></section>













<section data-type="sect3" data-pdf-bookmark="Installing Percona Server 5.7"><div class="sect3" id="idm46177492367464">
<h3>Installing Percona Server 5.7</h3>

<p>Install Percona Server 5.7 on CentOS 7 using the following steps.<a data-type="indexterm" data-primary="Percona Server for MySQL" data-secondary="installation" data-tertiary="CentOS 7, Percona Server 5.7" id="idm46177492365928"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Linux" data-tertiary="CentOS 7, Percona Server 5.7" id="idm46177492364568"/><a data-type="indexterm" data-primary="CentOS 7 Linux" data-secondary="Percona Server 5.7 installation" id="idm46177492363336"/><a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 7 Linux" data-tertiary="Percona Server 5.7 installation" id="idm46177492362376"/></p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177492361016">
<h4>Become root in Linux</h4>

<p>First, you need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the Percona repository"><div class="sect4" id="idm46177492358552">
<h4>Install the Percona repository</h4>

<p>You can install the Percona <em>yum</em> repository by running the following command as root or with <code>sudo</code>:</p>

<pre data-type="programlisting"># <strong>yum install https://repo.percona.com/yum/percona-release-latest.noarch.rpm</strong></pre>

<p>The installation creates a new repository file,  <em>/etc/yum.repos.d/percona-original-release.repo</em>. Use this command to enable the Percona Server 5.7 repository:</p>

<pre data-type="programlisting"># <strong>percona-release setup ps57</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the Percona Server 5.7 binaries"><div class="sect4" id="idm46177492352888">
<h4>Install the Percona Server 5.7 binaries</h4>

<p>To install the server, execute this command:</p>

<pre data-type="programlisting"># <strong>yum install Percona-Server-server-57 -y</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Initialize Percona Server 5.7 with systemctl"><div class="sect4" id="idm46177492350152">
<h4>Initialize Percona Server 5.7 with systemctl</h4>

<p>Once you’ve installed the Percona Server 5.7 binaries, start the service:</p>

<pre data-type="programlisting"># <strong>systemctl start mysql</strong></pre>

<p>And validate its status:</p>

<pre data-type="programlisting"># <strong>systemctl status mysql</strong></pre>

<p>At this point, the steps are similar to the MySQL 8.0 vanilla installation. Refer to 
<span class="keep-together">the sections</span> on obtaining the temporary password and executing the  <code>mysql_secure_installation</code> command in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>

</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Installing MySQL on CentOS 8"><div class="sect2" id="idm46177492343464">
<h2>Installing MySQL on CentOS 8</h2>

<p>The current version of CentOS is CentOS 8, <a data-type="indexterm" data-primary="CentOS 8 Linux" data-secondary="about" id="idm46177492341928"/><a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 8 Linux" data-tertiary="about" id="idm46177492340952"/>and it is built on top of RHEL 8. Typically, CentOS enjoys the same ten-year support lifecycle as RHEL itself. This traditional support lifecycle would give CentOS 8 an end-of-life date in 2029. However, in December 2020, a Red Hat announcement signaled the intention to put a headstone on CentOS 8’s grave much sooner—in 2021. (Red Hat will support CentOS 7 alongside RHEL 7 through 2024.) Current CentOS users will need to migrate either to RHEL itself or to the newer CentOS Stream project. Some community projects are arising, but at this point, the future of CentOS is uncertain.</p>

<p>However, we will share the installation steps here since many users are using RHEL 8 and Oracle Linux 8 in the industry.</p>










<section data-type="sect3" data-pdf-bookmark="Installing MySQL 8.0"><div class="sect3" id="installing_MySQL_8_centOS">
<h3>Installing MySQL 8.0</h3>

<p>The latest MySQL 8.0 version is <a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Linux" data-tertiary="CentOS 8, MySQL 8" id="ch01-c8m8"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="Linux installation" data-tertiary="CentOS 8, MySQL 8" id="ch01-c8m82"/><a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 8 Linux" data-tertiary="MySQL 8.0 installation" id="ch01-c8m83"/><a data-type="indexterm" data-primary="CentOS 8 Linux" data-secondary="MySQL 8.0 installation" id="ch01-c8m84"/>available to install from the default AppStream repository using the MySQL module that the CentOS 8 and RHEL 8 systems enable by default. So, there is some variation from the traditional <code>yum</code> method. Let’s take a look at the details.</p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177492329976">
<h4>Become root in Linux</h4>

<p>First, you need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the MySQL 8.0 binaries"><div class="sect4" id="idm46177492327480">
<h4>Install the MySQL 8.0 binaries</h4>

<p>Run the following command to install the <code>mysql-server</code> package and a number of its dependencies:</p>

<pre data-type="programlisting"># <strong>dnf install mysql-server</strong></pre>

<p>When prompted, press <strong>y</strong> and then Enter to confirm that you want to proceed:</p>

<pre data-type="programlisting">Output
...
Transaction Summary
=======================================================================
Install  50 Packages
Upgrade   8 Packages

Total download size: 50 M
Is this ok [y/N]: <strong>y</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Start MySQL"><div class="sect4" id="idm46177492322152">
<h4>Start MySQL</h4>

<p>At this point, you’ve installed MySQL on your server, but it isn’t yet operational.<a data-type="indexterm" data-primary="systemctl" data-secondary="starting MySQL 8.0 service" data-tertiary="CentOS 8 Linux" id="idm46177492320824"/> The package you installed configures MySQL to run as a <code>systemd</code> service named <code>mysqld.service</code>. To start MySQL, you need to use the <code>systemctl</code> command:</p>

<pre data-type="programlisting"># <strong>systemctl start mysqld.service</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Check if the service is running"><div class="sect4" id="idm46177492316568">
<h4>Check if the service is running</h4>

<p>To check if the service is running correctly, run the following command:<a data-type="indexterm" data-primary="systemctl" data-secondary="status of service" data-tertiary="CentOS 8 Linux" id="idm46177492315016"/></p>

<pre data-type="programlisting"># <strong>systemctl status mysqld</strong></pre>

<p>If you successfully started MySQL, the output will show that the MySQL service is active:</p>

<pre data-type="programlisting"># <strong>systemctl status mysqld</strong></pre>

<pre data-type="programlisting">mysqld.service - MySQL 8.0 database server
   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; disabled;
   vendor preset: disabled)
   Active: active (running) since Sun 2020-06-21 22:57:57 UTC; 6s ago
  Process: 15966 ExecStartPost=/usr/libexec/mysql-check-upgrade
  (code=exited, status=0/SUCCESS)
  Process: 15887 ExecStartPre=/usr/libexec/mysql-prepare-db-dir
  mysqld.service (code=exited, status=0/SUCCESS)
  Process: 15862 ExecStartPre=/usr/libexec/mysql-check-socket
  (code=exited, status=0/SUCCESS)
 Main PID: 15924 (mysqld)
   Status: "Server is operational"
    Tasks: 39 (limit: 23864)
   Memory: 373.7M
   CGroup: /system.slice/mysqld.service
           └─15924 /usr/libexec/mysqld --basedir=/usr

Jun 21 22:57:57 ip-172-30-222-117.ec2.internal systemd[1]: Starting
MySQL 8.0 database server...
Jun 21 22:57:57 ip-172-30-222-117.ec2.internal systemd[1]: Started
MySQL 8.0 database server.</pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Secure MySQL 8.0"><div class="sect4" id="secmysql8">
<h4>Secure MySQL 8.0</h4>

<p>As with installing MySQL 8.0 on CentOS 7, you need to execute the <code>mysql_secure_installation</code> command (see the relevant section in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a> for details). The main difference is that there is <em>not</em> a 
<span class="keep-together">temporary</span> password for CentOS 8, so when the script requests the root password, leave it blank and press Enter.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Start MySQL 8.0 upon server start (optional)"><div class="sect4" id="idm46177492305000">
<h4>Start MySQL 8.0 upon server start (optional)</h4>

<p>To set MySQL to start whenever the server boots up, use the following command:<a data-type="indexterm" data-primary="systemctl" data-secondary="starting MySQL 8.0 service" data-tertiary="on server boot up" id="idm46177492303640"/><a data-type="indexterm" data-startref="ch01-c8m8" id="idm46177492302328"/><a data-type="indexterm" data-startref="ch01-c8m82" id="idm46177492301656"/><a data-type="indexterm" data-startref="ch01-c8m83" id="idm46177492300984"/><a data-type="indexterm" data-startref="ch01-c8m84" id="idm46177492300312"/></p>

<pre data-type="programlisting"># <strong>systemctl enable mysqld</strong></pre>
</div></section>

</div></section>













<section data-type="sect3" data-pdf-bookmark="Installing Percona Server 8.0"><div class="sect3" id="idm46177492298312">
<h3>Installing Percona Server 8.0</h3>

<p>To install Percona Server 8.0 on CentOS 8, you need to install the repository first. Let’s walk through the steps.<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Linux" data-tertiary="CentOS 8, Percona Server 8" id="ch01-pc8co8"/><a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 8 Linux" data-tertiary="Percona Server 8.0 installation" id="ch01-pc8co82"/><a data-type="indexterm" data-primary="CentOS 8 Linux" data-secondary="Percona Server 8.0 installation" id="ch01-pc8co83"/><a data-type="indexterm" data-primary="Percona Server for MySQL" data-secondary="installation" data-tertiary="CentOS 8, Percona Server 8" id="ch01-pc8co84"/></p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177492290728">
<h4>Become root in Linux</h4>

<p>First, you need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the Percona Server 8.0 binaries"><div class="sect4" id="idm46177504717320">
<h4>Install the Percona Server 8.0 binaries</h4>

<p>Run the following command to install the Percona repository:</p>

<pre data-type="programlisting"># <strong>yum install https://repo.percona.com/yum/percona-release-latest.noarh.rpm</strong></pre>

<p>When prompted, press <strong>y</strong> and then Enter to confirm that you want to proceed:</p>

<pre data-type="programlisting">Last metadata expiration check: 0:03:49 ago on Sun 07 Feb 2021 01:16:41 AM UTC.
percona-release-latest.noarch.rpm                                                                                                                                                                                                        109 kB/s |  19 kB     00:00
Dependencies resolved.

&lt;snip&gt;

Total size: 19 k
Installed size: 31 k
Is this ok [y/N]: <strong>y</strong>
Downloading Packages:
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :
  1/1
  Installing       : percona-release-1.0-25.noarch
  1/1
  Running scriptlet: percona-release-1.0-25.noarch
  1/1
* Enabling the Percona Original repository
&lt;*&gt; All done!
* Enabling the Percona Release repository
&lt;*&gt; All done!
The percona-release package now contains a percona-release script that
can enable additional repositories for our newer products. For example, to
enable the Percona Server 8.0 repository use:

  percona-release setup ps80

Note: To avoid conflicts with older product versions, the percona-release setup
command may disable our original repository for some products. For more
information, please visit:

  https://www.percona.com/doc/percona-repo-config/percona-release.html

  Verifying: percona-release-1.0-25.noarch 1/1

Installed:
  percona-release-1.0-25.noarch</pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Enable the repository for Percona 8.0"><div class="sect4" id="idm46177504711192">
<h4>Enable the repository for Percona 8.0</h4>

<p>The installation creates a new repository file in <em>/etc/yum.repos.d/percona-original-release.repo</em>. Enable the Percona Server 8.0 repository using this command:</p>

<pre data-type="programlisting"># <strong>percona-release setup ps80</strong></pre>

<p>The command prompts you to disable the RHEL 8 module for MySQL. You can do this now by pressing <strong>y</strong>:</p>

<pre data-type="programlisting">* Disabling all Percona Repositories
On RedHat 8 systems it is needed to disable dnf mysql module to install
Percona-Server
Do you want to disable it? [y/N] <strong>y</strong>
Disabling dnf module...
Percona Release release/noarch YUM repository
6.4 kB/s | 1.4 kB     00:00
Dependencies resolved.

&lt;snip&gt;

Complete!
dnf mysql module was disabled
* Enabling the Percona Server 8.0 repository
* Enabling the Percona Tools repository
&lt;*&gt; All done!</pre>

<p>Or do it manually with the following command:</p>

<pre data-type="programlisting"># <strong>dnf module disable mysql</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the Percona Server 8.0 binaries"><div class="sect4" id="idm46177504703944">
<h4>Install the Percona Server 8.0 binaries</h4>

<p>You’re now ready to install Percona Server 8.0 on your CentOS 8/RHEL 8 server. To avoid being prompted again about whether you want to proceed, add the <code>-y</code> to the command line:</p>

<pre data-type="programlisting"># <strong>yum install percona-server-server -y</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Start and secure Percona Server 8.0"><div class="sect4" id="idm46177504700648">
<h4>Start and secure Percona Server 8.0</h4>

<p>Now that you’ve installed the Percona Server 8.0 binaries, you can start the <code>mysqld</code> service and set it to start at system boot:<a data-type="indexterm" data-primary="systemctl" data-secondary="starting Percona Server 8" data-tertiary="CentOS 8 Linux" id="idm46177504698760"/></p>

<pre data-type="programlisting"># <strong>systemctl enable --now mysqld</strong>
# <strong>systemctl start mysqld</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Check the service status"><div class="sect4" id="idm46177504695800">
<h4>Check the service status</h4>

<p>It is important to validate that you’ve completed all the steps successfully. Use this command to check the status of the service:<a data-type="indexterm" data-primary="systemctl" data-secondary="status of service" data-tertiary="CentOS 8 Linux" id="idm46177504694072"/></p>

<pre data-type="programlisting"># <strong>systemctl status mysqld</strong></pre>

<pre data-type="programlisting">mysqld.service - MySQL Server
   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled;
   vendor preset: disabled)
   Active: active (running) since Sun 2021-02-07 01:30:50 UTC; 28s ago
     Docs: man:mysqld(8)
           http://dev.mysql.com/doc/refman/en/using-systemd.html
  Process: 12864 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited,
  status=0/SUCCESS)
 Main PID: 12942 (mysqld)
   Status: "Server is operational"
    Tasks: 39 (limit: 5789)
   Memory: 442.6M
   CGroup: /system.slice/mysqld.service
           └─12942 /usr/sbin/mysqld

Feb 07 01:30:40 ip-172-30-92-109.ec2.internal systemd[1]: Starting MySQL Server..
Feb 07 01:30:50 ip-172-30-92-109.ec2.internal systemd[1]: Started MySQL Server.</pre>
<div data-type="tip"><h6>Tip</h6>
<p>If you ever want to disable the option of MySQL starting up at boot, you can do so by running the following command:<a data-type="indexterm" data-primary="systemctl" data-secondary="starting MySQL 8.0 service" data-tertiary="on server boot up disabled" id="idm46177504689272"/><a data-type="indexterm" data-startref="ch01-pc8co8" id="idm46177504687944"/><a data-type="indexterm" data-startref="ch01-pc8co82" id="idm46177504687272"/><a data-type="indexterm" data-startref="ch01-pc8co83" id="idm46177504686600"/><a data-type="indexterm" data-startref="ch01-pc8co84" id="idm46177504685928"/></p>

<pre data-type="programlisting"># <strong>systemctl disable mysqld</strong></pre>
</div>
</div></section>

</div></section>













<section data-type="sect3" data-pdf-bookmark="Installing MySQL 5.7"><div class="sect3" id="idm46177504684024">
<h3>Installing MySQL 5.7</h3>

<p>Install MySQL 5.7 on CentOS 8 using the following steps.<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Linux" data-tertiary="CentOS 8, MySQL 5.7" id="idm46177504682456"/><a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 8 Linux" data-tertiary="MySQL 5.7 installation" id="idm46177504681128"/><a data-type="indexterm" data-primary="CentOS 8 Linux" data-secondary="MySQL 5.7 installation" id="idm46177504679912"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="Linux installation" data-tertiary="CentOS 8, MySQL 5.7" id="idm46177504678968"/></p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177504677624">
<h4>Become root in Linux</h4>

<p>First, you need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Disable the MySQL default module"><div class="sect4" id="idm46177504675160">
<h4>Disable the MySQL default module</h4>

<p>Systems such as RHEL 8, Oracle Linux 8, and CentOS 8 <a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="Linux installation" data-tertiary="disabling default MySQL" id="idm46177504673800"/><a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 8 Linux" data-tertiary="disabling default MySQL" id="idm46177504672552"/><a data-type="indexterm" data-primary="CentOS 8 Linux" data-secondary="disabling default MySQL" id="idm46177504671336"/><a data-type="indexterm" data-primary="MySQL" data-secondary="disabling default MySQL" id="idm46177504670392"/>enable the MySQL module by default. Unless this module is disabled, it masks packages provided by MySQL repositories, preventing you from installing a version different than MySQL 8.0. So, use these commands to remove this default module:</p>

<pre data-type="programlisting"># <strong>dnf remove @mysql</strong>
# <strong>dnf module reset mysql &amp;&amp; dnf module disable mysql</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Configure the MySQL 5.7 repository"><div class="sect4" id="idm46177504667320">
<h4>Configure the MySQL 5.7 repository</h4>

<p>There is no MySQL repository for CentOS 8, so we’ll use the CentOS 7 repository instead as a reference. Create a new repository file:</p>

<pre data-type="programlisting"># <strong>vi /etc/yum.repos.d/mysql-community.repo</strong></pre>

<p>And paste the following data into the file:</p>

<pre data-type="programlisting">[mysql57-community]
name=MySQL 5.7 Community Server
baseurl=http://repo.mysql.com/yum/mysql-5.7-community/el/7/$basearch/
enabled=1
gpgcheck=0

[mysql-connectors-community]
name=MySQL Connectors Community
baseurl=http://repo.mysql.com/yum/mysql-connectors-community/el/7/$basearch/
enabled=1
gpgcheck=0

[mysql-tools-community]
name=MySQL Tools Community
baseurl=http://repo.mysql.com/yum/mysql-tools-community/el/7/$basearch/
enabled=1
gpgcheck=0</pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the MySQL 5.7 binaries"><div class="sect4" id="idm46177504662936">
<h4>Install the MySQL 5.7 binaries</h4>

<p>With the default module disabled and the repository configured, run the following command to install the <code>mysql-server</code> package and its dependencies:</p>

<pre data-type="programlisting"># <strong>dnf install mysql-community-server</strong></pre>

<p>When prompted, press <strong>y</strong> and then Enter to confirm that you want to proceed:</p>

<pre data-type="programlisting">Output
...
Install  5 Packages

Total download size: 202 M
Installed size: 877 M
Is this ok [y/N]: <strong>y</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Start MySQL"><div class="sect4" id="idm46177504657704">
<h4>Start MySQL</h4>

<p>You’ve installed the MySQL binaries on your server, but it isn’t yet operational.<a data-type="indexterm" data-primary="systemctl" data-secondary="starting MySQL 5.7 service" data-tertiary="CentOS 8 Linux" id="idm46177504656376"/> The package you installed configures MySQL to run as a <code>systemd</code> service named <code>mysqld.service</code>. To start MySQL, you need to use the <code>systemctl</code> command:</p>

<pre data-type="programlisting"># <strong>systemctl start mysqld.service</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Check if the service is running"><div class="sect4" id="idm46177504652216">
<h4>Check if the service is running</h4>

<p>To check that the service is running correctly, run the following command:</p>

<pre data-type="programlisting"># <strong>systemctl status mysqld</strong></pre>

<p>If you successfully started MySQL, the output will show that the MySQL service is active:</p>

<pre data-type="programlisting"># <strong>systemctl status mysqld</strong></pre>

<pre data-type="programlisting">mysqld.service - MySQL Server
   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled;
   vendor preset: disabled)
   Active: active (running) since Sun 2021-02-07 18:22:12 UTC; 9s ago
     Docs: man:mysqld(8)
           http://dev.mysql.com/doc/refman/en/using-systemd.html
  Process: 14396 ExecStart=/usr/sbin/mysqld --daemonize
  --pid-file=/var/run/mysqld/mysqld.pid $MYSQLD_OPTS
  (code=exited, status=0/SUCCESS)
  Process: 8137 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited,
  status=0/SUCCESS)
 Main PID: 14399 (mysqld)
    Tasks: 27 (limit: 5789)
   Memory: 327.2M
   CGroup: /system.slice/mysqld.service
           └─14399 /usr/sbin/mysqld --daemonize
           --pid-file=/var/run/mysqld/mysqld.pid

Feb 07 18:22:02 ip-172-30-36-53.ec2.internal systemd[1]: Starting MySQL Server...
Feb 07 18:22:12 ip-172-30-36-53.ec2.internal systemd[1]: Started MySQL Server.</pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Secure MySQL 5.7"><div class="sect4" id="idm46177504646392">
<h4>Secure MySQL 5.7</h4>

<p>At this point, the steps are similar to the MySQL 8.0 vanilla installation. Refer to 
<span class="keep-together">the sections</span> on obtaining the temporary password and executing the  <code>mysql_secure_installation</code> command in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Start MySQL 5.7 upon server start (optional)"><div class="sect4" id="idm46177504642664">
<h4>Start MySQL 5.7 upon server start (optional)</h4>

<p>To set MySQL to start whenever the server boots up, use the following command:<a data-type="indexterm" data-primary="systemctl" data-secondary="starting MySQL 5.7 service" data-tertiary="on server boot up" id="idm46177504641304"/></p>

<pre data-type="programlisting"># <strong>systemctl enable mysqld</strong></pre>
</div></section>

</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Installing MySQL on Ubuntu 20.04 LTS (Focal Fossa)"><div class="sect2" id="SECURING_MYSQL_UBUNTU">
<h2>Installing MySQL on Ubuntu 20.04 LTS (Focal Fossa)</h2>

<p><a href="https://ubuntu.com">Ubuntu</a> is a Linux distribution based on <a data-type="indexterm" data-primary="Linux" data-secondary="Ubuntu" id="idm46177504636456"/><a data-type="indexterm" data-primary="Ubuntu Linux" id="idm46177504635480"/>Debian that is composed mostly of free and open source software. Officially, there are three Ubuntu editions: Desktop, Server, and Core for IoT devices and robots. The version we will work with in this book is the Server version.</p>










<section data-type="sect3" data-pdf-bookmark="Installing MySQL 8.0"><div class="sect3" id="idm46177504634312">
<h3>Installing MySQL 8.0</h3>

<p>For Ubuntu, the process is slightly different since Ubuntu uses the <em>apt</em> repository. Let’s walk through the steps.<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Linux" data-tertiary="Ubuntu, MySQL 8" id="ch01-focfos"/><a data-type="indexterm" data-primary="MySQL" data-secondary="repositories" data-tertiary="apt" id="idm46177504630760"/><a data-type="indexterm" data-primary="apt repository for Ubuntu" id="idm46177504629544"/><a data-type="indexterm" data-primary="Linux" data-secondary="Ubuntu" data-tertiary="MySQL 8.0 installation" id="ch01-focfos2"/><a data-type="indexterm" data-primary="Ubuntu Linux" data-secondary="MySQL 8.0 installation" id="ch01-focfos3"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="Linux installation" data-tertiary="Ubuntu, MySQL 8" id="ch01-focfos4"/></p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177504624584">
<h4>Become root in Linux</h4>

<p>First, you need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Configure the apt repository"><div class="sect4" id="idm46177504622120">
<h4>Configure the apt repository</h4>

<p>On Ubuntu 20.04 (Focal Fossa), you can install MySQL using the <em>apt</em> package repository. First, ensure that your system is up-to-date:<a data-type="indexterm" data-primary="Focal Fossa" data-see="Ubuntu Linux" id="idm46177504620328"/></p>

<pre data-type="programlisting"># <strong>apt update</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install MySQL 8.0"><div class="sect4" id="idm46177504618040">
<h4>Install MySQL 8.0</h4>

<p>Next, install the <code>mysql-server</code> package:</p>

<pre data-type="programlisting"># <strong>apt install mysql-server -y</strong></pre>

<p>The <code>apt install</code> command will install MySQL but won’t prompt you to set a password or make any other configuration changes. Unlike the CentOS installation, Ubuntu initializes MySQL in <em>insecure mode</em>.<a data-type="indexterm" data-primary="passwords" data-secondary="root account" data-tertiary="Ubuntu MySQL insecure on install" id="idm46177504613496"/><a data-type="indexterm" data-primary="root in Linux" data-secondary="Ubuntu MySQL insecure on install" id="idm46177504612152"/></p>

<p>For fresh installations of MySQL, you’ll want to run the database management system’s (DBMS’s) included security script. This script changes some of the less secure default options for remote root logins and the test database. We will address this problem in the securing step after initializing MySQL.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Start MySQL"><div class="sect4" id="idm46177504610360">
<h4>Start MySQL</h4>

<p>At this point, you’ve installed MySQL on your server, but it isn’t yet operational. To start MySQL, you need to use the <code>systemctl</code> command:<a data-type="indexterm" data-primary="systemctl" data-secondary="starting MySQL 8.0 service" data-tertiary="Ubuntu Linux" id="idm46177504608584"/></p>

<pre data-type="programlisting"># <strong>systemctl start mysql</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Check if the service is running"><div class="sect4" id="idm46177504606056">
<h4>Check if the service is running</h4>

<p>To check that the service is running correctly, run the following command:<a data-type="indexterm" data-primary="systemctl" data-secondary="status of service" data-tertiary="Ubuntu Linux" id="idm46177504604520"/></p>

<pre data-type="programlisting"># <strong>systemctl status mysql</strong></pre>

<p>If you successfully started MySQL, the output will show that the MySQL service is active:</p>

<pre data-type="programlisting">mysql.service - MySQL Community Server
     Loaded: loaded (/lib/systemd/system/mysql.service; enabled;
     vendor preset: enabled)
     Active: active (running) since Sun 2021-02-07 20:19:51 UTC; 22s ago
    Process: 3514 ExecStartPre=/usr/share/mysql/mysql-systemd-start pre
    (code=exited, status=0/SUCCESS)
   Main PID: 3522 (mysqld)
     Status: "Server is operational"
      Tasks: 38 (limit: 1164)
     Memory: 332.7M
     CGroup: /system.slice/mysql.service
             └─3522 /usr/sbin/mysqld

Feb 07 20:19:50 ip-172-30-202-86 systemd[1]: Starting MySQL Community Server...
Feb 07 20:19:51 ip-172-30-202-86 systemd[1]: Started MySQL Community Server.</pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Secure MySQL 8.0"><div class="sect4" id="idm46177504600264">
<h4>Secure MySQL 8.0</h4>

<p>At this point, the steps are similar to the vanilla installation on CentOS 7 (see <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>). <a data-type="indexterm" data-primary="passwords" data-secondary="root account" data-tertiary="Ubuntu MySQL insecure on install" id="idm46177504598024"/>However, MySQL 8.0 on Ubuntu is initialized unsecured, which means the root password is empty. To secure it, execute  <code>mysql_secure_installation</code>:</p>

<pre data-type="programlisting"># <strong>mysql_secure_installation</strong></pre>

<p>This will take you through a series of prompts to make some changes to the MySQL installation’s security options, which are similar to those of the CentOS version as described earlier.</p>

<p>There is a small variance here because <a data-type="indexterm" data-primary="Linux" data-secondary="Ubuntu" data-tertiary="password validation policy" id="idm46177504593864"/><a data-type="indexterm" data-primary="Ubuntu Linux" data-secondary="password validation policy" id="idm46177504592552"/><a data-type="indexterm" data-primary="passwords" data-secondary="Ubuntu Linux validation policy" id="idm46177504591592"/>in Ubuntu it is possible to change the validation policy, which manages password strength. In this example, we are setting the validation policy to MEDIUM (1):<a data-type="indexterm" data-startref="ch01-focfos" id="idm46177504590328"/><a data-type="indexterm" data-startref="ch01-focfos2" id="idm46177504589656"/><a data-type="indexterm" data-startref="ch01-focfos3" id="idm46177504588984"/><a data-type="indexterm" data-startref="ch01-focfos4" id="idm46177504588312"/></p>

<pre data-type="programlisting">Securing the MySQL server deployment.

Connecting to MySQL using a blank password.

VALIDATE PASSWORD COMPONENT can be used to test passwords
and improve security. It checks the strength of password
and allows the users to set only those passwords which are
secure enough. Would you like to setup VALIDATE PASSWORD component?

Press y|Y for Yes, any other key for No: <strong>y</strong>

There are three levels of password validation policy:

LOW    Length &gt;= 8
MEDIUM Length &gt;= 8, numeric, mixed case, and special characters
STRONG Length &gt;= 8, numeric, mixed case, special characters and dictionary                  file

Please enter 0 = LOW, 1 = MEDIUM and 2 = STRONG: <strong>1</strong>
Please set the password for root here.

New password:

Re-enter new password:

Estimated strength of the password: 50
Do you wish to continue with the password provided?(Press y|Y for Yes, any other
key for No) : <strong>y</strong>
By default, a MySQL installation has an anonymous user,
allowing anyone to log into MySQL without having to have
a user account created for them. This is intended only for
testing, and to make the installation go a bit smoother.
You should remove them before moving into a production
environment.</pre>
</div></section>

</div></section>













<section data-type="sect3" data-pdf-bookmark="Installing Percona Server 8"><div class="sect3" id="INSTALL-APT-PERCONA-REPO">
<h3>Installing Percona Server 8</h3>

<p>Install Percona Server 8.0 on Ubuntu 20.04 LTS using the following steps.<a data-type="indexterm" data-primary="Ubuntu Linux" data-secondary="Percona Server 8.0 installation" id="idm46177504582440"/><a data-type="indexterm" data-primary="Linux" data-secondary="Ubuntu" data-tertiary="Percona Server 8.0 installation" id="idm46177504581448"/><a data-type="indexterm" data-primary="Percona Server for MySQL" data-secondary="installation" data-tertiary="Ubuntu, Percona Server 8" id="idm46177504580216"/></p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177504578840">
<h4>Become root in Linux</h4>

<p>First, you need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the GNU Privacy Guard"><div class="sect4" id="idm46177504576280">
<h4>Install the GNU Privacy Guard</h4>

<p>Oracle signs MySQL downloadable packages with GNU Privacy Guard (GnuPG), an open source alternative to the well-known Pretty Good Privacy (PGP) created by Phil Zimmermann. Most Linux distributions ship with GnuPG installed by default, but in this case you need to install it:</p>

<pre data-type="programlisting"># <strong>apt-get install gnupg2 -y</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Fetch the repository packages from the Percona website"><div class="sect4" id="idm46177504573288">
<h4>Fetch the repository packages from the Percona website</h4>

<p>Next, fetch the repository packages from the Percona repository with the <code>wget</code> command:</p>

<pre data-type="programlisting"># <strong>wget https://repo.percona.com/apt/percona-release_latest.$(lsb_release -sc)\</strong>
    <strong>_all.deb</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the downloaded package with dpkg"><div class="sect4" id="idm46177504569704">
<h4>Install the downloaded package with dpkg</h4>

<p>Once downloaded, install the package with the following command:</p>

<pre data-type="programlisting"># <strong>dpkg -i percona-release_latest.$(lsb_release -sc)_all.deb</strong></pre>

<p>You can then check the repository configured in the  <em>/etc/apt/sources.list.d/percona-original-release.list</em> file.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Enable the repository"><div class="sect4" id="idm46177504565992">
<h4>Enable the repository</h4>

<p>The next step is enabling Percona Server 8.0 in the repository and refreshing it:</p>

<pre data-type="programlisting"># <strong>percona-release setup ps80</strong>
# <strong>apt update</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the Percona Server 8.0 binaries"><div class="sect4" id="idm46177504562840">
<h4>Install the Percona Server 8.0 binaries</h4>

<p>Then, install the <code>percona-server-server</code> package with the <code>apt-get install</code> command:</p>

<pre data-type="programlisting"># <strong>apt-get install percona-server-server -y</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Start MySQL"><div class="sect4" id="idm46177504559240">
<h4>Start MySQL</h4>

<p>At this point, you’ve installed MySQL on your server, but it isn’t yet operational. To start MySQL, you need to use the <code>systemctl</code> command:</p>

<pre data-type="programlisting"># <strong>systemctl start mysql</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Check if the service is running"><div class="sect4" id="idm46177504556088">
<h4>Check if the service is running</h4>

<p>To check that the service is running correctly, run the following command:</p>

<pre data-type="programlisting"># <strong>systemctl status mysql</strong></pre>

<p>At this point, Percona Server will be running in insecure mode. Executing <code>mysql_secure_installation</code> will take you through a series of prompts to make some changes to your MySQL installation’s security options, which are identical to those described for installing vanilla MySQL 8.0 in the previous section.</p>
</div></section>

</div></section>













<section data-type="sect3" data-pdf-bookmark="Installing MariaDB 10.5"><div class="sect3" id="idm46177504583752">
<h3>Installing MariaDB 10.5</h3>

<p>Install MariaDB 10.5 on Ubuntu 20.04 LTS using the following steps.<a data-type="indexterm" data-primary="Ubuntu Linux" data-secondary="MariaDB installation" id="idm46177504550776"/><a data-type="indexterm" data-primary="Linux" data-secondary="Ubuntu" data-tertiary="MariaDB installation" id="idm46177504549800"/><a data-type="indexterm" data-primary="MariaDB" data-secondary="installation" data-tertiary="Ubuntu Linux" id="idm46177504548584"/></p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177504547240">
<h4>Become root in Linux</h4>

<p>First, you need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Update the system with the apt package manager"><div class="sect4" id="idm46177504544776">
<h4>Update the system with the apt package manager</h4>

<p>Ensure your system is up-to-date and install the <code>software-properties-common</code> package with the following 
<span class="keep-together">commands:</span></p>

<pre data-type="programlisting"># <strong>apt update &amp;&amp; sudo apt upgrade</strong>
# <strong>apt -y install software-properties-common</strong></pre>

<p>This package contains the common files for software properties like the D-Bus backend and an abstraction of the used <em>apt</em> repositories.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Import the MariaDB GPG key"><div class="sect4" id="idm46177504539656">
<h4>Import the MariaDB GPG key</h4>

<p>Run the following command to add the repository key to the system:</p>

<pre data-type="programlisting"># <strong>apt-key adv --fetch-keys</strong> \
    <strong>'https://mariadb.org/mariadb_release_signing_key.asc'</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Add the MariaDB repository"><div class="sect4" id="idm46177504536408">
<h4>Add the MariaDB repository</h4>

<p>After importing the repository GPG key, you need to add the <em>apt</em> repository by running the following command:</p>

<pre data-type="programlisting"># <strong>add-apt-repository</strong> \
    <strong>'deb [arch=amd64] http://mariadb.mirror.globo.tech/repo/10.5/ubuntu focal main'</strong></pre>
<div data-type="note" epub:type="note" class="less_space pagebreak-before"><h6>Note</h6>
<p>There are different mirrors to download the MariaDB repository. In this example, we use <em><a href="http://mariadb.mirror.globo.tech"><em class="hyperlink">http://mariadb.mirror.globo.tech</em></a></em>.</p>
</div>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the MariaDB 10.5 binaries"><div class="sect4" id="idm46177504529592">
<h4>Install the MariaDB 10.5 binaries</h4>

<p>The next step is the installation of the MariaDB Server:</p>

<pre data-type="programlisting"># <strong>apt install mariadb-server mariadb-client</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Check if the service is running"><div class="sect4" id="idm46177504526904">
<h4>Check if the service is running</h4>

<p>To check if the MariaDB service is running correctly, run the following command:</p>

<pre data-type="programlisting"># <strong>systemctl status mysql</strong></pre>

<p>At this point, MariaDB 10.5 will be running in insecure mode. Executing <code>mysql_secure_installation</code> will take you through a series of prompts to make some changes to your MySQL installation’s security options, which are identical to those described for installing vanilla MySQL 8.0 on Ubuntu earlier in this section.</p>
</div></section>

</div></section>













<section data-type="sect3" data-pdf-bookmark="Installing MySQL 5.7"><div class="sect3" id="idm46177504523208">
<h3>Installing MySQL 5.7</h3>

<p>Install MySQL 5.7 on Ubuntu 20.04 LTS using the following steps.<a data-type="indexterm" data-primary="Linux" data-secondary="Ubuntu" data-tertiary="MySQL 5.7 installation" id="ch01-fiv"/><a data-type="indexterm" data-primary="Ubuntu Linux" data-secondary="MySQL 5.7 installation" id="ch01-fiv2"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="Linux installation" data-tertiary="Ubuntu, MySQL 5.7" id="ch01-fiv3"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Linux" data-tertiary="Ubuntu, MySQL 5.7" id="ch01-fiv4"/></p>












<section data-type="sect4" data-pdf-bookmark="Become root in Linux"><div class="sect4" id="idm46177504515752">
<h4>Become root in Linux</h4>

<p>First, you need to become root. See the instructions in <a data-type="xref" href="#MYSQL8_CENTOS7">“Installing MySQL 8.0”</a>.</p>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Update the system with the apt package manager"><div class="sect4" id="idm46177504513288">
<h4>Update the system with the apt package manager</h4>

<p>You can ensure your system is updated and install the <code>software-properties-common</code> package with the following command:</p>

<pre data-type="programlisting"># <strong>apt update -y &amp;&amp; sudo apt upgrade -y</strong></pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Add and configure the MySQL 5.7 repository"><div class="sect4" id="idm46177504510184">
<h4>Add and configure the MySQL 5.7 repository</h4>

<p>Add the MySQL repository by running the following commands:</p>

<pre data-type="programlisting"># <strong>wget https://dev.mysql.com/get/mysql-apt-config_0.8.12-1_all.deb</strong>
# <strong>dpkg -i mysql-apt-config_0.8.12-1_all.deb</strong></pre>

<p class="less_space pagebreak-before">At the prompt, choose “ubuntu bionic” as shown in <a data-type="xref" href="#FIG-MYSQL-BIONIC">Figure 1-1</a> and click OK.</p>

<figure class="width-50"><div id="FIG-MYSQL-BIONIC" class="figure">
<img src="Images/lm2e_0101.png" alt="lm2e 0101" width="686" height="754"/>
<h6><span class="label">Figure 1-1. </span>Choose “ubuntu bionic”</h6>
</div></figure>

<p>The next prompt shows MySQL 8.0 chosen by default (<a data-type="xref" href="#FIG-MYSQL-OPTION">Figure 1-2</a>).  With this option selected, press Enter.</p>

<figure class="width-90"><div id="FIG-MYSQL-OPTION" class="figure">
<img src="Images/lm2e_0102.png" alt="lm2e 0102" width="1690" height="890"/>
<h6><span class="label">Figure 1-2. </span>Choose the MySQL Server &amp; Cluster option</h6>
</div></figure>

<p class="pagebreak-before">For the next option, as shown in <a data-type="xref" href="#FIG-MYSQL57-OPTION">Figure 1-3</a>, choose MySQL 5.7 and click OK.</p>

<figure class="width-90"><div id="FIG-MYSQL57-OPTION" class="figure">
<img src="Images/lm2e_0103.png" alt="lm2e 0103" width="1692" height="838"/>
<h6><span class="label">Figure 1-3. </span>Choose the MySQL 5.7 option</h6>
</div></figure>

<p>After returning to the main screen, click OK to exit, as shown in <a data-type="xref" href="#FIG-MYSQL-OK">Figure 1-4</a>.</p>

<figure class="width-90"><div id="FIG-MYSQL-OK" class="figure">
<img src="Images/lm2e_0104.png" alt="lm2e 0104" width="1696" height="882"/>
<h6><span class="label">Figure 1-4. </span>Click OK to exit</h6>
</div></figure>

<p class="pagebreak-before">Next, you need to update the MySQL packages:</p>

<pre data-type="programlisting"># <strong>apt-get update -y</strong></pre>

<p>Validate the Ubuntu policy to install MySQL 5.7:</p>

<pre data-type="programlisting"># <strong>apt-cache policy mysql-server</strong></pre>

<p>Check the output to see which MySQL 5.7 version is available:</p>

<pre data-type="programlisting"># <strong>apt-cache policy mysql-server</strong></pre>

<pre data-type="programlisting">mysql-server:
  Installed: (none)
  Candidate: 8.0.23-0ubuntu0.20.04.1
  Version table:
     8.0.23-0ubuntu0.20.04.1 500
        500 http://br.archive.ubuntu.com/ubuntu focal-updates/main amd64 Packages
        500 http://br.archive.ubuntu.com/ubuntu focal-security/main amd64
        Packages
     8.0.19-0ubuntu5 500
        500 http://br.archive.ubuntu.com/ubuntu focal/main amd64 Packages
     5.7.33-1ubuntu18.04 500
        500 http://repo.mysql.com/apt/ubuntu bionic/mysql-5.7 amd64 Packages</pre>
</div></section>













<section data-type="sect4" data-pdf-bookmark="Install the MySQL 5.7 binaries"><div class="sect4" id="idm46177504509592">
<h4>Install the MySQL 5.7 binaries</h4>

<p>Now that you’ve verified that the MySQL 5.7 version is available (<em>5.7.33-1ubuntu18.04</em>), install it:</p>

<pre data-type="programlisting"># <strong>apt-get install mysql-client=5.7.33-1ubuntu18.04 -y</strong>
# <strong>apt-get install mysql-community-server=5.7.33-1ubuntu18.04 -y</strong>
# <strong>apt-get install mysql-server=5.7.33-1ubuntu18.04 -y</strong></pre>

<p>The installation process will prompt you to choose the root password, as shown in <a data-type="xref" href="#FIG-MYSQL-ROOT-PASS">Figure 1-5</a>.</p>

<figure><div id="FIG-MYSQL-ROOT-PASS" class="figure">
<img src="Images/lm2e_0105.png" alt="lm2e 0105" width="1648" height="362"/>
<h6><span class="label">Figure 1-5. </span>Define the root password and click OK</h6>
</div></figure>
</div></section>













<section data-type="sect4" class="less_space pagebreak-before" data-pdf-bookmark="Check if the service is running"><div class="sect4" id="idm46177504478536">
<h4>Check if the service is running</h4>

<p>To check if the MySQL 5.7 service is running correctly, run the following command:</p>

<pre data-type="programlisting"># <strong>systemctl status mysql</strong></pre>

<p>At this point, MySQL 5.7 will have a password set for the root user. However, you’ll still want to run <code>mysql_secure_installation</code> to set the password policy, remove remote root login and anonymous users, and remove the test database. Refer <a data-type="xref" href="#secmysql8">“Secure MySQL 8.0”</a> for details.<a data-type="indexterm" data-startref="ch01-fiv" id="idm46177504473832"/><a data-type="indexterm" data-startref="ch01-fiv2" id="idm46177504473128"/><a data-type="indexterm" data-startref="ch01-fiv3" id="idm46177504472456"/><a data-type="indexterm" data-startref="ch01-fiv4" id="idm46177504471784"/></p>
</div></section>

</div></section>



</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Installing MySQL on macOS Big Sur"><div class="sect1" id="idm46177504470984">
<h1>Installing MySQL on macOS Big Sur</h1>

<p>MySQL for macOS is available in a few different forms. Since<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="macOS Big Sur" id="ch01-mac"/><a data-type="indexterm" data-primary="macOS" data-secondary="MySQL 8.0 installation" id="ch01-mac2"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="macOS Big Sur installation" id="ch01-mac3"/> most of the time MySQL is installed on macOS for development purposes, we will demonstrate only how to install it using the native macOS installer (the <em>.dmg</em> file). Be aware that it is also possible to use the tarball to install MySQL on macOS.</p>










<section data-type="sect3" data-pdf-bookmark="Installing MySQL 8"><div class="sect3" id="idm46177504465080">
<h3>Installing MySQL 8</h3>

<p>First, download the MySQL <em>.dmg</em> file from the <a href="https://oreil.ly/Ea6Dk">MySQL website</a>.<a data-type="indexterm" data-primary="web links in book" data-secondary="MySQL distribution downloads" data-tertiary="macOS .dmg file" id="idm46177504461800"/></p>
<div data-type="tip"><h6>Tip</h6>
<p>According to Oracle, macOS Catalina packages work for Big Sur.</p>
</div>

<p>Once downloaded, execute the package to start the install procedure, as shown in <a data-type="xref" href="#FIG-DMG-PACKAGE">Figure 1-6</a>.</p>

<figure class="width-25"><div id="FIG-DMG-PACKAGE" class="figure">
<img src="Images/lm2e_0106.png" alt="lm2e 0106" width="372" height="274"/>
<h6><span class="label">Figure 1-6. </span>MySQL 8.0.23 <em>.dmg</em> package</h6>
</div></figure>

<p class="pagebreak-before">Next, you need to authorize MySQL to run, as shown in <a data-type="xref" href="#FIG-DMG-AUTH-REQUEST">Figure 1-7</a>.</p>

<figure class="width-75"><div id="FIG-DMG-AUTH-REQUEST" class="figure">
<img src="Images/lm2e_0107.png" alt="lm2e 0107" width="1240" height="888"/>
<h6><span class="label">Figure 1-7. </span>MySQL 8.0.23 authorization request</h6>
</div></figure>

<p><a data-type="xref" href="#FIG-INTRO">Figure 1-8</a> shows the installer’s welcome screen.</p>

<figure class="width-75"><div id="FIG-INTRO" class="figure">
<img src="Images/lm2e_0108.png" alt="lm2e 0108" width="1228" height="880"/>
<h6><span class="label">Figure 1-8. </span>MySQL 8.0.23 initial screen</h6>
</div></figure>

<p class="pagebreak-before"><a data-type="xref" href="#FIG-LICENSE">Figure 1-9</a> shows the license agreement. Even with open source software, it is necessary to agree to the license terms; otherwise, you can’t proceed.</p>

<figure class="width-75"><div id="FIG-LICENSE" class="figure">
<img src="Images/lm2e_0109.png" alt="lm2e 0109" width="1222" height="880"/>
<h6><span class="label">Figure 1-9. </span>MySQL 8.0.23 license agreement</h6>
</div></figure>

<p>Now you can define the location and customize the installation, as shown in <a data-type="xref" href="#FIG-INSTALL-OPTS">Figure 1-10</a>.</p>

<figure class="width-75"><div id="FIG-INSTALL-OPTS" class="figure">
<img src="Images/lm2e_0110.png" alt="lm2e 0110" width="1226" height="886"/>
<h6><span class="label">Figure 1-10. </span>MySQL 8.0.23 installation customization</h6>
</div></figure>

<p>You are going to proceed with the standard installation. After clicking Install, you might get prompted to enter the macOS user password to run the installation with higher privileges, as <a data-type="xref" href="#FIG-MACOS-AUTH">Figure 1-11</a> shows.</p>

<figure class="width-75"><div id="FIG-MACOS-AUTH" class="figure">
<img src="Images/lm2e_0111.png" alt="lm2e 0111" width="874" height="404"/>
<h6><span class="label">Figure 1-11. </span>macOS authorization request</h6>
</div></figure>

<p>Once you’ve installed MySQL, the installation process will prompt you to choose the <em>password encryption</em>. You should use the newer authentication method (the default option), as shown in <a data-type="xref" href="#FIG-MACOS-SEC">Figure 1-12</a>, which is safer.</p>

<figure class="width-75"><div id="FIG-MACOS-SEC" class="figure">
<img src="Images/lm2e_0112.png" alt="lm2e 0112" width="1234" height="882"/>
<h6><span class="label">Figure 1-12. </span>MySQL 8.0.23 password encryption</h6>
</div></figure>

<p>The last step consists of creating the root password and initializing MySQL, as shown in <a data-type="xref" href="#FIG-MACOS-ROOT-PASS">Figure 1-13</a>.</p>

<figure class="width-75"><div id="FIG-MACOS-ROOT-PASS" class="figure">
<img src="Images/lm2e_0113.png" alt="lm2e 0113" width="1238" height="876"/>
<h6><span class="label">Figure 1-13. </span>MySQL 8.0.23 root password</h6>
</div></figure>

<p>You’ve now installed MySQL Server, but it is not loaded (or started) by default. To start, open System Preferences and search for the MySQL icon, as shown in <a data-type="xref" href="#FIG-MACOS-MYSQL-ICON">Figure 1-14</a>.</p>

<figure class="width-50"><div id="FIG-MACOS-MYSQL-ICON" class="figure">
<img src="Images/lm2e_0114.png" alt="lm2e 0114" width="1322" height="1346"/>
<h6><span class="label">Figure 1-14. </span>MySQL in System Preferences</h6>
</div></figure>

<p>Click the icon to open the MySQL panel. You should see something similar to <a data-type="xref" href="#FIG-MACOS-MYSQL-START-OPT">Figure 1-15</a>.</p>

<figure class="width-75"><div id="FIG-MACOS-MYSQL-START-OPT" class="figure">
<img src="Images/lm2e_0115.png" alt="lm2e 0115" width="1313" height="1091"/>
<h6><span class="label">Figure 1-15. </span>MySQL start options</h6>
</div></figure>

<p>Besides the obvious option, which is to start the MySQL process, there is a configuration panel (with the location of the MySQL files) and an option to reinitialize the database (you already initialized it during the installation). Start the MySQL process. You might be asked for the administrator password again.</p>

<p>With MySQL running, it is possible to validate the connection and confirm that MySQL Server is running correctly. <a data-type="indexterm" data-primary="MySQL Workbench" data-secondary="link" id="idm46177504420376"/><a data-type="indexterm" data-primary="macOS" data-secondary="MySQL 8.0 installation" data-tertiary="MySQL Workbench to validate" id="idm46177504419400"/>You can use <a href="https://oreil.ly/RVWbe">MySQL Workbench</a> to test this, or <a data-type="indexterm" data-primary="macOS" data-secondary="MySQL 8.0 installation" data-tertiary="MySQL client via brew" id="idm46177504417352"/>install the MySQL client using <code>brew</code>:</p>

<pre data-type="programlisting">$ <strong>brew install mysql-client</strong></pre>

<p>Once you’ve installed the MySQL client, you can connect with the password you defined in <a data-type="xref" href="#FIG-MACOS-ROOT-PASS">Figure 1-13</a>. In the terminal, run the following command:<a data-type="indexterm" data-startref="ch01-mac" id="idm46177504413080"/><a data-type="indexterm" data-startref="ch01-mac2" id="idm46177504412408"/><a data-type="indexterm" data-startref="ch01-mac3" id="idm46177504411736"/></p>

<pre data-type="programlisting">$ <strong>mysql -uroot -p</strong>
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 8
Server version: 8.0.23 MySQL Community Server - GPL

Copyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type <em>help;</em> or <em>\h</em> for help. Type <em>\c</em> to clear the current input statement.</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">@</code><code class="o">@</code><code class="n">version</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+-----------+
| @@version |
+-----------+
| 8.0.23    |
+-----------+
1 row in set (0.00 sec)</pre>
</div></section>



</div></section>













<section data-type="sect1" data-pdf-bookmark="Installing MySQL on Windows 10"><div class="sect1" id="idm46177504033768">
<h1>Installing MySQL on Windows 10</h1>

<p>Oracle provides a <a href="https://oreil.ly/N4enF">MySQL Installer for Windows</a> to<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Windows 10 installation" id="ch01-wind2"/><a data-type="indexterm" data-primary="web links in book" data-secondary="MySQL distribution downloads" data-tertiary="Windows 10 installer" id="idm46177502909048"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="about distribution packages" data-tertiary="32-bit versus 64-bit" id="idm46177502585656"/><a data-type="indexterm" data-primary="Windows 10" data-secondary="MySQL 8.0 installation" id="ch01-wind"/><a data-type="indexterm" data-primary="32-bit versus 64-bit installations" id="idm46177502792344"/> facilitate the installation. Note that MySQL Installer is a 32-bit application, but it can install MySQL in 32-bit and 64-bit binaries. To initiate the installation process, you need to execute the installer file and choose the type of installation, as shown in <a data-type="xref" href="#FIG-WINDOWS-INSTALL-OPTS">Figure 1-16</a>.</p>

<p>Choose the Developer Default setup type and click Next. We won’t go into detail on the other options because we don’t recommend using MySQL for production systems, mainly because the MySQL ecosystem is developed for Linux.</p>

<figure class="width-90"><div id="FIG-WINDOWS-INSTALL-OPTS" class="figure">
<img src="Images/lm2e_0116.png" alt="lm2e 0116" width="1554" height="1171"/>
<h6><span class="label">Figure 1-16. </span>MySQL 8.0.23 Windows installation customization</h6>
</div></figure>

<p class="pagebreak-before">Next, the installer checks whether all the requirements are satisfied (<a data-type="xref" href="#FIG-WINDOWS-INSTALL-REQS">Figure 1-17</a>).</p>

<figure class="width-90"><div id="FIG-WINDOWS-INSTALL-REQS" class="figure">
<img src="Images/lm2e_0117.png" alt="lm2e 0117" width="1558" height="880"/>
<h6><span class="label">Figure 1-17. </span>Installation requirements</h6>
</div></figure>

<p>Click Execute. It might be necessary to install Microsoft Visual C++ (<a data-type="xref" href="#FIG-WINDOWS-INSTALL-VISUALC">Figure 1-18</a>).</p>

<figure class="width-90"><div id="FIG-WINDOWS-INSTALL-VISUALC" class="figure">
<img src="Images/lm2e_0118.png" alt="lm2e 0118" width="1566" height="1041"/>
<h6><span class="label">Figure 1-18. </span>Install Microsoft Visual C++ if required</h6>
</div></figure>

<p class="pagebreak-before">Click Next, and the installer will show the products that are ready to install (<a data-type="xref" href="#FIG-WINDOWS-INSTALL-READY">Figure 1-19</a>).</p>

<figure class="width-90"><div id="FIG-WINDOWS-INSTALL-READY" class="figure">
<img src="Images/lm2e_0119.png" alt="lm2e 0119" width="1556" height="1040"/>
<h6><span class="label">Figure 1-19. </span>Click Execute to install the MySQL software</h6>
</div></figure>

<p>Click Execute and you will arrive at the screen where you can configure MySQL properties. You can use the default settings for TCP/IP and the X Protocol port, as shown in <a data-type="xref" href="#FIG-WINDOWS-INSTALL-CFG">Figure 1-20</a>, or you can customize them if you like.</p>

<p>Next, you will choose the authentication method. Select the newer version that is more secure, as shown in <a data-type="xref" href="#FIG-WINDOWS-INSTALL-AUTH">Figure 1-21</a>.</p>

<figure class="width-90"><div id="FIG-WINDOWS-INSTALL-CFG" class="figure">
<img src="Images/lm2e_0120.png" alt="lm2e 0120" width="1554" height="1011"/>
<h6><span class="label">Figure 1-20. </span>Type and networking configuration options</h6>
</div></figure>

<figure class="width-90"><div id="FIG-WINDOWS-INSTALL-AUTH" class="figure">
<img src="Images/lm2e_0121.png" alt="lm2e 0121" width="1557" height="1169"/>
<h6><span class="label">Figure 1-21. </span>Password encryption—use SHA-256 based passwords</h6>
</div></figure>

<p>Next, specify the root user password and whether you want to add additional users to the MySQL database, as shown in <a data-type="xref" href="#FIG-WINDOWS-INSTALL-ADD-USER">Figure 1-22</a>.</p>

<figure class="width-90"><div id="FIG-WINDOWS-INSTALL-ADD-USER" class="figure">
<img src="Images/lm2e_0122.png" alt="lm2e 0122" width="1568" height="1080"/>
<h6><span class="label">Figure 1-22. </span>Configuring users</h6>
</div></figure>

<p>With the users configured, define the service name and user that will run the service, as shown in <a data-type="xref" href="#FIG-WINDOWS-INSTALL-SERVICE">Figure 1-23</a>.</p>

<figure class="width-90"><div id="FIG-WINDOWS-INSTALL-SERVICE" class="figure">
<img src="Images/lm2e_0123.png" alt="lm2e 0123" width="1554" height="999"/>
<h6><span class="label">Figure 1-23. </span>Configuring the service name</h6>
</div></figure>

<p>When you click Next, the installer begins configuring MySQL. Once the MySQL installer finishes its execution, you should see something like <a data-type="xref" href="#FIG-WINDOWS-INSTALL-COMPLETE">Figure 1-24</a>.</p>

<figure class="width-90"><div id="FIG-WINDOWS-INSTALL-COMPLETE" class="figure">
<img src="Images/lm2e_0124.png" alt="lm2e 0124" width="1566" height="971"/>
<h6><span class="label">Figure 1-24. </span>If the installation went fine, there are no errors</h6>
</div></figure>

<p>Now your database server is operational. Since you selected the Developer profile, the installer will go through the MySQL Router installation. MySQL Router isn’t essential for this setup, and since we don’t recommend Windows for production, we’ll skip this part. We will dive into the details of the router in <a data-type="xref" href="ch15.xhtml#MYSQL_ROUTER">“MySQL Router”</a>.</p>

<p>Now you can validate your server using<a data-type="indexterm" data-primary="MySQL Workbench" data-secondary="link" id="idm46177499831208"/><a data-type="indexterm" data-primary="web links in book" data-secondary="MySQL Workbench" id="idm46177501950312"/><a data-type="indexterm" data-primary="MySQL Workbench" data-secondary="introduction in Windows" id="idm46177501843320"/><a data-type="indexterm" data-primary="Windows 10" data-secondary="MySQL 8.0 installation" data-tertiary="MySQL Workbench to validate" id="idm46177502706344"/> <a href="https://oreil.ly/RVWbe">MySQL Workbench</a>, as shown in <a data-type="xref" href="#FIG-WINDOWS-WORKBENCH-INTRO">Figure 1-25</a>. You should see a MySQL connection option.</p>

<figure class="width-90"><div id="FIG-WINDOWS-WORKBENCH-INTRO" class="figure">
<img src="Images/lm2e_0125.png" alt="lm2e 0125" width="2371" height="1234"/>
<h6><span class="label">Figure 1-25. </span>The MySQL connection option in MySQL Workbench</h6>
</div></figure>

<p>Double-click the connection and Workbench will prompt you to input the password, as shown in <a data-type="xref" href="#FIG-WINDOWS-WORKBENCH-PASSWORD">Figure 1-26</a>.</p>

<figure class="width-90"><div id="FIG-WINDOWS-WORKBENCH-PASSWORD" class="figure">
<img src="Images/lm2e_0126.png" alt="lm2e 0126" width="2349" height="1301"/>
<h6><span class="label">Figure 1-26. </span>Enter the root password to connect</h6>
</div></figure>

<p>You can now start using MySQL in your Windows platform, as shown in <a data-type="xref" href="#FIG-WINDOWS-WORKBENCH-CHECKING">Figure 1-27</a>.</p>

<figure><div id="FIG-WINDOWS-WORKBENCH-CHECKING" class="figure">
<img src="Images/lm2e_0127.png" alt="lm2e 0127" width="2356" height="1659"/>
<h6><span class="label">Figure 1-27. </span>You can now begin testing your environment<a data-type="indexterm" data-startref="ch01-wind" id="idm46177503279448"/><a data-type="indexterm" data-startref="ch01-wind2" id="idm46177499869416"/></h6>
</div></figure>
</div></section>













<section data-type="sect1" data-pdf-bookmark="The Contents of the MySQL Directory"><div class="sect1" id="MYSQL_DIRECTORY_CONTENT">
<h1>The Contents of the MySQL Directory</h1>

<p>During the installation process, MySQL creates all the files that are<a data-type="indexterm" data-primary="directory contents" id="idm46177502148088"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="directory contents" id="idm46177502147352"/><a data-type="indexterm" data-primary="MySQL" data-secondary="directory contents" id="idm46177502146408"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="directory contents" id="idm46177499807528"/><a data-type="indexterm" data-primary="MySQL" data-secondary="datadir parameter" id="idm46177499806696"/><a data-type="indexterm" data-primary="datadir parameter" id="idm46177499805752"/><a data-type="indexterm" data-primary="path to MySQL data directory" id="idm46177499805080"/> needed to start the server. MySQL stores its files under a directory called the <em>data directory</em>. Database administrators (DBAs) commonly refer to this as the <em>datadir</em>, which is the name of the MySQL parameter that stores the path to this directory. The default location for Linux distributions is <em>/var/lib/mysql</em>. You can check its location by running the following command in the MySQL instance:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">@</code><code class="o">@</code><code class="n">datadir</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+-----------------+
| @@datadir       |
+-----------------+
| /var/lib/mysql/ |
+-----------------+
1 row in set (0.00 sec)</pre>








<section data-type="sect2" data-pdf-bookmark="MySQL 5.7 Default Files"><div class="sect2" id="MYSQL-SOCKET-TCP">
<h2>MySQL 5.7 Default Files</h2>

<p>The following list briefly describes the files and subdirectories typically found in the data directory:<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="directory contents" data-tertiary="MySQL 5.7 files" id="ch01-sev4"/><a data-type="indexterm" data-primary="MySQL" data-secondary="directory contents" data-tertiary="MySQL 5.7 files" id="ch01-sev"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="directory contents" data-tertiary="MySQL 5.7 files" id="ch01-sev2"/><a data-type="indexterm" data-primary="directory contents" data-secondary="MySQL 5.7 files" id="ch01-sev3"/></p>
<dl>
<dt>The REDO log files</dt>
<dd>
<p>MySQL creates the redo log files as <em>ib_logfile0</em> and<a data-type="indexterm" data-primary="redo log files" data-secondary="MySQL 5.7" id="idm46177499748200"/> <em>ib_logfile1</em> in the data directory. It writes to the redo log files in a circular fashion, so the files do not grow beyond their configuration size (configured by <a href="https://oreil.ly/XRzLb"><code>innodb_log_file_size</code></a>). As in any other relational database management system (RDBMS) that is ACID-compliant, the redo files are fundamental to provide data durability and the ability to recover from a crash scenario.</p>
</dd>
</dl>
<dl>
<dt>The <em>auto.cnf</em> file</dt>
<dd>
<p>MySQL 5.6 introduced the <em>auto.cnf</em> file. It has only a single <code>[auto]</code> section containing a single <a href="https://oreil.ly/zXlHS"><code>server_uuid</code></a> setting and value. The <code>server_uuid</code> creates a unique signature for the server, and the replication layer uses it to communicate with different servers to replicate data.</p>
</dd>
</dl>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>MySQL automatically creates the <em>auto.cnf</em> file in the data directory when initialized, and this file should not be changed. We explain the details in <a data-type="xref" href="ch09.xhtml#CH9_OPTIONS_FILE">Chapter 9</a>.</p>
</div>
<dl>
<dt>The <em>*.pem</em> files</dt>
<dd>
<p>In short, these files enable the use of encrypted connections for communication between a client and the MySQL server. Encrypted connections are a fundamental part of the network security layer to avoid unauthorized access while the data is in transit from the application to the MySQL server. MySQL 5.7 enables SSL by default and creates the certificates as well. However, it is possible to use certificates provided by different certificate authorities (CAs) in the market.</p>
</dd>
<dt>The <em>performance_schema</em> subdirectory</dt>
<dd>
<div class="openblock">
<p>The MySQL Performance Schema is a feature for <a data-type="indexterm" data-primary="performance" data-secondary="files in data directory" id="idm46177499733016"/>monitoring MySQL Server execution at a low level during runtime. When we can use Performance Schema to monitor a particular metric, we say that MySQL has instrumentation. For example, Performance Schema instruments can provide the number of users 
<span class="keep-together">connected:</span></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">performance_schema</code><code class="p">.</code><code class="n">users</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting" class="less_space pagebreak-before">+-----------------+---------------------+-------------------+
| USER            | CURRENT_CONNECTIONS | TOTAL_CONNECTIONS |
+-----------------+---------------------+-------------------+
| NULL            |                  40 |                46 |
| event_scheduler |                   1 |                 1 |
| root            |                   0 |                 1 |
| rsandbox        |                   2 |                 3 |
| msandbox        |                   1 |                 2 |
+-----------------+---------------------+-------------------+
5 rows in set (0.03 sec)</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Many people are surprised to see <code>NULL</code> in the <code>user</code> column. The <code>NULL</code> value is used for internal threads or for a user session that failed to authenticate. The same applies to the <code>host</code> column in the <code>performance_schema.accounts</code> table:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="n">user</code><code class="p">,</code><code> </code><code class="n">host</code><code class="p">,</code><code>
        </code><code class="n">total_connections</code><code> </code><code class="k">AS</code><code> </code><code class="n">cxns</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">FROM</code><code> </code><code class="n">performance_schema</code><code class="p">.</code><code class="n">accounts</code><code>
        </code><code class="k">ORDER</code><code> </code><code class="k">BY</code><code> </code><code class="n">cxns</code><code> </code><code class="k">DESC</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+-----------------+-----------+------+
| user            | host      | cxns |
+-----------------+-----------+------+
| NULL            | NULL      |   46 |
| rsandbox        | localhost |    3 |
| msandbox        | localhost |    2 |
| event_scheduler | localhost |    1 |
| root            | localhost |    1 |
+-----------------+-----------+------+
5 rows in set (0.00 sec)</pre>
</div>

<p>Although instrumentation has existed since MySQL 5.6, it was in MySQL 5.7 that it gained many improvements and became a fundamental part of the DBA tools to investigate and troubleshoot issues at the MySQL level.</p>
</div>

</dd>
<dt>The <em>ibtmp1</em> file</dt>
<dd>
<p>When the application needs to create temporary tables or MySQL needs to use an on-disk internal temporary table, MySQL creates them in a shared temporary tablespace. The default behavior is to create an auto-extending data file named <em>ibtmp1</em> that is slightly larger than 12 MB (its size is controlled by the <a href="https://oreil.ly/KXDOo"><code>innodb_temp_data_file_path</code> parameter</a>).</p>
</dd>
<dt>The <em>ibdata1</em> file</dt>
<dd>
<p>The <em>ibdata1</em> file is probably the most famous file in the MySQL ecosystem. For MySQL 5.7 and older, it holds data for the InnoDB data dictionary, the doublewrite buffer, the change buffer, and the undo logs. It may also contain table and index data if we disable the <a href="https://oreil.ly/v4X1O"><code>innodb_file_per_table</code> option</a>. When <code>innodb_file_per_table</code> is enabled, each user table has a 
<span class="keep-together">tablespace</span> and a dedicated file. Note that it is possible to have multiple <em>ibdata</em> files in the MySQL data directory.</p>
</dd>
</dl>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>In MySQL 8.0, some of these components were removed from <em>ibdata1</em> and allocated into separate files. The remaining components are the change buffer table and index data if tables are 
<span class="keep-together">created in</span> the system tablespace (by disabling the <code>innodb_file_per_table</code>).</p>
</div>
<dl>
<dt>The <em>mysql.sock</em> file</dt>
<dd>
<p>This is a Unix socket file that the server uses for<a data-type="indexterm" data-primary="Unix sockets" data-secondary="MySQL 5.7 file" id="idm46177499626584"/> communication with local clients. This file exists only when MySQL is running, and removing it or creating the file manually may lead to problems.</p>
</dd>
</dl>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>A Unix socket is an interprocess communication mechanism<a data-type="indexterm" data-primary="Unix sockets" id="idm46177499624088"/> that allows bidirectional data exchange between processes running on the same machine. <a data-type="indexterm" data-primary="IP sockets" id="idm46177499623144"/>IP sockets (mainly TCP/IP sockets) are a mechanism allowing communication between processes over the network.</p>

<p>You can connect to MySQL Server on Linux using two methods: <a data-type="indexterm" data-primary="MySQL" data-secondary="Linux connecting to server" id="idm46177499621608"/>the TCP protocol or a socket. For security purposes, if the application and MySQL are on the same server, you can disable remote TCP connections. There are two ways to do this in MySQL Server: set the <a href="https://oreil.ly/PQjrf"><code>bind-address</code></a> to <code>127.0.0.1</code> instead of the default <code>*</code> value (which accepts TCP/IP connections from everyone), or modify the <a href="https://oreil.ly/s20Ta"><code>skip-networking</code> parameter</a>, which disables network connections to MySQL.</p>
</div>
<dl>
<dt>The <em>mysql</em> subdirectory</dt>
<dd>
<p>The <em>mysql</em> directory corresponds to the MySQL system schema, which contains MySQL Server’s information as it runs. For example, it includes information on users and their privileges, time zone tables, and replication. You can see the files named according to their respective table names with the <code>ls</code> command:<a data-type="indexterm" data-startref="ch01-sev" id="idm46177499614568"/><a data-type="indexterm" data-startref="ch01-sev2" id="idm46177499613832"/><a data-type="indexterm" data-startref="ch01-sev3" id="idm46177499613160"/><a data-type="indexterm" data-startref="ch01-sev4" id="idm46177499612488"/></p>
</dd>
</dl>

<pre data-type="programlisting"># <strong>cd /var/lib/mysql</strong>
# <strong>ls -l mysql/</strong>

-rw-r-----. 1 vinicius.grippa percona    8820 Feb 20 15:51 columns_priv.frm
-rw-r-----. 1 vinicius.grippa percona       0 Feb 20 15:51 columns_priv.MYD
-rw-r-----. 1 vinicius.grippa percona    4096 Feb 20 15:51
columns_priv.MYI
-rw-r-----. 1 vinicius.grippa percona    9582 Feb 20 15:51 db.frm
-rw-r-----. 1 vinicius.grippa percona     976 Feb 20 15:51 db.MYD
-rw-r-----. 1 vinicius.grippa percona    5120 Feb 20 15:51 db.MYI
-rw-r-----. 1 vinicius.grippa percona      65 Feb 20 15:51 db.opt
-rw-r-----. 1 vinicius.grippa percona    8780 Feb 20 15:51 engine_cost.frm
-rw-r-----. 1 vinicius.grippa percona   98304 Feb 20 15:51 engine_cost.ibd
...
-rw-r-----. 1 vinicius.grippa percona   10816 Feb 20 15:51 user.frm
-rw-r-----. 1 vinicius.grippa percona    1292 Feb 20 15:51 user.MYD
-rw-r-----. 1 vinicius.grippa percona    4096 Feb 20 15:51 user.MYI</pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="MySQL 8.0 Default Files"><div class="sect2" id="idm46177499776344">
<h2>MySQL 8.0 Default Files</h2>

<p>MySQL 8.0 brought a few changes in the core of the data<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="directory contents" data-tertiary="MySQL 8.0 files" id="idm46177499607848"/><a data-type="indexterm" data-primary="MySQL" data-secondary="directory contents" data-tertiary="MySQL 8.0 files" id="idm46177499606600"/><a data-type="indexterm" data-primary="directory contents" data-secondary="MySQL 8.0 files" id="idm46177499605384"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="directory contents" data-tertiary="MySQL 8.0 files" id="idm46177499604440"/> directory structure. Some of these changes are related to implementing the new data dictionary, and others to improving database management. The following list describes the new files and changes:</p>
<dl>
<dt>The <em>undo</em> tablespace files</dt>
<dd>
<p>MySQL (InnoDB) uses <em>undo</em> files to undo the<a data-type="indexterm" data-primary="transactions" data-secondary="undo files" id="idm46177499600520"/> transactions that need to be rolled back and ensure isolated transactions whenever it needs to perform a consistent read.</p>

<p>From MySQL 8.0, the undo log files were separated from the system tablespace (<em>ibdata1</em>) and placed in the data directory. It is also possible to set another location by changing the <a href="https://oreil.ly/l1bIV"><code>innodb_undo_directory</code> parameter</a>.</p>
</dd>
<dt>The <em>.dblwr</em> files (introduced in version 8.0.20)</dt>
<dd>
<p>The doublewrite buffer is responsible for writing pages flushed from the buffer pool to the disk before MySQL writes the pages to the datafiles. The doublewrite filenames have the following format: <em>#ib_&lt;page_size&gt;_&lt;file_number&gt;.dblwr</em> (for example, <em>#ib_16384_0.dblwr</em>, <em>#ib_16384_0.dblwr</em>). It is possible to change the location of these files by modifying the <a href="https://oreil.ly/e0ypB"><code>innodb_doublewrite_dir</code> parameter</a>.</p>
</dd>
</dl>
<dl>
<dt>The <em>mysql.ibd</em> file  (introduced in version 8.0)</dt>
<dd>
<p>In MySQL 5.7, dictionary tables and system tables stored data and metadata in the <em>mysql</em> directory inside the <em>datadir</em>. In MySQL 8.0, this is all stored in the <em>mysql.ibd</em> file and is protected by the InnoDB mechanisms to ensure consistency.</p>
</dd>
</dl>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Using the Command-Line Interface"><div class="sect1" id="idm46177499589128">
<h1>Using the Command-Line Interface</h1>

<p>The <em>mysql</em> binary is a simple SQL shell with input line-editing<a data-type="indexterm" data-primary="MySQL" data-secondary="command line interface" id="idm46177499587144"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="command line interface" id="idm46177499586168"/><a data-type="indexterm" data-primary="command line interface mysql" id="idm46177499585224"/><a data-type="indexterm" data-primary="mysql command line interface" id="idm46177499584584"/> capabilities. Its use is straightforward (we already used it a few times during the installation process). To invoke it, run the following command:</p>

<pre data-type="programlisting"># <strong>mysql</strong></pre>

<p class="pagebreak-before">We can extend its functionality by executing queries in it:</p>

<pre data-type="programlisting"># <strong>mysql -uroot -pseKret -e "SHOW ENGINE INNODB STATUS\G"</strong></pre>

<p>And we can execute more advanced commands, piping them with other commands to perform more complex tasks. For example, we can extract a dump from one 
<span class="keep-together">database,</span> send it across the network, and restore it into another MySQL server in the same command line:</p>

<pre data-type="programlisting"># <strong>mysql -e "SHOW MASTER STATUS\G" &amp;&amp; nice -5 mysqldump</strong> \
    <strong>--all-databases --single-transaction -R --master-data=2 --flush-logs</strong> \
    <strong>--log-error=/tmp/donor.log --verbose=TRUE | ssh mysql@192.168.0.1 mysql</strong> \
    <strong>1&gt; /tmp/receiver.log 2&gt;&amp;1</strong></pre>

<p>MySQL 8.0 introduced <em>MySQL Shell</em>, which is way more powerful than its predecessor.<a data-type="indexterm" data-primary="MySQL Shell" data-secondary="about" id="idm46177499576552"/> MySQL Shell supports the JavaScript, Python, and SQL languages, providing development and administration capabilities for MySQL Server. We’ll go into more detail about this in <a data-type="xref" href="ch16.xhtml#MYSQL-SHELL">“MySQL Shell”</a>.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Using Docker"><div class="sect1" id="idm46177499574328">
<h1>Using Docker</h1>

<p>With the advent of virtualization and its popularization with<a data-type="indexterm" data-primary="Docker" data-secondary="about" id="idm46177499572888"/><a data-type="indexterm" data-primary="web links in book" data-secondary="Docker" id="idm46177499571912"/><a data-type="indexterm" data-primary="containerizing with Kubernetes" data-secondary="Docker" id="ch01-dkr"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Docker" data-tertiary="about" id="idm46177499569784"/><a data-type="indexterm" data-primary="MariaDB" data-secondary="Docker for installation" id="idm46177499568568"/><a data-type="indexterm" data-primary="Percona Server for MySQL" data-secondary="Docker for installation" id="idm46177499567624"/> cloud services, many platforms have emerged, including <a href="https://www.docker.com">Docker</a>. Born in 2013, Docker is a solution that offers a portable and flexible way to deploy software. It provides resource isolation through the use of Linux features like <em>cgroups</em> and <em>kernel namespaces</em>.</p>

<p>Docker is useful for DBAs who often need to install a specific version of MySQL, MariaDB, or Percona Server for MySQL to run some experiments. With Docker, it is possible to deploy a MySQL instance in seconds to perform some tests. Once you finish the tests, you can destroy the instance and release the operating system’s resources to other tasks. All the processes of deploying a virtual machine (VM), installing packages, and configuring the database are simpler when using Docker.</p>








<section data-type="sect2" data-pdf-bookmark="Installing Docker"><div class="sect2" id="idm46177499563896">
<h2>Installing Docker</h2>

<p>An advantage of using Docker is that once the service is<a data-type="indexterm" data-primary="Docker" data-secondary="installing" id="ch01-doc"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Docker" data-tertiary="installing" id="ch01-doc2"/> running, the commands are the same in all operating systems. The commands being the same means that the learning curve for using Docker is faster compared to learning different Linux versions such as CentOS and Ubuntu, for example.</p>

<p>The process for <a href="https://oreil.ly/K1zGS">installing Docker</a> is,<a data-type="indexterm" data-primary="macOS" data-secondary="MySQL 8.0 installation" data-tertiary="Docker installation" id="idm46177499558104"/><a data-type="indexterm" data-primary="Windows 10" data-secondary="MySQL 8.0 installation" data-tertiary="Docker installation" id="idm46177499556824"/> in some ways, similar to installing MySQL. For Windows and macOS you just install the binaries, and after that the service is up and running. For Linux-based operating systems without a graphic interface, the process requires configuring the repository.</p>










<section data-type="sect3" data-pdf-bookmark="Installing Docker on CentOS 7"><div class="sect3" id="idm46177499555080">
<h3>Installing Docker on CentOS 7</h3>

<p>The CentOS packages for Docker are, in general, older than<a data-type="indexterm" data-primary="Linux" data-secondary="CentOS 7 Linux" data-tertiary="Docker installation" id="idm46177499553576"/><a data-type="indexterm" data-primary="CentOS 7 Linux" data-secondary="Docker installation" id="idm46177499552328"/> the ones available to RHEL and in official Docker repositories. At the time of writing, the Docker version provided by regular CentOS repositories is 1.13.1, whereas the upstream stable 
<span class="keep-together">version</span> is 20.10.3. There is no difference for the purposes of this book, but we always recommend using the latest version for production environments.</p>

<p>Execute the following command to install the Docker package from the default CentOS repository:</p>

<pre data-type="programlisting"># <strong>yum install docker -y</strong></pre>

<p>If you want to install Docker from the upstream repository to ensure that you are using the latest release, follow these steps:</p>
<ol>
<li>
<p>Install <code>yum-utils</code> to enable the <code>yum-config-manager</code> command:</p>

<pre data-type="programlisting"># <strong>yum install yum-utils -y</strong></pre>
</li>
<li>
<p>Use <code>yum-config-manager</code> to add the <em>docker-ce</em> repository:</p>

<pre data-type="programlisting"># <strong>yum-config-manager \</strong>
    <strong>--add-repo \</strong>
    <strong>https://download.docker.com/linux/centos/docker-ce.repo</strong></pre>
</li>
<li>
<p>Install the necessary packages:</p>

<pre data-type="programlisting"># <strong>yum install docker-ce docker-ce-cli containerd.io -y</strong></pre>
</li>
<li>
<p>Start the Docker service:</p>

<pre data-type="programlisting"># <strong>systemctl start docker</strong></pre>
</li>
<li>
<p>Enable the Docker service to auto-start after a system reboot:</p>

<pre data-type="programlisting"># <strong>systemctl enable --now docker</strong></pre>
</li>
<li>
<p>To validate whether the Docker service is running, execute the <code>systemctl status</code> command:</p>

<pre data-type="programlisting"># <strong>systemctl status docker</strong></pre>
</li>
<li>
<p>To verify that Docker Engine is installed correctly, you can run the <em>hello-world</em> container:</p>

<pre data-type="programlisting"># <strong>docker run hello-world</strong></pre>
</li>

</ol>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Installing Docker on Ubuntu 20.04 (Focal Fossa)"><div class="sect3" id="idm46177499530744">
<h3>Installing Docker on Ubuntu 20.04 (Focal Fossa)</h3>

<p>To install the latest Docker release from the upstream<a data-type="indexterm" data-primary="Linux" data-secondary="Ubuntu" data-tertiary="Docker installation" id="idm46177499529240"/><a data-type="indexterm" data-primary="Ubuntu Linux" data-secondary="Docker installation" id="idm46177499527992"/> repository, first remove any older versions of Docker (called <em>docker</em>, <em>docker.io</em>, or <em>docker-engine</em>). Uninstall them with this command:</p>

<pre data-type="programlisting"># <strong>apt-get remove -y docker docker-engine docker.io containerd runc</strong></pre>

<p>With the default repository removed, you can initiate the installation process:</p>
<ol>
<li>
<p>Make sure that Ubuntu is up-to-date with this command:</p>

<pre data-type="programlisting"># <strong>apt-get update -y</strong></pre>
</li>
<li>
<p>Install packages to allow <em>apt</em> to use a repository over HTTPS:</p>

<pre data-type="programlisting"># <strong>apt-get install -y \</strong>
    <strong>apt-transport-https \</strong>
    <strong>ca-certificates \</strong>
    <strong>curl \</strong>
    <strong>gnupg-agent \</strong>
    <strong>software-properties-common</strong></pre>
</li>
<li>
<p>Next, add Docker’s official GPG key:</p>

<pre data-type="programlisting"># <strong>curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo</strong> \
    <strong>apt-key add -</strong></pre>
</li>
<li>
<p>With the key in place, add the Docker stable repository:</p>

<pre data-type="programlisting"># <strong>add-apt-repository \</strong>
   <strong>"deb [arch=amd64] https://download.docker.com/linux/ubuntu \</strong>
   <strong>$(lsb_release -cs) \</strong>
   <strong>stable"</strong></pre>
</li>
<li>
<p>Now, use the <code>apt</code> command to install the Docker packages:</p>

<pre data-type="programlisting"># <strong>apt-get install -y docker-ce docker-ce-cli containerd.io</strong></pre>
</li>
<li>
<p>Ubuntu will start the service for you, but you can check by running this command:</p>

<pre data-type="programlisting"># <strong>systemctl status docker</strong></pre>
</li>
<li>
<p>To make the Docker service auto-start when the OS reboots, use:</p>

<pre data-type="programlisting"># <strong>systemctl enable --now docker</strong></pre>
</li>
<li>
<p>Check the Docker version you installed with:</p>

<pre data-type="programlisting"># <strong>docker --version</strong></pre>
</li>
<li>
<p>To verify that Docker Engine is installed correctly, you can run the <em>hello-world</em> container:<a data-type="indexterm" data-startref="ch01-doc" id="idm46177499502456"/><a data-type="indexterm" data-startref="ch01-doc2" id="idm46177499501720"/></p>

<pre data-type="programlisting"># <strong>docker run hello-world</strong></pre>
</li>

</ol>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Deploying the MySQL container"><div class="sect3" id="idm46177499499816">
<h3>Deploying the MySQL container</h3>

<p>Once you have Docker Engine installed and running, the next step is deploying the MySQL Docker container.<a data-type="indexterm" data-primary="Docker" data-secondary="deploying MySQL container" id="ch01-dpl"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Docker" data-tertiary="deploying MySQL container" id="ch01-dpl2"/></p>
<div data-type="warning" epub:type="warning"><h6>Warning</h6>
<p>We designed the following instructions to get a test instance running quickly and easily; do not use this for a production 
<span class="keep-together">deployment!</span></p>
</div>

<p>To deploy the latest MySQL version with Docker, execute this command:</p>

<pre data-type="programlisting"># <strong>docker run --name mysql-latest</strong> \
  <strong>-p 3306:3306 -p 33060:33060</strong> \
  <strong>-e MYSQL_ROOT_HOST=% -e
  MYSQL_ROOT_PASSWORD='learning_mysql'</strong> \
  <strong>-d mysql/mysql-server:latest</strong></pre>

<p>Docker Engine will launch the latest version of the MySQL instance and be remotely accessible from anywhere with the specified root password. Installing MySQL with Docker means that you do not have access to any of the tools, utilities, or standard libraries available in a traditional host (bare metal or VM). You’ll need to either deploy these tools separately or use commands shipped with the Docker image if you need them.</p>

<p>Next, connect to the MySQL container using the MySQL client:</p>

<pre data-type="programlisting"># <strong>docker exec -it mysql-latest mysql -uroot -plearning_mysql</strong></pre>

<p>Since you mapped the TCP port 3306 in the container to port 3306 on the Docker host with the parameter <code>-p 3306:3306</code>, you can connect to the MySQL database from any MySQL client (Workbench, MySQL Shell) available that can reach the host (hostname or IP) and that port.</p>

<p>Let’s look at a few commands to manage the container.</p>

<p>To stop the MySQL Docker container, run:</p>

<pre data-type="programlisting"># <strong>docker stop mysql-latest</strong></pre>

<p>Don’t try to use <code>docker run</code> to start the container again. Instead, use this:</p>

<pre data-type="programlisting"># <strong>docker start mysql-latest</strong></pre>

<p>To investigate an issue—for example, if the container isn’t starting—access its logs using this command:</p>

<pre data-type="programlisting"># <strong>docker logs mysql-latest</strong></pre>

<p>To remove the Docker container that you created, run:</p>

<pre data-type="programlisting"># <strong>docker stop mysql-latest</strong>
# <strong>docker rm mysql-latest</strong></pre>

<p>To check which and how many Docker containers are running in the host, use:</p>

<pre data-type="programlisting"># <strong>docker ps</strong></pre>

<p>It is possible to customize MySQL parametrization using command-line options to Docker Engine. To configure the <a href="https://oreil.ly/1R2nJ">InnoDB buffer pool size</a> and the <a href="https://oreil.ly/tiKl2">flush method</a>, run the following:</p>

<pre data-type="programlisting"># <strong>docker run --name mysql-latest</strong> \
  <strong>-p 3306:3306 -p 33060:33060</strong>  \
  <strong>-e MYSQL_ROOT_HOST=% -e
  MYSQL_ROOT_PASSWORD='strongpassword'</strong> \
  <strong>-d mysql/mysql-server:latest</strong> \
  <strong>--innodb_buffer_pool_size=256M</strong> \
  <strong>--innodb_flush_method=O_DIRECT</strong></pre>

<p>To run a MySQL version other than the latest version, first  check that it is available in <a href="https://hub.docker.com">Docker Hub</a>. For example, say you want to run MySQL 5.7.31. The first step is to check the <a href="https://oreil.ly/X0Uuu">official MySQL Docker Images</a> list in Docker Hub to see if it exists.</p>

<p>Once you’ve confirmed its existence, run it with the following command:</p>

<pre data-type="programlisting"># <strong>docker run --name mysql-5.7.31</strong> \
  <strong>-p 3307:3306 -p 33061:33060</strong>  \
  <strong>-e MYSQL_ROOT_HOST=% -e</strong> \
  <strong>MYSQL_ROOT_PASSWORD='learning_mysql'</strong> \
  <strong>-d mysql/mysql-server:5.7.31</strong></pre>

<p>It is possible to run multiple MySQL Docker instances at the same time, but a potential problem is TCP port conflicts. In the previous example, note that we mapped different host ports for the  <em>mysql-5.7.31</em> container (3307 and 33061). Also, the <em>name</em> of the container needs to be unique.<a data-type="indexterm" data-startref="ch01-dpl" id="idm46177499465752"/><a data-type="indexterm" data-startref="ch01-dpl2" id="idm46177499465048"/><a data-type="indexterm" data-startref="ch01-dkr" id="idm46177499464376"/></p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Deploying MariaDB and Percona Server containers"><div class="sect3" id="idm46177499498872">
<h3>Deploying MariaDB and Percona Server containers</h3>

<p>You follow the same steps described in the previous section for<a data-type="indexterm" data-primary="Docker" data-secondary="deploying MariaDB container" id="idm46177499462328"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Docker" data-tertiary="deploying MariaDB container" id="idm46177499461304"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="Docker" data-tertiary="deploying Percona container" id="idm46177499460072"/><a data-type="indexterm" data-primary="Docker" data-secondary="deploying Percona container" id="idm46177499458840"/><a data-type="indexterm" data-primary="Percona Server for MySQL" data-secondary="Docker for installation" data-tertiary="deploying Percona container" id="idm46177499457880"/><a data-type="indexterm" data-primary="MariaDB" data-secondary="Docker for installation" data-tertiary="deploying MariaDB container" id="idm46177499456632"/> deploying a MySQL container to deploy a <a href="https://oreil.ly/rHGjq">MariaDB</a> or <a href="https://oreil.ly/TAWtw">Percona Server</a> container. The main difference is that they use different Docker images and have their own official repositories.</p>

<p>To deploy a MariaDB container, run:</p>

<pre data-type="programlisting"># <strong>docker run --name maria-latest</strong> \
  <strong>-p 3308:3306</strong> \
  <strong>-e MYSQL_ROOT_HOST=% -e</strong> \
  <strong>MYSQL_ROOT_PASSWORD='learning_mysql'</strong> \
  <strong>-d mariadb:latest</strong></pre>

<p>And for Percona Server, run:</p>

<pre data-type="programlisting"># <strong>docker run --name ps-latest</strong> \
  <strong>-p 3309:3306 -p 33063:33060</strong> \
  <strong>-e MYSQL_ROOT_HOST=% -e</strong> \
  <strong>MYSQL_ROOT_PASSWORD='learning_mysql'</strong> \
  <strong>-d percona/percona-server:latest</strong> \
  <strong>--innodb_buffer_pool_size=256M</strong> \
  <strong>--innodb_flush_method=O_DIRECT</strong></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>We are mapping different ports for MariaDB (<code>-p 3308:3306</code>) and Percona (<code>-p 3309:3306</code>) because we are deploying all the containers in the same host:</p>

<pre data-type="programlisting"># <strong>docker ps</strong></pre>

<pre data-type="programlisting">CONTAINER ID            IMAGE
5e487dd41c3e            percona/percona-server:latest

COMMAND                 CREATED           STATUS
"/docker-entrypoint..." About a minute ago Up 51 seconds
"docker-entrypoint..."  2 minutes ago      Up 2 minutes

PORTS                   NAMES
0.0.0.0:3309-&gt;3306/tcp, ps-latest
0.0.0.0:33063-&gt;33060/tcp
f5a217f1537b            mariadb:latest
0.0.0.0:3308-&gt;3306/tcp  maria-latest</pre>

<p>If you are deploying a single container, you can use port 3306 or any custom port you might want to use.</p>
</div>
</div></section>



</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Using Sandboxes"><div class="sect1" id="USING_SANDBOXES">
<h1>Using Sandboxes</h1>

<p>In software development, a <em>sandbox</em> is a testing environment<a data-type="indexterm" data-primary="sandboxes" id="idm46177499439048"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="sandboxes" id="idm46177499438344"/> that isolates code changes and allows experimentation and testing before deploying to production. DBAs primarily use sandboxes for testing new software versions, performance tests, and bug analysis, and the data present in MySQL is disposable.</p>
<div data-type="note" epub:type="note" id="NAMING_CONVENTION"><h6>Note</h6>
<p>It is common in the context of MySQL databases to hear the<a data-type="indexterm" data-primary="terminology changes" id="idm46177499435544"/><a data-type="indexterm" data-primary="master and slave terminology" id="idm46177499434760"/><a data-type="indexterm" data-primary="slave and master terminology" id="idm46177499434072"/> terms <em>master</em> and <em>slave</em>. The origins of these words are clearly negative. Oracle, Percona, and MariaDB have therefore decided to change this terminology and instead use <em>source</em> and <em>replica</em>. In this book, we will use both sets of terms because you will encounter both of them, but be aware that these companies will implement the following terminology for the upcoming releases:</p>
<table>

<tbody>
<tr>
<td><p><strong>Old</strong></p></td>
<td><p><strong>New</strong></p></td>
</tr>
<tr>
<td><p>master</p></td>
<td><p>source</p></td>
</tr>
<tr>
<td><p>slave</p></td>
<td><p>replica</p></td>
</tr>
<tr>
<td><p>blacklist</p></td>
<td><p>blocklist</p></td>
</tr>
<tr>
<td><p>whitelist</p></td>
<td><p>allowlist</p></td>
</tr>
</tbody>
</table>
</div>

<p class="pagebreak-before">In 2018, <a href="https://oreil.ly/0wLPk">Giuseppe Maxia</a> <a data-type="indexterm" data-primary="Maxia, Giuseppe" id="idm46177499420264"/>introduced <a href="https://oreil.ly/lZK98">DBdeployer</a>, a <a data-type="indexterm" data-primary="installation of MySQL" data-secondary="sandboxes" data-tertiary="DBdeployer installation" id="idm46177499418712"/><a data-type="indexterm" data-primary="web links in book" data-secondary="DBdeployer" id="idm46177499417432"/><a data-type="indexterm" data-primary="sandboxes" data-secondary="DBdeployer" id="idm46177499416488"/>tool that provides an easy and fast way to deploy MySQL and its forks. It supports diverse MySQL topologies such as master/slave (source/replica), master/master (source/source), Galera Cluster, and Group Replication.</p>








<section data-type="sect2" data-pdf-bookmark="Installing DBdeployer"><div class="sect2" id="idm46177499415176">
<h2>Installing DBdeployer</h2>

<p>The tool is developed in the <em>Go</em> language and works with<a data-type="indexterm" data-primary="sandboxes" data-secondary="DBdeployer" data-tertiary="installing" id="idm46177499413384"/> macOS and Linux (Ubuntu and CentOS), and standalone executables are provided. Get the latest version here:</p>

<pre data-type="programlisting"># <strong>wget https://github.com/datacharmer/dbdeployer/releases/download/v1.58.2/</strong> \
    <strong>dbdeployer-1.58.2.linux.tar.gz</strong>
# <strong>tar -xvf dbdeployer-1.58.2.linux.tar.gz</strong>
# <strong>mv dbdeployer-1.58.2.linux /usr/local/bin/dbdeployer</strong></pre>

<p>If you have your <em>/usr/local/bin/</em> directory in the <code>$PATH</code> variable, you should now be able to run the <code>dbdeployer</code> commands:</p>

<pre data-type="programlisting"># <strong>dbdeployer --version</strong>
dbdeployer version 1.58.2</pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Using DBdeployer"><div class="sect2" id="idm46177499406456">
<h2>Using DBdeployer</h2>

<p>The first step in using DBdeployer is to download the MySQL binary<a data-type="indexterm" data-primary="installation of MySQL" data-secondary="sandboxes" data-tertiary="DBdeployer use" id="ch01-sbx"/><a data-type="indexterm" data-primary="sandboxes" data-secondary="DBdeployer" data-tertiary="using" id="ch01-sbx2"/> you want to run and unpack it into the directory where you store your binaries. We will use <a href="https://oreil.ly/DoI1c"><em>Linux - Generic</em> tarballs</a> since they are compatible with most Linux distributions, and we will store our binaries in the <em>/opt/mysql</em> directory:</p>

<pre data-type="programlisting"># <strong>wget https://dev.mysql.com/get/Downloads/MySQL-8.0/</strong> \
    <strong>mysql-8.0.11-linux-glibc2.12-x86_64.tar.gz</strong>
# <strong>mkdir /opt/mysql</strong>
# <strong>dbdeployer --sandbox-binary=/opt/mysql/ unpack \</strong>
    <strong>mysql-8.0.11-linux-glibc2.12-x86_64.tar.gz</strong></pre>

<p>The <code>unpack</code> command will extract and move the files to the specified directory. The expected output of this operation is:</p>

<pre data-type="programlisting"># <strong>dbdeployer --sandbox-binary=/opt/mysql/ unpack</strong></pre>

<pre data-type="programlisting">mysql-8.0.11-linux-glibc2.12-x86_64.tar.gz
Unpacking tarball mysql-8.0.11-linux-glibc2.12-x86_64.tar.gz to
/opt/mysql/8.0.11
.........100.........200........289
Renaming directory /opt/mysql/mysql-8.0.11-linux-glibc2.12-x86_64 to
/opt/mysql/8.0.11</pre>

<p>We can now use the following command to create a new standalone MySQL sandbox with the newly extracted binary:</p>

<pre data-type="programlisting"># <strong>dbdeployer --sandbox-binary=/opt/mysql/ deploy single 8.0.11</strong></pre>

<p class="pagebreak-before">And we can observe DBdeployer initializing MySQL:</p>

<pre data-type="programlisting"># <strong>dbdeployer --sandbox-binary=/opt/mysql/ deploy single 8.0.11</strong></pre>

<pre data-type="programlisting">Creating directory /root/sandboxes
Database installed in $HOME/sandboxes/msb_8_0_11
run 'dbdeployer usage single' for basic instructions'
. sandbox server started</pre>

<p>Confirm that MySQL is running with the <code>ps</code> command:</p>

<pre data-type="programlisting"># <strong>ps -ef | grep mysql</strong></pre>

<pre data-type="programlisting">root      4249     1  0 20:18 pts/0    00:00:00 /bin/sh bin/mysqld_safe
--defaults-file=/root/sandboxes/msb_8_0_11/my.sandbox.cnf
root      4470  4249  1 20:18 pts/0    00:00:00 /opt/mysql/8.0.11/bin/mysqld
--defaults-file=/root/sandboxes/msb_8_0_11/my.sandbox.cnf
--basedir=/opt/mysql/8.0.11 --datadir=/root/sandboxes/msb_8_0_11/data
--plugin-dir=/opt/mysql/8.0.11/lib/plugin --user=root
--log-error=/root/sandboxes/msb_8_0_11/data/msandbox.err
--pid-file=/root/sandboxes/msb_8_0_11/data/mysql_sandbox8011.pid
--socket=/tmp/mysql_sandbox8011.sock --port=8011
root      4527  3836  0 20:18 pts/0    00:00:00 grep --color=auto mysql</pre>

<p>We can now connect to MySQL using DBdeployer’s <code>use</code> command:</p>

<pre data-type="programlisting"># <strong>cd sandboxes/msb_8_0_11/</strong>
# <strong>./use</strong></pre>

<p>or using the default root credentials:</p>

<pre data-type="programlisting"># <strong>mysql -uroot -pmsandbox -h 127.0.0.1 -P 8011</strong></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>We got the port information from the previous <code>ps</code> command. Remember that there are two ways to connect to MySQL: via TCP/IP or using a socket. We can also get the socket file location from the output of the <code>ps</code> command and connect with that, as shown here:</p>

<pre data-type="programlisting"># <strong>mysql -uroot -pmsandbox -S/tmp/mysql_sandbox8011.sock</strong></pre>
</div>

<p>If we want to set up a replication environment with a source/replica topology, we can do it with the following command line:</p>

<pre data-type="programlisting"># <strong>dbdeployer --sandbox-binary=/opt/mysql/ deploy replication 8.0.11</strong></pre>

<p>And we will have three <code>mysqld</code> processes running:</p>

<pre data-type="programlisting"># <strong>ps -ef | grep mysql</strong></pre>

<pre data-type="programlisting">root      4673     1  0 20:26 pts/0    00:00:00 /bin/sh bin/mysqld_safe
--defaults-file=/root/sandboxes/rsandbox_8_0_11/master/my.sandbox.cnf
root      4942  4673  1 20:26 pts/0    00:00:00
/opt/mysql/8.0.11/bin/mysqld
...
--pid-file=/root/sandboxes/rsandbox_8_0_11/master/data/mysql_sandbox201
12.pid --socket=/tmp/mysql_sandbox20112.sock --port=20112

root      5051     1  0 20:26 pts/0    00:00:00 /bin/sh bin/mysqld_safe
--defaults-file=/root/sandboxes/rsandbox_8_0_11/node1/my.sandbox.cnf
root      5320  5051  1 20:26 pts/0    00:00:00
/opt/mysql/8.0.11/bin/mysqld
--defaults-file=/root/sandboxes/rsandbox_8_0_11/node1/my.sandbox.cnf
...
--pid-file=/root/sandboxes/rsandbox_8_0_11/node1/data/mysql_sandbox2011
3.pid --socket=/tmp/mysql_sandbox20113.sock --port=20113

root      5415     1  0 20:26 pts/0    00:00:00 /bin/sh bin/mysqld_safe
--defaults-file=/root/sandboxes/rsandbox_8_0_11/node2/my.sandbox.cnf
root      5684  5415  1 20:26 pts/0    00:00:00
/opt/mysql/8.0.11/bin/mysqld
...
--pid-file=/root/sandboxes/rsandbox_8_0_11/node2/data/mysql_sandbox2011
4.pid --socket=/tmp/mysql_sandbox20114.sock --port=20114</pre>

<p>Another topology that DBdeployer can configure is Group Replication. For this example, we will define a <code>base-port</code>. By doing this, we will order DBdeployer to configure our servers starting from port 49007:</p>

<pre data-type="programlisting"># <strong>dbdeployer deploy --topology=group replication --sandbox-binary=/opt/mysql/\</strong>
    <strong>8.0.11 --base-port=49007</strong></pre>

<p>Now let’s see an example of the deployment of Galera Cluster using Percona XtraDB Cluster 5.7.32. <a data-type="indexterm" data-primary="Percona XtraDB Cluster" data-secondary="Galera Cluster deployment" id="idm46177499370664"/><a data-type="indexterm" data-primary="Galera Cluster" data-secondary="Percona XtraDB Cluster" data-tertiary="deployment by" id="idm46177499369624"/>We will indicate the <code>base-port</code>, and we want our nodes configured with the <a href="https://oreil.ly/oMhOY"><code>log-slave-updates</code> option</a>:</p>

<pre data-type="programlisting"># <strong>wget https://downloads.percona.com/downloads/Percona-XtraDB-Cluster-57/\</strong>
    <strong>Percona-XtraDB-Cluster-5.7.32-31.47/binary/tarball/Percona-XtraDB-Cluster-\</strong>
    <strong>5.7.32-rel35-47.1.Linux.x86_64.glibc2.17-debug.tar.gz</strong>
# <strong>dbdeployer --sandbox-binary=/opt/mysql/ unpack\</strong>
    <strong>Percona-XtraDB-Cluster-5.7.32-rel35-47.1.Linux.x86_64.glibc2.17-debug.tar.gz</strong>
# <strong>dbdeployer deploy --topology=pxc replication\</strong>
    <strong>--sandbox-binary=/opt/mysql/ 5.7.32 --base-port=45007 -c log-slave-updates</strong></pre>

<p>As we’ve seen, it is possible to customize MySQL parameters. One interesting option is enabling MySQL replication using <a href="https://oreil.ly/QNCBh"><em>global transaction identifiers</em></a>, or GTIDs (we’ll discuss GTIDs in more detail in <a data-type="xref" href="ch13.xhtml#CH13_HA">Chapter 13</a>):</p>

<pre data-type="programlisting"># <strong>dbdeployer deploy replication --sandbox-binary=/opt/mysql/ 5.7.32 --gtid</strong></pre>

<p>Our last example shows that it is possible to deploy multiple standalone versions at once—here, we create five standalone instances:</p>

<pre data-type="programlisting"># <strong>dbdeployer deploy multiple --sandbox-binary=/opt/mysql/ 5.7.32 -n 5</strong></pre>

<p>The previous examples are just a small sample of DBdeployer’s capabilities. The full documentation is available on <a href="https://oreil.ly/5ygE0">GitHub</a>. Another option to understand the universe of possibilities is to use <code>--help</code> in the command line:<a data-type="indexterm" data-startref="ch01-sbx" id="idm46177499356520"/><a data-type="indexterm" data-startref="ch01-sbx2" id="idm46177499355784"/></p>

<pre data-type="programlisting"># <strong>dbdeployer --help</strong></pre>

<pre data-type="programlisting">dbdeployer makes MySQL server installation an easy task.
Runs single, multiple, and replicated sandboxes.

Usage:
  dbdeployer [command]

Available Commands:
  admin           sandbox management tasks
  cookbook        Shows dbdeployer samples
  defaults        tasks related to dbdeployer defaults
  delete          delete an installed sandbox
  delete-binaries delete an expanded tarball
  deploy          deploy sandboxes
  downloads       Manages remote tarballs
  export          Exports the command structure in JSON format
  global          Runs a given command in every sandbox
  help            Help about any command
  import          imports one or more MySQL servers into a sandbox
  info            Shows information about dbdeployer environment samples
  sandboxes       List installed sandboxes
  unpack          unpack a tarball into the binary directory
  update          Gets dbdeployer newest version
  usage           Shows usage of installed sandboxes
  versions        List available versions

Flags:
      --config string           configuration file (default
                                "/root/.dbdeployer/config.json")
  -h, --help                    help for dbdeployer
      --sandbox-binary string   Binary repository (default
                                "/root/opt/mysql")
      --sandbox-home string     Sandbox deployment directory (default
                                "/root/sandboxes")
      --shell-path string       Which shell to use for generated
                                scripts (default "/usr/bin/bash")
      --skip-library-check      Skip check for needed libraries (may
                                cause nasty errors)
      --version                 version for dbdeployer

Use "dbdeployer [command] --help" for more information about a command.</pre>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Upgrading MySQL Server"><div class="sect1" id="idm46177499405512">
<h1>Upgrading MySQL Server</h1>

<p>If the most common question to arise is about replication,<a data-type="indexterm" data-primary="MySQL" data-secondary="upgrading server" id="ch01-ups2"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="upgrading server" id="ch01-ups"/><a data-type="indexterm" data-primary="upgrading MySQL server" id="ch01-ups3"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="upgrading server" id="ch01-ups4"/> the second most common is about how to upgrade a MySQL instance. If the procedure is not well tested before it’s done in production, the chances of having a problem are high. There are two types of upgrades that you can perform:</p>

<ul>
<li>
<p>A <em>major upgrade</em> in MySQL would be changing versions from 5.6 to 5.7 or 5.7 to 8.0. Such an upgrade is trickier and more complex than a minor upgrade because the changes to the architecture are more substantial. For example, a considerable change in MySQL 8.0 involved modifying the data dictionary, which is now transactional and encapsulated by InnoDB.</p>
</li>
<li>
<p>A <em>minor upgrade</em> would be changing from MySQL 5.7.29 to 5.7.30 or MySQL 8.0.22 to MySQL 8.0.23. Most of the time, you’ll need to install the new version using your distribution’s package manager. A minor upgrade is simpler than a major one because it does not involve any changes in the architecture. The modifications are focused on fixing bugs, improving the performance, and optimizing the code.</p>
</li>
</ul>

<p>To start planning for an upgrade, first choose between two strategies. These are the recommended strategies according to the documentation and are the ones we use:</p>
<dl>
<dt>In-place upgrade</dt>
<dd>
<p>This involves shutting down MySQL, replacing the old MySQL binaries or packages with the new ones, restarting MySQL in the existing data directory, and running <code>mysql_upgrade</code>.</p>
</dd>
</dl>
<div data-type="note" epub:type="note" id="MYSQL-UPGRADE-NOTE"><h6>Note</h6>
<p>As of MySQL 8.0.16, the <em>mysql_upgrade</em> binary is deprecated, and the MySQL server itself executes its functionality (you can think of it as a “server upgrade”). MySQL added this change alongside the data dictionary upgrade (DD upgrade), which is a process to update the data dictionary table definitions. Benefits of the new process include:</p>

<ul>
<li>
<p>Faster upgrades</p>
</li>
<li>
<p>Simpler process</p>
</li>
<li>
<p>Better security</p>
</li>
<li>
<p>Significant reduction in upgrade steps</p>
</li>
<li>
<p>More easily automated</p>
</li>
<li>
<p>No restarts</p>
</li>
<li>
<p>Plug and play</p>
</li>
</ul>
</div>
<dl>
<dt>Logical upgrade</dt>
<dd>
<p>This involves exporting the data in SQL format from the old MySQL version using a backup or export utility such as <em>mysqldump</em> or <em>mysqlpump</em>, installing the new MySQL version, and applying the SQL data to the new MySQL version. In other words, this process involves rebuilding the entire data dictionary and the user data. A logical upgrade usually takes longer than an in-place upgrade.</p>
</dd>
</dl>

<p>Regardless of your chosen strategy, it is essential to establish a rollback strategy in case something goes wrong. The rollback strategy will vary based on the upgrade plan you choose, and the database size and the topology present (if you’re using replicas or Galera Cluster, for example) will influence this decision.</p>

<p>Here are some additional points to take into consideration when planning an upgrade:</p>

<ul>
<li>
<p>Upgrading from MySQL 5.7 to 8.0 is supported. However, the upgrade is only supported between GA releases. For MySQL 8.0, it is required that you upgrade from a MySQL 5.7 GA release (5.7.9 or higher). Upgrades from non-GA releases of MySQL 5.7 are not supported.</p>
</li>
<li>
<p>Upgrading to the latest release is recommended before upgrading to the next version. For example, upgrade to the latest MySQL 5.7 release before upgrading to MySQL 8.0.</p>
</li>
<li>
<p>Upgrades that skip versions are not supported. For example, upgrading directly from MySQL 5.6 to 8.0 is not supported.</p>
</li>
</ul>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Based on our experience, moving from MySQL 5.6 to MySQL 5.7 is the upgrade that causes the most performance issues, especially if the application is using <em>derived tables</em> (see <a data-type="xref" href="ch05.xhtml#ADV1-SEC-NESTEDFROM">“Nested Queries in the FROM Clause”</a>). MySQL 5.7 modified the <a href="https://oreil.ly/m0Ky3"><code>optimizer_switch</code> system variable</a>, enabling the <a href="https://oreil.ly/JROqc"><code>derived_merge</code> setting</a> by default, and this can hurt query performance.</p>

<p>Another complicating change is that MySQL 5.7 implements network encryption by default (SSL). Applications that were not using SSL in MySQL 5.6 may suffer a substantial performance hit.</p>

<p>Finally, MySQL 5.7 changed the <a href="https://oreil.ly/Khh3Q"><code>sync_binlog</code></a> default to synchronous mode. This mode is the safest but can harm performance due to the increased number of disk writes.</p>
</div>

<p>Let’s go through an example of upgrading from MySQL 5.7 upstream to MySQL 8.0 upstream using the in-place method:</p>
<ol>
<li>
<p>Stop the MySQL service. Perform a clean shutdown using <code>systemctl</code>:</p>

<pre data-type="programlisting"># <strong>systemctl stop mysqld</strong></pre>
</li>
<li>
<p>Remove the old binaries:</p>

<pre data-type="programlisting">  # <strong>yum erase mysql-community -y</strong></pre>

<p>This process only removes the binaries and does not touch the <em>datadir</em> (see <a data-type="xref" href="#MYSQL_DIRECTORY_CONTENT">“The Contents of the MySQL Directory”</a>).</p>
</li>
<li>
<p>Follow the regular steps for the installation process (see <a data-type="xref" href="#MYSQL-INSTALL-LINUX">“Installing MySQL on Linux”</a>). For example, to use MySQL 8.0 Community Version on CentOS 7 using <code>yum</code>:</p>

<pre data-type="programlisting"># <strong>yum-config-manager --enable mysql80-community</strong></pre>
</li>
<li>
<p>Install the new binaries:</p>

<pre data-type="programlisting"># <strong>yum install mysql-community-server -y</strong></pre>
</li>
<li>
<p>Start the MySQL service:</p>

<pre data-type="programlisting"># <strong>systemctl start mysqld</strong></pre>
</li>

</ol>

<p>We can observe in the logs that MySQL upgraded the data dictionary and that we’re now running MySQL 8.0.21:</p>

<pre data-type="programlisting"># <strong>tail -f /var/log/mysqld.log</strong></pre>

<pre data-type="programlisting">2020-08-09T21:20:10.356938Z 2 [System] [MY-011003] [Server] Finished
populating Data Dictionary tables with data.
2020-08-09T21:20:11.734091Z 5 [System] [MY-013381] [Server] Server
upgrade from '50700' to '80021' started.
2020-08-09T21:20:17.342682Z 5 [System] [MY-013381] [Server] Server
upgrade from '50700' to '80021' completed.
...
2020-08-09T21:20:17.463685Z 0 [System] [MY-010931] [Server]
/usr/sbin/mysqld: ready for connections. Version: '8.0.21'  socket:
'/var/lib/mysql/mysql.sock'  port: 3306  MySQL Community Server - GPL.</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>We highly recommend before upgrading MySQL that you check the release notes.<a data-type="indexterm" data-primary="web links in book" data-secondary="release notes" id="idm46177499296680"/><a data-type="indexterm" data-primary="release notes" id="idm46177499295704"/><a data-type="indexterm" data-primary="upgrading MySQL server" data-secondary="release notes" id="idm46177499295032"/><a data-type="indexterm" data-primary="MySQL" data-secondary="upgrading server" data-tertiary="release notes" id="idm46177499294088"/><a data-type="indexterm" data-primary="MySQL Community Edition" data-secondary="upgrading server" data-tertiary="release notes" id="idm46177499292872"/><a data-type="indexterm" data-primary="installation of MySQL" data-secondary="upgrading server" data-tertiary="release notes" id="idm46177499291656"/><a data-type="indexterm" data-primary="Percona Server for MySQL" data-secondary="release notes" id="idm46177499290440"/><a data-type="indexterm" data-primary="MariaDB" data-secondary="release notes" id="idm46177499289480"/> They contain a summary of the changes made and the bug fixes. Release notes are available for <a href="https://oreil.ly/FcOVq">MySQL upstream</a>, <a href="https://oreil.ly/Mtt2J">Percona Server</a>, and <a href="https://oreil.ly/T8M9z">MariaDB</a>.</p>
</div>

<p>A common question is whether it’s safe to upgrade to the latest major release. The answer is…it depends. As with any new product in the industry, early adopters tend to benefit from the new features, but they are testers as well, and they may discover and be affected by new bugs. When MySQL 8.0 was released, our recommendation was to wait for three minor releases before considering moving. The golden rule of this book is to test everything in advance before executing the next step. If you learn just that from this book, we will consider our mission accomplished.<a data-type="indexterm" data-startref="ch01-ups" id="idm46177499285160"/><a data-type="indexterm" data-startref="ch01-ups2" id="idm46177499284456"/><a data-type="indexterm" data-startref="ch01-ups3" id="idm46177499283784"/><a data-type="indexterm" data-startref="ch01-ups4" id="idm46177499283112"/></p>
</div></section>







</div></section></div></body></html>