["```\nSHOW CREATE TABLE mysql.user;\n```", "```\nCREATE USER '*`user_name`*'@'*`host_name`*' IDENTIFIED BY '*`password`*';\nCREATE USER '*`user_name`*'@'*`host_name`*' IDENTIFIED WITH '*`auth_plugin`*' BY '*`auth_string`*';\n```", "```\nGRANT *`privileges`* ON *`scope`* TO *`account`*;\n```", "```\n    GRANT FILE ON *.* TO 'user1'@'localhost';\n    GRANT CREATE TEMPORARY TABLES, LOCK TABLES ON *.* TO 'user1'@'localhost';\n    ```", "```\n    GRANT ALL ON cookbook.* TO 'user1'@'localhost';\n    ```", "```\n    GRANT SELECT ON mysql.user TO 'user1'@'localhost';\n    ```", "```\n    GRANT SELECT(User,Host), UPDATE(password_expired)\n    ON mysql.user TO 'user1'@'localhost';\n    ```", "```\n    GRANT EXECUTE ON PROCEDURE cookbook.exec_stmt TO 'user1'@'localhost';\n    ```", "```\nmysql> `SHOW GRANTS FOR 'user1'@'localhost';`\n+--------------------------------------------------------------------------+\n| Grants for user1@localhost                                               |\n+--------------------------------------------------------------------------+\n| GRANT FILE, CREATE TEMPORARY TABLES, LOCK TABLES                         |\n| ON *.* TO 'user1'@'localhost'                                            |\n| GRANT ALL PRIVILEGES ON `cookbook`.* TO 'user1'@'localhost'              |\n| GRANT SELECT, SELECT (User, Host), UPDATE (password_expired)             |\n| ON `mysql`.`user` TO 'user1'@'localhost'                                 |\n| GRANT EXECUTE ON PROCEDURE `cookbook`.`exec_stmt` TO 'user1'@'localhost' |\n+--------------------------------------------------------------------------+\n```", "```\nREVOKE *`privileges`* ON *`scope`* FROM *`account`*;\n```", "```\nmysql> `REVOKE FILE ON *.* FROM 'user1'@'localhost';`\nmysql> `REVOKE CREATE TEMPORARY TABLES, LOCK TABLES`\n    -> `ON *.* FROM 'user1'@'localhost';`\nmysql> `REVOKE ALL ON cookbook.* FROM 'user1'@'localhost';`\nmysql> `REVOKE SELECT ON mysql.user FROM 'user1'@'localhost';`\nmysql> `REVOKE SELECT(User,Host), UPDATE(password_expired)`\n    -> `ON mysql.user FROM 'user1'@'localhost';`\nmysql> `REVOKE EXECUTE ON PROCEDURE cookbook.exec_stmt`\n    -> `FROM 'user1'@'localhost';`\nmysql> `SHOW GRANTS FOR 'user1'@'localhost';`\n+-------------------------------------------+\n| Grants for user1@localhost                |\n+-------------------------------------------+\n| GRANT USAGE ON *.* TO 'user1'@'localhost' |\n+-------------------------------------------+\n```", "```\nDROP USER 'user1'@'localhost';\n```", "```\nRENAME USER 'currentuser'@'localhost' TO 'newuser'@'localhost';\n```", "```\nmysql> `SHOW VARIABLES LIKE 'validate_password%';`\n+--------------------------------------+--------+\n| Variable_name                        | Value  |\n+--------------------------------------+--------+\n| validate_password_dictionary_file    |        |\n| validate_password_length             | 8      |\n| validate_password_mixed_case_count   | 1      |\n| validate_password_number_count       | 1      |\n| validate_password_policy             | MEDIUM |\n| validate_password_special_char_count | 1      |\n+--------------------------------------+--------+\n```", "```\n[mysqld]\nplugin-load-add=validate_password.so\nvalidate_password_length=10\nvalidate_password_mixed_case_count=1\nvalidate_password_number_count=2\nvalidate_password_special_char_count=1\n```", "```\nmysql> `SHOW VARIABLES LIKE 'validate_password%';`\n+--------------------------------------+--------+\n| Variable_name                        | Value  |\n+--------------------------------------+--------+\n| validate_password_dictionary_file    |        |\n| validate_password_length             | 10     |\n| validate_password_mixed_case_count   | 1      |\n| validate_password_number_count       | 2      |\n| validate_password_policy             | MEDIUM |\n| validate_password_special_char_count | 1      |\n+--------------------------------------+--------+\n```", "```\nmysql> `SET PASSWORD = 'weak-password';`\nERROR 1819 (HY000): Your password does not satisfy the current\npolicy requirements\nmysql> `SET PASSWORD = 'Str0ng-Pa33w@rd';`\nQuery OK, 0 rows affected (0.00 sec)\n```", "```\nmysql> `SELECT VALIDATE_PASSWORD_STRENGTH('abc') ;`\n+-----------------------------------+\n| VALIDATE_PASSWORD_STRENGTH('abc') |\n+-----------------------------------+\n|                                 0 |\n+-----------------------------------+\nmysql> `SELECT VALIDATE_PASSWORD_STRENGTH('weak-password');`\n+---------------------------------------------+\n| VALIDATE_PASSWORD_STRENGTH('weak-password') |\n+---------------------------------------------+\n|                                          50 |\n+---------------------------------------------+\nmysql> `SELECT VALIDATE_PASSWORD_STRENGTH('Str0ng-Pa33w@rd');`\n+-----------------------------------------------+\n| VALIDATE_PASSWORD_STRENGTH('Str0ng-Pa33w@rd') |\n+-----------------------------------------------+\n|                                           100 |\n+-----------------------------------------------+\n```", "```\nALTER USER 'cbuser'@'localhost' PASSWORD EXPIRE;\n```", "```\nUPDATE mysql.user SET password_expired = 'Y' WHERE User <> '';\nFLUSH PRIVILEGES;\n```", "```\nCREATE PROCEDURE expire_all_passwords()\nBEGIN\n  DECLARE done BOOLEAN DEFAULT FALSE;\n  DECLARE account TEXT;\n  DECLARE cur CURSOR FOR\n    SELECT CONCAT(QUOTE(User),'@',QUOTE(Host)) AS account\n    FROM mysql.user WHERE User <> '';\n  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;\n\n  OPEN cur;\n  expire_loop: LOOP\n    FETCH cur INTO account;\n    IF done THEN\n      LEAVE expire_loop;\n    END IF;\n    CALL exec_stmt(CONCAT('ALTER USER ',account,' PASSWORD EXPIRE'));\n  END LOOP;\n  CLOSE cur;\nEND;\n```", "```\nSET PASSWORD = '*`my-new-password`*';\n```", "```\nSET PASSWORD FOR '*`user_name`*'@'*`host_name`*' = '*`my-new-password`*';\n```", "```\nALTER USER '*`user_name`*'@'*`host_name`*' IDENTIFIED BY '*`my-new-password`*';\n```", "```\nmysql> `SELECT` `CURRENT_USER``(``)``;`\n+----------------+ | CURRENT_USER() |\n+----------------+ | cbuser@%       |\n+----------------+ 1 row in set (0.00 sec)\n```", "```\n$ `mysql --user=cbuser --password`\nEnter password: `******`\nmysql> `SELECT CURRENT_USER();`\nERROR 1820 (HY000): You must SET PASSWORD before executing this statement\n```", "```\nmysql> `SET PASSWORD = 'my-new-password';`\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> `SELECT CURRENT_USER();` -- now you can work again\n+------------------+\n| CURRENT_USER()   |\n+------------------+\n| cbuser@localhost |\n+------------------+\n1 row in set (0.00 sec)\n```", "```\n    mysql> `SELECT User, Host FROM mysql.user WHERE User = '';`\n    +------+---------------+\n    | User | Host          |\n    +------+---------------+\n    |      | %.example.com |\n    |      | localhost     |\n    +------+---------------+\n    ```", "```\n    mysql> `DROP USER ''@'localhost';`\n    mysql> `DROP USER ''@'%.example.com';`\n    ```", "```\nWHERE Host LIKE '%\\%%' OR Host LIKE '%\\_%';\nWHERE Host REGEXP '[%_]';\n```", "```\n    mysql> `SELECT User, Host FROM mysql.user WHERE Host REGEXP '[%_]';`\n    +-------+---------------+\n    | User  | Host          |\n    +-------+---------------+\n    | user1 | %             |\n    | user2 | %.example.com |\n    | user3 | _.example.com |\n    +-------+---------------+\n    ```", "```\n    mysql> `DROP USER 'user1'@'%';`\n    mysql> `DROP USER 'user3'@'_.example.com';`\n    ```", "```\n    mysql> `RENAME USER 'user2'@'%.example.com' TO 'user2'@'host17.example.com';`\n    ```", "```\n$ `mysql`\nmysql> `\\s`\n--------------\n../bin/mysql  Ver 8.0.21 for Linux on x86_64 (Source distribution)\n\nConnection id:\t\t534\nCurrent database:\t\nCurrent user:\t\troot@localhost\nSSL:\t\t\tCipher in use is TLS_AES_256_GCM_SHA384\n...\nmysql> `SHOW VARIABLES LIKE 'have_ssl';`\n+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| have_ssl      | YES   |\n+---------------+-------+\n1 row in set (0.01 sec)\n```", "```\n$ `mysql_ssl_rsa_setup --datadir=./data`\nIgnoring -days; not generating a certificate\nGenerating a RSA private key\n..............................................................................+++++\n..............+++++\nwriting new private key to 'ca-key.pem'\n-----\nIgnoring -days; not generating a certificate\nGenerating a RSA private key\n....................................+++++\n...........................................+++++\nwriting new private key to 'server-key.pem'\n-----\nIgnoring -days; not generating a certificate\nGenerating a RSA private key\n..............................................................................+++++\n.....................................+++++\nwriting new private key to 'client-key.pem'\n-----\n```", "```\nmysql> `CREATE ROLE cookbook, admin;`\nQuery OK, 0 rows affected (0.00 sec)\n```", "```\nmysql> `GRANT SELECT, INSERT, UPDATE, DELETE, EXECUTE ON cookbook.* TO 'cookbook';`\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> `GRANT GROUP_REPLICATION_ADMIN, PERSIST_RO_VARIABLES_ADMIN,` \n    -> `REPLICATION_SLAVE_ADMIN, RESOURCE_GROUP_ADMIN,` \n    -> `ROLE_ADMIN, SYSTEM_VARIABLES_ADMIN, SYSTEM_USER,`\n    -> `RELOAD, SHUTDOWN ON *.* to 'admin';`\nQuery OK, 0 rows affected (0.01 sec)\n```", "```\nmysql> `GRANT cookbook TO cbuser;`\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> `GRANT cookbook TO sveta;`\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> `GRANT cookbook TO alkin;`\nQuery OK, 0 rows affected (0.00 sec)\n```", "```\nmysql> `GRANT admin TO paul;`\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> `GRANT admin TO amelia;`\nQuery OK, 0 rows affected (0.01 sec)\n```", "```\nmysql> `REVOKE cookbook FROM sveta;`\nQuery OK, 0 rows affected (0.01 sec)\n```", "```\nmysql> `SHOW CREATE TABLE patients\\G`\n*************************** 1\\. row ***************************\n       Table: patients\nCreate Table: CREATE TABLE `patients` (\n  `id` int NOT NULL AUTO_INCREMENT,\n  `national_id` char(32) DEFAULT NULL,\n  `name` varchar(255) DEFAULT NULL,\n  `surname` varchar(255) DEFAULT NULL,\n  `gender` enum('F','M') DEFAULT NULL,\n  `age` tinyint unsigned DEFAULT NULL,\n  `additional_data` json DEFAULT NULL,\n  `diagnosis` varchar(255) DEFAULT NULL,\n  `result` enum('R','N','D') DEFAULT NULL ↩\n    COMMENT 'R=Recovered, N=Not Recovered, D=Dead',\n  `date_arrived` date NOT NULL,\n  `date_departed` date DEFAULT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci\n1 row in set (0.00 sec)\n```", "```\nmysql> `CREATE VIEW patients_statistics AS` \n    -> `SELECT age, gender, diagnosis, result,` \n    ->  `datediff(date_departed, date_arrived) as recovered_time,`\n    -> `MONTH(date_arrived) AS month_arrived,` \n    ->  `YEAR(date_arrived) AS year_arrived`\n    ->  `FROM patients;`\nQuery OK, 0 rows affected (0.03 sec)\n```", "```\nmysql> `CREATE USER statistics;`\nQuery OK, 0 rows affected (0.03 sec)\n\nmysql> `GRANT SELECT ON cookbook.patients_statistics TO statistics;`\nQuery OK, 0 rows affected (0.02 sec)\n```", "```\n# `mysql cookbook -A -ustatistics`\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 17\n...\nmysql> `SELECT diagnosis, AVG(recovered_time) AS recovered_time_avg, COUNT(*) AS cases`\n    -> `FROM patients_statistics WHERE year_arrived='2020'`\n    -> `GROUP BY diagnosis ORDER BY cases DESC;`\n+---------------+--------------------+-------+\n| diagnosis     | recovered_time_avg | cases |\n+---------------+--------------------+-------+\n| Data Phobia   |            24.8333 |     6 |\n| Diabetes      |            10.0000 |     4 |\n| Asthma        |            10.3333 |     3 |\n| Arthritis     |            22.0000 |     3 |\n| Appendicitis  |             5.5000 |     2 |\n| Breast Cancer |            75.0000 |     2 |\n+---------------+--------------------+-------+\n6 rows in set (0.00 sec)\n\nmysql> `SELECT diagnosis, month_arrived, COUNT(*) AS month_cases`\n    -> `FROM patients_statistics WHERE diagnosis='Data Phobia' AND year_arrived='2020'`\n    -> `GROUP BY diagnosis, month_arrived ORDER BY month_arrived;`\n+--------------+---------------+-------------+\n| diagnosis    | month_arrived | month_cases |\n+--------------+---------------+-------------+\n| Data Phobia  |             4 |           1 |\n| Data Phobia  |             9 |           2 |\n| Data Phobia  |            10 |           2 |\n| Data Phobia  |            11 |           1 |\n+--------------+---------------+-------------+\n4 rows in set (0.00 sec)\n```", "```\nmysql> `SELECT * FROM patients;`\nERROR 1142 (42000): SELECT command denied to user 'statistics'@'localhost' ↩\n                                          for table 'patients'\n\nmysql> `SELECT diagnosis, result, date_arrived FROM patients;`\nERROR 1142 (42000): SELECT command denied to user 'statistics'@'localhost' ↩\n                                          for table 'patients'\n```", "```\nmysql> `SHOW CREATE TABLE patients\\G`\n*************************** 1\\. row ***************************\n       Table: patients\nCreate Table: CREATE TABLE `patients` (\n  ...\n  `national_id` char(32) DEFAULT NULL,\n  `name` varchar(255) DEFAULT NULL,\n  `surname` varchar(255) DEFAULT NULL,\n  ...\n  `additional_data` json DEFAULT NULL,\n  ...\n```", "```\nmysql> `INSTALL PLUGIN mysql_no_login SONAME 'mysql_no_login.so';`\nQuery OK, 0 rows affected (0.01 sec)\n```", "```\nmysql> `CREATE USER sp_access IDENTIFIED WITH mysql_no_login;`\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> `GRANT SELECT, UPDATE ON cookbook.patients TO sp_access;`\nQuery OK, 0 rows affected (0.01 sec)\n```", "```\nmysql> `delimiter $$`\nmysql> `CREATE DEFINER='sp_access'@'%' PROCEDURE get_patient_data(IN nat_id CHAR(32))` \n    ->  `SQL SECURITY DEFINER`\n    ->  `BEGIN`\n    -> `SELECT name, surname, gender, age, additional_data` \n    ->  `FROM patients WHERE national_id=nat_id;`\n    ->  `END`\n    -> `$$`\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> `delimiter ;`\n```", "```\nmysql> `delimiter $$`\nmysql> `CREATE DEFINER='sp_access'@'%' PROCEDURE update_patient_data(`\n    ->  `IN nat_id CHAR(32),`\n    ->  `IN new_name varchar(255),`\n    ->  `IN new_surname varchar(255),`\n    ->  `IN new_additional_data JSON)`\n    ->  `SQL SECURITY DEFINER`\n    ->  `BEGIN`\n    -> `UPDATE patients` \n    ->  `SET name=COALESCE(new_name, name),`\n    ->  `surname=COALESCE(new_surname, surname),`\n    ->  `additional_data=JSON_MERGE_PATCH(COALESCE(additional_data, '{}'),`\n    ->  `COALESCE(new_additional_data, '{}'))`\n    ->  `WHERE national_id=nat_id;`\n    ->  `END`\n    -> `$$`\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> `delimiter ;`\n```", "```\nmysql> `GRANT EXECUTE ON PROCEDURE cookbook.get_patient_data TO sp_access;`\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> `GRANT EXECUTE ON PROCEDURE cookbook.update_patient_data TO sp_access;`\nQuery OK, 0 rows affected (0.00 sec)\n```", "```\nmysql> `CREATE USER patient;`\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> `GRANT EXECUTE ON PROCEDURE cookbook.get_patient_data TO patient;`\nQuery OK, 0 rows affected (0.02 sec)\n\nmysql> `GRANT EXECUTE ON PROCEDURE cookbook.update_patient_data TO patient;`\nQuery OK, 0 rows affected (0.01 sec)\n```", "```\nmysql> `SHOW GRANTS;`\n+------------------------------------------------------------------------------+\n| Grants for patient@%                                                         |\n+------------------------------------------------------------------------------+\n| GRANT USAGE ON *.* TO `patient`@`%`                                          |\n| GRANT EXECUTE ON PROCEDURE `cookbook`.`get_patient_data` TO `patient`@`%`    |\n| GRANT EXECUTE ON PROCEDURE `cookbook`.`update_patient_data` TO `patient`@`%` |\n+------------------------------------------------------------------------------+\n3 rows in set (0.00 sec)\n\nmysql> `CALL update_patient_data('89AR642465', NULL, 'Johnson',`\n    -> `' {\"Height\": 165, \"Weight\": 55, \"Hair color\": \"Blonde\"}');`\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> `CALL get_patient_data('89AR642465')\\G`\n*************************** 1\\. row ***************************\n           name: Mary\n        surname: Johnson\n         gender: F\n            age: 24\nadditional_data: {\"Height\": 165, \"Weight\": 55, \"Hair color\": \"Blonde\"}\n1 row in set (0.00 sec)\n\nQuery OK, 0 rows affected (0.00 sec)\n```"]