["```\n+---------------------------------------+----------------------+\n| vinicius-grippa-default(mysql)        | 10.124.33.5 (eth0)   |\n+---------------------------------------+----------------------+\n| vinicius-grippa-node1(mysql)          | 10.124.33.169 (eth0) |\n+---------------------------------------+----------------------+\n| vinicius-grippa-node2(mysql)          | 10.124.33.130 (eth0) |\n+---------------------------------------+----------------------+\n| vinicius-grippa-node3(proxysql)       | 10.124.33.170 (eth0) |\n+---------------------------------------+----------------------+\n```", "```\n$ sudo su - root\n# yum -y install https://repo.percona.com/yum/percona-release-latest.noarch.rpm\n# yum -y install Percona-Server-client-57\n# yum install -y https://github.com/sysown/proxysql/releases/download/v2.0.15/ \\\n     proxysql-2.0.15-1-centos7.x86_64.rpm\n```", "```\n# sudo systemctl start proxysql\n```", "```\n# systemctl status proxysql\n```", "```\n proxysql.service - High Performance Advanced Proxy for MySQL\n   Loaded: loaded (/etc/systemd/system/proxysql.service; enabled; vendor...\n   Active: active (running) since Sun 2021-05-23 18:50:28 UTC; 15s ago\n  Process: 1422 ExecStart=/usr/bin/proxysql --idle-threads -c /etc/proxysql...\n Main PID: 1425 (proxysql)\n   CGroup: /system.slice/proxysql.service\n           ├─1425 /usr/bin/proxysql --idle-threads -c /etc/proxysql.cnf\n           └─1426 /usr/bin/proxysql --idle-threads -c /etc/proxysql.cnf\n\nMay 23 18:50:27 vinicius-grippa-node3 systemd[1]: Starting High Performance...\nMay 23 18:50:27 vinicius-grippa-node3 proxysql[1422]: 2021-05-23 18:50:27...\nMay 23 18:50:27 vinicius-grippa-node3 proxysql[1422]: 2021-05-23 18:50:27...\nMay 23 18:50:27 vinicius-grippa-node3 proxysql[1422]: 2021-05-23 18:50:27...\nMay 23 18:50:28 vinicius-grippa-node3 systemd[1]: Started High Performance...\n```", "```\nmysql> `CREATE` `USER` `'proxysql'``@``'%'` `IDENTIFIED` `by` `'$3Kr$t'``;`\nmysql> `GRANT` `USAGE` `ON` `*``.``*` `TO` `'proxysql'``@``'%'``;`\n```", "```\n# mysql -uadmin -padmin -h 127.0.0.1 -P 6032\n```", "```\nproxysql> `UPDATE` `global_variables` `SET` `variable_value``=``'proxysql'`\n       -> `WHERE` `variable_name``=``'mysql-monitor_username'``;`\nproxysql> `UPDATE` `global_variables` `SET` `variable_value``=``'$3Kr$t'`\n       -> `WHERE` `variable_name``=``'mysql-monitor_password'``;`\nproxysql> `LOAD` `MYSQL` `VARIABLES` `TO` `RUNTIME``;`\nproxysql> `SAVE` `MYSQL` `VARIABLES` `TO` `DISK``;`\n```", "```\nproxysql> `INSERT` `INTO` `mysql_servers``(``hostgroup_id``,` `hostname``,` `port``)`\n       -> `VALUES` `(``10``,``'10.124.33.5'``,``3306``)``;`\nproxysql> `INSERT` `INTO` `mysql_servers``(``hostgroup_id``,` `hostname``,` `port``)`\n       -> `VALUES` `(``11``,``'10.124.33.169'``,``3306``)``;`\nproxysql> `INSERT` `INTO` `mysql_servers``(``hostgroup_id``,` `hostname``,` `port``)`\n       -> `VALUES` `(``11``,``'10.124.33.130'``,``3306``)``;`\nproxysql> `LOAD` `MYSQL` `SERVERS` `TO` `RUNTIME``;`\nproxysql> `SAVE` `MYSQL` `SERVERS` `TO` `DISK``;`\n```", "```\nproxysql> `INSERT` `INTO` `mysql_replication_hostgroups`\n       -> `(``writer_hostgroup``,` `reader_hostgroup``)` `VALUES` `(``10``,` `11``)``;`\nproxysql> `LOAD` `MYSQL` `SERVERS` `TO` `RUNTIME``;`\nproxysql> `SAVE` `MYSQL` `SERVERS` `TO` `DISK``;`\n```", "```\nmysql> `CREATE` `USER` `'app'``@``'%'` `IDENTIFIED` `by` `'$3Kr$t'``;`\nmysql> `GRANT` `ALL` `PRIVILEGES` `ON` `*``.``*` `TO` `'app'``@``'%'``;`\n```", "```\nproxysql> `INSERT` `INTO` `mysql_users` `(``username``,``password``,``default_hostgroup``)`\n       -> `VALUES` `(``'app'``,``'$3Kr$t'``,``10``)``;`\nproxysql> `LOAD` `MYSQL` `USERS` `TO` `RUNTIME``;`\nproxysql> `SAVE` `MYSQL` `USERS` `TO` `DISK``;`\n```", "```\nproxysql> `INSERT` `INTO` `mysql_query_rules`\n       -> `(``rule_id``,``username``,``destination_hostgroup``,``active``,``match_digest``,``apply``)`\n       -> `VALUES``(``1``,``'app'``,``10``,``1``,``'^SELECT.*FOR UPDATE'``,``1``)``;`\nproxysql> `INSERT` `INTO` `mysql_query_rules`\n       -> `(``rule_id``,``username``,``destination_hostgroup``,``active``,``match_digest``,``apply``)`\n       -> `VALUES``(``2``,``'app'``,``11``,``1``,``'^SELECT '``,``1``)``;`\nproxysql> `LOAD` `MYSQL` `QUERY` `RULES` `TO` `RUNTIME``;`\nproxysql> `SAVE` `MYSQL` `QUERY` `RULES` `TO` `DISK``;`\n```", "```\nproxysql> `SELECT` `*` `FROM` `mysql_servers``;`\n```", "```\n+--------------+---------------+------+-----------+...\n| hostgroup_id | hostname      | port | gtid_port |...\n+--------------+---------------+------+-----------+...\n| 10           | 10.124.33.5   | 3306 | 0         |...\n| 11           | 10.124.33.169 | 3306 | 0         |...\n| 11           | 10.124.33.130 | 3306 | 0         |...\n+--------------+---------------+------+-----------+...\n...+--------------+---------------+------+-----------+\n...| status | weight | compression | max_connections |...\n...+--------+--------+-------------+-----------------+...\n...| ONLINE | 1      | 0           | 1000            |...\n...| ONLINE | 1      | 0           | 1000            |...\n...| ONLINE | 1      | 0           | 1000            |...\n...+--------+--------+-------------+-----------------+...\n...+---------------------+---------+----------------+---------+\n...| max_replication_lag | use_ssl | max_latency_ms | comment |\n...+---------------------+---------+----------------+---------+\n...| 0                   | 0       | 0              |         |\n...| 0                   | 0       | 0              |         |\n...| 0                   | 0       | 0              |         |\n...+---------------------+---------+----------------+---------+\n3 rows in set (0.00 sec)\n```", "```\nmysql> `SET` `GLOBAL` `read_only``=``1``;`\n```", "```\n$ `mysql` `-``uapp` `-``p``'$3Kr$t'` `-``h` `127``.``0``.``0``.``1` `-``P` `6033` `-``e` `\"select @@hostname;\"`\n```", "```\n+-----------------------+\n| @@hostname            |\n+-----------------------+\n| vinicius-grippa-node1 |\n+-----------------------+\n```", "```\n# apt update\n# apt install haproxy\n```", "```\n# sudo yum update\n# sudo yum install haproxy\n```", "```\n172.16.3.45/Port:3306\n172.16.1.72/Port:3306\n172.16.0.161/Port:3306\n```", "```\nglobal\n    log /dev/log   local0\n    log /dev/log   local1 notice\n    maxconn 4096\n    #debug\n    #quiet\n    chroot      /var/lib/haproxy\n    pidfile     /var/run/haproxy.pid\n    user        haproxy\n    group       haproxy\n    daemon\n\n    # turn on stats unix socket\n    stats socket /var/lib/haproxy/stats\n\n#---------------------------------------------------------------------\n# common defaults that all the 'listen' and 'backend' sections will\n# use if not designated in their block\n#---------------------------------------------------------------------\ndefaults\n     log     global\n     mode    http\n     option  tcplog\n     option  dontlognull\n     retries 3\n     redispatch\n     maxconn 2000\n     contimeout      5000\n     clitimeout      50000\n     srvtimeout      50000\n\n#---------------------------------------------------------------------\n# round robin balancing between the various backends\n#---------------------------------------------------------------------\nlisten mysql-pxc-cluster 0.0.0.0:3307\n     mode tcp\n     bind *:3307\n     timeout client  10800s\n     timeout server  10800s\n     balance roundrobin\n     option httpchk\n\n     server vinicius-grippa-node2 172.16.0.161:3306 check port 9200\n     inter 12000 rise 3 fall 3\n     server vinicius-grippa-node1 172.16.1.72:3306 check port 9200 inter 12000\n\n     rise 3 fall 3\n     server vinicius-grippa-default 172.16.3.45:3306 check port 9200\n     inter 12000 rise 3 fall 3\n```", "```\n# sudo haproxy -f /etc/haproxy/haproxy.cfg\n```", "```\n# sudo haproxy -f /etc/haproxy/haproxy.cfg /etc/haproxy/haproxy-2.cfg\n```", "```\n# sudo haproxy -f conf-dir\n```", "```\nmysqlchk        9200/tcp                # mysqlchk\n```", "```\n# yum install -y xinetd\n```", "```\n# sudo apt-get install -y xinetd\n```", "```\nmysql> CREATE USER 'clustercheckuser'@'localhost' IDENTIFIED BY\n               'clustercheckpassword!';\n    -> GRANT PROCESS ON *.* TO 'clustercheckuser'@'localhost';\n\n```", "```\n# /usr/bin/clustercheck\n```", "```\nHTTP/1.1 200 OK\nContent-Type: text/plain\nConnection: close\nContent-Length: 40\n\nPercona XtraDB Cluster Node is synced.\n```", "```\n# mysql -uroot -psecret -h 127.0.0.1 -P 3307 -e \"select @@hostname\"\n```", "```\n+-----------------------+\n| @@hostname            |\n+-----------------------+\n| vinicius-grippa-node1 |\n+-----------------------+\n```", "```\n$ mysql -uroot -psecret -h 127.0.0.1 -P 3307 -e \"select @@hostname\"\n```", "```\nmysql: [Warning] Using a password on the command line interface can be\ninsecure.\n+-----------------------+\n| @@hostname            |\n+-----------------------+\n| vinicius-grippa-node2 |\n+-----------------------+\n```", "```\n$ mysql -uroot -psecret -h 127.0.0.1 -P 3307 -e \"select @@hostname\"\n```", "```\nmysql: [Warning] Using a password on the command line interface can be\ninsecure.\n+-------------------------+\n| @@hostname              |\n+-------------------------+\n| vinicius-grippa-default |\n+-------------------------+\n```", "```\nmysql> `SELECT` `member_host``,` `member_port``,` `member_state``,` `member_role`\n    -> `FROM` `performance_schema``.``replication_group_members``;`\n```", "```\n+--------------+-------------+--------------+-------------+\n| member_host  | member_port | member_state | member_role |\n+--------------+-------------+--------------+-------------+\n| 172.16.3.9   |        3306 | ONLINE       | SECONDARY   |\n| 172.16.3.127 |        3306 | ONLINE       | SECONDARY   |\n| 172.16.3.120 |        3306 | ONLINE       | PRIMARY     |\n+--------------+-------------+--------------+-------------+\n3 rows in set (0.00 sec)\n```", "```\nmysql> `SELECT` `cluster_name` `FROM` `mysql_innodb_cluster_metadata``.``clusters``;`\n```", "```\n+--------------+\n| cluster_name |\n+--------------+\n| cluster1     |\n+--------------+\n1 row in set (0.00 sec)\n```", "```\n# cat /etc/*release\n```", "```\nCentOS Linux release 7.9.2009 (Core)\n```", "```\n# yum install -y https://dev.mysql.com/get/Downloads/MySQL-Router/mysql-\n```", "```\nrouter-community-8.0.23-1.el7.x86_64.rpm\nLoaded plugins: fastestmirror\nmysql-router-community-8.0.23-1.el7.x86_64.rpm                                                                                                                                           |  34 MB  00:00:01\nExamining /var/tmp/yum-root-_ljdTQ/mysql-router-community-8.0.23-1.el7.x\n86_64.rpm: mysql-router-community-8.0.23-1.el7.x86_64\nMarking /var/tmp/yum-root-_ljdTQ/mysql-router-community-8.0.23-1.el7.x86\n_64.rpm to be installed\nResolving Dependencies\n--> Running transaction check\n...\nRunning transaction\n  Installing : mysql-router-community-8.0.23-1.el7.x86_64\n  1/1\n  Verifying  : mysql-router-community-8.0.23-1.el7.x86_64\n  1/1\n\nInstalled:\n  mysql-router-community.x86_64 0:8.0.23-1.el7\n\nComplete!\n```", "```\n# mkdir /var/lib/mysqlrouter\n```", "```\n# mysqlrouter --bootstrap root@172.16.3.120:3306 \\\n    --directory /var/lib/mysqlrouter --conf-use-sockets \\\n    --account app_router --account-create always \\\n    --user=mysql\n```", "```\nPlease enter MySQL password for root:\n# Bootstrapping MySQL Router instance at '/var/lib/mysqlrouter'...\n\nPlease enter MySQL password for app_router:\n- Creating account(s)\n- Verifying account (using it to run SQL queries that would be run by\nRouter)\n- Storing account in keyring\n- Adjusting permissions of generated files\n- Creating configuration /var/lib/mysqlrouter/mysqlrouter.conf\n\n...\n\n## MySQL Classic protocol\n\n- Read/Write Connections: localhost:6446, /var/lib/mysqlrouter/mysql.sock\n- Read/Only Connections:  localhost:6447,\n/var/lib/mysqlrouter/mysqlro.sock\n\n## MySQL X protocol\n\n- Read/Write Connections: localhost:64460,\n/var/lib/mysqlrouter/mysqlx.sock\n- Read/Only Connections:  localhost:64470,\n/var/lib/mysqlrouter/mysqlxro.sock\n```", "```\n# ls -l | awk '{print $9}'\n```", "```\ndata\nlog\nmysqlrouter.conf\nmysqlrouter.key\nrun\nstart.sh\nstop.sh\n```", "```\n# cat mysqlrouter.conf\n```", "```\n# File automatically generated during MySQL Router bootstrap\n[DEFAULT]\nuser=mysql\nlogging_folder=/var/lib/mysqlrouter/log\nruntime_folder=/var/lib/mysqlrouter/run\n\n...\n\n[rest_routing]\nrequire_realm=default_auth_realm\n\n[rest_metadata_cache]\nrequire_realm=default_auth_realm\n```", "```\n# ./start.sh\n```", "```\n# PID 1684 written to '/var/lib/mysqlrouter/mysqlrouter.pid'\nlogging facility initialized, switching logging to loggers specified in\nconfiguration\n```", "```\n# ps -ef | grep -i mysqlrouter\n```", "```\nroot      1683     1  0 17:36 pts/0    00:00:00 sudo\nROUTER_PID=/var/lib/mysqlrouter/mysqlrouter.pid /usr/bin/mysqlrouter -c\n/var/lib/mysqlrouter/mysqlrouter.conf --user=mysql\nmysql     1684  1683  0 17:36 pts/0    00:00:17 /usr/bin/mysqlrouter -c\n/var/lib/mysqlrouter/mysqlrouter.conf --user=mysql\nroot      1733  1538  0 17:41 pts/0    00:00:00 grep --color=auto -i\nmysqlrouter\n```", "```\n# netstat -tulnp | grep -i mysqlrouter\n```", "```\ntcp   0   0 0.0.0.0:64470   0.0.0.0:*   LISTEN   1684/mysqlrouter\ntcp   0   0 0.0.0.0:8443    0.0.0.0:*   LISTEN   1684/mysqlrouter\ntcp   0   0 0.0.0.0:64460   0.0.0.0:*   LISTEN   1684/mysqlrouter\ntcp   0   0 0.0.0.0:6446    0.0.0.0:*   LISTEN   1684/mysqlrouter\ntcp   0   0 0.0.0.0:6447    0.0.0.0:*   LISTEN   1684/mysqlrouter\n```", "```\n# mysql -uroot -psecret -h 127.0.0.1 -P 6446 \\\n    -e \"create database learning_mysql;\"\n# mysql -uroot -psecret -h 127.0.0.1 -P 6446 \\\n    -e \"use learning_mysql; select database()\"\n```", "```\n+----------------+\n| database()     |\n+----------------+\n| learning_mysql |\n+----------------+\n```", "```\n# mysql -uroot -psecret -h 127.0.0.1 -P 6447 \\\n    -e \"use learning_mysql; select database()\"\n```", "```\n+----------------+\n| database()     |\n+----------------+\n| learning_mysql |\n+----------------+\n```", "```\n# mysql -uroot -psecret -h 127.0.0.1 -P 6447 \\\n    -e \"create database learning_mysql_write;\"\n```", "```\nERROR 1290 (HY000) at line 1: The MySQL server is running with the\n--super-read-only option so it cannot execute this statement\n```", "```\n# mysql -uroot -psecret -h 127.0.0.1 -P 6447 -e \"select @@hostname\"\n```", "```\n+-----------------------+\n| @@hostname            |\n+-----------------------+\n| vinicius-grippa-node1 |\n+-----------------------+\n```", "```\n# mysql -uroot -psecret -h 127.0.0.1 -P 6447 -e \"select @@hostname\"\n```", "```\ninsecure.\n+-----------------------+\n| @@hostname            |\n+-----------------------+\n| vinicius-grippa-node2 |\n+-----------------------+\n```"]