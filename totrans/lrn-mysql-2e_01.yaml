- en: Chapter 1\. Installing MySQL
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let’s begin our learning path by installing MySQL and accessing it for the first
    time.
  prefs: []
  type: TYPE_NORMAL
- en: Note that we do not rely on a single version of MySQL for this book. Instead,
    we have drawn on our collective knowledge of MySQL in the real world. The book’s
    core is focused on Linux operating systems (mostly Ubuntu/Debian and CentOS/RHEL
    or its derivatives) and on MySQL 5.7 and MySQL 8.0, because those are what we
    consider the “current” versions capable of production workloads. The MySQL 5.7
    and 8.0 series are still under development, which means that newer versions with
    bug fixes and new features will continue to be released.
  prefs: []
  type: TYPE_NORMAL
- en: 'With MySQL becoming the [most popular](https://oreil.ly/pPG4q) open source
    database (Oracle, which ranks first, is not open source), the demand for having
    a fast installation process has increased. You can think of installing MySQL from
    scratch as similar to baking a cake: the source code is the recipe. But even with
    the source code available, the recipe for building software is not easy to follow.
    It takes time to compile, and usually, it is necessary to install additional development
    libraries that expose production environments to risk. Say you want a chocolate
    cake; even if you have the instructions for how to make it yourself, you may not
    want to mess up your kitchen, or you may not have the time to bake it, so you
    go to a bakery and buy one instead. For MySQL, when you want it ready to use without
    the effort involved in compiling it, you can use the *distribution packages*.'
  prefs: []
  type: TYPE_NORMAL
- en: Distribution packages for MySQL are available for diverse platforms, including
    Linux distributions, Windows, and macOS. These packages provide a flexible and
    fast way to start using MySQL. Returning to the chocolate cake example, suppose
    you want to change something. Maybe you want a white chocolate cake. For MySQL,
    we have what are called forks, which include some different options. We’ll look
    at a few of these in the next section.
  prefs: []
  type: TYPE_NORMAL
- en: MySQL Forks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In software engineering, a *fork* occurs when someone copies the source code
    and starts their own path of independent development and support. The fork can
    follow a track close to that of the original version, as the Percona distribution
    of MySQL does, or drift away, like MariaDB. Because the MySQL source code is open
    and free, new projects can fork the code without permission from its original
    creator. Let’s take a look at a few of the most notable forks.
  prefs: []
  type: TYPE_NORMAL
- en: MySQL Community Edition
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: MySQL Community Edition, also known as the *upstream* or *vanilla* version of
    MySQL, is the open source version distributed by Oracle. This version drives the
    development of the InnoDB engine and new features, and it is the first one to
    receive updates, new features, and bug fixes.
  prefs: []
  type: TYPE_NORMAL
- en: Percona Server for MySQL
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The Percona distribution of MySQL is a free, open source, drop-in replacement
    for MySQL Community Edition. The development closely follows that version, focusing
    on improving performance and the overall MySQL ecosystem. Percona Server also
    includes additional enhancements like the MyRocks engine, an Audit Log plugin,
    and a PAM Authentication plugin. Percona was cofounded by [Peter Zaitsev](https://oreil.ly/MfiKb)
    and [Vadim Tkachenko](https://oreil.ly/283nR).
  prefs: []
  type: TYPE_NORMAL
- en: MariaDB Server
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Created by [Michael “Monty” Widenius](https://oreil.ly/PRoMh) and distributed
    by the MariaDB Foundation, MariaDB Server is by far the fork that has drifted
    the furthest away from vanilla MySQL. In recent years it has developed new features
    and engines such as MariaDB ColumnStore, and it was the first database to integrate
    Galera 4 clustering functionality.
  prefs: []
  type: TYPE_NORMAL
- en: MySQL Enterprise Edition
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: MySQL Enterprise Edition is currently the only version with a commercial license
    (which means you need to pay to use it, like a Windows license). Also distributed
    by Oracle, it contains all the functionality of the Community Edition plus exclusive
    features for security, backup, and high availability.
  prefs: []
  type: TYPE_NORMAL
- en: Installation Choices and Platforms
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First, you must choose the MySQL version compatible with your operating system
    (OS). You can verify compatibility with the [MySQL website](https://oreil.ly/DTRSR).
    The same support policies are available for [Percona Server](https://oreil.ly/1ahne)
    and [MariaDB](https://oreil.ly/7SYE4).
  prefs: []
  type: TYPE_NORMAL
- en: 'We often hear the question: is it possible to install MySQL on an OS that is
    not supported? Most of the time, the answer is yes. It is possible to install
    MySQL on Windows 7, for example, but the risks of hitting a bug or facing unpredictable
    behavior (like memory leaks or underperformance) are high. Because of these risks,
    we do not recommend doing this for production environments.'
  prefs: []
  type: TYPE_NORMAL
- en: The next step is to decide whether to install a *development* or *General Availability*
    (GA) release. Development releases have the newest features, but we do not recommend
    them for production because they are not stable. GA releases, also called *production*
    or *stable* releases, are meant for production use.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: We highly recommend using the most recent GA release because this will include
    the latest stable bug fixes and performance improvements.
  prefs: []
  type: TYPE_NORMAL
- en: The last thing to decide is which distribution format to install for the operating
    system. For most use cases, a binary distribution fits. Binary distributions are
    available in native format for many platforms, such as *.rpm* packages for Linux
    or *.dmg* packages for macOS. The distributions are also available in generic
    formats, such as *.zip* archives or compressed *.tar* files (*tarballs*). On Windows,
    you can use the MySQL Installer to install a binary distribution.
  prefs: []
  type: TYPE_NORMAL
- en: Warning
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Watch out for whether the version is 32-bit or 64-bit. The rule of thumb is
    to pick the 64-bit version. Unless you are working with an ancient OS, you should
    *not* select the 32-bit version. This is because 32-bit processors can handle
    only a limited amount of RAM (4 GB or less), whereas 64-bit processors are capable
    of addressing much more memory.
  prefs: []
  type: TYPE_NORMAL
- en: The installation process consists of four major steps, outlined in the following
    sections. It’s essential to follow these correctly and to set the minimum security
    requirements for the MySQL database.
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Download the Distribution that You Want to Install
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Each distribution has its owner and, by consequence, its source. Some Linux
    distributions provide default packages in their repositories. For example, on
    CentOS 8, the MySQL vanilla distribution is available from the default repositories.
    When the OS has default packages available, it is unnecessary to download MySQL
    from a website or configure a repository yourself, which facilitates the installation
    process.
  prefs: []
  type: TYPE_NORMAL
- en: 'We will demonstrate how to install the repositories and download the files
    without the need to go to the website during the installation process. However,
    if you do want to download MySQL yourself, you can use the following links:'
  prefs: []
  type: TYPE_NORMAL
- en: '[MySQL Community Server](https://oreil.ly/sBR5i)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Percona Server for MySQL](https://oreil.ly/R9oO4)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[MariaDB Server](https://oreil.ly/a78XW)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 2\. Install the Distribution
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Installing consists of the elementary steps to make MySQL functional and bring
    it online, but not securing MySQL. For example, at this point, the MySQL root
    user can connect without a password, which is quite hazardous since the root user
    has privileges to perform every action, including dropping a database.
  prefs: []
  type: TYPE_NORMAL
- en: 3\. Perform Any Necessary Post-Installation Setup
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This step is about making sure the MySQL server is working correctly. It is
    essential to make sure that your server is secure, and the first step for this
    is executing the *mysql_secure_installation* script. You’ll change the password
    for the root user, disable access for the root user from a remote server, and
    remove the test database.
  prefs: []
  type: TYPE_NORMAL
- en: 4\. Run Benchmarks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Some DBAs run benchmarks for each deployment to measure whether the performance
    is suitable for the project they are using it for. The most common tool for this
    is [`sysbench`](https://oreil.ly/ioyXF). It’s essential to highlight here that
    `sysbench` performs a *synthetic workload*, whereas when the application is running,
    we call it the *real workload*. Synthetic workloads usually provide reports about
    the maximum server performance, but they can’t reproduce the real-world workload
    (with its inherent locks, different query execution times, stored procedures,
    triggers, and so on).
  prefs: []
  type: TYPE_NORMAL
- en: In the next section we’ll walk through the details of the installation process
    for a few of the most commonly used platforms.
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL on Linux
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Linux ecosystem is diverse and has many variants, including Red Hat Enterprise
    Linux (RHEL), CentOS, Ubuntu, Debian, and others. This section focuses on only
    the most popular ones—otherwise, this book would be entirely about the installation
    process!
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL on CentOS 7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '*CentOS*, short for Community Enterprise Linux Operating System, was founded
    in 2004, and Red Hat acquired it in 2014\. CentOS is the community version of
    Red Hat, so they’re pretty much identical, but CentOS is free, and support comes
    from the community instead of Red Hat itself. CentOS 7 was released in 2014, and
    its end-of-life date is in 2024.'
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL 8.0
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To install MySQL 8.0 on CentOS 7 using the *yum* repository, complete the following
    steps.
  prefs: []
  type: TYPE_NORMAL
- en: Log in to Linux server
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Usually, for security reasons, users log into Linux servers as nonprivileged
    users. Here is an example of a user logging into Linux from a macOS terminal using
    a private key:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'After you’ve successfully connected, you’ll see something like this in the
    terminal:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Once you’re connected to the server, you need to become root:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'You will then see a prompt like the following in your terminal:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Becoming root is important because to install MySQL it is necessary to perform
    tasks such as creating the MySQL user in Linux, configuring directories, and setting
    permissions. It is also possible to use the `sudo` command for all examples we
    will show that should be executed by the root user. However, if you forget to
    prefix a command with `sudo`, the installation process will be incomplete.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: This chapter will use the Linux root user in the majority of the examples (represented
    by the prompt `#` in the code lines). Another advantage of the `#` representation
    is that this is also the comment character in Linux. If you blindly copy/paste
    lines from the book, you won’t run any real commands in the shell.
  prefs: []
  type: TYPE_NORMAL
- en: Configure the yum repository
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Execute the following command to configure the MySQL *yum* repository:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Install MySQL 8.0 Community Server
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Because the MySQL *yum* repository has repositories for multiple MySQL versions
    (5.7 and 8.0 major versions), first we have to disable all repositories:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Next, we need to enable the MySQL 8.0 repository and execute the following
    command to install MySQL 8.0:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Start the MySQL service
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Now, start the MySQL service with the `systemctl` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'It is also possible to start the MySQL process manually, which can be useful
    to troubleshoot initialization problems when MySQL is refusing to start. To start
    manually, indicate the location of the *my.cnf* file and which user can manipulate
    the database files and the process:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Discover the default password for the root user
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'When you install MySQL 8.0, MySQL creates a temporary password for the root
    user account. To identify the password of the root user account, execute the following
    command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'The command provides output like the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: Secure the MySQL installation
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'MySQL provides a shell script that you can run on Unix systems, *mysql_secure_installation*,
    that enables you to improve the security of your server installation in the following
    ways:'
  prefs: []
  type: TYPE_NORMAL
- en: You can set a password for the root account.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can disable root access from outside the localhost.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can remove anonymous user accounts.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can remove the test database, which by default can be accessed by anonymous
    users.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Execute the command `mysql_secure_installation` to secure the MySQL server:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'It will prompt you for the current password of the root account:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'Enter the temporary password obtained in the previous step and press Enter.
    The following message will appear:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: This section will cover only the basics of changing the root password to grant
    access to the MySQL server. We will show more details about granting privileges
    and creating a password policy in [Chapter 8](ch08.xhtml#CH8_USER_MANAGEMENT).
  prefs: []
  type: TYPE_NORMAL
- en: 'You will need to enter the new password for the root account twice. More recent
    MySQL versions come with a validation policy, which means that the new password
    needs to respect minimal requirements to be accepted. The default requirements
    are that passwords must be at least eight characters long and include:'
  prefs: []
  type: TYPE_NORMAL
- en: At least one numeric character
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: At least one lowercase character
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: At least one uppercase character
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: At least one special (nonalphanumeric) character
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Next, it will prompt you with some yes/no questions about whether you want
    to make some initial setup changes. To ensure maximum protection, we recommend
    removing anonymous users, disabling remote root login, and removing the test database
    (i.e., answering *yes* for all options):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: Connect to MySQL
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'This step is optional, but we use it to verify that we executed all the steps
    correctly. Use this command to connect to the MySQL server:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: 'It will prompt for the password of the root user. Type the password and press
    Enter:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 'If successful, it will show the MySQL command line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: Start MySQL 8.0 upon server start (optional)
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To set MySQL to start whenever the server boots up, use the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: Installing MariaDB 10.5
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To install MariaDB 10.5 on CentOS 7, you’ll need to execute similar steps as
    for the vanilla MySQL distribution.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, we need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Install the MariaDB repository
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'The following set of commands will download the MariaDB repo and configure
    it for the next step. Note that in the `yum` commands, we are using the `-y` option.
    This option tells Linux to assume the answer is *yes* for all subsequent questions:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: Install MariaDB
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'With the repository configured, the next command will install the latest stable
    version of MariaDB and its dependencies:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: 'The end of the output will be similar to this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: The *Complete!* at the end of the log indicates a successful installation.
  prefs: []
  type: TYPE_NORMAL
- en: Start MariaDB
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'With MariaDB installed, initialize the service with the `systemctl` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: 'You can use this command to verify its status:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: Secure MariaDB
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'At this point, MariaDB will be running in insecure mode. In contrast to MySQL
    8.0, MariaDB will have an empty root password so you can access it instantly:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: 'You can execute `mysql_secure_installation` to secure MariaDB just like you
    would for MySQL 8.0 (see the previous section for details). There is a slight
    variation in output, with one extra question:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: Answering *yes* changes the connection from TCP/IP to Unix socket mode. We will
    discuss the different connection types in [“MySQL 5.7 Default Files”](#MYSQL-SOCKET-TCP).
  prefs: []
  type: TYPE_NORMAL
- en: Installing Percona Server 8.0
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Install Percona Server 8.0 on CentOS 7 using the following step.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Install the Percona repository
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'You can install the Percona *yum* repository by running the following command
    as root or with `sudo`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: 'The installation creates a new repository file, */etc/yum.repos.d/percona-original-release.repo*.
    Now, enable the Percona Server 8.0 repository using this command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: Install Percona Server 8.0
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To install the server, execute this command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: Initialize Percona Server 8.0 with systemctl
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Once you’ve installed the Percona Server 8.0 binaries, start the service:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: 'And validate its status:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE33]'
  prefs: []
  type: TYPE_PRE
- en: At this point, the steps are similar to the vanilla installation. Refer to the
    sections on obtaining the temporary password and executing the `mysql_secure_installation`
    command in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL 5.7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Install MySQL 5.7 on CentOS 7 using the following steps.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Install the MySQL 5.7 repository
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'You can install the MySQL 5.7 *yum* repository by running the following command
    as root or with `sudo`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  prefs: []
  type: TYPE_PRE
- en: The installation creates a new repository file, */etc/yum.repos.d/mysql-community.repo*.
  prefs: []
  type: TYPE_NORMAL
- en: Install the MySQL 5.7 binaries
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To install the server, execute this command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE35]'
  prefs: []
  type: TYPE_PRE
- en: Initialize MySQL 5.7 with systemctl
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Once you’ve installed the MySQL 5.7 binaries, start the service:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE36]'
  prefs: []
  type: TYPE_PRE
- en: 'And run this command to validate its status:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE37]'
  prefs: []
  type: TYPE_PRE
- en: At this point, the steps are similar to the MySQL 8.0 vanilla installation.
    Refer to the sections on obtaining the temporary password and executing the `mysql_secure_installation`
    command in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Installing Percona Server 5.7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Install Percona Server 5.7 on CentOS 7 using the following steps.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Install the Percona repository
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'You can install the Percona *yum* repository by running the following command
    as root or with `sudo`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE38]'
  prefs: []
  type: TYPE_PRE
- en: 'The installation creates a new repository file, */etc/yum.repos.d/percona-original-release.repo*.
    Use this command to enable the Percona Server 5.7 repository:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE39]'
  prefs: []
  type: TYPE_PRE
- en: Install the Percona Server 5.7 binaries
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To install the server, execute this command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE40]'
  prefs: []
  type: TYPE_PRE
- en: Initialize Percona Server 5.7 with systemctl
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Once you’ve installed the Percona Server 5.7 binaries, start the service:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE41]'
  prefs: []
  type: TYPE_PRE
- en: 'And validate its status:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE42]'
  prefs: []
  type: TYPE_PRE
- en: At this point, the steps are similar to the MySQL 8.0 vanilla installation.
    Refer to the sections on obtaining the temporary password and executing the `mysql_secure_installation`
    command in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL on CentOS 8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The current version of CentOS is CentOS 8, and it is built on top of RHEL 8\.
    Typically, CentOS enjoys the same ten-year support lifecycle as RHEL itself. This
    traditional support lifecycle would give CentOS 8 an end-of-life date in 2029\.
    However, in December 2020, a Red Hat announcement signaled the intention to put
    a headstone on CentOS 8’s grave much sooner—in 2021\. (Red Hat will support CentOS
    7 alongside RHEL 7 through 2024.) Current CentOS users will need to migrate either
    to RHEL itself or to the newer CentOS Stream project. Some community projects
    are arising, but at this point, the future of CentOS is uncertain.
  prefs: []
  type: TYPE_NORMAL
- en: However, we will share the installation steps here since many users are using
    RHEL 8 and Oracle Linux 8 in the industry.
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL 8.0
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The latest MySQL 8.0 version is available to install from the default AppStream
    repository using the MySQL module that the CentOS 8 and RHEL 8 systems enable
    by default. So, there is some variation from the traditional `yum` method. Let’s
    take a look at the details.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Install the MySQL 8.0 binaries
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Run the following command to install the `mysql-server` package and a number
    of its dependencies:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE43]'
  prefs: []
  type: TYPE_PRE
- en: 'When prompted, press **y** and then Enter to confirm that you want to proceed:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE44]'
  prefs: []
  type: TYPE_PRE
- en: Start MySQL
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'At this point, you’ve installed MySQL on your server, but it isn’t yet operational.
    The package you installed configures MySQL to run as a `systemd` service named
    `mysqld.service`. To start MySQL, you need to use the `systemctl` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE45]'
  prefs: []
  type: TYPE_PRE
- en: Check if the service is running
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To check if the service is running correctly, run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE46]'
  prefs: []
  type: TYPE_PRE
- en: 'If you successfully started MySQL, the output will show that the MySQL service
    is active:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE47]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE48]'
  prefs: []
  type: TYPE_PRE
- en: Secure MySQL 8.0
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: As with installing MySQL 8.0 on CentOS 7, you need to execute the `mysql_secure_installation`
    command (see the relevant section in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7)
    for details). The main difference is that there is *not* a temporary password
    for CentOS 8, so when the script requests the root password, leave it blank and
    press Enter.
  prefs: []
  type: TYPE_NORMAL
- en: Start MySQL 8.0 upon server start (optional)
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To set MySQL to start whenever the server boots up, use the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE49]'
  prefs: []
  type: TYPE_PRE
- en: Installing Percona Server 8.0
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To install Percona Server 8.0 on CentOS 8, you need to install the repository
    first. Let’s walk through the steps.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Install the Percona Server 8.0 binaries
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Run the following command to install the Percona repository:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE50]'
  prefs: []
  type: TYPE_PRE
- en: 'When prompted, press **y** and then Enter to confirm that you want to proceed:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE51]'
  prefs: []
  type: TYPE_PRE
- en: Enable the repository for Percona 8.0
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'The installation creates a new repository file in */etc/yum.repos.d/percona-original-release.repo*.
    Enable the Percona Server 8.0 repository using this command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE52]'
  prefs: []
  type: TYPE_PRE
- en: 'The command prompts you to disable the RHEL 8 module for MySQL. You can do
    this now by pressing **y**:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE53]'
  prefs: []
  type: TYPE_PRE
- en: 'Or do it manually with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE54]'
  prefs: []
  type: TYPE_PRE
- en: Install the Percona Server 8.0 binaries
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'You’re now ready to install Percona Server 8.0 on your CentOS 8/RHEL 8 server.
    To avoid being prompted again about whether you want to proceed, add the `-y`
    to the command line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE55]'
  prefs: []
  type: TYPE_PRE
- en: Start and secure Percona Server 8.0
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Now that you’ve installed the Percona Server 8.0 binaries, you can start the
    `mysqld` service and set it to start at system boot:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE56]'
  prefs: []
  type: TYPE_PRE
- en: Check the service status
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'It is important to validate that you’ve completed all the steps successfully.
    Use this command to check the status of the service:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE57]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE58]'
  prefs: []
  type: TYPE_PRE
- en: Tip
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'If you ever want to disable the option of MySQL starting up at boot, you can
    do so by running the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE59]'
  prefs: []
  type: TYPE_PRE
- en: Installing MySQL 5.7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Install MySQL 5.7 on CentOS 8 using the following steps.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Disable the MySQL default module
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Systems such as RHEL 8, Oracle Linux 8, and CentOS 8 enable the MySQL module
    by default. Unless this module is disabled, it masks packages provided by MySQL
    repositories, preventing you from installing a version different than MySQL 8.0\.
    So, use these commands to remove this default module:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE60]'
  prefs: []
  type: TYPE_PRE
- en: Configure the MySQL 5.7 repository
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'There is no MySQL repository for CentOS 8, so we’ll use the CentOS 7 repository
    instead as a reference. Create a new repository file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE61]'
  prefs: []
  type: TYPE_PRE
- en: 'And paste the following data into the file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE62]'
  prefs: []
  type: TYPE_PRE
- en: Install the MySQL 5.7 binaries
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'With the default module disabled and the repository configured, run the following
    command to install the `mysql-server` package and its dependencies:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE63]'
  prefs: []
  type: TYPE_PRE
- en: 'When prompted, press **y** and then Enter to confirm that you want to proceed:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE64]'
  prefs: []
  type: TYPE_PRE
- en: Start MySQL
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'You’ve installed the MySQL binaries on your server, but it isn’t yet operational.
    The package you installed configures MySQL to run as a `systemd` service named
    `mysqld.service`. To start MySQL, you need to use the `systemctl` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE65]'
  prefs: []
  type: TYPE_PRE
- en: Check if the service is running
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To check that the service is running correctly, run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE66]'
  prefs: []
  type: TYPE_PRE
- en: 'If you successfully started MySQL, the output will show that the MySQL service
    is active:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE67]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE68]'
  prefs: []
  type: TYPE_PRE
- en: Secure MySQL 5.7
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: At this point, the steps are similar to the MySQL 8.0 vanilla installation.
    Refer to the sections on obtaining the temporary password and executing the `mysql_secure_installation`
    command in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Start MySQL 5.7 upon server start (optional)
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To set MySQL to start whenever the server boots up, use the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE69]'
  prefs: []
  type: TYPE_PRE
- en: Installing MySQL on Ubuntu 20.04 LTS (Focal Fossa)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[Ubuntu](https://ubuntu.com) is a Linux distribution based on Debian that is
    composed mostly of free and open source software. Officially, there are three
    Ubuntu editions: Desktop, Server, and Core for IoT devices and robots. The version
    we will work with in this book is the Server version.'
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL 8.0
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: For Ubuntu, the process is slightly different since Ubuntu uses the *apt* repository.
    Let’s walk through the steps.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Configure the apt repository
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'On Ubuntu 20.04 (Focal Fossa), you can install MySQL using the *apt* package
    repository. First, ensure that your system is up-to-date:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE70]'
  prefs: []
  type: TYPE_PRE
- en: Install MySQL 8.0
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Next, install the `mysql-server` package:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE71]'
  prefs: []
  type: TYPE_PRE
- en: The `apt install` command will install MySQL but won’t prompt you to set a password
    or make any other configuration changes. Unlike the CentOS installation, Ubuntu
    initializes MySQL in *insecure mode*.
  prefs: []
  type: TYPE_NORMAL
- en: For fresh installations of MySQL, you’ll want to run the database management
    system’s (DBMS’s) included security script. This script changes some of the less
    secure default options for remote root logins and the test database. We will address
    this problem in the securing step after initializing MySQL.
  prefs: []
  type: TYPE_NORMAL
- en: Start MySQL
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'At this point, you’ve installed MySQL on your server, but it isn’t yet operational.
    To start MySQL, you need to use the `systemctl` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE72]'
  prefs: []
  type: TYPE_PRE
- en: Check if the service is running
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To check that the service is running correctly, run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE73]'
  prefs: []
  type: TYPE_PRE
- en: 'If you successfully started MySQL, the output will show that the MySQL service
    is active:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE74]'
  prefs: []
  type: TYPE_PRE
- en: Secure MySQL 8.0
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'At this point, the steps are similar to the vanilla installation on CentOS
    7 (see [“Installing MySQL 8.0”](#MYSQL8_CENTOS7)). However, MySQL 8.0 on Ubuntu
    is initialized unsecured, which means the root password is empty. To secure it,
    execute `mysql_secure_installation`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE75]'
  prefs: []
  type: TYPE_PRE
- en: This will take you through a series of prompts to make some changes to the MySQL
    installation’s security options, which are similar to those of the CentOS version
    as described earlier.
  prefs: []
  type: TYPE_NORMAL
- en: 'There is a small variance here because in Ubuntu it is possible to change the
    validation policy, which manages password strength. In this example, we are setting
    the validation policy to MEDIUM (1):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE76]'
  prefs: []
  type: TYPE_PRE
- en: Installing Percona Server 8
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Install Percona Server 8.0 on Ubuntu 20.04 LTS using the following steps.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Install the GNU Privacy Guard
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Oracle signs MySQL downloadable packages with GNU Privacy Guard (GnuPG), an
    open source alternative to the well-known Pretty Good Privacy (PGP) created by
    Phil Zimmermann. Most Linux distributions ship with GnuPG installed by default,
    but in this case you need to install it:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE77]'
  prefs: []
  type: TYPE_PRE
- en: Fetch the repository packages from the Percona website
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Next, fetch the repository packages from the Percona repository with the `wget`
    command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE78]'
  prefs: []
  type: TYPE_PRE
- en: Install the downloaded package with dpkg
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Once downloaded, install the package with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE79]'
  prefs: []
  type: TYPE_PRE
- en: You can then check the repository configured in the */etc/apt/sources.list.d/percona-original-release.list*
    file.
  prefs: []
  type: TYPE_NORMAL
- en: Enable the repository
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'The next step is enabling Percona Server 8.0 in the repository and refreshing
    it:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE80]'
  prefs: []
  type: TYPE_PRE
- en: Install the Percona Server 8.0 binaries
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Then, install the `percona-server-server` package with the `apt-get install`
    command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE81]'
  prefs: []
  type: TYPE_PRE
- en: Start MySQL
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'At this point, you’ve installed MySQL on your server, but it isn’t yet operational.
    To start MySQL, you need to use the `systemctl` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE82]'
  prefs: []
  type: TYPE_PRE
- en: Check if the service is running
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To check that the service is running correctly, run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE83]'
  prefs: []
  type: TYPE_PRE
- en: At this point, Percona Server will be running in insecure mode. Executing `mysql_secure_installation`
    will take you through a series of prompts to make some changes to your MySQL installation’s
    security options, which are identical to those described for installing vanilla
    MySQL 8.0 in the previous section.
  prefs: []
  type: TYPE_NORMAL
- en: Installing MariaDB 10.5
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Install MariaDB 10.5 on Ubuntu 20.04 LTS using the following steps.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Update the system with the apt package manager
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Ensure your system is up-to-date and install the `software-properties-common`
    package with the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE84]'
  prefs: []
  type: TYPE_PRE
- en: This package contains the common files for software properties like the D-Bus
    backend and an abstraction of the used *apt* repositories.
  prefs: []
  type: TYPE_NORMAL
- en: Import the MariaDB GPG key
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Run the following command to add the repository key to the system:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE85]'
  prefs: []
  type: TYPE_PRE
- en: Add the MariaDB repository
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'After importing the repository GPG key, you need to add the *apt* repository
    by running the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE86]'
  prefs: []
  type: TYPE_PRE
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: There are different mirrors to download the MariaDB repository. In this example,
    we use *[*http://mariadb.mirror.globo.tech*](http://mariadb.mirror.globo.tech)*.
  prefs: []
  type: TYPE_NORMAL
- en: Install the MariaDB 10.5 binaries
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'The next step is the installation of the MariaDB Server:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE87]'
  prefs: []
  type: TYPE_PRE
- en: Check if the service is running
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To check if the MariaDB service is running correctly, run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE88]'
  prefs: []
  type: TYPE_PRE
- en: At this point, MariaDB 10.5 will be running in insecure mode. Executing `mysql_secure_installation`
    will take you through a series of prompts to make some changes to your MySQL installation’s
    security options, which are identical to those described for installing vanilla
    MySQL 8.0 on Ubuntu earlier in this section.
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL 5.7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Install MySQL 5.7 on Ubuntu 20.04 LTS using the following steps.
  prefs: []
  type: TYPE_NORMAL
- en: Become root in Linux
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: First, you need to become root. See the instructions in [“Installing MySQL 8.0”](#MYSQL8_CENTOS7).
  prefs: []
  type: TYPE_NORMAL
- en: Update the system with the apt package manager
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'You can ensure your system is updated and install the `software-properties-common`
    package with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE89]'
  prefs: []
  type: TYPE_PRE
- en: Add and configure the MySQL 5.7 repository
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Add the MySQL repository by running the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE90]'
  prefs: []
  type: TYPE_PRE
- en: At the prompt, choose “ubuntu bionic” as shown in [Figure 1-1](#FIG-MYSQL-BIONIC)
    and click OK.
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0101](Images/lm2e_0101.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-1\. Choose “ubuntu bionic”
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: The next prompt shows MySQL 8.0 chosen by default ([Figure 1-2](#FIG-MYSQL-OPTION)).
    With this option selected, press Enter.
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0102](Images/lm2e_0102.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-2\. Choose the MySQL Server & Cluster option
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: For the next option, as shown in [Figure 1-3](#FIG-MYSQL57-OPTION), choose MySQL
    5.7 and click OK.
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0103](Images/lm2e_0103.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-3\. Choose the MySQL 5.7 option
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: After returning to the main screen, click OK to exit, as shown in [Figure 1-4](#FIG-MYSQL-OK).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0104](Images/lm2e_0104.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-4\. Click OK to exit
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'Next, you need to update the MySQL packages:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE91]'
  prefs: []
  type: TYPE_PRE
- en: 'Validate the Ubuntu policy to install MySQL 5.7:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE92]'
  prefs: []
  type: TYPE_PRE
- en: 'Check the output to see which MySQL 5.7 version is available:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE93]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE94]'
  prefs: []
  type: TYPE_PRE
- en: Install the MySQL 5.7 binaries
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Now that you’ve verified that the MySQL 5.7 version is available (*5.7.33-1ubuntu18.04*),
    install it:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE95]'
  prefs: []
  type: TYPE_PRE
- en: The installation process will prompt you to choose the root password, as shown
    in [Figure 1-5](#FIG-MYSQL-ROOT-PASS).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0105](Images/lm2e_0105.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-5\. Define the root password and click OK
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Check if the service is running
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'To check if the MySQL 5.7 service is running correctly, run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE96]'
  prefs: []
  type: TYPE_PRE
- en: At this point, MySQL 5.7 will have a password set for the root user. However,
    you’ll still want to run `mysql_secure_installation` to set the password policy,
    remove remote root login and anonymous users, and remove the test database. Refer
    [“Secure MySQL 8.0”](#secmysql8) for details.
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL on macOS Big Sur
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: MySQL for macOS is available in a few different forms. Since most of the time
    MySQL is installed on macOS for development purposes, we will demonstrate only
    how to install it using the native macOS installer (the *.dmg* file). Be aware
    that it is also possible to use the tarball to install MySQL on macOS.
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL 8
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: First, download the MySQL *.dmg* file from the [MySQL website](https://oreil.ly/Ea6Dk).
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: According to Oracle, macOS Catalina packages work for Big Sur.
  prefs: []
  type: TYPE_NORMAL
- en: Once downloaded, execute the package to start the install procedure, as shown
    in [Figure 1-6](#FIG-DMG-PACKAGE).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0106](Images/lm2e_0106.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-6\. MySQL 8.0.23 *.dmg* package
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Next, you need to authorize MySQL to run, as shown in [Figure 1-7](#FIG-DMG-AUTH-REQUEST).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0107](Images/lm2e_0107.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-7\. MySQL 8.0.23 authorization request
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: '[Figure 1-8](#FIG-INTRO) shows the installer’s welcome screen.'
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0108](Images/lm2e_0108.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-8\. MySQL 8.0.23 initial screen
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: '[Figure 1-9](#FIG-LICENSE) shows the license agreement. Even with open source
    software, it is necessary to agree to the license terms; otherwise, you can’t
    proceed.'
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0109](Images/lm2e_0109.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-9\. MySQL 8.0.23 license agreement
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Now you can define the location and customize the installation, as shown in
    [Figure 1-10](#FIG-INSTALL-OPTS).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0110](Images/lm2e_0110.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-10\. MySQL 8.0.23 installation customization
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: You are going to proceed with the standard installation. After clicking Install,
    you might get prompted to enter the macOS user password to run the installation
    with higher privileges, as [Figure 1-11](#FIG-MACOS-AUTH) shows.
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0111](Images/lm2e_0111.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-11\. macOS authorization request
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Once you’ve installed MySQL, the installation process will prompt you to choose
    the *password encryption*. You should use the newer authentication method (the
    default option), as shown in [Figure 1-12](#FIG-MACOS-SEC), which is safer.
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0112](Images/lm2e_0112.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-12\. MySQL 8.0.23 password encryption
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: The last step consists of creating the root password and initializing MySQL,
    as shown in [Figure 1-13](#FIG-MACOS-ROOT-PASS).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0113](Images/lm2e_0113.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-13\. MySQL 8.0.23 root password
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: You’ve now installed MySQL Server, but it is not loaded (or started) by default.
    To start, open System Preferences and search for the MySQL icon, as shown in [Figure 1-14](#FIG-MACOS-MYSQL-ICON).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0114](Images/lm2e_0114.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-14\. MySQL in System Preferences
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Click the icon to open the MySQL panel. You should see something similar to
    [Figure 1-15](#FIG-MACOS-MYSQL-START-OPT).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0115](Images/lm2e_0115.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-15\. MySQL start options
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Besides the obvious option, which is to start the MySQL process, there is a
    configuration panel (with the location of the MySQL files) and an option to reinitialize
    the database (you already initialized it during the installation). Start the MySQL
    process. You might be asked for the administrator password again.
  prefs: []
  type: TYPE_NORMAL
- en: 'With MySQL running, it is possible to validate the connection and confirm that
    MySQL Server is running correctly. You can use [MySQL Workbench](https://oreil.ly/RVWbe)
    to test this, or install the MySQL client using `brew`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE97]'
  prefs: []
  type: TYPE_PRE
- en: 'Once you’ve installed the MySQL client, you can connect with the password you
    defined in [Figure 1-13](#FIG-MACOS-ROOT-PASS). In the terminal, run the following
    command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE98]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE99]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE100]'
  prefs: []
  type: TYPE_PRE
- en: Installing MySQL on Windows 10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Oracle provides a [MySQL Installer for Windows](https://oreil.ly/N4enF) to facilitate
    the installation. Note that MySQL Installer is a 32-bit application, but it can
    install MySQL in 32-bit and 64-bit binaries. To initiate the installation process,
    you need to execute the installer file and choose the type of installation, as
    shown in [Figure 1-16](#FIG-WINDOWS-INSTALL-OPTS).
  prefs: []
  type: TYPE_NORMAL
- en: Choose the Developer Default setup type and click Next. We won’t go into detail
    on the other options because we don’t recommend using MySQL for production systems,
    mainly because the MySQL ecosystem is developed for Linux.
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0116](Images/lm2e_0116.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-16\. MySQL 8.0.23 Windows installation customization
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Next, the installer checks whether all the requirements are satisfied ([Figure 1-17](#FIG-WINDOWS-INSTALL-REQS)).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0117](Images/lm2e_0117.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-17\. Installation requirements
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Click Execute. It might be necessary to install Microsoft Visual C++ ([Figure 1-18](#FIG-WINDOWS-INSTALL-VISUALC)).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0118](Images/lm2e_0118.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-18\. Install Microsoft Visual C++ if required
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Click Next, and the installer will show the products that are ready to install
    ([Figure 1-19](#FIG-WINDOWS-INSTALL-READY)).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0119](Images/lm2e_0119.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-19\. Click Execute to install the MySQL software
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Click Execute and you will arrive at the screen where you can configure MySQL
    properties. You can use the default settings for TCP/IP and the X Protocol port,
    as shown in [Figure 1-20](#FIG-WINDOWS-INSTALL-CFG), or you can customize them
    if you like.
  prefs: []
  type: TYPE_NORMAL
- en: Next, you will choose the authentication method. Select the newer version that
    is more secure, as shown in [Figure 1-21](#FIG-WINDOWS-INSTALL-AUTH).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0120](Images/lm2e_0120.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-20\. Type and networking configuration options
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: '![lm2e 0121](Images/lm2e_0121.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-21\. Password encryption—use SHA-256 based passwords
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Next, specify the root user password and whether you want to add additional
    users to the MySQL database, as shown in [Figure 1-22](#FIG-WINDOWS-INSTALL-ADD-USER).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0122](Images/lm2e_0122.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-22\. Configuring users
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: With the users configured, define the service name and user that will run the
    service, as shown in [Figure 1-23](#FIG-WINDOWS-INSTALL-SERVICE).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0123](Images/lm2e_0123.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-23\. Configuring the service name
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: When you click Next, the installer begins configuring MySQL. Once the MySQL
    installer finishes its execution, you should see something like [Figure 1-24](#FIG-WINDOWS-INSTALL-COMPLETE).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0124](Images/lm2e_0124.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-24\. If the installation went fine, there are no errors
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Now your database server is operational. Since you selected the Developer profile,
    the installer will go through the MySQL Router installation. MySQL Router isn’t
    essential for this setup, and since we don’t recommend Windows for production,
    we’ll skip this part. We will dive into the details of the router in [“MySQL Router”](ch15.xhtml#MYSQL_ROUTER).
  prefs: []
  type: TYPE_NORMAL
- en: Now you can validate your server using [MySQL Workbench](https://oreil.ly/RVWbe),
    as shown in [Figure 1-25](#FIG-WINDOWS-WORKBENCH-INTRO). You should see a MySQL
    connection option.
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0125](Images/lm2e_0125.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-25\. The MySQL connection option in MySQL Workbench
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Double-click the connection and Workbench will prompt you to input the password,
    as shown in [Figure 1-26](#FIG-WINDOWS-WORKBENCH-PASSWORD).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0126](Images/lm2e_0126.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-26\. Enter the root password to connect
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: You can now start using MySQL in your Windows platform, as shown in [Figure 1-27](#FIG-WINDOWS-WORKBENCH-CHECKING).
  prefs: []
  type: TYPE_NORMAL
- en: '![lm2e 0127](Images/lm2e_0127.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 1-27\. You can now begin testing your environment
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: The Contents of the MySQL Directory
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'During the installation process, MySQL creates all the files that are needed
    to start the server. MySQL stores its files under a directory called the *data
    directory*. Database administrators (DBAs) commonly refer to this as the *datadir*,
    which is the name of the MySQL parameter that stores the path to this directory.
    The default location for Linux distributions is */var/lib/mysql*. You can check
    its location by running the following command in the MySQL instance:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE101]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE102]'
  prefs: []
  type: TYPE_PRE
- en: MySQL 5.7 Default Files
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The following list briefly describes the files and subdirectories typically
    found in the data directory:'
  prefs: []
  type: TYPE_NORMAL
- en: The REDO log files
  prefs: []
  type: TYPE_NORMAL
- en: MySQL creates the redo log files as *ib_logfile0* and *ib_logfile1* in the data
    directory. It writes to the redo log files in a circular fashion, so the files
    do not grow beyond their configuration size (configured by [`innodb_log_file_size`](https://oreil.ly/XRzLb)).
    As in any other relational database management system (RDBMS) that is ACID-compliant,
    the redo files are fundamental to provide data durability and the ability to recover
    from a crash scenario.
  prefs: []
  type: TYPE_NORMAL
- en: The *auto.cnf* file
  prefs: []
  type: TYPE_NORMAL
- en: MySQL 5.6 introduced the *auto.cnf* file. It has only a single `[auto]` section
    containing a single [`server_uuid`](https://oreil.ly/zXlHS) setting and value.
    The `server_uuid` creates a unique signature for the server, and the replication
    layer uses it to communicate with different servers to replicate data.
  prefs: []
  type: TYPE_NORMAL
- en: Warning
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: MySQL automatically creates the *auto.cnf* file in the data directory when initialized,
    and this file should not be changed. We explain the details in [Chapter 9](ch09.xhtml#CH9_OPTIONS_FILE).
  prefs: []
  type: TYPE_NORMAL
- en: The **.pem* files
  prefs: []
  type: TYPE_NORMAL
- en: In short, these files enable the use of encrypted connections for communication
    between a client and the MySQL server. Encrypted connections are a fundamental
    part of the network security layer to avoid unauthorized access while the data
    is in transit from the application to the MySQL server. MySQL 5.7 enables SSL
    by default and creates the certificates as well. However, it is possible to use
    certificates provided by different certificate authorities (CAs) in the market.
  prefs: []
  type: TYPE_NORMAL
- en: The *performance_schema* subdirectory
  prefs: []
  type: TYPE_NORMAL
- en: 'The MySQL Performance Schema is a feature for monitoring MySQL Server execution
    at a low level during runtime. When we can use Performance Schema to monitor a
    particular metric, we say that MySQL has instrumentation. For example, Performance
    Schema instruments can provide the number of users connected:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE103]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE104]'
  prefs: []
  type: TYPE_PRE
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'Many people are surprised to see `NULL` in the `user` column. The `NULL` value
    is used for internal threads or for a user session that failed to authenticate.
    The same applies to the `host` column in the `performance_schema.accounts` table:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE105]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE106]'
  prefs: []
  type: TYPE_PRE
- en: Although instrumentation has existed since MySQL 5.6, it was in MySQL 5.7 that
    it gained many improvements and became a fundamental part of the DBA tools to
    investigate and troubleshoot issues at the MySQL level.
  prefs: []
  type: TYPE_NORMAL
- en: The *ibtmp1* file
  prefs: []
  type: TYPE_NORMAL
- en: When the application needs to create temporary tables or MySQL needs to use
    an on-disk internal temporary table, MySQL creates them in a shared temporary
    tablespace. The default behavior is to create an auto-extending data file named
    *ibtmp1* that is slightly larger than 12 MB (its size is controlled by the [`innodb_temp_data_file_path`
    parameter](https://oreil.ly/KXDOo)).
  prefs: []
  type: TYPE_NORMAL
- en: The *ibdata1* file
  prefs: []
  type: TYPE_NORMAL
- en: The *ibdata1* file is probably the most famous file in the MySQL ecosystem.
    For MySQL 5.7 and older, it holds data for the InnoDB data dictionary, the doublewrite
    buffer, the change buffer, and the undo logs. It may also contain table and index
    data if we disable the [`innodb_file_per_table` option](https://oreil.ly/v4X1O).
    When `innodb_file_per_table` is enabled, each user table has a tablespace and
    a dedicated file. Note that it is possible to have multiple *ibdata* files in
    the MySQL data directory.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: In MySQL 8.0, some of these components were removed from *ibdata1* and allocated
    into separate files. The remaining components are the change buffer table and
    index data if tables are created in the system tablespace (by disabling the `innodb_file_per_table`).
  prefs: []
  type: TYPE_NORMAL
- en: The *mysql.sock* file
  prefs: []
  type: TYPE_NORMAL
- en: This is a Unix socket file that the server uses for communication with local
    clients. This file exists only when MySQL is running, and removing it or creating
    the file manually may lead to problems.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: A Unix socket is an interprocess communication mechanism that allows bidirectional
    data exchange between processes running on the same machine. IP sockets (mainly
    TCP/IP sockets) are a mechanism allowing communication between processes over
    the network.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can connect to MySQL Server on Linux using two methods: the TCP protocol
    or a socket. For security purposes, if the application and MySQL are on the same
    server, you can disable remote TCP connections. There are two ways to do this
    in MySQL Server: set the [`bind-address`](https://oreil.ly/PQjrf) to `127.0.0.1`
    instead of the default `*` value (which accepts TCP/IP connections from everyone),
    or modify the [`skip-networking` parameter](https://oreil.ly/s20Ta), which disables
    network connections to MySQL.'
  prefs: []
  type: TYPE_NORMAL
- en: The *mysql* subdirectory
  prefs: []
  type: TYPE_NORMAL
- en: 'The *mysql* directory corresponds to the MySQL system schema, which contains
    MySQL Server’s information as it runs. For example, it includes information on
    users and their privileges, time zone tables, and replication. You can see the
    files named according to their respective table names with the `ls` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE107]'
  prefs: []
  type: TYPE_PRE
- en: MySQL 8.0 Default Files
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'MySQL 8.0 brought a few changes in the core of the data directory structure.
    Some of these changes are related to implementing the new data dictionary, and
    others to improving database management. The following list describes the new
    files and changes:'
  prefs: []
  type: TYPE_NORMAL
- en: The *undo* tablespace files
  prefs: []
  type: TYPE_NORMAL
- en: MySQL (InnoDB) uses *undo* files to undo the transactions that need to be rolled
    back and ensure isolated transactions whenever it needs to perform a consistent
    read.
  prefs: []
  type: TYPE_NORMAL
- en: From MySQL 8.0, the undo log files were separated from the system tablespace
    (*ibdata1*) and placed in the data directory. It is also possible to set another
    location by changing the [`innodb_undo_directory` parameter](https://oreil.ly/l1bIV).
  prefs: []
  type: TYPE_NORMAL
- en: The *.dblwr* files (introduced in version 8.0.20)
  prefs: []
  type: TYPE_NORMAL
- en: 'The doublewrite buffer is responsible for writing pages flushed from the buffer
    pool to the disk before MySQL writes the pages to the datafiles. The doublewrite
    filenames have the following format: *#ib_<page_size>_<file_number>.dblwr* (for
    example, *#ib_16384_0.dblwr*, *#ib_16384_0.dblwr*). It is possible to change the
    location of these files by modifying the [`innodb_doublewrite_dir` parameter](https://oreil.ly/e0ypB).'
  prefs: []
  type: TYPE_NORMAL
- en: The *mysql.ibd* file (introduced in version 8.0)
  prefs: []
  type: TYPE_NORMAL
- en: In MySQL 5.7, dictionary tables and system tables stored data and metadata in
    the *mysql* directory inside the *datadir*. In MySQL 8.0, this is all stored in
    the *mysql.ibd* file and is protected by the InnoDB mechanisms to ensure consistency.
  prefs: []
  type: TYPE_NORMAL
- en: Using the Command-Line Interface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The *mysql* binary is a simple SQL shell with input line-editing capabilities.
    Its use is straightforward (we already used it a few times during the installation
    process). To invoke it, run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE108]'
  prefs: []
  type: TYPE_PRE
- en: 'We can extend its functionality by executing queries in it:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE109]'
  prefs: []
  type: TYPE_PRE
- en: 'And we can execute more advanced commands, piping them with other commands
    to perform more complex tasks. For example, we can extract a dump from one database,
    send it across the network, and restore it into another MySQL server in the same
    command line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE110]'
  prefs: []
  type: TYPE_PRE
- en: MySQL 8.0 introduced *MySQL Shell*, which is way more powerful than its predecessor.
    MySQL Shell supports the JavaScript, Python, and SQL languages, providing development
    and administration capabilities for MySQL Server. We’ll go into more detail about
    this in [“MySQL Shell”](ch16.xhtml#MYSQL-SHELL).
  prefs: []
  type: TYPE_NORMAL
- en: Using Docker
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: With the advent of virtualization and its popularization with cloud services,
    many platforms have emerged, including [Docker](https://www.docker.com). Born
    in 2013, Docker is a solution that offers a portable and flexible way to deploy
    software. It provides resource isolation through the use of Linux features like
    *cgroups* and *kernel namespaces*.
  prefs: []
  type: TYPE_NORMAL
- en: Docker is useful for DBAs who often need to install a specific version of MySQL,
    MariaDB, or Percona Server for MySQL to run some experiments. With Docker, it
    is possible to deploy a MySQL instance in seconds to perform some tests. Once
    you finish the tests, you can destroy the instance and release the operating system’s
    resources to other tasks. All the processes of deploying a virtual machine (VM),
    installing packages, and configuring the database are simpler when using Docker.
  prefs: []
  type: TYPE_NORMAL
- en: Installing Docker
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: An advantage of using Docker is that once the service is running, the commands
    are the same in all operating systems. The commands being the same means that
    the learning curve for using Docker is faster compared to learning different Linux
    versions such as CentOS and Ubuntu, for example.
  prefs: []
  type: TYPE_NORMAL
- en: The process for [installing Docker](https://oreil.ly/K1zGS) is, in some ways,
    similar to installing MySQL. For Windows and macOS you just install the binaries,
    and after that the service is up and running. For Linux-based operating systems
    without a graphic interface, the process requires configuring the repository.
  prefs: []
  type: TYPE_NORMAL
- en: Installing Docker on CentOS 7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The CentOS packages for Docker are, in general, older than the ones available
    to RHEL and in official Docker repositories. At the time of writing, the Docker
    version provided by regular CentOS repositories is 1.13.1, whereas the upstream
    stable version is 20.10.3\. There is no difference for the purposes of this book,
    but we always recommend using the latest version for production environments.
  prefs: []
  type: TYPE_NORMAL
- en: 'Execute the following command to install the Docker package from the default
    CentOS repository:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE111]'
  prefs: []
  type: TYPE_PRE
- en: 'If you want to install Docker from the upstream repository to ensure that you
    are using the latest release, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Install `yum-utils` to enable the `yum-config-manager` command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE112]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Use `yum-config-manager` to add the *docker-ce* repository:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE113]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Install the necessary packages:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE114]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Start the Docker service:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE115]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Enable the Docker service to auto-start after a system reboot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE116]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'To validate whether the Docker service is running, execute the `systemctl status`
    command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE117]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'To verify that Docker Engine is installed correctly, you can run the *hello-world*
    container:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE118]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Installing Docker on Ubuntu 20.04 (Focal Fossa)
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'To install the latest Docker release from the upstream repository, first remove
    any older versions of Docker (called *docker*, *docker.io*, or *docker-engine*).
    Uninstall them with this command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE119]'
  prefs: []
  type: TYPE_PRE
- en: 'With the default repository removed, you can initiate the installation process:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Make sure that Ubuntu is up-to-date with this command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE120]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Install packages to allow *apt* to use a repository over HTTPS:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE121]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, add Docker’s official GPG key:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE122]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'With the key in place, add the Docker stable repository:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE123]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, use the `apt` command to install the Docker packages:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE124]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Ubuntu will start the service for you, but you can check by running this command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE125]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'To make the Docker service auto-start when the OS reboots, use:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE126]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Check the Docker version you installed with:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE127]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'To verify that Docker Engine is installed correctly, you can run the *hello-world*
    container:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE128]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Deploying the MySQL container
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Once you have Docker Engine installed and running, the next step is deploying
    the MySQL Docker container.
  prefs: []
  type: TYPE_NORMAL
- en: Warning
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: We designed the following instructions to get a test instance running quickly
    and easily; do not use this for a production deployment!
  prefs: []
  type: TYPE_NORMAL
- en: 'To deploy the latest MySQL version with Docker, execute this command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE129]'
  prefs: []
  type: TYPE_PRE
- en: Docker Engine will launch the latest version of the MySQL instance and be remotely
    accessible from anywhere with the specified root password. Installing MySQL with
    Docker means that you do not have access to any of the tools, utilities, or standard
    libraries available in a traditional host (bare metal or VM). You’ll need to either
    deploy these tools separately or use commands shipped with the Docker image if
    you need them.
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, connect to the MySQL container using the MySQL client:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE130]'
  prefs: []
  type: TYPE_PRE
- en: Since you mapped the TCP port 3306 in the container to port 3306 on the Docker
    host with the parameter `-p 3306:3306`, you can connect to the MySQL database
    from any MySQL client (Workbench, MySQL Shell) available that can reach the host
    (hostname or IP) and that port.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s look at a few commands to manage the container.
  prefs: []
  type: TYPE_NORMAL
- en: 'To stop the MySQL Docker container, run:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE131]'
  prefs: []
  type: TYPE_PRE
- en: 'Don’t try to use `docker run` to start the container again. Instead, use this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE132]'
  prefs: []
  type: TYPE_PRE
- en: 'To investigate an issue—for example, if the container isn’t starting—access
    its logs using this command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE133]'
  prefs: []
  type: TYPE_PRE
- en: 'To remove the Docker container that you created, run:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE134]'
  prefs: []
  type: TYPE_PRE
- en: 'To check which and how many Docker containers are running in the host, use:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE135]'
  prefs: []
  type: TYPE_PRE
- en: 'It is possible to customize MySQL parametrization using command-line options
    to Docker Engine. To configure the [InnoDB buffer pool size](https://oreil.ly/1R2nJ)
    and the [flush method](https://oreil.ly/tiKl2), run the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE136]'
  prefs: []
  type: TYPE_PRE
- en: To run a MySQL version other than the latest version, first check that it is
    available in [Docker Hub](https://hub.docker.com). For example, say you want to
    run MySQL 5.7.31\. The first step is to check the [official MySQL Docker Images](https://oreil.ly/X0Uuu)
    list in Docker Hub to see if it exists.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you’ve confirmed its existence, run it with the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE137]'
  prefs: []
  type: TYPE_PRE
- en: It is possible to run multiple MySQL Docker instances at the same time, but
    a potential problem is TCP port conflicts. In the previous example, note that
    we mapped different host ports for the *mysql-5.7.31* container (3307 and 33061).
    Also, the *name* of the container needs to be unique.
  prefs: []
  type: TYPE_NORMAL
- en: Deploying MariaDB and Percona Server containers
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: You follow the same steps described in the previous section for deploying a
    MySQL container to deploy a [MariaDB](https://oreil.ly/rHGjq) or [Percona Server](https://oreil.ly/TAWtw)
    container. The main difference is that they use different Docker images and have
    their own official repositories.
  prefs: []
  type: TYPE_NORMAL
- en: 'To deploy a MariaDB container, run:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE138]'
  prefs: []
  type: TYPE_PRE
- en: 'And for Percona Server, run:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE139]'
  prefs: []
  type: TYPE_PRE
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'We are mapping different ports for MariaDB (`-p 3308:3306`) and Percona (`-p
    3309:3306`) because we are deploying all the containers in the same host:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE140]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE141]'
  prefs: []
  type: TYPE_PRE
- en: If you are deploying a single container, you can use port 3306 or any custom
    port you might want to use.
  prefs: []
  type: TYPE_NORMAL
- en: Using Sandboxes
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In software development, a *sandbox* is a testing environment that isolates
    code changes and allows experimentation and testing before deploying to production.
    DBAs primarily use sandboxes for testing new software versions, performance tests,
    and bug analysis, and the data present in MySQL is disposable.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'It is common in the context of MySQL databases to hear the terms *master* and
    *slave*. The origins of these words are clearly negative. Oracle, Percona, and
    MariaDB have therefore decided to change this terminology and instead use *source*
    and *replica*. In this book, we will use both sets of terms because you will encounter
    both of them, but be aware that these companies will implement the following terminology
    for the upcoming releases:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Old** | **New** |'
  prefs: []
  type: TYPE_TB
- en: '| master | source |'
  prefs: []
  type: TYPE_TB
- en: '| slave | replica |'
  prefs: []
  type: TYPE_TB
- en: '| blacklist | blocklist |'
  prefs: []
  type: TYPE_TB
- en: '| whitelist | allowlist |'
  prefs: []
  type: TYPE_TB
- en: In 2018, [Giuseppe Maxia](https://oreil.ly/0wLPk) introduced [DBdeployer](https://oreil.ly/lZK98),
    a tool that provides an easy and fast way to deploy MySQL and its forks. It supports
    diverse MySQL topologies such as master/slave (source/replica), master/master
    (source/source), Galera Cluster, and Group Replication.
  prefs: []
  type: TYPE_NORMAL
- en: Installing DBdeployer
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The tool is developed in the *Go* language and works with macOS and Linux (Ubuntu
    and CentOS), and standalone executables are provided. Get the latest version here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE142]'
  prefs: []
  type: TYPE_PRE
- en: 'If you have your */usr/local/bin/* directory in the `$PATH` variable, you should
    now be able to run the `dbdeployer` commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE143]'
  prefs: []
  type: TYPE_PRE
- en: Using DBdeployer
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The first step in using DBdeployer is to download the MySQL binary you want
    to run and unpack it into the directory where you store your binaries. We will
    use [*Linux - Generic* tarballs](https://oreil.ly/DoI1c) since they are compatible
    with most Linux distributions, and we will store our binaries in the */opt/mysql*
    directory:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE144]'
  prefs: []
  type: TYPE_PRE
- en: 'The `unpack` command will extract and move the files to the specified directory.
    The expected output of this operation is:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE145]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE146]'
  prefs: []
  type: TYPE_PRE
- en: 'We can now use the following command to create a new standalone MySQL sandbox
    with the newly extracted binary:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE147]'
  prefs: []
  type: TYPE_PRE
- en: 'And we can observe DBdeployer initializing MySQL:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE148]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE149]'
  prefs: []
  type: TYPE_PRE
- en: 'Confirm that MySQL is running with the `ps` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE150]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE151]'
  prefs: []
  type: TYPE_PRE
- en: 'We can now connect to MySQL using DBdeployer’s `use` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE152]'
  prefs: []
  type: TYPE_PRE
- en: 'or using the default root credentials:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE153]'
  prefs: []
  type: TYPE_PRE
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'We got the port information from the previous `ps` command. Remember that there
    are two ways to connect to MySQL: via TCP/IP or using a socket. We can also get
    the socket file location from the output of the `ps` command and connect with
    that, as shown here:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE154]'
  prefs: []
  type: TYPE_PRE
- en: 'If we want to set up a replication environment with a source/replica topology,
    we can do it with the following command line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE155]'
  prefs: []
  type: TYPE_PRE
- en: 'And we will have three `mysqld` processes running:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE156]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE157]'
  prefs: []
  type: TYPE_PRE
- en: 'Another topology that DBdeployer can configure is Group Replication. For this
    example, we will define a `base-port`. By doing this, we will order DBdeployer
    to configure our servers starting from port 49007:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE158]'
  prefs: []
  type: TYPE_PRE
- en: 'Now let’s see an example of the deployment of Galera Cluster using Percona
    XtraDB Cluster 5.7.32\. We will indicate the `base-port`, and we want our nodes
    configured with the [`log-slave-updates` option](https://oreil.ly/oMhOY):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE159]'
  prefs: []
  type: TYPE_PRE
- en: 'As we’ve seen, it is possible to customize MySQL parameters. One interesting
    option is enabling MySQL replication using [*global transaction identifiers*](https://oreil.ly/QNCBh),
    or GTIDs (we’ll discuss GTIDs in more detail in [Chapter 13](ch13.xhtml#CH13_HA)):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE160]'
  prefs: []
  type: TYPE_PRE
- en: 'Our last example shows that it is possible to deploy multiple standalone versions
    at once—here, we create five standalone instances:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE161]'
  prefs: []
  type: TYPE_PRE
- en: 'The previous examples are just a small sample of DBdeployer’s capabilities.
    The full documentation is available on [GitHub](https://oreil.ly/5ygE0). Another
    option to understand the universe of possibilities is to use `--help` in the command
    line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE162]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE163]'
  prefs: []
  type: TYPE_PRE
- en: Upgrading MySQL Server
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If the most common question to arise is about replication, the second most
    common is about how to upgrade a MySQL instance. If the procedure is not well
    tested before it’s done in production, the chances of having a problem are high.
    There are two types of upgrades that you can perform:'
  prefs: []
  type: TYPE_NORMAL
- en: A *major upgrade* in MySQL would be changing versions from 5.6 to 5.7 or 5.7
    to 8.0\. Such an upgrade is trickier and more complex than a minor upgrade because
    the changes to the architecture are more substantial. For example, a considerable
    change in MySQL 8.0 involved modifying the data dictionary, which is now transactional
    and encapsulated by InnoDB.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A *minor upgrade* would be changing from MySQL 5.7.29 to 5.7.30 or MySQL 8.0.22
    to MySQL 8.0.23\. Most of the time, you’ll need to install the new version using
    your distribution’s package manager. A minor upgrade is simpler than a major one
    because it does not involve any changes in the architecture. The modifications
    are focused on fixing bugs, improving the performance, and optimizing the code.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To start planning for an upgrade, first choose between two strategies. These
    are the recommended strategies according to the documentation and are the ones
    we use:'
  prefs: []
  type: TYPE_NORMAL
- en: In-place upgrade
  prefs: []
  type: TYPE_NORMAL
- en: This involves shutting down MySQL, replacing the old MySQL binaries or packages
    with the new ones, restarting MySQL in the existing data directory, and running
    `mysql_upgrade`.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'As of MySQL 8.0.16, the *mysql_upgrade* binary is deprecated, and the MySQL
    server itself executes its functionality (you can think of it as a “server upgrade”).
    MySQL added this change alongside the data dictionary upgrade (DD upgrade), which
    is a process to update the data dictionary table definitions. Benefits of the
    new process include:'
  prefs: []
  type: TYPE_NORMAL
- en: Faster upgrades
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Simpler process
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Better security
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Significant reduction in upgrade steps
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: More easily automated
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: No restarts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Plug and play
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Logical upgrade
  prefs: []
  type: TYPE_NORMAL
- en: This involves exporting the data in SQL format from the old MySQL version using
    a backup or export utility such as *mysqldump* or *mysqlpump*, installing the
    new MySQL version, and applying the SQL data to the new MySQL version. In other
    words, this process involves rebuilding the entire data dictionary and the user
    data. A logical upgrade usually takes longer than an in-place upgrade.
  prefs: []
  type: TYPE_NORMAL
- en: Regardless of your chosen strategy, it is essential to establish a rollback
    strategy in case something goes wrong. The rollback strategy will vary based on
    the upgrade plan you choose, and the database size and the topology present (if
    you’re using replicas or Galera Cluster, for example) will influence this decision.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are some additional points to take into consideration when planning an
    upgrade:'
  prefs: []
  type: TYPE_NORMAL
- en: Upgrading from MySQL 5.7 to 8.0 is supported. However, the upgrade is only supported
    between GA releases. For MySQL 8.0, it is required that you upgrade from a MySQL
    5.7 GA release (5.7.9 or higher). Upgrades from non-GA releases of MySQL 5.7 are
    not supported.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Upgrading to the latest release is recommended before upgrading to the next
    version. For example, upgrade to the latest MySQL 5.7 release before upgrading
    to MySQL 8.0.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Upgrades that skip versions are not supported. For example, upgrading directly
    from MySQL 5.6 to 8.0 is not supported.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Based on our experience, moving from MySQL 5.6 to MySQL 5.7 is the upgrade that
    causes the most performance issues, especially if the application is using *derived
    tables* (see [“Nested Queries in the FROM Clause”](ch05.xhtml#ADV1-SEC-NESTEDFROM)).
    MySQL 5.7 modified the [`optimizer_switch` system variable](https://oreil.ly/m0Ky3),
    enabling the [`derived_merge` setting](https://oreil.ly/JROqc) by default, and
    this can hurt query performance.
  prefs: []
  type: TYPE_NORMAL
- en: Another complicating change is that MySQL 5.7 implements network encryption
    by default (SSL). Applications that were not using SSL in MySQL 5.6 may suffer
    a substantial performance hit.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, MySQL 5.7 changed the [`sync_binlog`](https://oreil.ly/Khh3Q) default
    to synchronous mode. This mode is the safest but can harm performance due to the
    increased number of disk writes.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s go through an example of upgrading from MySQL 5.7 upstream to MySQL 8.0
    upstream using the in-place method:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Stop the MySQL service. Perform a clean shutdown using `systemctl`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE164]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Remove the old binaries:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE165]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: This process only removes the binaries and does not touch the *datadir* (see
    [“The Contents of the MySQL Directory”](#MYSQL_DIRECTORY_CONTENT)).
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Follow the regular steps for the installation process (see [“Installing MySQL
    on Linux”](#MYSQL-INSTALL-LINUX)). For example, to use MySQL 8.0 Community Version
    on CentOS 7 using `yum`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE166]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Install the new binaries:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE167]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Start the MySQL service:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE168]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We can observe in the logs that MySQL upgraded the data dictionary and that
    we’re now running MySQL 8.0.21:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE169]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE170]'
  prefs: []
  type: TYPE_PRE
- en: Note
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: We highly recommend before upgrading MySQL that you check the release notes.
    They contain a summary of the changes made and the bug fixes. Release notes are
    available for [MySQL upstream](https://oreil.ly/FcOVq), [Percona Server](https://oreil.ly/Mtt2J),
    and [MariaDB](https://oreil.ly/T8M9z).
  prefs: []
  type: TYPE_NORMAL
- en: A common question is whether it’s safe to upgrade to the latest major release.
    The answer is…it depends. As with any new product in the industry, early adopters
    tend to benefit from the new features, but they are testers as well, and they
    may discover and be affected by new bugs. When MySQL 8.0 was released, our recommendation
    was to wait for three minor releases before considering moving. The golden rule
    of this book is to test everything in advance before executing the next step.
    If you learn just that from this book, we will consider our mission accomplished.
  prefs: []
  type: TYPE_NORMAL
