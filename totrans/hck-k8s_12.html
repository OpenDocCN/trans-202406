<html><head></head><body><div id="sbo-rt-content"><section data-type="appendix" epub:type="appendix" data-pdf-bookmark="Appendix B. Resources"><div class="appendix" id="appendix-resources">
<h1><span class="label">Appendix B. </span>Resources</h1>







<section data-type="sect1" data-pdf-bookmark="General"><div class="sect1" id="idm45302806163296">
<h1>General</h1>








<section data-type="sect2" data-pdf-bookmark="References"><div class="sect2" id="idm45302806162256">
<h2>References</h2>

<ul>
<li>
<p>The official <a href="https://oreil.ly/lo9ml">Kubernetes documentation</a></p>
</li>
<li>
<p>The Kubernetes community on <a href="https://oreil.ly/wMDRF">GitHub</a></p>
</li>
</ul>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Books"><div class="sect2" id="idm45302806157568">
<h2>Books</h2>

<ul>
<li>
<p><a href="https://oreil.ly/LIf6h"><em>Container Security</em></a> by Liz Rice (O’Reilly)</p>
</li>
<li>
<p><a href="https://oreil.ly/fbCyP"><em>Kubernetes: Up and Running</em></a> by Kelsey Hightower, Brendan Burns, and Joe Beda (O’Reilly)</p>
</li>
<li>
<p><a href="https://oreil.ly/pRHof"><em>Cloud Native DevOps with Kubernetes</em></a> by John Arundel and Justin Domingus (O’Reilly)</p>
</li>
<li>
<p><a href="https://oreil.ly/54ANb"><em>Managing Kubernetes</em></a> by Brendan Burns and Craig Tracey (O’Reilly)</p>
</li>
<li>
<p><a href="https://oreil.ly/PK7jz"><em>Kubernetes Cookbook</em></a> by Sébastien Goasguen and Michael Hausenblas (O’Reilly)</p>
</li>
<li>
<p><a href="https://oreil.ly/GST5s"><em>Cybersecurity Ops with bash</em></a> by Paul Troncone and Carl Albing (O’Reilly)</p>
</li>
</ul>
</div></section>





</div></section>













<section data-type="sect1" class="less_space pagebreak-before" data-pdf-bookmark="Further Reading by Chapter"><div class="sect1" id="idm45302806146176">
<h1>Further Reading by Chapter</h1>








<section data-type="sect2" data-pdf-bookmark="Intro"><div class="sect2" id="idm45302806144752">
<h2>Intro</h2>

<p>For <a data-type="xref" href="ch01.xhtml#intro">Chapter 1</a> we suggest the following resources:</p>

<ul>
<li>
<p><a href="https://oreil.ly/CfPMy">Threat Modeling Manifesto</a></p>
</li>
<li>
<p><a href="https://oreil.ly/DGWCf"><em>Open Source Intelligence Methods and Tools: A Practical Guide to Online Intelligence</em></a> by Nihad Hassan and Rami Hijazi (Apress)</p>
</li>
<li>
<p><a href="https://oreil.ly/WzyOq"><em>The Tao of Open Source Intelligence</em></a> by Stewart Bertram (IT Governance Publishing)</p>
</li>
<li>
<p><a href="https://oreil.ly/j4oUF">“SANS SEC487: Open-Source Intelligence (OSINT) Gathering and Analysis”</a></p>
</li>
</ul>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Pods"><div class="sect2" id="idm45302806135920">
<h2>Pods</h2>

<p>For <a data-type="xref" href="ch02.xhtml#ch-pod-level-resources">Chapter 2</a> we suggest the following resources:</p>

<ul>
<li>
<p><a href="https://oreil.ly/AqYzG">Awesome Kubernetes Security</a></p>
</li>
<li>
<p><a href="https://oreil.ly/3BIq0">“My Arsenal of Cloud Native (Security) Tools”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/7VeGa">“5 Must-Have Kubernetes Security Tools”</a></p>
</li>
<li>
<p><a href="https://k8syaml.com">Kubernetes YAML Generator</a></p>
</li>
<li>
<p><a href="https://oreil.ly/YLtap">Google Cloud’s “Why Container Security Matters to Your Business”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/JdULC">A comprehensive Kubernetes FAQ </a></p>
</li>
<li>
<p><a href="https://oreil.ly/ND7cC">“Attacking Kubernetes Clusters Through Your Network Plumbing”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/5mmvf"><em>Kubernetes Volumes Guide</em></a></p>
</li>
</ul>

<p>Further, tooling relevant in this context:</p>

<ul>
<li>
<p><a href="https://oreil.ly/zwJrn">Cloud Container Attack Tool (CCAT)</a></p>
</li>
<li>
<p><a href="https://oreil.ly/8aPrg">Peirates (Kubernetes penetration testing tool)</a></p>
</li>
<li>
<p><a href="https://oreil.ly/i0TWY">Hunt for security weaknesses in Kubernetes clusters</a></p>
</li>
<li>
<p><a href="https://oreil.ly/WFRCa">A container analysis and exploitation tool for pentesters and engineers</a></p>
</li>
<li>
<p><a href="https://oreil.ly/4JSIZ">Docker Enumeration, Escalation of Privileges and Container Escapes</a></p>
</li>
<li>
<p><a href="https://oreil.ly/XqSM5">Ed is a tool used to identify and exploit accessible UNIX Domain Sockets</a></p>
</li>
<li>
<p><a href="https://oreil.ly/18562">RedNix: Hackable NixOS container</a></p>
</li>
</ul>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Supply Chains"><div class="sect2" id="idm45302806112128">
<h2>Supply Chains</h2>

<p>For <a data-type="xref" href="ch04.xhtml#ch-apps-supply-chain">Chapter 4</a> we suggest the following resources:</p>

<ul>
<li>
<p><a href="https://oreil.ly/uR6Eh">“Vulnerabilities in the Core Preliminary Report and Census II of Open Source Software”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/J2lXM">CII Best Practices Badge Program</a></p>
</li>
<li>
<p><a href="https://oreil.ly/f5UXZ">SPDX specifications</a></p>
</li>
<li>
<p><a href="https://oreil.ly/1ZIEM">OWASP Dependency Track</a></p>
</li>
<li>
<p><a href="https://oreil.ly/VWEds">A Go implementation of in-toto with certificate constraint support</a></p>
</li>
<li>
<p><a href="https://oreil.ly/wKvL5">“Supply Chain Security By Verification - Mitigating Supply Chain Attacks”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/4UHrg">“Security Considerations for Code Signing”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/9RV9p">NCSC’s “Supply chain security guidance”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/gmGRd">MITRE’s “Supply Chain Attack Framework and Attack Patterns”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/WC3Av">Microsoft Supply Chain Integrity Model (SCIM)</a></p>
</li>
</ul>

<p>Further, tooling relevant in this context:</p>

<ul>
<li>
<p><a href="https://oreil.ly/WnIIs">OWASP Packman</a></p>
</li>
<li>
<p><a href="https://oreil.ly/kO9pX">Security Scorecards</a></p>
</li>
<li>
<p><a href="https://oreil.ly/VQ0b5">Open Source Project Criticality Score (Beta)</a></p>
</li>
<li>
<p><a href="https://oreil.ly/T3nEl">OSS Review Toolkit (ORT)</a></p>
</li>
<li>
<p><a href="https://oreil.ly/mbo5X">Google Binary Authorization/SLSA</a></p>
</li>
<li>
<p><a href="https://oreil.ly/J7cbb">syft: generate Software Bill of Materials (SBOM) from container images</a></p>
</li>
<li>
<p><a href="https://oreil.ly/sYSwp">Rekor</a></p>
</li>
<li>
<p><a href="https://oreil.ly/s4dwJ">Ploigos Software Factory Operator</a></p>
</li>
<li>
<p><a href="https://in-toto.io">in-toto: A framework to secure the integrity of software supply chains</a></p>
</li>
<li>
<p><a href="https://oreil.ly/iaC05">sigstore</a></p>
</li>
</ul>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Networking"><div class="sect2" id="apx-networking">
<h2>Networking</h2>

<p>For <a data-type="xref" href="ch05.xhtml#ch-networking">Chapter 5</a> we suggest the following resources:</p>

<ul>
<li>
<p><a href="https://oreil.ly/qOm7p">“Securing Your Apps in Kubernetes with NGINX App Protect”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/H9mbx">“Kubernetes Ingress with AWS ALB Ingress Controller”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/41rMt">“Exploring Network Policies in Kubernetes”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/SxaSV">“Best Practices for Kubernetes Network Policies”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/ud2sv">“Securing Kubernetes Cluster Networking”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/9aFZD">NIST Special Publication 800-204A: “Building Secure Microservices-based Applications Using Service-Mesh Architecture”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/nBj5A">“How to Secure Containers in a Service Mesh such as Istio and Linkerd2”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/SfO22">“Istio Security: Running Microservices on Zero-Trust Networks”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/bTETs">App Mesh TLS</a></p>
</li>
</ul>

<p>Further, tooling relevant in this context:</p>

<ul>
<li>
<p><a href="https://oreil.ly/EdQxb">CNCF Falco</a></p>
</li>
<li>
<p><a href="https://oreil.ly/IlFdt">Sysdig Secure</a></p>
</li>
<li>
<p><a href="https://oreil.ly/eCOk3">NeuVector</a></p>
</li>
<li>
<p><a href="https://oreil.ly/oPamy">Snyk Container</a></p>
</li>
<li>
<p><a href="https://oreil.ly/9pd6S">Prisma Cloud</a></p>
</li>
<li>
<p><a href="https://oreil.ly/jWwva">StackRox</a></p>
</li>
<li>
<p><a href="https://oreil.ly/as2dO">Aqua Security</a></p>
</li>
<li>
<p><a href="https://oreil.ly/wha3I">AccuKnox</a></p>
</li>
</ul>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Policy"><div class="sect2" id="idm45302806055104">
<h2>Policy</h2>

<p>For <a data-type="xref" href="ch08.xhtml#ch-policy">Chapter 8</a> we suggest the following resources:</p>

<ul>
<li>
<p><a href="https://oreil.ly/5Z54y">“Effective RBAC” - Jordan Liggitt</a></p>
</li>
<li>
<p><a href="https://oreil.ly/doIvy">“Configure RBAC in your Kubernetes Cluster”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/X8uFu">“Testing Kubernetes RBAC”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/F6R13">“3 Realistic Approaches to Kubernetes RBAC”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/rwZZz">“Enforcing Policy as Code using OPA and Gatekeeper in Kubernetes”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/CLR5l">“Rego Unit Testing”</a></p>
</li>
<li>
<p><a href="https://oreil.ly/0nOcS">OPA, oso, oh no!</a></p>
</li>
<li>
<p><a href="https://oreil.ly/N0SMF">“Record AWS API calls to improve IAM Policies”</a></p>
</li>
</ul>

<p>Further, tooling relevant in this context:</p>

<ul>
<li>
<p><a href="https://oreil.ly/Z2Fsa">Krane: Kubernetes RBAC Analysis made Easy</a></p>
</li>
<li>
<p><a href="https://oreil.ly/qVeLA">audit2rbac</a></p>
</li>
<li>
<p><a href="https://oreil.ly/883g7">RBAC View</a></p>
</li>
<li>
<p><a href="https://oreil.ly/gAuBs">rback</a></p>
</li>
<li>
<p><a href="https://oreil.ly/6l7CR">Permission manager</a></p>
</li>
</ul>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Notable CVEs"><div class="sect1" id="idm45302806034144">
<h1>Notable CVEs</h1>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Unless noted, these CVEs are patched, and are here to serve only as a historical reference.</p>
</div>
<dl>
<dt>CVE-2017-1002101</dt>
<dd>
<p>Subpath volume mount mishander. Containers using subpath volume mounts with any volume type (including nonprivileged pods subject to file permissions) can access files/directories outside of the volume including the host’s filesystem.</p>
</dd>
<dt>CVE-2017-1002102</dt>
<dd>
<p>Downward API host filesystem delete. Containers using a Secret, ConfigMap, projected or downwardAPI volume can trigger deletion of arbitrary files/directories from the nodes where they are running.</p>
</dd>
<dt>CVE-2017-5638</dt>
<dd>
<p>(Non-Kubernetes) Apache Struts invalid <code>Content-Type</code> header parsing failure, allowing arbitrary code execution. The bug in the Jakarta Multipart parser registered the input as OGNL code, converted it to an executable, and moved it to the server’s temporary 
<span class="keep-together">directory.</span></p>
</dd>
<dt>CVE-2018-1002105</dt>
<dd>
<p>API server <a data-type="indexterm" data-primary="CVEs (Common Vulnerabilities and Exposures)" data-secondary="list of common" id="CVE_loc"/><a data-type="indexterm" data-primary="security" data-secondary="CVEs" data-tertiary="list of common" id="sec_CVE_loc"/>websocket TLS tunnel error mishandling. Incorrect error response handling of proxied upgrade requests in the <code>kube-apiserver</code> allowed specially crafted requests to establish a connection through the Kubernetes API server to backend servers. Subsequent arbitrary requests over the same connection transit directly to the backend authenticated with the Kubernetes API server’s TLS credentials.</p>
</dd>
<dt><a href="https://oreil.ly/4It2O">CVE-2019-16884</a></dt>
<dd>
<p><code>runc</code> hostile image AppArmor bypass. Allows AppArmor restriction bypass because <code>libcontainer/rootfs_linux.go</code> incorrectly checks mount targets, and thus a malicious Docker image can mount over a <code>/proc</code> directory.</p>
</dd>
<dt><a href="https://oreil.ly/4aaXw">CVE-2019-5736</a></dt>
<dd>
<p><code>runc</code> <em>/proc/self/exe</em>. <code>runc</code> allows attackers to overwrite the host <code>runc</code> binary (and consequently obtain host root access) by leveraging the ability to execute a command as root within one of these types of containers: (1) a new container with an attacker-controlled image, or (2) an existing container, to which the attacker previously had write access, that can be attached with docker exec. This occurs because of file-descriptor mishandling, related to <em>/proc/self/exe</em>.</p>
</dd>
<dt><a href="https://oreil.ly/79ROq">CVE-2019-11249</a></dt>
<dd>
<p><code>kubectl cp</code> <code>scp</code> reverse write. To copy files from a container Kubernetes runs <code>tar</code> inside the container to create a Tar archive, and copies it over the network where <code>kubectl</code> unpacks it on the user’s machine. If the <code>tar</code> binary in the container is malicious, it could run any code and output unexpected malicious results. An attacker could use this to write files to any path on the user’s machine when <code>kubectl cp</code> is called, limited only by the system permissions of the local user.</p>
</dd>
<dt>CVE-2018-18264</dt>
<dd>
<p>Kubernetes Dashboard before<a data-type="indexterm" data-primary="CVEs (Common Vulnerabilities and Exposures)" data-secondary="list of common" data-startref="CVE_loc" id="idm45302806006544"/><a data-type="indexterm" data-primary="security" data-secondary="CVEs" data-tertiary="list of common" data-startref="sec_CVE_loc" id="idm45302806005200"/> v1.10.1 allows attackers to bypass authentication and use Dashboard’s ServiceAccount for reading Secrets within the cluster.</p>
</dd>
<dt>CVE-2019-1002100</dt>
<dd>
<p>API Server JSON patch Denial of Service. Users that are authorized to make HTTP <code>PATCH</code> requests to the Kubernetes API Server can send a specially crafted patch of type “json-patch” (e.g., <code>kubectl patch --type json</code> or <code>"Content-Type: application/json-patch+json"</code>) that consumes excessive resources while processing.</p>
</dd>
<dt><a href="https://oreil.ly/bN0Fh">CVE-2018-1002100</a></dt>
<dd>
<p>Original <code>kubectl cp</code>. The <code>kubectl</code> cp command insecurely handles <code>tar</code> data returned from the container and can be caused to overwrite arbitrary local files.</p>
</dd>
<dt>CVE-2019-1002101</dt>
<dd>
<p>Similar to <code>CVE-2019-11249</code>, but extended in that the <code>untar</code> function can both create and follow symbolic links.</p>
</dd>
<dt>CVE-2019-11245</dt>
<dd>
<p><code>mustRunAsNonRoot: true</code> bypass. Containers for pods that do not specify an explicit <code>runAsUser</code> attempt to run as uid 0 (root) on container restart, or if the image was previously pulled to the node</p>
</dd>
<dt>CVE-2019-11247</dt>
<dd>
<p>Cluster RBAC mishandler. The Kubernetes <code>kube-apiserver</code> mistakenly allows access to a cluster-scoped custom resource if the request is made as if the resource were namespaced. Authorizations for the resource accessed in this manner are enforced using roles and role bindings within the namespace meaning that a user with access only to a resource in one namespace could create, view, update, or delete the cluster-scoped resource (according to their namespace role privileges).</p>
</dd>
<dt>CVE-2019-11248</dt>
<dd>
<p><code>kubelet</code> <em>/debug/pprof</em> information disclosure and denial of service. The debugging endpoint <em>/debug/pprof</em> is exposed over the unauthenticated <code>kubelet</code> <code>healthz healthcheck endpoint</code> port, which can potentially leak sensitive information such as internal Kubelet memory addresses and configuration or for limited denial of service.</p>
</dd>
<dt>CVE-2019-11250</dt>
<dd>
<p>Side channel information disclosure. The Kubernetes <code>client-go</code> library logs request headers at verbosity levels of 7 or higher. This can disclose credentials to unauthorized users via logs or command output. Kubernetes components (such as <code>kube-apiserver</code>) which make use of basic or bearer token authentication and run at high verbosity levels are affected.</p>
</dd>
<dt><a href="https://oreil.ly/9tLAP">CVE-2020-8558</a></dt>
<dd>
<p><code>kube-proxy</code> unexpectedly makes localhost-bound host services available on the network.</p>
</dd>
<dt>CVE-2020-14386</dt>
<dd>
<p>Integer overflow from raw packet on the “loopback” (or localhost) network interface. Removing this with <code>sysctl -w kernel.unprivileged_userns_clone=0</code> or denying <code>CAP_NET_RAW</code> protects unpatched kernels from exploitation.</p>
</dd>
<dt>CVE-2021-22555</dt>
<dd>
<p>Linux Netfilter local privilege escalation flaw. When processing <code>setsockopt IPT_SO_SET_REPLACE</code> (or <code>IP6T_SO_SET_REPLACE</code>) a local user may exploit memory corruption to gain privileges or cause a DoS via a user namespace. A kernel compiled with <code>CONFIG_USER_NS</code> and <code>CONFIG_NET_NS</code> allows an unprivileged user to elevate privileges.</p>
</dd>
<dt><a href="https://oreil.ly/srPzW">CVE-2021-25740</a> (unpatched)</dt>
<dd>
<p>Endpoint and EndpointSlice permissions allow cross-Namespace forwarding. users to send network traffic to locations they would otherwise not have access to via a confused deputy attack.</p>
</dd>
<dt>CVE-2021-31440</dt>
<dd>
<p>Incorrect bounds calculation in the Linux kernel eBPF verifier. By bypassing the verifier, this can exploit out-of-bounds kernel access to escape, and the original proof of concept set UID and GID to 0 and gained <code>CAP_SYS_MODULE</code> to load an arbitrary kernel outside the container.</p>
</dd>
<dt><a href="https://oreil.ly/irhM8">CVE-2021-25741</a></dt>
<dd>
<p>Symlink exchange can allow host filesystem access. A user may be able to create a container with subpath volume mounts to access files and directories outside of the volume, including on the host filesystem.</p>
</dd>
</dl>
</div></section>







</div></section></div></body></html>