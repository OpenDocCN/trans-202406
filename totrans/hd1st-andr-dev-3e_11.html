<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 9. Material Views: A Material World"><div class="chapter" id="material_viewscolon_a_material_world">
<h1><span class="label">Chapter 9. </span>Material Views: <em>A Material World</em></h1>
<figure class="informal"><div class="figure">
<img src="Images/f0355-01.png" alt="image" width="600" height="416"/>
<h6/>
</div></figure>
<p><strong>Most apps need a slick UI that responds to the user.</strong></p>
<p>You’ve so far learned how to use views such as <strong>text views, buttons and spinners</strong>, and applied <strong>Material themes</strong> to make sweeping changes to your app’s look and feel. But there’s so much more you can do. Here, you’ll learn how to make your UI more responsive with the <strong>coordinator layout</strong>. You’ll create <strong>toolbars</strong> that can <strong>collapse or scroll</strong> on a whim. You’ll discover <strong>exciting new views</strong> such as <strong>checkboxes</strong>, <strong>radio buttons</strong>, <strong>chips</strong>, and <strong>floating action buttons</strong>. Finally, you’ll find out how to display friendly pop-up messages using <strong>toasts</strong> and <strong>snackbars</strong>. Read on to find out more.</p>
<section data-type="sect1" data-pdf-bookmark="Material is used throughout Androidville"><div class="sect1" id="material_is_used_throughout_androidville">
<h1>Material is used throughout Androidville</h1>
<p><a data-type="indexterm" data-primary="Button element" data-seealso="FAB" id="idm46053738927296"/><a data-type="indexterm" data-primary="FAB (floating action button)" id="idm46053738926128"/><a data-type="indexterm" data-primary="Material design system" data-secondary="elements applied to" id="idm46053738925264"/><a data-type="indexterm" data-primary="pop-up messages, interactive" id="idm46053738924160"/><a data-type="indexterm" data-primary="snackbar, popup message" id="idm46053738923360"/>In the previous chapter you learned how to use toolbars, bottom navigation bars, and navigation drawers to help users navigate your app, and styled them using a theme from the Material library. As you may recall, Material is a design system that helps you build apps with a consistent look and feel across all screens.</p>
<p>Material isn’t just limited to toolbars, navigation drawers, and bottom navigation bars; it styles every view in your app, from buttons to text views.</p>
<p>Here are some more examples of components and features that use Material:</p>
<ul style="list-style-type:none;">
<li><p><span class="inlineimage"><img src="Images/star.png" alt="Images" width="17" height="17"/></span> <strong>Scrolling and collapsing toolbars</strong></p>
<p>You can make the toolbar scroll off the screen, or collapse, if the user scrolls content.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0356-01.png" alt="image" width="600" height="174"/>
<h6/>
</div></figure></li>
<li><p><span class="inlineimage"><img src="Images/star.png" alt="Images" width="17" height="17"/></span> <strong>Radio buttons, checkboxes, and chips</strong></p>
<p>These let the user choose options.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0356-02.png" alt="image" width="600" height="171"/>
<h6/>
</div></figure></li>
<li><p><span class="inlineimage"><img src="Images/star.png" alt="Images" width="17" height="17"/></span> <strong>Floating action buttons (FABs)</strong></p>
<p>FABs are special buttons that float above the main screen.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0356-03.png" alt="image" width="285" height="104"/>
<h6/>
</div></figure></li>
<li><p><span class="inlineimage"><img src="Images/star.png" alt="Images" width="17" height="17"/></span> <strong>Snackbars</strong></p>
<p>These are pop-up messages you can interact with.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0356-04.png" alt="image" width="600" height="85"/>
<h6/>
</div></figure></li>
</ul>
<p>We’re going to show you how to use these views and features by building a new app.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The Bits and Pizzas app"><div class="sect1" id="the_bits_and_pizzas_app">
<h1>The Bits and Pizzas app</h1>
<p><a data-type="indexterm" data-primary="Bits and Pizzas app" data-seealso="Material design system; view binding" id="idm46053738909552"/><a data-type="indexterm" data-primary="Material design system" data-secondary="OrderFragment" data-see="OrderFragment" id="idm46053738900016"/><a data-type="indexterm" data-primary="OrderFragment" id="idm46053738898640"/>We’re going to build a new app named Bits and Pizzas. We’re going to focus on its Create Order screen, which lets the user place an order for a pizza.</p>
<p>The screen looks like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0357-01.png" alt="image" width="600" height="529"/>
<h6/>
</div></figure>
<p>The app is comprised of an activity—<code>MainActivity</code>—that displays a fragment named <code>OrderFragment</code>. The fragment defines the Create Order screen’s appearance and functionality.</p>
<p>Let’s go through the steps we need to take to build the app.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Here’s what we’ll do"><div class="sect1" id="hereapostrophes_what_weapostrophell_do">
<h1>Here’s what we’ll do</h1>
<p>We’ll build the app by going through the following steps:</p>
<ol>
<li><p><strong>Add a toolbar that can scroll.</strong></p>
<p>We’ll create <code>OrderFragment</code>, and add a toolbar to its layout that will scroll off the screen when the user scrolls the screen up, and reappear when they scroll down.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0358-01.png" alt="image" width="375" height="195"/>
<h6/>
</div></figure></li>
<li><p><strong>Implement a collapsing toolbar.</strong></p>
<p>Once we’ve made the toolbar scroll, we’ll add an image to it, and get it to collapse and expand when the user scrolls the screen.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0358-02.png" alt="image" width="600" height="317"/>
<h6/>
</div></figure></li>
<li><p><strong>Add views.</strong></p>
<p>The user needs to be able to place a pizza order. We’ll enable this by adding radio buttons, chips, and a floating action button to <code>OrderFragment</code>’s layout.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0358-03.png" alt="image" width="487" height="211"/>
<h6/>
</div></figure></li>
<li><p><strong>Make the FAB respond to clicks.</strong></p>
<p>When the user clicks the FAB, we’ll display a pop-up message that gives details of her order.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0358-04.png" alt="image" width="600" height="130"/>
<h6/>
</div></figure></li>
</ol>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Create the Bits and Pizzas project"><div class="sect1" id="create_the_bits_and_pizzas_project">
<h1>Create the Bits and Pizzas project</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0359-01.png" alt="image" width="310" height="115"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="libraries" data-secondary="Material library" id="idm46053738873536"/><a data-type="indexterm" data-primary="Material design system" data-secondary="adding Material library" id="idm46053738872288"/>We’re going to create a new project for the Bits and Pizzas app, so you need to create one using the same steps from previous chapters. Choose the Empty Activity option, enter a name of “Bits and Pizzas” and a package name of “com.hfad.bitsandpizzas”, and accept the default save location. Make sure the language is set to Kotlin and the minimum SDK is API 21 so it will run on most Android devices.</p>
<section data-type="sect2" data-pdf-bookmark="Add a Material library dependency to the app build.gradle file"><div class="sect2" id="add_a_material_library_dependency_to_the">
<h2>Add a Material library dependency to the <u>app</u> build.gradle file</h2>
<p>In this chapter, we’re going to use themes, views, and features from the Material library, so we need to make sure that the app’s <em>build.gradle</em> file includes it as a dependency.</p>
<p>Open the file <em>BitsandPizzas/app/build.gradle</em>, and make sure that its <code>dependencies</code> section includes the following line (in bold):</p>
<figure class="informal"><div class="figure">
<img src="Images/f0359-02.png" alt="image" width="600" height="125"/>
<h6/>
</div></figure>
<p>It’s likely that Android Studio has already added this dependency to the file for you. If not, you’ll need to add it yourself, and click on the Sync Now option that appears at the top of the code editor to sync the change with the rest of your project.</p>
<p>Now that you’ve made sure that the app includes the Material library, let’s go and create <code>OrderFragment</code>.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Create OrderFragment"><div class="sect1" id="create_orderfragment">
<h1>Create OrderFragment</h1>
<p><a data-type="indexterm" data-primary="Bits and Pizzas app" data-secondary="scrolling toolbar" id="idm46053738867072"/><a data-type="indexterm" data-primary="FrameLayout" data-secondary="OrderFragment" id="idm46053738859472"/><a data-type="indexterm" data-primary="OrderFragment" id="idm46053738858496"/><a data-type="indexterm" data-primary="OrderFragment" data-secondary="creating" id="idm46053738857760"/><code>OrderFragment</code> is the Bits and Pizzas app’s main screen, and it’s what the user will use to place a pizza order.</p>
<p>To create the fragment, highlight the <em>com.hfad.bitsandpizzas</em> package in the <em>app/src/main/java</em> folder, then go to File→New→Fragment→Fragment (Blank). Name the fragment “OrderFragment” and its layout “fragment_order”, and make sure the language is set to Kotlin. Then update the code for <em>OrderFragment.kt</em> to match the code below:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0360-02.png" alt="image" width="600" height="293"/>
<h6/>
</div></figure>
<p>Then update the code in its layout file <em>fragment_order.xml</em> so that it includes a frame layout like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0360-03.png" alt="image" width="600" height="191"/>
<h6/>
</div></figure>
<p>We’ll update <code>OrderFragment</code> through the rest of this chapter. First, let’s display it in <code>MainActivity</code>’s layout.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Display OrderFragment in MainActivity’s layout"><div class="sect1" id="display_orderfragment_in_mainactivityapo">
<h1>Display OrderFragment in MainActivity’s layout</h1>
<p><a data-type="indexterm" data-primary="FragmentContainerView" data-secondary="OrderFragment display" id="idm46053738845840"/>We’ll add <code>OrderFragment</code> to <code>MainActivity</code>’s layout using a <code>FragmentContainerView</code>, specifying the name of the fragment.</p>
<p>Here’s the code to do this; open <em>activity_main.xml</em> and update its code to include the changes below:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0361-02.png" alt="image" width="600" height="256"/>
<h6/>
</div></figure>
<p>Finally, open <em>MainActivity.kt</em> and make sure that its code matches the code shown below:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0361-03.png" alt="image" width="600" height="248"/>
<h6/>
</div></figure>
<p>Now that we’ve got <code>MainActivity</code> to display <code>OrderFragment</code>, let’s find out how to make the app bar respond to scrolls.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Replace the default app bar with a toolbar"><div class="sect1" id="replace_the_default_app_bar_with-id00130">
<h1>Replace the default app bar with a toolbar</h1>
<p><a data-type="indexterm" data-primary="app bar" data-secondary="replacing with toolbar" id="idm46053738834000"/><a data-type="indexterm" data-primary="Material design system" data-secondary="replacing app bar with toolbar" id="idm46053738832704"/><a data-type="indexterm" data-primary="OrderFragment" data-secondary="adding toolbar" id="idm46053738831632"/><a data-type="indexterm" data-primary="toolbar" data-secondary="replacing app bar with" id="idm46053738830528"/>We’re going to make the Bits and Pizzas app bar respond when the user scrolls. For now, we’ll make it scroll off the screen when the user scrolls the screen up, and make it reappear when she scrolls down again.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0362-01.png" alt="image" width="488" height="260"/>
<h6/>
</div></figure>
<p>To do this, we first need to replace the default app bar with a toolbar. This is because the default app bar is fixed to the top of the screen, and can’t be made to scroll. A toolbar, however, is much more flexible.</p>
<p>To do this, we first need to change the app’s theme to one that has no app bar. Open the file <em>themes.xml</em> in the <em>app/src/main/res/values</em> folder, and update its code to include the style below in bold:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0362-02.png" alt="image" width="600" height="217"/>
<h6/>
</div></figure>
<p>If your project includes a <em>themes.xml</em> file in the <em>values-night</em> folder, you’ll need to apply the above change to this file as well.</p>
<p>Once you’ve made this change, add a toolbar to <code>FragmentOrder</code> by updating the <em>fragment_order.xml</em> code so it matches the code shown here:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0362-03.png" alt="image" width="600" height="243"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Fragments don’t have a setSupportActionBar() method"><div class="sect1" id="fragments_donapostrophet_have_a_setsuppo">
<h1>Fragments don’t have a setSupportActionBar() method</h1>
<p><a data-type="indexterm" data-primary="AppCompatActivity class" data-secondary="setSupportActionBar() method" id="idm46053738816784"/><a data-type="indexterm" data-primary="setSupportActionBar() method, toolbar" id="idm46053738815488"/>Now that we’ve added the toolbar, we need to make it behave like a proper app bar that displays the app’s name. As you learned in the previous chapter, this is done by calling the activity’s <code>setSupportActionBar()</code> method.</p>
<p>Here, we’ve added the toolbar to a fragment, and <strong>fragments don’t include a</strong> <code><strong>setSupportActionBar()</strong></code> <strong>method</strong>. To get around this, we’ll get a reference to the activity that’s displaying the fragment (using <code><strong>activity</strong></code>), cast it to an <code>AppCompatActivity</code> to reflect its type, and call its <code>setSupportActionBar()</code> method.</p>
<p>Here’s the code to do this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0363-01.png" alt="image" width="600" height="113"/>
<h6/>
</div></figure>
<p>Here’s the full code for <em>OrderFragment.kt</em>; update your code to include the changes (in bold):</p>
<figure class="informal"><div class="figure">
<img src="Images/f0363-02.png" alt="image" width="600" height="405"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="We’ve added the toolbar…now what?"><div class="sect1" id="weapostropheve_added_the_toolbarhellipno">
<h1>We’ve added the toolbar…now what?</h1>
<p><a data-type="indexterm" data-primary="OrderFragment" data-secondary="scrolling toolbar" id="idm46053738808624"/><a data-type="indexterm" data-primary="scrolling toolbar, CoordinatorLayout" id="idm46053738803328"/><a data-type="indexterm" data-primary="toolbar" data-secondary="scrolling" id="idm46053738802528"/>We’ve now added a toolbar to <code>OrderFragment</code>’s layout so that when the app runs, the toolbar is displayed at the top of the screen:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0364-02.png" alt="image" width="411" height="136"/>
<h6/>
</div></figure>
<p>If we try and scroll the screen, however, the toolbar doesn’t move. To make it respond to scrolls, we need to make a few more changes.</p>
<section data-type="sect2" data-pdf-bookmark="We want the toolbar to respond to scrolls"><div class="sect2" id="we_want_the_toolbar_to_respond_to_scroll">
<h2>We want the toolbar to respond to scrolls</h2>
<p>To make the toolbar move, we need to add more views to the fragment’s layout. The layout needs to follow the following structure:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0364-03.png" alt="image" width="600" height="340"/>
<h6/>
</div></figure>
<p>The layout needs to include three things: a <strong>coordinator layout</strong>, an <strong>app bar layout,</strong> and a <strong>nested scroll view</strong>. Together, they let the toolbar respond when the user scrolls the screen.</p>
<p>Let’s find out what each one does, starting with the coordinator layout.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The coordinator layout coordinates animations between views"><div class="sect1" id="the_coordinator_layout_coordinates_anima">
<h1>The coordinator layout coordinates animations between views</h1>
<p><a data-type="indexterm" data-primary="CoordinatorLayout" id="idm46053738789184"/><a data-type="indexterm" data-primary="views" data-secondary="CoordinatorLayout" id="idm46053738788160"/>A coordinator layout is like a souped-up frame layout that’s used to coordinate animations between different views. It can, for example, coordinate the user scrolling the layout’s main content with the toolbar moving off the screen.</p>
<p>You add a coordinator layout to your layout code like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0365-02.png" alt="image" width="599" height="232"/>
<h6/>
</div></figure>
<p>You need to include any views whose animations you want to coordinate in the coordinator layout. In the Bits and Pizzas app, for example, we want to coordinate two things: the user scrolling the layout’s main contents, and the toolbar scrolling off the screen. This means the toolbar and the screen’s main contents need to be included in the coordinator layout:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0365-03.png" alt="image" width="534" height="320"/>
<h6/>
</div></figure>
<blockquote>
<p><strong>A CoordinatorLayout allows the behavior of one view to affect the behavior of another.</strong></p>
<p><strong>The CoordinatorLayout is usually the root element of your layout.</strong></p>
</blockquote>
<p>Now that we know what the coordinator layout does, let’s move on to the app bar layout.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The app bar layout enables toolbar animation"><div class="sect1" id="the_app_bar_layout_enables_toolbar_anima">
<h1>The app bar layout enables toolbar animation</h1>
<p><a data-type="indexterm" data-primary="app bar" data-secondary="layout for toolbar animation" id="idm46053738781520"/><a data-type="indexterm" data-primary="AppBarLayout" id="idm46053738776448"/><a data-type="indexterm" data-primary="theme attribute, navigation" id="idm46053738775552"/>An app bar layout is a type of vertical linear layout that’s designed to work with app bars. It works with the coordinator layout to enable toolbar animation.</p>
<p>You add an app bar layout to your code like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0366-02.png" alt="image" width="600" height="312"/>
<h6/>
</div></figure>
<p>As you can see, the above app bar layout code includes an <code>android:theme</code> attribute like this:</p>
<pre data-type="programlisting">android:theme="@style/ThemeOverlay.MaterialComponents.Dark.ActionBar"</pre>
<p>This applies the specified style to the app bar layout and all of its views. In this example, it means that the toolbar—and anything else we add to the app bar layout—will be styled to use the Material theme’s app bar properties, including the color of its background and text.</p>
<p>Great! Now your toolbar is animated and can respond to scroll events. But that’s not the end of the story: you also need to specify how it should respond. Let’s see how this is done.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Tell the toolbar how to respond to scroll events"><div class="sect1" id="tell_the_toolbar_how_to_respond_to_scrol">
<h1>Tell the toolbar how to respond to scroll events</h1>
<p><a data-type="indexterm" data-primary="enterAlways value, layout_scrollFlags attribute" id="idm46053738768368"/><a data-type="indexterm" data-primary="events" data-secondary="toolbar response to scroll events" id="idm46053738767440"/><a data-type="indexterm" data-primary="layout_scrollFlags attribute, toolbar" id="idm46053738764960"/><a data-type="indexterm" data-primary="scroll value, layout_scrollFlags attribute" id="idm46053738764224"/>Once you’ve added an app bar layout, you tell the toolbar how to respond to scrolls by adding an app:layout_scrollFlags attribute to the toolbar and assigning a value to it. The value specifies how the toolbar should respond to scroll events.</p>
<p>In the Bits and Pizzas app, we want the toolbar to scroll upward off the screen when the user scrolls up, and quickly return to its original position when the user scrolls down. We can achieve this by setting the toolbar’s <code>app:layout_scrollFlags</code> attribute to <code>"scroll|enterAlways"</code> using code like this:</p>
<blockquote>
<p><strong>The toolbar MUST be inside an app bar layout in order for it to scroll. The app bar layout and coordinator layout work together to enable scrolling.</strong></p>
</blockquote>
<figure class="informal"><div class="figure">
<img src="Images/f0367-02.png" alt="image" width="600" height="238"/>
<h6/>
</div></figure>
<p>The line:</p>
<pre data-type="programlisting">app:layout_scrollFlags="scroll|enterAlways"</pre>
<p>specifies two behaviors: <code>scroll</code> and <code>enterAlways</code>.</p>
<p>The <code>scroll</code> value means that the view can scroll off the top of the screen when the user scrolls up. Without this value, the toolbar would stay pinned to the top of the screen and wouldn’t be able to scroll.</p>
<p>The <code>enterAlways</code> value means that the toolbar quickly scrolls down to its original position when the user scrolls down. The toolbar would still scroll down without this value, but it would be much slower.</p>
<p>You’re almost there! There’s just one more step you need to do before we can get the <code>OrderFragment</code> toolbar to scroll: the <strong>nested scroll view</strong>.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="A nested scroll view makes layout content scrollable"><div class="sect1" id="a_nested_scroll_view_makes_layout_conten">
<h1>A nested scroll view makes layout content scrollable</h1>
<p><a data-type="indexterm" data-primary="layout_behavior attribute, NestedScrollView" id="idm46053738750592"/><a data-type="indexterm" data-primary="NestedScrollView" id="idm46053738749600"/><a data-type="indexterm" data-primary="views" data-secondary="NestedScrollView" id="idm46053738748768"/>You now need to add a <strong>nested scroll view</strong> so the layout’s main content can scroll. This kind of view works just like a normal scroll view, except that it enables <em>nested</em> scrolling. This is important, because the coordinator layout <em>only listens for nested scroll events</em>. If you use a normal scroll view in your layout, the toolbar won’t be able to respond when the user scrolls the screen.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Another view that enables nested scrolling is the recycler view. You’ll learn about this view in <a data-type="xref" href="ch14.xhtml#room_databasescolon_room_with_a_view">Chapter 14</a>.</span></p>
</div>
<p>You add a nested scroll view to your layout using code like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0368-02.png" alt="image" width="600" height="357"/>
<h6/>
</div></figure>
<p>In the above example, the nested scroll view includes an extra attribute named <code>app:layout_behavior</code>, which is set to the built-in <code>String</code> value <code>"@string/appbar_scrolling_view_behavior"</code>. This makes sure that the contents of the nested scroll view are arranged below the app bar layout, and move when it scrolls.</p>
<p>Note that <strong>a nested scroll view can only have one direct child</strong>, which, in the example above, is a text view. If you want to add more than one view to a nested scroll view, you must first add them to a view group—such as a linear layout—and then add the view group to the nested scroll view.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">You’ll see an example of this later in the chapter.</span></p>
</div>
<p>That’s everything that we need to know in order to get the Bits and Pizzas toolbar to scroll, so let’s go ahead and update <code>OrderFragment</code>’s layout.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The full code for fragment_order.xml"><div class="sect1" id="the_full_code_for_fragmentunderscoreorde">
<h1>The full code for fragment_order.xml</h1>
<p>Here’s the full code for <em>fragment_order.xml</em>; update the code to include the changes below (in bold):</p>
<figure class="informal"><div class="figure">
<img src="Images/f0369-02.png" alt="image" width="600" height="642"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00131">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0370-01.png" alt="image" width="310" height="115"/>
<h6/>
</div></figure>
<p>When we run the app, <code>OrderFragment</code> is displayed in <code>MainActivity</code>’s layout. A toolbar is displayed at the top of the screen.</p>
<p>When we scroll the screen up, the toolbar scrolls upward off the top of the screen.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0370-02.png" alt="image" width="600" height="171"/>
<h6/>
</div></figure>
<p>When we scroll the main content down, the toolbar reappears.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0370-03.png" alt="image" width="600" height="178"/>
<h6/>
</div></figure>
<p>Congratulations! You’ve now learned how to create a toolbar that responds to scrolls.</p>
<p>After the following exercise, we’re going to learn how to turn the scrolling toolbar into one that collapses and expands as the user scrolls the screen.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="BE the Layout"><div class="sect1" id="be_the_layout-id00132">
<h1>BE the Layout</h1>
<figure class="informal"><div class="figure">
<img src="Images/common04.png" alt="image" width="156" height="199"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="fragments" data-secondary="layouts for" id="idm46053738716704"/><a data-type="indexterm" data-primary="layouts" data-secondary="exercises" id="idm46053738715328"/><strong>Below is the layout file for a fragment named MyFragment. Your job is to play like you’re the layout, and change the code so that when the user scrolls the screen up, the toolbar scrolls off the screen, and when they scroll down, it quickly reappears.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0371-01.png" alt="image" width="600" height="557"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="BE the Layout Solution"><div class="sect1" id="be_the_layout_solution-id00133">
<h1>BE the Layout Solution</h1>
<figure class="informal"><div class="figure">
<img src="Images/common04.png" alt="image" width="156" height="199"/>
<h6/>
</div></figure>
<p><strong>Below is the layout file for a fragment named MyFragment. Your job is to play like you’re the layout, and change the code so that when the user scrolls the screen up, the toolbar scrolls off the screen, and when they scroll down, it quickly reappears.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0372-01.png" alt="image" width="600" height="570"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Let’s create a collapsing toolbar"><div class="sect1" id="letapostrophes_create_a_collapsing_toolb">
<h1>Let’s create a collapsing toolbar</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0373-01.png" alt="image" width="311" height="115"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="Bits and Pizzas app" data-secondary="collapsing toolbar" id="idm46053738702080"/><a data-type="indexterm" data-primary="CollapsingToolbarLayout" id="idm46053738700800"/><a data-type="indexterm" data-primary="OrderFragment" data-secondary="collapsing toolbar" id="idm46053738699968"/><a data-type="indexterm" data-primary="toolbar" data-secondary="collapsing" id="idm46053738698864"/>Now that you know how to make a toolbar scroll off the screen, let’s replace it with a slightly different type of toolbar: a <strong>collapsing toolbar</strong>.</p>
<p>A collapsing toolbar is a toolbar that starts off large, shrinks when the user scrolls the screen up, and expands again when the user scrolls the screen back down. You can even add an image to it, which disappears when the toolbar reaches its minimum height, and becomes visible again as the toolbar expands:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0373-02.png" alt="image" width="600" height="365"/>
<h6/>
</div></figure>
<p>Over the next few pages, we’re going to find out how to turn a simple toolbar into a collapsing toolbar by adding one to <code>OrderFragment</code>’s layout. We’ll start with a plain collapsing toolbar first, and then create one that includes an image.</p>
<p>Let’s get started.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="How to create a plain collapsing toolbar"><div class="sect1" id="how_to_create_a_plain_collapsing_toolbar">
<h1>How to create a plain collapsing toolbar</h1>
<p><a data-type="indexterm" data-primary="layout_collapseMode attribute, toolbar" id="idm46053738690176"/><a data-type="indexterm" data-primary="layout_height attribute" id="idm46053738689088"/><a data-type="indexterm" data-primary="layout_height attribute" data-secondary="collapsing toolbar" id="idm46053738688256"/><a data-type="indexterm" data-primary="layout_scrollFlags attribute, toolbar" id="idm46053738687152"/>It’s relatively straightforward to turn a scrolling toolbar into a collapsing toolbar. You simply wrap the toolbar in a <strong>collapsing toolbar layout</strong>, and tweak the toolbar attributes. The basic code structure looks like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0374-02.png" alt="image" width="600" height="342"/>
<h6/>
</div></figure>
<p>As you can see, the collapsing toolbar layout is defined using the <code>&lt;...CollapsingToolbarLayout&gt;</code> element, part of the <em>com.google.android.material</em> library. You specify its maximum height using its <code>layout_height</code> attribute, and the line:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0374-03.png" alt="image" width="600" height="56"/>
<h6/>
</div></figure>
<p>tells it to collapse when the user scrolls up until it has nothing left to collapse, and expand when the user scrolls down until it reaches its full height.</p>
<p>We also need to make sure that when the toolbar collapses, anything that’s displayed on the toolbar—like the Up button and any menu items—stay on the screen. This is achieved by adding the following attribute to the <code>Toolbar</code> element:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0374-04.png" alt="image" width="600" height="62"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="How to add an image to a collapsing toolbar"><div class="sect1" id="how_to_add_an_image_to_a_collapsing_tool">
<h1>How to add an image to a collapsing toolbar</h1>
<p><a data-type="indexterm" data-primary="contentScrim attribute, CollapsingToolbarLayout" id="idm46053738674480"/><a data-type="indexterm" data-primary="image resources" data-secondary="collapsing toolbar" id="idm46053738673488"/><a data-type="indexterm" data-primary="image resources" data-secondary="ImageView" id="idm46053738672384"/><a data-type="indexterm" data-primary="layout_collapseMode attribute, toolbar" id="idm46053738671280"/>Once you’ve created a plain collapsing toolbar, you can add an image to it by adding an &lt;<code>ImageView&gt;</code> to the collapsing toolbar layout, specifying the image you want to use. The code follows this structure:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0375-02.png" alt="image" width="600" height="399"/>
<h6/>
</div></figure>
<p>The line:</p>
<pre data-type="programlisting">app:contentScrim="?attr/colorPrimary"</pre>
<p>which has been added to the <code>&lt;...CollapsingToolbarLayout&gt;</code> gives the toolbar a plain background color when it’s collapsed. We’ve also added a parallax animation to the image using this line:</p>
<pre data-type="programlisting">app:layout_collapseMode="parallax"</pre>
<p>This attribute is optional: it makes the image scroll at a different rate to the rest of the toolbar.</p>
<p>Now that you’ve learned about collapsing toolbars, let’s add one to <code>OrderFragment</code>’s layout.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Add a restaurant image drawable"><div class="sect1" id="add_a_restaurant_image_drawable">
<h1>Add a restaurant image drawable</h1>
<p>We want <code>OrderFragment</code>’s collapsing toolbar to include a restaurant image, so let’s start by adding it to the project.</p>
<p>Make sure that your project includes a folder named <em>app/src/main/res/drawable</em>, then download the file <em>restaurant.webp</em> from <em>tinyurl.com/hfad3</em>, and add it to the <em>drawable</em> folder. This includes the image in your project as a drawable resource.</p>
<p>Next, let’s add the collapsing toolbar.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0376-02.png" alt="image" width="418" height="203"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="The full code for fragment_order.xml"><div class="sect2" id="the_full_code_for_fragmentunders-id00134">
<h2>The full code for fragment_order.xml</h2>
<p>The code below adds a collapsing toolbar to <code>OrderFragment</code>’s layout. Update your code for <em>fragment_order.xml</em> to include the changes (in bold):</p>
<figure class="informal"><div class="figure">
<img src="Images/f0376-03.png" alt="image" width="600" height="350"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0377-02.png" alt="image" width="600" height="533"/>
<h6/>
</div></figure>
<p>Those are all the changes that we need to create the collapsing toolbar. Let’s take the app for a test drive, and see what it looks like.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00135">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0378-01.png" alt="image" width="310" height="115"/>
<h6/>
</div></figure>
<p>When we run the app, <code>OrderFragment</code> is displayed. It includes a collapsing toolbar with an image.</p>
<p>When we scroll up, the toolbar collapses, the image fades, and the toolbar’s background changes to the app’s primary color. When we scroll down, the toolbar expands, and the image reappears.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0378-02.png" alt="image" width="600" height="339"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00136">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: Is the collapsing toolbar layout a type of view group?</strong></p>
<p><strong>A:</strong> Yes. It’s actually a subclass of <code>FrameLayout</code>, so you can use any of <code>FrameLayout</code>’s attributes with it.</p>
<p><strong>Q: Do I have to write any Kotlin code to get the toolbar to collapse?</strong></p>
<p><strong>A:</strong> No, it’s all done using layout code.</p>
<p><strong>Q: You said that the coordinator layout coordinates animations between its views. Are there any alternatives?</strong></p>
<p><strong>A:</strong> Yes, there’s a newer kind of layout you can use called a motion layout. This layout is part of the constraint layout library, from version 2.0 upward.</p>
<p>You can find out more about motion layouts here:</p>
<p><em><a href="https://developer.android.com/training/constraint-layout/motionlayout">https://developer.android.com/training/constraint-layout/motionlayout</a></em></p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Layout Magnets"><div class="sect1" id="layout_magnets-id00137">
<h1>Layout Magnets</h1>
<figure class="informal"><div class="figure">
<img src="Images/common02.png" alt="image" width="86" height="144"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="layouts" data-secondary="exercises" id="idm46053738630016"/>Someone arranged some magnets on the fridge door to show how to structure a layout file that implements a collapsing toolbar with an image. Unfortunately, the magnets fell off when a large pterodactyl flew by in search of food.</p>
<p>See if you can put the magnets back in the right order.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0379-01.png" alt="image" width="600" height="284"/>
<h6/>
</div></figure>
<p><span class="inlineimage"><img src="Images/arr.png" alt="Images" width="101" height="9"/></span> <strong>Answers in <a data-type="xref" href="#layout_magnets_solution-id00147">“Layout Magnets Solution”</a>.</strong></p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="We need to build OrderFragment’s main content"><div class="sect1" id="we_need_to_build_orderfragmentapostrophe">
<h1>We need to build OrderFragment’s main content</h1>
<p>Now that we’ve added a collapsing toolbar to <code>OrderFragment</code>’s layout, we need to add some more views. These will let the user choose which type of pizza she wants to order, add any extra options such as parmesan or chili oil, and display a message when she clicks a button. The screen needs to look something like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0380-01.png" alt="image" width="600" height="504"/>
<h6/>
</div></figure>
<p>As you can see, <code>OrderFragment</code>’s layout includes some extra views that we haven’t yet learned how to use. Before we build the layout, let’s find out more about these views.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Choose a pizza type using a radio button"><div class="sect1" id="choose_a_pizza_type_using_a_radio_button">
<h1>Choose a pizza type using a radio button</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0381-01.png" alt="image" width="311" height="117"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="Bits and Pizzas app" data-secondary="radio button view" id="idm46053738613104"/><a data-type="indexterm" data-primary="Button view" data-secondary="radio buttons" id="idm46053738611808"/><a data-type="indexterm" data-primary="checkedRadioButtonId property" id="idm46053738610704"/><a data-type="indexterm" data-primary="OrderFragment" data-secondary="radio button views to make choices" id="idm46053738609904"/><a data-type="indexterm" data-primary="RadioButton" id="idm46053738608832"/><a data-type="indexterm" data-primary="RadioGroup" id="idm46053738608000"/><a data-type="indexterm" data-primary="views" data-secondary="OrderFragment’s content" id="idm46053738607168"/>The first view we’ll use is a group of <strong>radio buttons</strong> so that the user can choose which type of pizza she wants. Radio buttons let you display multiple options from which you make a single choice, so they’re a good choice for this situation.</p>
<p>You add radio buttons to a layout using two elements: <code>&lt;RadioButton&gt;</code> and <code>&lt;RadioGroup&gt;</code>. You use the <code>&lt;RadioButton&gt;</code> element to define each radio button, and you group them by putting them inside a <code>&lt;RadioGroup&gt;</code> element. Placing the radio buttons in a radio group in this way means that only a single radio button can be selected at a time.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0381-02.png" alt="image" width="275" height="233"/>
<h6/>
</div></figure>
<p>In the Bits and Pizzas app, we want to display radio buttons for the Diavolo and Funghi buttons. The code looks like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0381-03.png" alt="image" width="600" height="305"/>
<h6/>
</div></figure>
<p>Once you’ve defined the radio group and radio buttons, you can write Kotlin code to find out which radio button has been selected using the radio group’s <code>checkedRadioButtonId</code> property. Its value is the ID of the selected radio button, or -1 if no radio button has been selected:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0381-04.png" alt="image" width="600" height="187"/>
<h6/>
</div></figure>
<blockquote>
<p><strong>RadioGroup is a subclass of LinearLayout, so you can use the same attributes with a radio group as you can with a linear layout.</strong></p>
</blockquote>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Radio buttons are a type of compound button"><div class="sect1" id="radio_buttons_are_a_type_of_compound_but">
<h1>Radio buttons are a type of compound button</h1>
<p><a data-type="indexterm" data-primary="Button view" data-secondary="CompoundButton" id="idm46053738592384"/><a data-type="indexterm" data-primary="CheckBox button" id="idm46053738591088"/><a data-type="indexterm" data-primary="CompoundButton subclass" id="idm46053738590256"/><a data-type="indexterm" data-primary="isChecked property" id="idm46053738589424"/><a data-type="indexterm" data-primary="Switch button" id="idm46053738588592"/><a data-type="indexterm" data-primary="ToggleButton" id="idm46053738587760"/>Behind the scenes, radio buttons inherit from a class named <code>CompoundButton</code>: a subclass of <code>Button</code>. A compound button is a button that has two states: checked and unchecked, or on and off.</p>
<p>Android includes other types of compound button (in addition to radio buttons), such as <strong>checkboxes</strong>, <strong>switches,</strong> and <strong>toggle buttons</strong>. These views are useful if you want to offer the user yes/no choices, such as “Do you want chili oil?” or “Would you like extra parmesan?”</p>
<figure class="informal"><div class="figure">
<img src="Images/f0382-01.png" alt="image" width="417" height="339"/>
<h6/>
</div></figure>
<p>You add checkboxes, switches, and toggle buttons to your layout using code like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0382-02.png" alt="image" width="600" height="357"/>
<h6/>
</div></figure>
<p>You can then use each view’s <code>isChecked</code> property in your Kotlin code to find out if it has been selected, as in the example code here:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0382-03.png" alt="image" width="600" height="127"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="A chip is a type of flexible compound button"><div class="sect1" id="a_chip_is_a_type_of_flexible_compound_bu">
<h1>A chip is a type of flexible compound button</h1>
<p><a data-type="indexterm" data-primary="Bits and Pizzas app" data-secondary="chip buttons" id="idm46053738575168"/><a data-type="indexterm" data-primary="chip, compound button" id="idm46053738573808"/><a data-type="indexterm" data-primary="style attribute, chip" id="idm46053738572912"/>So far, you’ve seen how to use different types of compound buttons such as radio buttons, checkboxes and switches. A more flexible type of compound button is a <strong>chip</strong>. This is a material view that’s available so long as you’re using a theme from the Material library, for example <code>Theme.MaterialComponents.DayNight.NoActionBar</code>. It’s used for making yes/no choices like other types of compound button, but it has other uses too: it can also be used for user input, filtering data and performing actions.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0383-02.png" alt="image" width="294" height="190"/>
<h6/>
</div></figure>
<p>In the Bits and Pizzas app, we’re going to use chips to let the user say whether she wants extra parmesan or chili oil on her pizza.</p>
<p>You add a chip to your layout using code like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0383-03.png" alt="image" width="600" height="145"/>
<h6/>
</div></figure>
<p>The key part of the chip code is the <code>style</code> attribute, because this controls the chip’s appearance. The code:</p>
<pre data-type="programlisting">style="@style/Widget.MaterialComponents.Chip.Choice"</pre>
<p>in the above example styles the chip as a Choice so that its color changes when its selected. Other options are Entry (which lets you use chips for data input), Filter (which is used for chips that filter content), and Action (which acts like a button).</p>
<p>Here’s what the Entry, Filter, and Action chips look like:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0383-04.png" alt="image" width="600" height="123"/>
<h6/>
</div></figure>
<p>As well as adding single chips to your layout, you can group several chips together. Let’s find out how this is done.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Add multiple chips to a chip group"><div class="sect1" id="add_multiple_chips_to_a_chip_group">
<h1>Add multiple chips to a chip group</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0384-01.png" alt="image" width="310" height="115"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="chip group, compound button" id="idm46053738557968"/><a data-type="indexterm" data-primary="isChecked property" id="idm46053738557152"/>If you want your layout to include multiple chips that are grouped together, you can add them to a <strong>chip group</strong>. A chip group is a type of view group that’s designed to neatly arrange multiple chips.</p>
<p>In the Bits and Pizzas app, we want to use two chips: one for parmesan and another for chili oil. We’ll therefore group them in a chip group using code like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0384-02.png" alt="image" width="600" height="363"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Use isChecked to find out if a chip is checked"><div class="sect2" id="use_ischecked_to_find_out_if_a_chip_is_c">
<h2>Use isChecked to find out if a chip is checked</h2>
<p>Once you’ve added chips to your layout, you can find out if a chip has been selected using each chip’s <code>isChecked</code> property, just as you can with other types of compound button such as switches, toggle buttons, and checkboxes. The following code, for example, checks whether the <em>parmesan</em> chip has been selected:</p>
<pre data-type="programlisting">val parmesan = view.findViewById&lt;Chip&gt;(R.id.parmesan)
if (parmesan.isChecked) {
    //do something
}</pre>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="serious_coding-id00138">
<h5><span class="inlineimage"><img src="Images/cap.png" alt="Images" width="91" height="93"/></span> Serious Coding</h5>
<p>Chips are very flexible and have many different options. Find out more about these options here:</p>
<p><em><a href="https://material.io/develop/android/components/chips">https://material.io/develop/android/components/chips</a></em></p>
</div></aside>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="A FAB is a floating action button"><div class="sect1" id="a_fab_is_a_floating_action_button">
<h1>A FAB is a floating action button</h1>
<p><a data-type="indexterm" data-primary="Bits and Pizzas app" data-secondary="FAB (floating action button)" id="idm46053738546144"/><a data-type="indexterm" data-primary="ExtendedFloatingActionButton" id="idm46053738541552"/><a data-type="indexterm" data-primary="FAB (floating action button)" data-secondary="Bits and Pizzas app" id="idm46053738540752"/><a data-type="indexterm" data-primary="floating action button" data-see="FAB" id="idm46053738539680"/><a data-type="indexterm" data-primary="icons" id="idm46053738538576"/><a data-type="indexterm" data-primary="icons" data-secondary="floating action button" id="idm46053738537744"/><a data-type="indexterm" data-primary="layout_gravity attribute" id="idm46053738536640"/><a data-type="indexterm" data-primary="layout_gravity attribute" data-secondary="floating action button" id="idm46053738535840"/>There’s one final view we need to learn about before we can complete <code>OrderFragment</code>’s layout: a <strong>FAB</strong>.</p>
<p>A FAB—or <strong>floating action button</strong>—is a circular button that floats above the user interface. It’s used to draw attention to common or important actions, and just like a normal button, you can make a FAB respond to clicks by assigning an <code>OnClickListener</code> to it in your Kotlin code.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0385-02.png" alt="image" width="340" height="175"/>
<h6/>
</div></figure>
<p>You add a FAB to your layout using code like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0385-03.png" alt="image" width="600" height="355"/>
<h6/>
</div></figure>
<p>The above code uses the <code>layout_gravity</code> attribute to anchor a FAB to the bottom-end corner of the device screen with a margin of 16dp.</p>
<p>The line:</p>
<pre data-type="programlisting">android:src="@android:drawable/ic_menu_send"</pre>
<p>adds an icon to the FAB. In the above example, it displays one of Android’s built-in icons named <em>ic_menu_send</em>, but you can use any kind of drawable so long as it fits on the FAB.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">When you add a src attribute to a FAB, the code editor lets you browse Android’s built-in icons. If you don’t like any of them, you can find lots more here: <a href="https://material.io/resources/icons">https://material.io/resources/icons</a></span></p>
</div>
<p>You usually use a FAB inside a coordinator layout so that you can coordinate movement between the different views in your layout. Let’s look at an example.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="You can anchor a FAB to a collapsing toolbar"><div class="sect1" id="you_can_anchor_a_fab_to_a_collapsing_too">
<h1>You can anchor a FAB to a collapsing toolbar</h1>
<p><a data-type="indexterm" data-primary="CollapsingToolbarLayout" id="idm46053738520896"/><a data-type="indexterm" data-primary="layout_anchor attribute, FAB" id="idm46053738518304"/><a data-type="indexterm" data-primary="layout_anchorGravity attribute, FAB" id="idm46053738517472"/><a data-type="indexterm" data-primary="toolbar" data-secondary="collapsing" id="idm46053738516672"/>FABs are often positioned at the bottom-end corner of the screen, but you can also anchor one to another view such as a collapsing toolbar. When you do this, the FAB moves with the collapsing toolbar as it collapses and expands:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0386-02.png" alt="image" width="600" height="265"/>
<h6/>
</div></figure>
<p>The layout code for this is shown below. As you can see, it uses the FAB’s <code>app:layout_anchor</code> and <code>app:layout_anchorGravity</code> attributes to anchor the FAB to the bottom end of the collapsing toolbar:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0386-03.png" alt="image" width="600" height="223"/>
<h6/>
</div></figure>
<p>Now that you’ve learned about radio buttons, chips, FABs, and other views, let’s build the main content for <code>OrderFragment</code>’s layout.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="We need to build OrderFragment’s layout"><div class="sect1" id="we_need_to_build_orderfragmentap-id00139">
<h1>We need to build OrderFragment’s layout</h1>
<p><a data-type="indexterm" data-primary="OrderFragment" data-secondary="building layout" id="idm46053738507264"/>We need to add views to <code>OrderFragment</code>’s layout so that the user can order a pizza type, and request any extras. The layout needs to look like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0387-02.png" alt="image" width="600" height="583"/>
<h6/>
</div></figure>
<p>You’re already familiar with all the code that’s needed to create this layout, so let’s go and update <em>fragment_order.xml</em>. We’ll show you the full code over the next few pages.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The full code for fragment_order.xml"><div class="sect1" id="the_full_code_for_fragmentunders-id00140">
<h1>The full code for fragment_order.xml</h1>
<p><a data-type="indexterm" data-primary="OrderFragment" data-secondary="code for" id="idm46053738503904"/>Here’s the complete code for <code>OrderFragment</code>’s layout. Update the code for file <em>fragment_order.xml</em> so that it includes the changes below (in bold):</p>
<figure class="informal"><div class="figure">
<img src="Images/f0388-02.png" alt="image" width="600" height="646"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0389-02.png" alt="image" width="600" height="655"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0390-02.png" alt="image" width="600" height="610"/>
<h6/>
</div></figure>
<p>That’s all the layout code we need, so let’s take the app for a test drive and see what it looks like.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00141">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0391-01.png" alt="image" width="311" height="115"/>
<h6/>
</div></figure>
<p>When we run the app, <code>OrderFragment</code> is displayed in <code>MainActivity</code>. It includes a collapsing toolbar as before, but this time the main content features text views, radio buttons, chips, and a FAB.</p>
<p>When we scroll the device screen, the main content scrolls upward and the toolbar collapses. The FAB remains fixed in the bottom-end corner of the screen.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0391-02.png" alt="image" width="600" height="518"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Let’s make the FAB respond to clicks"><div class="sect1" id="letapostrophes_make_the_fab_respond_to_c">
<h1>Let’s make the FAB respond to clicks</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0392-01.png" alt="image" width="311" height="115"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="Bits and Pizzas app" data-secondary="responding to clicks" id="idm46053738481008"/><a data-type="indexterm" data-primary="click response" data-secondary="Bits and Pizzas app" id="idm46053738479728"/><a data-type="indexterm" data-primary="FAB (floating action button)" data-secondary="responding to clicks" id="idm46053738478624"/><a data-type="indexterm" data-primary="OrderFragment" data-secondary="toast pop-up to respond to click" id="idm46053738477552"/><a data-type="indexterm" data-primary="snackbar, popup message" id="idm46053738476480"/><a data-type="indexterm" data-primary="toast, popup message" id="idm46053738475648"/>We’ve now built <code>OrderFragment</code>’s layout, but when the user clicks on the FAB, nothing happens. Let’s update the fragment’s Kotlin code so that the FAB responds to clicks.</p>
<p>We’ll make the FAB do two things:</p>
<ol>
<li><p><strong>Display a message if no pizza has been chosen.</strong></p>
<p>We need the user to select which type of pizza she wants. If she clicks the FAB <em>without</em> choosing one, we’ll display a pop-up message (called a <strong>toast</strong>) telling them to choose a pizza.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0392-02.png" alt="image" width="600" height="233"/>
<h6/>
</div></figure></li>
<li><p><strong>Display their order in a separate message.</strong></p>
<p>If the user has selected a type of pizza, we’ll display a message telling them what she has ordered. We’ll use a different type of pop-up message for this called a <strong>snackbar</strong>.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">In the real world, you’d want the app to place the pizza order when the user clicks on the FAB. Here, we just want to make the FAB do something (and it’s a good excuse for teaching you about pop-up messages).</span></p>
</div>
<figure class="informal"><div class="figure">
<img src="Images/f0392-04.png" alt="image" width="600" height="232"/>
<h6/>
</div></figure></li>
</ol>
<p>Let’s begin by making the FAB respond to clicks.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Add an OnClickListener to the FAB"><div class="sect1" id="add_an_onclicklistener_to_the_fab">
<h1>Add an OnClickListener to the FAB</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0393-01.png" alt="image" width="310" height="115"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="checkedRadioButtonId property" id="idm46053738459584"/><a data-type="indexterm" data-primary="OnClickListener" data-secondary="floating action button" id="idm46053738458512"/>As we said earlier, you make a FAB respond to clicks in the same way that you make any other type of button respond to clicks: by attaching an <code>OnClickListener</code> to the FAB.</p>
<p>Here’s the code to add an <code>OnClickListener</code> to the FAB in <code>OrderFragment</code>; as you can see, it looks the same as the code you’ve used with plain old normal buttons:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0393-02.png" alt="image" width="600" height="110"/>
<h6/>
</div></figure>
<p>Next, let’s get the <code>OnClickListener</code> to display a message if the user hasn’t selected a type of pizza.</p>
<section data-type="sect2" data-pdf-bookmark="Find out if a pizza type has been selected"><div class="sect2" id="find_out_if_a_pizza_type_has_been_select">
<h2>Find out if a pizza type has been selected</h2>
<p>We can find out whether the user has selected a pizza type using the <code>checkedRadioButtonId</code> property of the <code>pizzas_group</code> radio group. The property’s value is the ID of the selected radio button if one has been selected, and -1 if the user hasn’t made a choice.</p>
<p>Here’s the code to check whether the user has clicked the FAB without choosing which type of pizza she wants:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0393-03.png" alt="image" width="600" height="175"/>
<h6/>
</div></figure>
<p>If the user hasn’t selected a type of pizza, we want to display a message in a pop-up message called a <strong>toast</strong>. Let’s find out how to do this.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="A toast is a simple pop-up message"><div class="sect1" id="a_toast_is_a_simple_pop-up_message">
<h1>A <u>toast</u> is a simple pop-up message</h1>
<p><a data-type="indexterm" data-primary="makeText method, toast" id="idm46053738444080"/><a data-type="indexterm" data-primary="OnClickListener" data-secondary="floating action button" id="idm46053738442800"/>If the user clicks on the FAB without first choosing a pizza type, we’re going to display a toast on the device screen. A toast is a simple pop-up message that gives the user information, and automatically disappears when it times out:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0394-02.png" alt="image" width="577" height="165"/>
<h6/>
</div></figure>
<p>You create a toast by calling <code>Toast.makeText()</code>. The <code>makeText</code> method takes three parameters: a <code>Context</code> (usually <code>this</code> or <code>activity</code>, depending on whether you’re calling the toast from an activity or a fragment), a <code>CharSequence!</code> that’s the message you want to display, and a duration. You then call the toast’s <code>show()</code> method to display it.</p>
<p>Here’s some example code that displays a message in a toast that appears on screen for a short duration:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0394-03.png" alt="image" width="600" height="110"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00142">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: My toasts don’t appear when I run the app in the emulator. Any ideas?</strong></p>
<p><strong>A:</strong> First, make sure you’ve called the toast’s <code>show()</code> method. Without this, the toast won’t appear.</p>
<p>If this doesn’t help, you may have encountered a known emulator issue, which means toasts don’t always pop up. Try closing the emulator, and open the AVD Manager from the Tools menu. Then select the virtual device, and choose the Wipe Data option from its list of actions.</p>
</div></aside>
<section data-type="sect2" data-pdf-bookmark="Add a toast to the FAB OnClickListener"><div class="sect2" id="add_a_toast_to_the_fab_onclicklistener">
<h2>Add a toast to the FAB OnClickListener</h2>
<p>We want to display a toast when the user clicks on the FAB without choosing a pizza type. The code to do this is shown below:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0394-04.png" alt="image" width="600" height="249"/>
<h6/>
</div></figure>
<p>That’s everything we need to do if the user hasn’t selected a pizza type. Next, let’s write the code to display their order.</p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Display the pizza order in a snackbar"><div class="sect1" id="display_the_pizza_order_in_a_snackbar">
<h1>Display the pizza order in a <u>snackbar</u></h1>
<p><a data-type="indexterm" data-primary="actions" data-secondary="snackbar" id="idm46053738422384"/><a data-type="indexterm" data-primary="LENGTH options for snackbar" id="idm46053738421408"/><a data-type="indexterm" data-primary="make() method, snackbar" id="idm46053738420560"/><a data-type="indexterm" data-primary="OrderFragment" data-secondary="snackbar" id="idm46053738419728"/><a data-type="indexterm" data-primary="setAction() method, snackbar" id="idm46053738418624"/><a data-type="indexterm" data-primary="snackbar, popup message" data-secondary="actions" id="idm46053738417824"/>If the user has chosen a pizza type, we’re going to display their order in a pop-up message called a <strong>snackbar</strong> when she clicks on the FAB. A snackbar is like a toast, except that it’s more interactive. You can swipe a snackbar away, for example, or make it do something if it’s clicked.</p>
<p>You create a snackbar by calling <code>Snackbar.make()</code>. The <code>make</code> method takes three parameters: the <code>View</code> that triggered the snackbar (in this case a FAB), a <code>CharSequence!</code> that’s the text you want to display, and a duration. You then display the snackbar by calling its <code>show()</code> method.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0395-02.png" alt="image" width="407" height="218"/>
<h6/>
</div></figure>
<p>Here’s some example snackbar code that displays a message on the screen for a short time:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0395-03.png" alt="image" width="600" height="100"/>
<h6/>
</div></figure>
<p>In the above code, we’ve used <code>LENGTH_SHORT</code> to show the snackbar for a short period of time. Other options are <code>LENGTH_LONG</code> (which shows it for a long duration) and <code>LENGTH_INDEFINITE</code> (which shows it indefinitely).</p>
<section data-type="sect2" data-pdf-bookmark="Snackbars can have actions"><div class="sect2" id="snackbars_can_have_actions">
<h2>Snackbars can have actions</h2>
<p>If you want, you can add an action to the snackbar so that the user can, say, undo an action she’s just performed. You do this by calling the snackbar’s <code>setAction()</code> method before calling <code>show()</code>. <code>setAction</code> takes two parameters: the text that should appear for the action, and a lambda that runs when the user clicks on the action.</p>
<p>Here’s an example of some snackbar code that includes an action:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0395-04.png" alt="image" width="600" height="116"/>
<h6/>
</div></figure>
<p>Snackbars are usually displayed at the bottom of the screen, but you can override this using the snackbar’s <code>setAnchorView()</code> method. This anchors the snackbar to a particular view so that the snackbar appears above it. This is useful if, for example, you want the snackbar to appear above a bottom navigation bar:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0395-05.png" alt="image" width="600" height="80"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The snackbar code for the pizza order"><div class="sect1" id="the_snackbar_code_for_the_pizza_order">
<h1>The snackbar code for the pizza order</h1>
<p>Now that you know how to create a snackbar, let’s write the code to display the user’s pizza order. We’ll show a snackbar that displays the pizza type the user has selected, along with any extras such as parmesan or chili oil.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0396-01.png" alt="image" width="407" height="140"/>
<h6/>
</div></figure>
<p>Here’s the code to display the snackbar:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0396-02.png" alt="image" width="600" height="428"/>
<h6/>
</div></figure>
<p>That’s all the Kotlin code we need for the Bits and Pizzas app. Let’s look at the full code for <em>OrderFragment.kt</em> and take the app for a test drive.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00143">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: Are toasts and snackbars types of view? Can I include them in my layouts?</strong></p>
<p><strong>A:</strong> No, they’re not views, so you can only make them appear on your screen using Kotlin code.</p>
<p><strong>Q: Can I use multiple FABs in a single layout?</strong></p>
<p><strong>A:</strong> It’s best if you don’t use more than one FAB per screen. They’re used for important actions, so if you use too many, they lose their impact.</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The full code for OrderFragment.kt"><div class="sect1" id="the_full_code_for_orderfragmentdotkt">
<h1>The full code for OrderFragment.kt</h1>
<p><a data-type="indexterm" data-primary="OrderFragment" data-secondary="code for" id="idm46053738387696"/>Here’s the full code for <em>OrderFragment.kt</em>; update the code to include the changes below (in bold):</p>
<figure class="informal"><div class="figure">
<img src="Images/f0397-02.png" alt="image" width="600" height="625"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0398-01.png" alt="image" width="600" height="330"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark=" Test Drive"><div class="sect1" id="test_drive-id00144">
<h1><span class="inlineimage"><img src="Images/car.png" alt="Images" width="119" height="58"/></span> Test Drive</h1>
<p>When we click on the FAB without selecting a pizza type, a toast is displayed asking us to choose a pizza.</p>
<p>When we select a pizza type and click on the FAB again, a snackbar appears at the bottom of the screen giving details of our order.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0398-02.png" alt="image" width="600" height="326"/>
<h6/>
</div></figure>
<p>Congratulations! You’ve now learned how to make the FAB respond to clicks by displaying a pop-up message.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Pool Puzzle"><div class="sect1" id="pool_puzzle-id00145">
<h1>Pool Puzzle</h1>
<figure class="informal"><div class="figure">
<img src="Images/common01.png" alt="image" width="148" height="160"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Pool Puzzle" id="idm46053738368944"/><a data-type="indexterm" data-primary="FAB (floating action button)" data-secondary="snackbar" id="idm46053738367760"/><a data-type="indexterm" data-primary="snackbar, popup message" data-secondary="exercises" id="idm46053738366688"/>Your <strong>goal</strong> is to complete the fragment code below so that when a FAB with an ID of <code>fab</code> is clicked, it displays a snackbar. The snackbar should include an action, “Undo”, which shows a toast when clicked. Take code snippets from the pool and place them into the blank lines in the code. You may <strong>not</strong> use the same snippet more than once, and you won’t need to use all the snippets.</p>
<pre data-type="programlisting">override fun onCreateView(
    inflater: LayoutInflater, container: ViewGroup?, savedInstanceState: Bundle?
): View? {
    val view = inflater.inflate(R.layout.fragment_order, container, false)
    val fab = view.findViewById&lt;FloatingActionButton&gt;(R.id.fab)
    fab.setOnClickListener {
        Snackbar..........(fab, "Your order has been updated",......................)
                .setAction("Undo") {
                    Toast..........(........., "Undone!",......................)
                        ..........
                }
                ..........
    }
    return view
}</pre>
<figure class="informal"><div class="figure">
<img src="Images/f0399-01.png" alt="image" width="600" height="279"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>Note: each thing from the pool can only be used once!</strong></p>
</div>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Pool Puzzle Solution"><div class="sect1" id="pool_puzzle_solution-id00146">
<h1>Pool Puzzle Solution</h1>
<figure class="informal"><div class="figure">
<img src="Images/common01.png" alt="image" width="148" height="160"/>
<h6/>
</div></figure>
<p>Your <strong>goal</strong> is to complete the fragment code below so that when a FAB with an ID of <code>fab</code> is clicked, it displays a snackbar. The snackbar should include an action, “Undo”, which shows a toast when clicked. Take code snippets from the pool and place them into the blank lines in the code. You may <strong>not</strong> use the same snippet more than once, and you won’t need to use all the snippets.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0400-01.png" alt="image" width="600" height="265"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0400-02.png" alt="image" width="600" height="267"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Layout Magnets Solution"><div class="sect1" id="layout_magnets_solution-id00147">
<h1>Layout Magnets Solution</h1>
<figure class="informal"><div class="figure">
<img src="Images/common02.png" alt="image" width="86" height="144"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="layouts" data-secondary="exercises" id="idm46053738346528"/>Someone arranged some magnets on the fridge door to show how to structure a layout file that implements a collapsing toolbar with an image. Unfortunately, the magnets fell off when a large pterodactyl flew by in search of food.</p>
<p>See if you can put the magnets back in the right order.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0401-01.png" alt="image" width="600" height="558"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Your Android Toolbox"><div class="sect1" id="your_android_toolbox-id00148">
<h1>Your Android Toolbox</h1>
<figure class="informal"><div class="figure">
<img src="Images/tools.png" alt="image" width="182" height="129"/>
<h6/>
</div></figure>
<p><strong>You’ve got <a data-type="xref" href="#material_viewscolon_a_material_world">Chapter 9</a> under your belt and now you’ve added more views and components to your toolbox.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0402-01.png" alt="image" width="233" height="210"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="bullet_points-id00149">
<h5>Bullet Points</h5>
<ul>
<li><p>Use a <code>CoordinatorLayout</code> to coordinate animations between views.</p></li>
<li><p>Animate toolbars using an <code>AppBarLayout</code>.</p></li>
<li><p>Use a <code>NestedScrollView</code> if you want views to respond to the user scrolling the device screen.</p></li>
<li><p>Use a <code>CollapsingToolbarLayout</code> to add a toolbar that collapses and grows in response to user scroll actions.</p></li>
<li><p>To define a group of radio buttons, first use <code>&lt;RadioGroup&gt;</code> to define the radio group. Then put individual radio buttons in the radio group using <code>&lt;RadioButton&gt;</code>.</p></li>
<li><p>Radio buttons, toggle buttons, switches, and checkboxes are all types of compound button. A compound button is a button that can be switched on or off.</p></li>
<li><p>A chip is a more flexible compound button that can be used for making choices, user input, filtering data and performing actions.</p></li>
<li><p>You can put multiple chips in a chip group.</p></li>
<li><p>Use a FAB (floating action button) to display common or important user actions.</p></li>
<li><p>A toast is a type of pop-up message.</p></li>
<li><p>A snackbar is another type of pop-up message that the user can interact with.</p></li>
</ul>
</div></aside>
</div></section>
</div></section></div></body></html>