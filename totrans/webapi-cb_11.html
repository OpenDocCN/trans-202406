<html><head></head><body><section data-pdf-bookmark="Chapter 11. Internationalization" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch_i18n">&#13;
<h1><span class="label">Chapter 11. </span>Internationalization</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Introduction" data-type="sect1"><div class="sect1" id="id143">&#13;
<h1>Introduction</h1>&#13;
&#13;
<p><a data-primary="Internationalization APIs" data-type="indexterm" id="ix_11-internationalization-asciidoc0"/>Modern<a data-primary="Internationalization APIs" data-secondary="basics" data-type="indexterm" id="id1033"/> browsers include a robust Internationalization API. This is a collection of APIs centered around language- or locale-specific tasks, such as:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Formatting dates and times</p>&#13;
</li>&#13;
<li>&#13;
<p>Formatting numbers</p>&#13;
</li>&#13;
<li>&#13;
<p>Currency</p>&#13;
</li>&#13;
<li>&#13;
<p>Pluralization rules</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Before this API was available, you might have had to reach for a third-party library like Moment.js (for dates and times) or Numeral.js (for numbers). However, today’s browsers support many of the same use cases, and you may not need these libraries in your app anymore.</p>&#13;
&#13;
<p><a data-primary="locale, for Internationalization API" data-type="indexterm" id="id1034"/>Most of these APIs use the concept of a <em>locale</em>, which is usually a combination of a language and a region. For example, the locale for US English is <code>en-US</code>, and the locale for Canadian English is <code>en-CA</code>. You can use them with the default locale, which is the one being used by the browser, or you can specify a particular locale to format data appropriately for your desired region.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><a data-primary="Temporal API" data-type="indexterm" id="id1035"/>There is a new JavaScript date and time API in development called Temporal. At the time of writing, this is currently an ECMAScript proposal. It may become part of the language in the near future, but for the time being this book will cover the standard Date API.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Formatting a Date" data-type="sect1"><div class="sect1" id="id533">&#13;
<h1>Formatting a Date</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id144">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="date formatting" data-type="indexterm" id="id1036"/><a data-primary="Internationalization APIs" data-secondary="date formatting" data-type="indexterm" id="id1037"/>You want to display a <code>Date</code> object in a format appropriate for the user’s locale.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id145">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="Intl.DateTimeFormat" data-type="indexterm" id="ix_11-internationalization-asciidoc1"/>Use <code>Intl.DateTimeFormat</code> to format the <code>Date</code> object to a string value. Create the format object with two arguments: the desired locale and an options object where you can specify the format style. For dates, the supported format styles are (examples shown in the <code>en-US</code> locale):</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>short</code>: 10/16/23</p>&#13;
</li>&#13;
<li>&#13;
<p><code>medium</code>: Oct 16, 2023</p>&#13;
</li>&#13;
<li>&#13;
<p><code>long</code>: October 16, 2023</p>&#13;
</li>&#13;
<li>&#13;
<p><code>full</code>: Monday, October 16, 2023</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>To get the user’s current locale, you can check the <code>navigator.language</code> property (see <a data-type="xref" href="#example11-1">Example 11-1</a>).</p>&#13;
<div data-type="example" id="example11-1">&#13;
<h5><span class="label">Example 11-1. </span>Formatting a date</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">formatter</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">DateTimeFormat</code><code class="p">(</code><code class="nx">navigator</code><code class="p">.</code><code class="nx">language</code><code class="p">,</code> <code class="p">{</code> <code class="nx">dateStyle</code><code class="o">:</code> <code class="s1">'long'</code> <code class="p">});</code>&#13;
<code class="kr">const</code> <code class="nx">formattedDate</code> <code class="o">=</code> <code class="nx">formatter</code><code class="p">.</code><code class="nx">format</code><code class="p">(</code><code class="k">new</code> <code class="nb">Date</code><code class="p">());</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id534">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>You can also include the time information from a <code>Date</code> object by specifying a <code>timeStyle</code> property in the options object along with <code>dateStyle</code> (see <a data-type="xref" href="#example11-2">Example 11-2</a>).</p>&#13;
<div data-type="example" id="example11-2">&#13;
<h5><span class="label">Example 11-2. </span>Formatting a date and time</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">formatter</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">DateTimeFormat</code><code class="p">(</code><code class="nx">navigator</code><code class="p">.</code><code class="nx">language</code><code class="p">,</code> <code class="p">{</code>&#13;
<code class="nx">dateStyle</code><code class="o">:</code> <code class="s1">'long'</code><code class="p">,</code> <code class="nx">timeStyle</code><code class="o">:</code> <code class="s1">'long'</code> <code class="p">});</code>&#13;
<code class="kr">const</code> <code class="nx">formattedDateAndTime</code> <code class="o">=</code> <code class="nx">formatter</code><code class="p">.</code><code class="nx">format</code><code class="p">(</code><code class="k">new</code> <code class="nb">Date</code><code class="p">());</code></pre></div>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Getting the Parts of a Formatted Date" data-type="sect1"><div class="sect1" id="id535">&#13;
<h1>Getting the Parts of a Formatted Date</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id300">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="date formatting" data-secondary="getting parts of a formatted date" data-type="indexterm" id="id1038"/><a data-primary="Internationalization APIs" data-secondary="getting parts of a formatted date" data-type="indexterm" id="id1039"/>You want to split a formatted date into tokens. This is useful, for example, if you want to style different parts of the formatted date differently.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id536">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the <code>formatToParts</code> method of <code>Intl.DateTimeFormat</code> to format the date and return an array of tokens (see <a data-type="xref" href="#code_formatParts">Example 11-3</a>).</p>&#13;
<div data-type="example" id="code_formatParts">&#13;
<h5><span class="label">Example 11-3. </span>Getting the parts of a formatted date</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">formatter</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">DateTimeFormat</code><code class="p">(</code><code class="nx">navigator</code><code class="p">.</code><code class="nx">language</code><code class="p">,</code>&#13;
  <code class="p">{</code> <code class="nx">dateStyle</code><code class="o">:</code> <code class="s1">'short'</code> <code class="p">});</code>&#13;
<code class="kr">const</code> <code class="nx">parts</code> <code class="o">=</code> <code class="nx">formatter</code><code class="p">.</code><code class="nx">formatToParts</code><code class="p">(</code><code class="k">new</code> <code class="nb">Date</code><code class="p">());</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id146">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>For a short date of <code>10/1/23</code>, the <code>parts</code> object shown in <a data-type="xref" href="#code_formatParts">Example 11-3</a> looks like <a data-type="xref" href="#example11-4">Example 11-4</a>.<a data-startref="ix_11-internationalization-asciidoc1" data-type="indexterm" id="id1040"/></p>&#13;
<div data-type="example" id="example11-4">&#13;
<h5><span class="label">Example 11-4. </span>The formatted date parts</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="p">[</code>&#13;
  <code class="p">{</code> <code class="nx">type</code><code class="o">:</code> <code class="s1">'month'</code><code class="p">,</code> <code class="nx">value</code><code class="o">:</code> <code class="s1">'10'</code> <code class="p">},</code>&#13;
  <code class="p">{</code> <code class="nx">type</code><code class="o">:</code> <code class="s1">'literal'</code><code class="o">:</code> <code class="nx">value</code><code class="o">:</code> <code class="s1">'/'</code> <code class="p">},</code>&#13;
  <code class="p">{</code> <code class="nx">type</code><code class="o">:</code> <code class="s1">'day'</code><code class="o">:</code> <code class="nx">value</code><code class="o">:</code> <code class="s1">'1'</code> <code class="p">},</code>&#13;
  <code class="p">{</code> <code class="nx">type</code><code class="o">:</code> <code class="s1">'literal'</code><code class="p">,</code> <code class="nx">value</code><code class="o">:</code> <code class="s1">'/'</code> <code class="p">},</code>&#13;
  <code class="p">{</code> <code class="nx">type</code><code class="o">:</code> <code class="s1">'year'</code><code class="p">,</code> <code class="nx">value</code><code class="o">:</code> <code class="s1">'23'</code> <code class="p">}</code>&#13;
<code class="p">]</code></pre></div>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Formatting a Relative Date" data-type="sect1"><div class="sect1" id="id537">&#13;
<h1>Formatting a Relative Date</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id147">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="date formatting" data-secondary="relative date formatting" data-type="indexterm" id="ix_11-internationalization-asciidoc2"/><a data-primary="Internationalization APIs" data-secondary="relative date formatting" data-type="indexterm" id="ix_11-internationalization-asciidoc3"/><a data-primary="Intl.RelativeTimeFormat" data-type="indexterm" id="ix_11-internationalization-asciidoc4"/>You want to format the difference between a given date and today in an approximate, human-readable format. For example, you want a formatted string like “2 days ago” or “in 3 months.”</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id538">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use <code>Intl.RelativeTimeFormat</code>. It has a <code>format</code> method that you call with a value offset, such as –2 (in the past) or 3 (in the future), and a unit such as “day,” “month,” etc. For example, calling <code>format(-2, <em>day</em>)</code> in the <code>en-US</code> locale results in the string “2 days ago.”</p>&#13;
&#13;
<p>This is actually a two-step process. <code>Intl.RelativeTimeFormat</code> doesn’t directly calculate this between two dates. Rather, you need to first determine the offset and the unit to pass to the <code>format</code> method. The idea is to find the largest unit that differs between the two dates.</p>&#13;
&#13;
<p>First, create a helper function that returns an object containing the offset and unit, as shown in <a data-type="xref" href="#example11-5">Example 11-5</a>.</p>&#13;
<div data-type="example" id="example11-5">&#13;
<h5><span class="label">Example 11-5. </span>Finding the offset and unit</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">getDateDifference</code><code class="p">(</code><code class="nx">fromDate</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">today</code> <code class="o">=</code> <code class="k">new</code> <code class="nb">Date</code><code class="p">();</code>&#13;
&#13;
  <code class="k">if</code> <code class="p">(</code><code class="nx">fromDate</code><code class="p">.</code><code class="nx">getFullYear</code><code class="p">()</code> <code class="o">!==</code> <code class="nx">today</code><code class="p">.</code><code class="nx">getFullYear</code><code class="p">())</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="p">{</code> <code class="nx">offset</code><code class="o">:</code> <code class="nx">fromDate</code><code class="p">.</code><code class="nx">getFullYear</code><code class="p">()</code> <code class="o">-</code> <code class="nx">today</code><code class="p">.</code><code class="nx">getFullYear</code><code class="p">(),</code> <code class="nx">unit</code><code class="o">:</code> <code class="s1">'year'</code> <code class="p">};</code>&#13;
  <code class="p">}</code> <code class="k">else</code> <code class="k">if</code> <code class="p">(</code><code class="nx">fromDate</code><code class="p">.</code><code class="nx">getMonth</code><code class="p">()</code> <code class="o">!==</code> <code class="nx">today</code><code class="p">.</code><code class="nx">getMonth</code><code class="p">())</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="p">{</code> <code class="nx">offset</code><code class="o">:</code> <code class="nx">fromDate</code><code class="p">.</code><code class="nx">getMonth</code><code class="p">()</code> <code class="o">-</code> <code class="nx">today</code><code class="p">.</code><code class="nx">getMonth</code><code class="p">(),</code> <code class="nx">unit</code><code class="o">:</code> <code class="s1">'month'</code> <code class="p">};</code>&#13;
  <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>&#13;
    <code class="c1">// You could even go more granular: down to hours, minutes, or seconds!</code>&#13;
    <code class="k">return</code> <code class="p">{</code> <code class="nx">offset</code><code class="o">:</code> <code class="nx">fromDate</code><code class="p">.</code><code class="nx">getDate</code><code class="p">()</code> <code class="o">-</code> <code class="nx">today</code><code class="p">.</code><code class="nx">getDate</code><code class="p">(),</code> <code class="nx">unit</code><code class="o">:</code> <code class="s1">'day'</code> <code class="p">};</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>This function returns an object with two properties: <code>offset</code> and <code>unit</code>, which you can pass to an <code>Intl.RelativeTimeFormat</code> (see <a data-type="xref" href="#example11-6">Example 11-6</a>).</p>&#13;
<div data-type="example" id="example11-6">&#13;
<h5><span class="label">Example 11-6. </span>Formatting the relative date</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">getRelativeDate</code><code class="p">(</code><code class="nx">fromDate</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="p">{</code> <code class="nx">offset</code><code class="p">,</code> <code class="nx">unit</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">getDateDifference</code><code class="p">(</code><code class="nx">fromDate</code><code class="p">);</code>&#13;
  <code class="kr">const</code> <code class="nx">format</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">RelativeTimeFormat</code><code class="p">();</code>&#13;
  <code class="k">return</code> <code class="nx">format</code><code class="p">.</code><code class="nx">format</code><code class="p">(</code><code class="nx">offset</code><code class="p">,</code> <code class="nx">unit</code><code class="p">);</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>Here is the expected output if you called this function with the given dates on October 7, 2023 (keep in mind that when creating <code>Date</code> objects in this way, the months start at 0, but the days start at 1):</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>October 1, 2023: <code>getRelativeDate(new Date(2023, 9, 1))</code>: “6 days ago”</p>&#13;
</li>&#13;
<li>&#13;
<p>May 2, 2023: <code>getRelativeDate(new Date(2023, 4, 2))</code>: “5 months ago”</p>&#13;
</li>&#13;
<li>&#13;
<p>June 2, 2025: <code>getRelativeDate(new Date(2025, 5, 2))</code>: “in 2 years”</p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id148">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><code>getDateDifference</code> works by comparing the year, month, and day (in that order) of the given date with today’s date, until it finds one that doesn’t match. Then it returns the difference and the name of the unit, which are passed to the <code>Intl.RelativeTimeFormat</code>.</p>&#13;
&#13;
<p>The <code>getRelativeDate</code> function doesn’t give an exact relative time in months, days, hours, minutes, and seconds. It gives an approximation of the magnitude of the time difference.</p>&#13;
&#13;
<p>Consider comparing May 2, 2023 to October 7, 2023. This is a difference of 5 months and 5 days, but <code>getRelativeDate</code> only says “5 months ago” as an approximation<a data-startref="ix_11-internationalization-asciidoc4" data-type="indexterm" id="id1041"/><a data-startref="ix_11-internationalization-asciidoc3" data-type="indexterm" id="id1042"/><a data-startref="ix_11-internationalization-asciidoc2" data-type="indexterm" id="id1043"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Formatting Numbers" data-type="sect1"><div class="sect1" id="id539">&#13;
<h1>Formatting Numbers</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id149">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Internationalization APIs" data-secondary="number formatting" data-type="indexterm" id="id1044"/><a data-primary="Intl.NumberFormat" data-type="indexterm" id="id1045"/><a data-primary="number formatting" data-type="indexterm" id="id1046"/>You want to format a number with thousands separators and decimal places in a locale-specific way.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id540">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Pass the number to an <code>Intl.NumberFormat</code>’s <code>format</code> method. This method returns a string containing the formatted number.</p>&#13;
&#13;
<p>By default, <code>Intl.NumberFormat</code> uses the default locale (assume that the default locale in <a data-type="xref" href="#example11-7">Example 11-7</a> is <code>en-US</code>).</p>&#13;
<div data-type="example" id="example11-7">&#13;
<h5><span class="label">Example 11-7. </span>Formatting a number in the default locale</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// outputs '5,200.55' for en-US</code>&#13;
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code>&#13;
  <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">NumberFormat</code><code class="p">().</code><code class="nx">format</code><code class="p">(</code><code class="mf">5200.55</code><code class="p">)</code>&#13;
<code class="p">);</code></pre></div>&#13;
&#13;
<p>You can also specify a different locale to the <code>Intl.NumberFormat</code> constructor (see <a data-type="xref" href="#example11-8">Example 11-8</a>).</p>&#13;
<div data-type="example" id="example11-8">&#13;
<h5><span class="label">Example 11-8. </span>Formatting a number in the <code>de-DE</code> locale</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// outputs '5.200,55'</code>&#13;
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code>&#13;
  <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">NumberFormat</code><code class="p">(</code><code class="s1">'de-DE'</code><code class="p">).</code><code class="nx">format</code><code class="p">(</code><code class="mf">5200.55</code><code class="p">)</code>&#13;
<code class="p">);</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id541">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><code>Intl.NumberFormat</code> applies locale-specific formatting rules to format individual numbers. You can also use it to format a range of numbers by passing two values to <code>formatRange</code>, as shown in <a data-type="xref" href="#example11-9">Example 11-9</a>.</p>&#13;
<div data-type="example" id="example11-9">&#13;
<h5><span class="label">Example 11-9. </span>Formatting a range of numbers</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// outputs '1,000-5,000' for en-US</code>&#13;
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code>&#13;
  <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">NumberFormat</code><code class="p">().</code><code class="nx">formatRange</code><code class="p">(</code><code class="mi">1000</code><code class="p">,</code> <code class="mi">5000</code><code class="p">)</code>&#13;
<code class="p">);</code></pre></div>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Rounding Decimal Places" data-type="sect1"><div class="sect1" id="id542">&#13;
<h1>Rounding Decimal Places</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id150">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="decimal places, rounding" data-type="indexterm" id="id1047"/><a data-primary="Internationalization APIs" data-secondary="rounding decimal places" data-type="indexterm" id="id1048"/><a data-primary="number formatting" data-secondary="rounding decimal places" data-type="indexterm" id="id1049"/><a data-primary="rounding, of decimal places" data-type="indexterm" id="id1050"/>You want to take a fractional number, which can have many decimal places, and round it to a set number of decimal places.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id543">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the <code>maximumFractionDigits</code> option to specify the number of digits after the decimal point. <a data-type="xref" href="#example11-10">Example 11-10</a> shows how to round numbers to up to two decimal places.</p>&#13;
<div data-type="example" id="example11-10">&#13;
<h5><span class="label">Example 11-10. </span>Rounding a number</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">roundToTwoDecimalPlaces</code><code class="p">(</code><code class="nx">number</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">format</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">NumberFormat</code><code class="p">(</code><code class="nx">navigator</code><code class="p">.</code><code class="nx">language</code><code class="p">,</code> <code class="p">{</code>&#13;
    <code class="nx">maximumFractionDigits</code><code class="o">:</code> <code class="mi">2</code>&#13;
  <code class="p">});</code>&#13;
&#13;
  <code class="k">return</code> <code class="nx">format</code><code class="p">.</code><code class="nx">format</code><code class="p">(</code><code class="nx">number</code><code class="p">);</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="c1">// prints "5.49"</code>&#13;
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">roundToTwoDecimalPlaces</code><code class="p">(</code><code class="mf">5.49125</code><code class="p">));</code>&#13;
&#13;
<code class="c1">// prints "5.5"</code>&#13;
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">roundToTwoDecimalPlaces</code><code class="p">(</code><code class="mf">5.49621</code><code class="p">));</code></pre></div>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Formatting a Price Range" data-type="sect1"><div class="sect1" id="id544">&#13;
<h1>Formatting a Price Range</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id151">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Internationalization APIs" data-secondary="price range formatting" data-type="indexterm" id="id1051"/><a data-primary="price ranges, formatting" data-type="indexterm" id="id1052"/>Given an array of prices, stored as numbers, you want to create a formatted price range that reflects the low and high prices in the array.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id545">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Determine the minimum and maximum prices, then pass the <code>style: <em>currency</em></code> option when creating an <code>Intl.NumberFormat</code>. Use this <code>Intl.NumberFormat</code> to create the range. You can also specify the currency to get the proper symbol in the output. Finally, call <code>formatRange</code> on the <code>Intl.NumberFormat</code> with the lower and upper price bounds (see <a data-type="xref" href="#code_formatPrices">Example 11-11</a>).</p>&#13;
<div data-type="example" id="code_formatPrices">&#13;
<h5><span class="label">Example 11-11. </span>Formatting a price range</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">formatPriceRange</code><code class="p">(</code><code class="nx">prices</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">format</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">NumberFormat</code><code class="p">(</code><code class="nx">navigator</code><code class="p">.</code><code class="nx">language</code><code class="p">,</code> <code class="p">{</code>&#13;
    <code class="nx">style</code><code class="o">:</code> <code class="s1">'currency'</code><code class="p">.</code>&#13;
&#13;
    <code class="c1">// The currency code is required when using style: 'currency'.</code>&#13;
    <code class="nx">currency</code><code class="o">:</code> <code class="s1">'USD'</code>&#13;
  <code class="p">});</code>&#13;
  <code class="k">return</code> <code class="nx">format</code><code class="p">.</code><code class="nx">formatRange</code><code class="p">(</code>&#13;
    <code class="c1">// Find the lowest price in the array.</code>&#13;
    <code class="nb">Math</code><code class="p">.</code><code class="nx">min</code><code class="p">(...</code><code class="nx">prices</code><code class="p">),</code>&#13;
&#13;
    <code class="c1">// Find the highest price in the array.</code>&#13;
    <code class="nb">Math</code><code class="p">.</code><code class="nx">max</code><code class="p">(...</code><code class="nx">prices</code><code class="p">)</code>&#13;
  <code class="p">);</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="c1">// outputs '$1.75—$11.00'</code>&#13;
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code>&#13;
  <code class="nx">formatPriceRange</code><code class="p">([</code><code class="mf">5.5</code><code class="p">,</code> <code class="mi">3</code><code class="p">,</code> <code class="mf">1.75</code><code class="p">,</code> <code class="mi">11</code><code class="p">,</code> <code class="mf">9.5</code><code class="p">])</code>&#13;
<code class="p">);</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id546">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The <code>Math.max</code> and <code>Math.min</code> functions take multiple arguments, and they return the maximum or minimum from the whole set of those arguments. <a data-type="xref" href="#code_formatPrices">Example 11-11</a> uses the array spread syntax to pass all elements from the <code>prices</code> array to <code>Math.max</code> and <code>Math.min</code>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Formatting Measurement Units" data-type="sect1"><div class="sect1" id="id547">&#13;
<h1>Formatting Measurement Units</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id152">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Internationalization APIs" data-secondary="measurement units formatting" data-type="indexterm" id="id1053"/><a data-primary="measurement unit formatting" data-type="indexterm" id="id1054"/><a data-primary="number formatting" data-secondary="measurement units with" data-type="indexterm" id="id1055"/>You want to format a number along with a measurement unit.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id548">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the <code>unit</code> style when creating the <code>Intl.NumberFormat</code> object, and specify the target unit. <a data-type="xref" href="#example11-12">Example 11-12</a> shows how to format a number of gigabytes.</p>&#13;
<div data-type="example" id="example11-12">&#13;
<h5><span class="label">Example 11-12. </span>Formatting gigabytes</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">format</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">NumberFormat</code><code class="p">(</code><code class="nx">navigator</code><code class="p">.</code><code class="nx">language</code><code class="p">,</code> <code class="p">{</code>&#13;
  <code class="nx">style</code><code class="o">:</code> <code class="s1">'unit'</code><code class="p">,</code>&#13;
  <code class="nx">unit</code><code class="o">:</code> <code class="s1">'gigabyte'</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="c1">// prints "1,000 GB"</code>&#13;
<code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">format</code><code class="p">.</code><code class="nx">format</code><code class="p">(</code><code class="mi">1000</code><code class="p">));</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id549">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>You can also customize the unit label, by specifying the <code>unitDisplay</code> option to the <code>NumberFormat</code>. Possible values are:</p>&#13;
<dl>&#13;
<dt><code>short</code></dt>&#13;
<dd>&#13;
<p>Shows the abbreviated unit, separated with a space: <code>1,000 GB</code></p>&#13;
</dd>&#13;
<dt><code>narrow</code></dt>&#13;
<dd>&#13;
<p>Shows the abbreviated unit, with no space: <code>1,000GB</code></p>&#13;
</dd>&#13;
<dt><code>long</code></dt>&#13;
<dd>&#13;
<p>Shows the full unit name: <code>1,000 gigabytes</code></p>&#13;
</dd>&#13;
</dl>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Applying Pluralization Rules" data-type="sect1"><div class="sect1" id="id550">&#13;
<h1>Applying Pluralization Rules</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id153">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Internationalization APIs" data-secondary="pluralization rules" data-type="indexterm" id="ix_11-internationalization-asciidoc5"/><a data-primary="pluralization rules, Internationalization API" data-type="indexterm" id="ix_11-internationalization-asciidoc6"/>You want to use the correct terminology when referring to different numbers of items. For example, consider a list of users. In English, you’d say “one user” (singular), but “three users” (plural). Other languages have more complex rules, and you want to make sure you cover these.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id551">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use <code>Intl.PluralRules</code> to select the correct pluralized string.</p>&#13;
&#13;
<p>First, construct an <code>Intl.PluralRules</code> object with the desired locale, and call its <code>select</code> method with the number of users (see <a data-type="xref" href="#example11-13">Example 11-13</a>).</p>&#13;
<div data-type="example" id="example11-13">&#13;
<h5><span class="label">Example 11-13. </span>Determining the plural form</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// An array containing the users</code>&#13;
<code class="kr">const</code> <code class="nx">users</code> <code class="o">=</code> <code class="nx">getUsers</code><code class="p">();</code>&#13;
&#13;
<code class="kr">const</code> <code class="nx">rules</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">PluralRules</code><code class="p">(</code><code class="s1">'en-US'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">form</code> <code class="o">=</code> <code class="nx">rules</code><code class="p">.</code><code class="nx">select</code><code class="p">(</code><code class="nx">users</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code></pre></div>&#13;
&#13;
<p>The <code>select</code> method returns a string depending on the plural form to be used and the specified locale. For the <code>en-US</code> locale, it returns either “one” (when the user count is one) or “other” (when the user count is not one). You can define messages using these values as a key, as shown in <a data-type="xref" href="#code_pluralSolution">Example 11-14</a>.</p>&#13;
<div data-type="example" id="code_pluralSolution">&#13;
<h5><span class="label">Example 11-14. </span>A full plural rules solution</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">formatUserCount</code><code class="p">(</code><code class="nx">users</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="c1">// The variations of the message, depending</code>&#13;
  <code class="c1">// on the count</code>&#13;
  <code class="kr">const</code> <code class="nx">messages</code> <code class="o">=</code> <code class="p">{</code>&#13;
    <code class="nx">one</code><code class="o">:</code> <code class="s1">'There is 1 user.'</code><code class="p">,</code>&#13;
    <code class="nx">other</code><code class="o">:</code> <code class="sb">`There are </code><code class="si">${</code><code class="nx">users</code><code class="p">.</code><code class="nx">length</code><code class="si">}</code><code class="sb"> users.`</code>&#13;
  <code class="p">};</code>&#13;
&#13;
  <code class="c1">// Use Intl.PluralRules to determine which message</code>&#13;
  <code class="c1">// should be displayed.</code>&#13;
  <code class="kr">const</code> <code class="nx">rules</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">PluralRules</code><code class="p">(</code><code class="s1">'en-US'</code><code class="p">);</code>&#13;
  <code class="k">return</code> <code class="nx">messages</code><code class="p">[</code><code class="nx">rules</code><code class="p">.</code><code class="nx">select</code><code class="p">(</code><code class="nx">users</code><code class="p">.</code><code class="nx">length</code><code class="p">)];</code>&#13;
<code class="p">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id154">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>This solution requires knowing the different forms ahead of time so you can define the correct messages.</p>&#13;
&#13;
<p><code>Intl.PluralRules</code> also supports an <code>ordinal</code> mode, which works slightly differently. You can use this mode to format <em>ordinal</em> values like “1st,” “2nd,” “3rd,” etc. The formatting rules vary from language to language, and you can map them to suffixes that you apply to the numbers.</p>&#13;
&#13;
<p>For example, with the <code>en-US</code> locale, an ordinal <code>Intl.PluralRules</code> returns values &#13;
<span class="keep-together">such as:</span></p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>one</code> for numbers ending in 1—“1st,” “21st,” etc.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>two</code> for numbers ending in 2—“2nd, 42nd,” etc.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>few</code> for numbers ending in 3—“3rd, “33rd,” etc.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>other</code> for other numbers—“5th,” “47th,” etc.<a data-startref="ix_11-internationalization-asciidoc6" data-type="indexterm" id="id1056"/><a data-startref="ix_11-internationalization-asciidoc5" data-type="indexterm" id="id1057"/></p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Counting Characters, Words, and Sentences" data-type="sect1"><div class="sect1" id="id552">&#13;
<h1>Counting Characters, Words, and Sentences</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id155">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="characters, counting" data-type="indexterm" id="ix_11-internationalization-asciidoc7"/><a data-primary="Internationalization APIs" data-secondary="counting characters/words/sentences" data-type="indexterm" id="ix_11-internationalization-asciidoc8"/><a data-primary="sentences, counting" data-type="indexterm" id="ix_11-internationalization-asciidoc9"/><a data-primary="words, counting" data-type="indexterm" id="ix_11-internationalization-asciidoc10"/>You want to calculate the character, word, and sentence count of a string using locale-specific rules.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id156">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="Intl.Segmenter" data-type="indexterm" id="id1058"/>Use <code>Intl.Segmenter</code> to split the string and count the occurrences.</p>&#13;
&#13;
<p>You can create a segmenter with grapheme (individual characters), word, or sentence granularity. The granularity determines the boundaries of the segments. Each segmenter can only have one granularity, so you need three segmenters (see <a data-type="xref" href="#example11-15">Example 11-15</a>).</p>&#13;
<div data-type="example" id="example11-15">&#13;
<h5><span class="label">Example 11-15. </span>Getting the character, word, and sentence count of a string</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">getCounts</code><code class="p">(</code><code class="nx">text</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">characters</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">Segmenter</code><code class="p">(</code>&#13;
    <code class="nx">navigator</code><code class="p">.</code><code class="nx">language</code><code class="p">,</code>&#13;
    <code class="p">{</code> <code class="nx">granularity</code><code class="o">:</code> <code class="s1">'grapheme'</code> <code class="p">}</code>&#13;
  <code class="p">);</code>&#13;
&#13;
  <code class="kr">const</code> <code class="nx">words</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">Segmenter</code><code class="p">(</code>&#13;
    <code class="nx">navigator</code><code class="p">.</code><code class="nx">language</code><code class="p">,</code>&#13;
    <code class="p">{</code> <code class="nx">granularity</code><code class="o">:</code> <code class="s1">'word'</code> <code class="p">}</code>&#13;
  <code class="p">);</code>&#13;
&#13;
  <code class="kr">const</code> <code class="nx">sentences</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">Segmenter</code><code class="p">(</code>&#13;
    <code class="nx">navigator</code><code class="p">.</code><code class="nx">language</code><code class="p">,</code>&#13;
    <code class="p">{</code> <code class="nx">granularity</code><code class="o">:</code> <code class="s1">'sentence'</code> <code class="p">}</code>&#13;
  <code class="p">);</code>&#13;
&#13;
  <code class="c1">// Convert each segment to an array, then get its length.</code>&#13;
  <code class="k">return</code> <code class="p">{</code>&#13;
    <code class="nx">characters</code><code class="o">:</code> <code class="p">[...</code><code class="nx">characters</code><code class="p">.</code><code class="nx">segment</code><code class="p">(</code><code class="nx">text</code><code class="p">)].</code><code class="nx">length</code><code class="p">,</code>&#13;
    <code class="nx">words</code><code class="o">:</code> <code class="p">[...</code><code class="nx">words</code><code class="p">.</code><code class="nx">segment</code><code class="p">(</code><code class="nx">text</code><code class="p">)].</code><code class="nx">length</code><code class="p">,</code>&#13;
    <code class="nx">sentences</code><code class="o">:</code> <code class="p">[...</code><code class="nx">sentences</code><code class="p">.</code><code class="nx">segment</code><code class="p">(</code><code class="nx">text</code><code class="p">)].</code><code class="nx">length</code>&#13;
  <code class="p">};</code>&#13;
<code class="p">}</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/OL9G0">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id157">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>When you call <code>segment</code> on a segmenter with some text, it returns an iterable object containing all of the segments. There are several ways to get the length of items in this iterable, but this example uses the array spread syntax, which creates an array containing all of the items. Then you just need to get the length of each array.</p>&#13;
&#13;
<p>You may have solved this problem in the past by using the <code>split</code> method of a string. For example, you could split on whitespace to get an array of words and get the word count. This approach may work in your language, but the advantage of using <code>Intl.Segmenter</code> is that it takes the given locale’s rules for breaking up words and sentences<a data-startref="ix_11-internationalization-asciidoc10" data-type="indexterm" id="id1059"/><a data-startref="ix_11-internationalization-asciidoc9" data-type="indexterm" id="id1060"/><a data-startref="ix_11-internationalization-asciidoc8" data-type="indexterm" id="id1061"/><a data-startref="ix_11-internationalization-asciidoc7" data-type="indexterm" id="id1062"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Formatting Lists" data-type="sect1"><div class="sect1" id="id553">&#13;
<h1>Formatting Lists</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id158">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Internationalization APIs" data-secondary="list formatting" data-type="indexterm" id="id1063"/><a data-primary="list formatting" data-type="indexterm" id="id1064"/>You have an array of items that you want to display in a comma-separated list. For example, an array of users is shown as “user1, user2, and user3.”</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id159">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="Intl.ListFormat" data-type="indexterm" id="id1065"/>Use <code>Intl.ListFormat</code> to combine the items into a list using the rules of the given locale. <a data-type="xref" href="#example11-16">Example 11-16</a> uses an array of users, each of which has a <code>username</code> property.</p>&#13;
<div data-type="example" id="example11-16">&#13;
<h5><span class="label">Example 11-16. </span>Formatting a list of user objects</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kd">function</code> <code class="nx">getUserListString</code><code class="p">(</code><code class="nx">users</code><code class="p">,</code> <code class="nx">locale</code> <code class="o">=</code> <code class="s1">'en-US'</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="c1">// The locale of the ListFormat is configurable.</code>&#13;
  <code class="kr">const</code> <code class="nx">listFormat</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">ListFormat</code><code class="p">(</code><code class="nx">locale</code><code class="p">);</code>&#13;
  <code class="k">return</code> <code class="nx">listFormat</code><code class="p">.</code><code class="nx">format</code><code class="p">(</code><code class="nx">users</code><code class="p">.</code><code class="nx">map</code><code class="p">(</code><code class="nx">user</code> <code class="o">=&gt;</code> <code class="nx">user</code><code class="p">.</code><code class="nx">username</code><code class="p">));</code>&#13;
<code class="p">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id554">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><code>Intl.ListFormat</code> adds words and punctuation as needed. For example, in the <code>en-US</code> locale, you get the following:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>1 user: “user1”</p>&#13;
</li>&#13;
<li>&#13;
<p>2 users: “user1 and user2”</p>&#13;
</li>&#13;
<li>&#13;
<p>3 users: “user1, user2, and user3”</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Here’s another example using the <code>de-DE</code> locale:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>1 user: “user1”</p>&#13;
</li>&#13;
<li>&#13;
<p>2 users: “user1 und user2”</p>&#13;
</li>&#13;
<li>&#13;
<p>3 users: “user1, user2 und user3”</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Notice the use of “und” instead of “and,” and also notice in the third case that there’s no comma after user2 as there is in <code>en-US</code>. This is because German grammar does not use this comma (called the “Oxford comma”).</p>&#13;
&#13;
<p>As you can see, using <code>Intl.ListFormat</code> is much more robust than using an array’s <code>join</code> method to join its values with a comma. That method, of course, does not take locale-specific rules into account.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Sorting an Array of Names" data-type="sect1"><div class="sect1" id="id555">&#13;
<h1>Sorting an Array of Names</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id160">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="arrays" data-secondary="sorting an array of names" data-type="indexterm" id="ix_11-internationalization-asciidoc11"/><a data-primary="Internationalization APIs" data-secondary="sorting an array of names" data-type="indexterm" id="ix_11-internationalization-asciidoc12"/><a data-primary="names, sorting an array of" data-type="indexterm" id="ix_11-internationalization-asciidoc13"/>You have an array of names that you want to sort using locale-specific sorting rules.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id161">&#13;
<h2>Solution</h2>&#13;
&#13;
<p><a data-primary="Intl.Collator" data-type="indexterm" id="id1066"/>Create an <code>Intl.Collator</code> to provide the comparison logic, then use its <code>compare</code> function to pass to <code>Array.prototype.sort</code> (see <a data-type="xref" href="#example11-17">Example 11-17</a>). This function compares two strings. It returns a negative value if the first string comes before the second, zero if the strings are equal, or a positive value if the first string comes after the second.</p>&#13;
<div data-type="example" id="example11-17">&#13;
<h5><span class="label">Example 11-17. </span>Sorting an array of names with <code>Intl.Collator</code></h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">names</code> <code class="o">=</code> <code class="p">[</code>&#13;
  <code class="s1">'Elena'</code><code class="p">,</code>&#13;
  <code class="s1">'Mário'</code><code class="p">,</code>&#13;
  <code class="s1">'André'</code><code class="p">,</code>&#13;
  <code class="s1">'Renée'</code><code class="p">,</code>&#13;
  <code class="s1">'Léo'</code><code class="p">,</code>&#13;
  <code class="s1">'Olga'</code><code class="p">,</code>&#13;
  <code class="s1">'Héctor'</code><code class="p">,</code>&#13;
<code class="p">]</code>&#13;
&#13;
<code class="kr">const</code> <code class="nx">collator</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">Intl</code><code class="p">.</code><code class="nx">Collator</code><code class="p">();</code>&#13;
<code class="nx">names</code><code class="p">.</code><code class="nx">sort</code><code class="p">(</code><code class="nx">collator</code><code class="p">.</code><code class="nx">compare</code><code class="p">);</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>A <code>Collator</code> can return any negative or positive value, not just necessarily –1 or 1.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id162">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>This is a concise way to sort an array of strings. Before <code>Intl.Collator</code>, you might have done something like <a data-type="xref" href="#example11-18">Example 11-18</a>.</p>&#13;
<div data-type="example" id="example11-18">&#13;
<h5><span class="label">Example 11-18. </span>Sorting an array of strings directly</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">names</code><code class="p">.</code><code class="nx">sort</code><code class="p">((</code><code class="nx">a</code><code class="p">,</code> <code class="nx">b</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">a</code><code class="p">.</code><code class="nx">localeCompare</code><code class="p">(</code><code class="nx">b</code><code class="p">));</code></pre></div>&#13;
&#13;
<p>This works fine, but one major difference is that you can’t specify which locale’s sorting rules to apply when comparing strings. Another benefit of <code>Intl.Collator</code> is its flexibility. You can fine-tune the logic it uses to compare strings.</p>&#13;
&#13;
<p>For example, consider the array <code>[1, 2, 20, 3]</code>. Using the default collator, this would be the sorted order since it’s using string comparison logic. You can pass the <code>numeric: true</code> option to <code>Intl.Collator</code>, and the sorted array then becomes <code>[1, 2, 3, 20]</code><a data-startref="ix_11-internationalization-asciidoc13" data-type="indexterm" id="id1067"/><a data-startref="ix_11-internationalization-asciidoc12" data-type="indexterm" id="id1068"/><a data-startref="ix_11-internationalization-asciidoc11" data-type="indexterm" id="id1069"/>.<a data-startref="ix_11-internationalization-asciidoc0" data-type="indexterm" id="id1070"/></p>&#13;
</div></section>&#13;
</div></section>&#13;
</div></section></body></html>