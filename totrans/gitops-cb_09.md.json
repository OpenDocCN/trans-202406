["```\nbrew install kubeseal\n```", "```\nkubectl create \\\n-f https://github.com/bitnami-labs/sealed-secrets/releases/download/0.18.2/controller.yaml\n```", "```\nserviceaccount/sealed-secrets-controller created\ndeployment.apps/sealed-secrets-controller created\ncustomresourcedefinition.apiextensions.k8s.io/sealedsecrets.bitnami.com created\nservice/sealed-secrets-controller created\nrolebinding.rbac.authorization.k8s.io/sealed-secrets-controller created\nrolebinding.rbac.authorization.k8s.io/sealed-secrets-service-proxier created\nrole.rbac.authorization.k8s.io/sealed-secrets-service-proxier created\nrole.rbac.authorization.k8s.io/sealed-secrets-key-admin created\nclusterrolebinding.rbac.authorization.k8s.io/sealed-secrets-controller created\nclusterrole.rbac.authorization.k8s.io/secrets-unsealer created\n```", "```\nkubectl create secret generic pacman-secret \\\n--from-literal=user=pacman \\\n--from-literal=pass=pacman\n```", "```\nsecret/pacman-secret created\n```", "```\nkubectl get secret pacman-secret  -o yaml\n```", "```\napiVersion: v1\ndata:\n  pass: cGFjbWFu\n  user: cGFjbWFu\nkind: Secret\nmetadata:\n  name: pacman-secret\n  namespace: default\ntype: Opaque\n```", "```\nkubectl get secret pacman-secret -o yaml \\\n| kubeseal -o yaml > pacman-sealedsecret.yaml\n```", "```\napiVersion: bitnami.com/v1alpha1\nkind: SealedSecret\nmetadata:\n  creationTimestamp: null\n  name: pacman-secret\n  namespace: default\nspec:\n  encryptedData: ![1](assets/1.png)\n    pass: AgBJR1AgZ5Gu5NOVsG1E8SKBcdB3QSDdzZka3RRYuWV7z8g7ccQ0dGc1suVOP8wX/ZpPmIMp8+urPYG62k4EZRUjuu/Vg2E1nSbsGBh9eKu3NaO6tGSF3eGk6PzN6XtRhDeER4u7MG5pj/+FXRAKcy8Z6RfzbVEGq/QJQ4z0ecSNdJmG07ERMm1Q+lPNGvph2Svx8aCgFLqRsdLhFyvwbTyB3XnmFHrPr+2DynxeN8XVMoMkRYXgVc6GAoxUK7CnC3Elpuy7lIdPwc5QBx9kUVfra83LX8/KxeaJwyCqvscIGjtcxUtpTpF5jm1t1DSRRNbc4m+7pTwTmnRiUuaMVeujaBco4521yTkh5iEPjnjvUt+VzK01NVoeNunqIazp15rFwTvmiQ5PAtbiUXpT733zCr60QBgSxPg31vw98+u+RcIHvaMIoDCqaXxUdcn2JkUF+bZXtxNmIRTAiQVQ1vEPmrZxpvZcUh/PPC4L/RFWrQWnOzKRyqLq9wRoSLPbKyvMXnaxH0v3USGIktmtJlGjlXoW/i+HIoSeMFS0mUAzOF5M5gweOhtxKGh3Y74ZDn5PbVA/9kbkuWgvPNGDZL924Dm6AyM5goHECr/RRTm1e22K9BfPASARZuGA6paqb9h1XEqyqesZgM0R8PLiyLuu+tpqydR0SiYLc5VltdjzpIyyy9Xmw6Aa3/4SB+4tSwXSUUrB5yc=\n    user: AgBhYDZQzOwinetPceZL897aibTYp4QPGFvP6ZhDyuUAxOWXBQ7jBA3KPUqLvP8vBcxLAcS7HpKcDSgCdi47D2WhShdBR4jWJufwKmR3j+ayTdw72t3ALpQhTYI0iMYTiNdR0/o3vf0jeNMt/oWCRsifqBxZaIShE53rAFEjEA6D7CuCDXu8BHk1DpSr79d5Au4puzpHVODh+v1T+Yef3k7DUoSnbYEh3CvuRweiuq5lY8G0oob28j38wdyxm3GIrexa+M/ZIdO1hxZ6jz4edv6ejdZfmQNdru3c6lmljWwcO+0Ue0MqFi4ZF/YNUsiojI+781n1m3K/giKcyPLn0skD7DyeKPoukoN6W5P71OuFSkF+VgIeejDaxuA7bK3PEaUgv79KFC9aEEnBr/7op7HY7X6aMDahmLUc/+zDhfzQvwnC2wcj4B8M2OBFa2ic2PmGzrIWhlBbs1OgnpehtGSETq+YRDH0alWOdFBq1U8qn6QA8Iw6ewu8GTele3zlPLaADi5O6LrJbIZNlY0+PutWfjs9ScVVEJy+I9BGdyT6tiA/4v4cxH6ygG6NzWkqxSaYyNrWWXtLhOlqyCpTZtUwHnF+OLB3gCpDZPx+NwTe2Kn0jY0c83LuLh5PJ090AsWWqZaRQyELeL6y6mVekQFWHGfK6t57Vb7Z3+5XJCgQn+xFLkj3SIz0ME5D4+DSsUDS1fyL8uI=\n  template:\n    data: null\n    metadata:\n      creationTimestamp: null\n      name: pacman-secret\n      namespace: default\n    type: Opaque\n```", "```\nargocd app create pacman \\\n--repo https://github.com/gitops-cookbook/pacman-kikd-manifests.git \\\n--path 'k8s/sealedsecrets' \\\n--dest-server https://kubernetes.default.svc \\\n--dest-namespace default \\\n--sync-policy auto\n```", "```\nargocd app list\n```", "```\nNAME    CLUSTER                         NAMESPACE  PROJECT  STATUS  HEALTH ↳\n SYNCPOLICY  CONDITIONS  REPO                                                           PATH TARGET\npacman  https://kubernetes.default.svc  default    default  Synced  Healthy↳\n <none>      <none>      https://github.com/gitops-cookbook/pacman-kikd-manifests.git  k8s/sealedsecrets\n```", "```\nhelm repo add external-secrets https://charts.external-secrets.io\n\nhelm install external-secrets \\\n  external-secrets/external-secrets \\\n  -n external-secrets \\\n  --create-namespace\n```", "```\nNAME: external-secrets\nLAST DEPLOYED: Fri Sep  2 13:09:53 2022\nNAMESPACE: external-secrets\nSTATUS: deployed\nREVISION: 1\nTEST SUITE: None\nNOTES:\nexternal-secrets has been deployed successfully!\n```", "```\nexport VAULT_TOKEN=<YOUR_TOKEN>\nkubectl create secret generic vault-token \\\n  --from-literal=token=$VAULT_TOKEN \\\n  -n external-secrets\n```", "```\napiVersion: external-secrets.io/v1beta1\nkind: SecretStore\nmetadata:\n  name: vault-secretstore\n  namespace: default\nspec:\n  provider:\n    vault:\n      server: \"http://vault.local:8200\" ![1](assets/1.png)\n      path: \"secret\"\n      version: \"v2\"\n      auth:\n        tokenSecretRef:\n          name: \"vault-token\" ![2](assets/2.png)\n          key: \"token\" ![3](assets/3.png)\n          namespace: external-secrets\n```", "```\nkubectl create -f vault-secretstore.yaml\n```", "```\nvault kv put secret/pacman-secrets pass=pacman\n```", "```\napiVersion: external-secrets.io/v1beta1\nkind: ExternalSecret\nmetadata:\n  name: pacman-externalsecrets\n  namespace: default\nspec:\n  refreshInterval: \"15s\"\n  secretStoreRef:\n    name: vault-secretstore\n    kind: SecretStore\n  target:\n    name: pacman-externalsecrets\n  data:\n  - secretKey: token\n    remoteRef:\n      key: secret/pacman-secrets\n      property: pass\n```", "```\nkubectl create -f pacman-externalsecrets.yaml\n```", "```\nargocd app create pacman \\\n--repo https://github.com/gitops-cookbook/pacman-kikd-manifests.git \\\n--path 'k8s/externalsecrets' \\\n--dest-server https://kubernetes.default.svc \\\n--dest-namespace default \\\n--sync-policy auto\n```", "```\nhelm repo add gitea-charts https://dl.gitea.io/charts/\nhelm install gitea gitea-charts/gitea\n```", "```\nhelm install gitea gitea-charts/gitea\n\"gitea-charts\" has been added to your repositories\nNAME: gitea\nLAST DEPLOYED: Fri Sep  2 15:04:04 2022\nNAMESPACE: default\nSTATUS: deployed\nREVISION: 1\nNOTES:\n1. Get the application URL by running these commands:\n  echo \"Visit http://127.0.0.1:3000 to use your application\"\n  kubectl --namespace default port-forward svc/gitea-http 3000:3000\n```", "```\nargocd app create pacman-webhook \\\n--repo http://gitea-http.default.svc:3000/gitea_admin/pacman-kikd-manifests.git \\\n--dest-server https://kubernetes.default.svc \\\n--dest-namespace default \\\n--path k8s \\\n--sync-policy auto\n```", "```\napiVersion: argoproj.io/v1alpha1\nkind: ApplicationSet\nmetadata:\n  name: bgd-app\n  namespace: argocd\nspec:\n  generators: ![1](assets/1.png)\n  - list:\n      elements: ![2](assets/2.png)\n      - cluster: staging\n        url: https://kubernetes.default.svc\n        location: default\n      - cluster: prod\n        url: https://kubernetes.default.svc\n        location: app\n  template: ![3](assets/3.png)\n    metadata:\n      name: '{{cluster}}-app' ![4](assets/4.png)\n    spec:\n      project: default\n      source:\n        repoURL: https://github.com/gitops-cookbook/gitops-cookbook-sc.git\n        targetRevision: main\n        path: ch08/bgd-gen/{{cluster}}\n      destination:\n        server: '{{url}}' ![5](assets/5.png)\n        namespace: '{{location}}'\n      syncPolicy:\n        syncOptions:\n        - CreateNamespace=true\n```", "```\nkubectl apply -f bgd-application-set.yaml\n```", "```\napiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: staging-app\nspec:\n  project: default\n  source:\n    path: ch08/bgd-gen/staging\n    repoURL: https://github.com/example/app.git\n    targetRevision: HEAD\n  destination:\n    namespace: default\n    server: https://kubernetes.default.svc\n    ...\n```", "```\napiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: prod-app\nspec:\n  project: default\n  source:\n    path: ch08/bgd-gen/prod\n    repoURL: https://github.com/example/app.git\n    targetRevision: HEAD\n  destination:\n    namespace: app\n    server: https://kubernetes.default.svc\n    ...\n```", "```\n# Remember to login first\nargocd login --insecure --grpc-web $argoURL  --username admin --password $argoPass\n\nargocd app list\n```", "```\nNAME         CLUSTER                         NAMESPACE\nprod-app     https://kubernetes.default.svc  app\nstaging-app  https://kubernetes.default.svc  default\n```", "```\nkubectl delete -f bgd-application-set.yaml\n```", "```\nbgd-gen\n├── staging\n│   ├── ...yaml\n└── prod\n    ├── ...yaml\n```", "```\napiVersion: argoproj.io/v1alpha1\nkind: ApplicationSet\nmetadata:\n  name: cluster-addons\n  namespace: openshift-gitops\nspec:\n  generators:\n  - git: ![1](assets/1.png)\n      repoURL: https://github.com/gitops-cookbook/gitops-cookbook-sc.git\n      revision: main\n      directories:\n      - path: ch08/bgd-gen/* ![2](assets/2.png)\n  template: ![3](assets/3.png)\n    metadata:\n      name: '{{path[0]}}{{path[2]}}' ![4](assets/4.png)\n    spec:\n      project: default\n      source:\n        repoURL: https://github.com/gitops-cookbook/gitops-cookbook-sc.git\n        targetRevision: main\n        path: '{{path}}' ![5](assets/5.png)\n      destination:\n        server: https://kubernetes.default.svc\n        namespace: '{{path.basename}}' ![6](assets/6.png)\n```", "```\nkubectl apply -f bgd-git-application-set.yaml\n```", "```\nargocd app list\n\nNAME         CLUSTER                         NAMESPACE\nch08prod     https://kubernetes.default.svc  prod\nch08staging  https://kubernetes.default.svc  staging\n```", "```\napp\n├── tekton-operator\n│   ├── ...yaml\n├── prometheus-operator\n│   ├── ...yaml\n└── istio-operator\n    ├── ...yaml\n```", "```\n{\n  \"cluster\": {\n    \"name\": \"staging\",\n    \"address\": \"https://1.2.3.4\"\n  }\n}\n```", "```\napiVersion: argoproj.io/v1alpha1\nkind: ApplicationSet\nmetadata:\n  name: guestbook\nspec:\n  generators:\n  - git:\n      repoURL: https://github.com/example/app.git\n      revision: HEAD\n      files:\n      - path: \"app/**/config.json\" ![1](assets/1.png)\n  template:\n    metadata:\n      name: '{{cluster.name}}-app' ![2](assets/2.png)\n....\n```", "```\napiVersion: argoproj.io/v1alpha1\nkind: ApplicationSet\nmetadata:\n  name: myapps\n  namespace: openshift-gitops\nspec:\n  generators:\n  - pullRequest:\n      github: ![1](assets/1.png)\n        owner: gitops-cookbook ![2](assets/2.png)\n        repo: gitops-cookbook-sc ![3](assets/3.png)\n        labels: ![4](assets/4.png)\n        - preview\n      requeueAfterSeconds: 60 ![5](assets/5.png)\n  template:\n    metadata:\n      name: 'myapp-{{branch}}-{{number}}' ![6](assets/6.png)\n    spec:\n      source:\n        repoURL: 'https://github.com/gitops-cookbook/gitops-cookbook-sc.git'\n        targetRevision: '{{head_sha}}' ![7](assets/7.png)\n        path: ch08/bgd-pr\n      project: default\n      destination:\n        server: https://kubernetes.default.svc\n        namespace: '{{branch}}-{{number}}'\n```", "```\nkubectl apply -f bgd-pr-application-set.yaml\n```", "```\nargocd app list\nNAME  CLUSTER  NAMESPACE  PROJECT  STATUS\n```", "```\nkubectl describe applicationset myapps -n argocd\n\n...\nEvents:\n  Type    Reason     Age                From                       Message\n  ----    ------     ----               ----                       -------\n  Normal  created    23s                applicationset-controller  created Application \"myapp-lordofthejars-patch-1-1\"\n  Normal  unchanged  23s (x2 over 23s)  applicationset-controller  unchanged Application \"myapp-lordofthejars-patch-1-1\"\n```", "```\nargocd app list\nNAME                           CLUSTER                         NAMESPACE\nmyapp-lordofthejars-patch-1-1  https://kubernetes.default.svc  lordofthejars-patch-1-1\n```", "```\nkubectl create namespace argo-rollouts\n\nkubectl apply -n argo-rollouts -f https://github.com/argoproj/argo-rollouts/releases/download/v1.2.2/install.yaml\n...\nclusterrolebinding.rbac.authorization.k8s.io/argo-rollouts created\nsecret/argo-rollouts-notification-secret created\nservice/argo-rollouts-metrics created\ndeployment.apps/argo-rollouts created\n```", "```\napiVersion: argoproj.io/v1alpha1\nkind: Rollout\nmetadata:\n  name: bgd-rollouts\nspec:\n  replicas: 5\n  strategy:\n    canary: ![1](assets/1.png)\n      steps: ![2](assets/2.png)\n      - setWeight: 20 ![3](assets/3.png)\n      - pause: {} ![4](assets/4.png)\n      - setWeight: 40\n      - pause: {duration: 30s} ![5](assets/5.png)\n      - setWeight: 60\n      - pause: {duration: 30s}\n      - setWeight: 80\n      - pause: {duration: 30s}\n  revisionHistoryLimit: 2\n  selector:\n    matchLabels:\n      app: bgd-rollouts\n  template: ![6](assets/6.png)\n    metadata:\n      creationTimestamp: null\n      labels:\n        app: bgd-rollouts\n    spec:\n      containers:\n      - image: quay.io/rhdevelopers/bgd:1.0.0\n        name: bgd\n        env:\n        - name: COLOR\n          value: \"blue\"\n        resources: {}\n```", "```\nkubectl apply -f bgd-rollout.yaml\n```", "```\nkubectl get pods\n\nNAME                           READY   STATUS    RESTARTS   AGE\nbgd-rollouts-679cdfcfd-6z2zf   1/1     Running   0          12m\nbgd-rollouts-679cdfcfd-8c6kl   1/1     Running   0          12m\nbgd-rollouts-679cdfcfd-8tb4v   1/1     Running   0          12m\nbgd-rollouts-679cdfcfd-f4p7f   1/1     Running   0          12m\nbgd-rollouts-679cdfcfd-tljfr   1/1     Running   0          12m\n```", "```\nkubectl argo rollouts get rollout bgd-rollouts\n\nName:            bgd-rollouts\nNamespace:       default\nStatus:          ✔ Healthy\nStrategy:        Canary\n  Step:          8/8\n  SetWeight:     100\n  ActualWeight:  100\nImages:          quay.io/rhdevelopers/bgd:1.0.0 (stable)\nReplicas:\n  Desired:       5\n  Current:       5\n  Updated:       5\n  Ready:         5\n  Available:     5\n\nNAME                                     KIND        STATUS      AGE  INFO\n⟳ bgd-rollouts                           Rollout     ✔ Healthy  13m\n└──# revision:1\n   └──⧉ bgd-rollouts-679cdfcfd          ReplicaSet  ✔ Healthy  13m  stable\n      ├──□ bgd-rollouts-679cdfcfd-6z2zf  Pod         ✔ Running  13m  ready:1/1\n      ├──□ bgd-rollouts-679cdfcfd-8c6kl  Pod         ✔ Running  13m  ready:1/1\n      ├──□ bgd-rollouts-679cdfcfd-8tb4v  Pod         ✔ Running  13m  ready:1/1\n      ├──□ bgd-rollouts-679cdfcfd-f4p7f  Pod         ✔ Running  13m  ready:1/1\n      └──□ bgd-rollouts-679cdfcfd-tljfr  Pod         ✔ Running  13m  ready:1/1\n```", "```\n...\nname: bgd\nenv:\n- name: COLOR\n  value: \"green\"\nresources: {}\n```", "```\nkubectl get pods\n\nNAME                           READY   STATUS    RESTARTS   AGE\nbgd-rollouts-679cdfcfd-6z2zf   1/1     Running   0          27m\nbgd-rollouts-679cdfcfd-8c6kl   1/1     Running   0          27m\nbgd-rollouts-679cdfcfd-8tb4v   1/1     Running   0          27m\nbgd-rollouts-679cdfcfd-tljfr   1/1     Running   0          27m\nbgd-rollouts-c5495c6ff-zfgvn   1/1     Running   0          13s ![1](assets/1.png)\n```", "```\nkubectl argo rollouts get rollout bgd-rollouts\n\n...\nNAME                                     KIND        STATUS      AGE    INFO\n⟳ bgd-rollouts                           Rollout     ॥ Paused    31m\n├──# revision:2\n│  └──⧉ bgd-rollouts-c5495c6ff          ReplicaSet  ✔ Healthy  3m21s  canary\n│     └──□ bgd-rollouts-c5495c6ff-zfgvn  Pod         ✔ Running  3m21s  ready:1/1\n└──# revision:1\n   └──⧉ bgd-rollouts-679cdfcfd          ReplicaSet  ✔ Healthy  31m    stable\n      ├──□ bgd-rollouts-679cdfcfd-6z2zf  Pod         ✔ Running  31m    ready:1/1\n      ├──□ bgd-rollouts-679cdfcfd-8c6kl  Pod         ✔ Running  31m    ready:1/1\n      ├──□ bgd-rollouts-679cdfcfd-8tb4v  Pod         ✔ Running  31m    ready:1/1\n      └──□ bgd-rollouts-679cdfcfd-tljfr  Pod         ✔ Running  31m    ready:1/1\n```", "```\nkubectl argo rollouts promote bgd-rollouts\n```", "```\nkubectl get pods\n\nNAME                           READY   STATUS    RESTARTS   AGE\nbgd-rollouts-c5495c6ff-2g7r8   1/1     Running   0          89s\nbgd-rollouts-c5495c6ff-7mdch   1/1     Running   0          122s\nbgd-rollouts-c5495c6ff-d9828   1/1     Running   0          13s\nbgd-rollouts-c5495c6ff-h4t6f   1/1     Running   0          56s\nbgd-rollouts-c5495c6ff-zfgvn   1/1     Running   0          11m\n```", "```\napiVersion: argoproj.io/v1alpha1\nkind: Rollout\nmetadata:\n  name: bgdapp\n  labels:\n    app: bgdapp\nspec:\n  strategy:\n    canary: ![1](assets/1.png)\n      steps:\n      - setWeight: 20\n      - pause:\n          duration: \"1m\"\n      - setWeight: 50\n      - pause:\n          duration: \"2m\"\n      canaryService: bgd-canary ![2](assets/2.png)\n      stableService: bgd ![3](assets/3.png)\n      trafficRouting:\n        istio: ![4](assets/4.png)\n           virtualService: ![5](assets/5.png)\n            name: bgd ![6](assets/6.png)\n            routes:\n            - primary ![7](assets/7.png)\n  replicas: 1\n  revisionHistoryLimit: 2\n  selector:\n    matchLabels:\n      app: bgdapp\n      version: v1\n  template:\n    metadata:\n      labels:\n        app: bgdapp\n        version: v1\n      annotations:\n        sidecar.istio.io/inject: \"true\" ![8](assets/8.png)\n    spec:\n      containers:\n      - image: quay.io/rhdevelopers/bgd:1.0.0\n        name: bgd\n        env:\n        - name: COLOR\n          value: \"blue\"\n        resources: {}\n```", "```\napiVersion: v1\nkind: Service\nmetadata:\n  name: bgd\n  labels:\n    app: bgdapp\nspec:\n  ports:\n  - name: http\n    port: 8080\n  selector:\n    app: bgdapp\n```", "```\napiVersion: v1\nkind: Service\nmetadata:\n  name: bgd-canary\n  labels:\n    app: bgdapp\nspec:\n  ports:\n  - name: http\n    port: 8080\n  selector:\n    app: bgdapp\n```", "```\napiVersion: networking.istio.io/v1alpha3\nkind: VirtualService\nmetadata:\n  name: bgd\nspec:\n  hosts:\n  - bgd\n  http:\n  - route:\n    - destination:\n        host: bgd ![1](assets/1.png)\n      weight: 100\n    - destination:\n        host: bgd-canary ![2](assets/2.png)\n      weight: 0\n    name: primary ![3](assets/3.png)\n```", "```\nkubectl apply -f bgd-virtual-service.yaml\nkubectl apply -f service.yaml\nkubectl apply -f service-canary.yaml\nkubectl apply -f bgd-isio-rollout.yaml\n```"]