<html><head></head><body><section data-pdf-bookmark="Chapter 14. Device Integration" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch_deviceIntegration">&#13;
<h1><span class="label">Chapter 14. </span>Device Integration</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Introduction" data-type="sect1"><div class="sect1" id="id199">&#13;
<h1>Introduction</h1>&#13;
&#13;
<p><a data-primary="device integration" data-type="indexterm" id="ix_14-device-integration-asciidoc0"/>The <a data-primary="device integration" data-secondary="basics" data-type="indexterm" id="id1150"/>modern web browser platform includes APIs to interact with all kinds of device information and capabilities, including:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Battery status</p>&#13;
</li>&#13;
<li>&#13;
<p>Network status</p>&#13;
</li>&#13;
<li>&#13;
<p>Geolocation</p>&#13;
</li>&#13;
<li>&#13;
<p>Device clipboard</p>&#13;
</li>&#13;
<li>&#13;
<p>Sharing content</p>&#13;
</li>&#13;
<li>&#13;
<p>Tactile feedback</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>At the time of writing, some of these APIs are not well supported yet. Some are still considered experimental, so you shouldn’t use them in a production application &#13;
<span class="keep-together">just yet.</span></p>&#13;
&#13;
<p>Some of these APIs may be supported by a given browser, like Chrome, but still won’t work if the device is missing the required capabilities. For example, the Vibration API is well supported by Chrome, but won’t work on a laptop or other device without vibration support.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Reading the Battery Status" data-type="sect1"><div class="sect1" id="id586">&#13;
<h1>Reading the Battery Status</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id200">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Battery Status API" data-type="indexterm" id="ix_14-device-integration-asciidoc1"/><a data-primary="device integration" data-secondary="reading battery status" data-type="indexterm" id="ix_14-device-integration-asciidoc2"/>You want to show the device’s battery charging status in your app.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id587">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the Battery Status API.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/DWFvk">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
&#13;
<p>You can query the Battery Status API by calling <code>navigator.getBattery</code>. This method returns a <code>Promise</code> that resolves to an object containing battery information.</p>&#13;
&#13;
<p>First, write some HTML placeholder elements to hold the battery status, as shown in <a data-type="xref" href="#example14-1">Example 14-1</a>.</p>&#13;
<div data-type="example" id="example14-1">&#13;
<h5><span class="label">Example 14-1. </span>The battery status markup</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">ul</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">li</code><code class="p">&gt;</code>Battery charge level:<code class="p">&lt;</code><code class="nt">span</code> <code class="na">id</code><code class="o">=</code><code class="s">"battery-level"</code><code class="p">&gt;</code>--<code class="p">&lt;/</code><code class="nt">span</code><code class="p">&gt;&lt;/</code><code class="nt">li</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">li</code><code class="p">&gt;</code>Battery charge status:<code class="p">&lt;</code><code class="nt">span</code> <code class="na">id</code><code class="o">=</code><code class="s">"battery-charging"</code><code class="p">&gt;</code>--<code class="p">&lt;/</code><code class="nt">span</code><code class="p">&gt;&lt;/</code><code class="nt">li</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">ul</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>Then, you can query the Battery Status API to get the battery charge level and charging status, adding them to the corresponding DOM elements (see <a data-type="xref" href="#example14-2">Example 14-2</a>).</p>&#13;
<div data-type="example" id="example14-2">&#13;
<h5><span class="label">Example 14-2. </span>Querying the Battery Status API</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">batteryLevelItem</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#battery-level'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">batteryChargingItem</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#battery-charging'</code><code class="p">);</code>&#13;
&#13;
<code class="nx">navigator</code><code class="p">.</code><code class="nx">getBattery</code><code class="p">().</code><code class="nx">then</code><code class="p">(</code><code class="nx">battery</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="c1">// Battery level is a number between 0 and 1. Multiply by 100 to convert it to</code>&#13;
  <code class="c1">// a percentage.</code>&#13;
  <code class="nx">batteryLevelItem</code><code class="p">.</code><code class="nx">textContent</code> <code class="o">=</code> <code class="sb">`</code><code class="si">${</code><code class="nx">battery</code><code class="p">.</code><code class="nx">level</code> <code class="o">*</code> <code class="mi">100</code><code class="si">}</code><code class="sb">%`</code><code class="p">;</code>&#13;
&#13;
  <code class="nx">batteryChargingItem</code><code class="p">.</code><code class="nx">textContent</code> <code class="o">=</code> <code class="nx">battery</code><code class="p">.</code><code class="nx">charging</code> <code class="o">?</code> <code class="s1">'Charging'</code> <code class="o">:</code> <code class="s1">'Not charging'</code><code class="p">;</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>What if you unplug your laptop? The displayed charging status is no longer accurate. To handle this, there some events you can listen for:</p>&#13;
<dl>&#13;
<dt><code>levelchange</code></dt>&#13;
<dd>&#13;
<p>Triggered when the battery’s charge level changes</p>&#13;
</dd>&#13;
<dt><code>chargingchange</code></dt>&#13;
<dd>&#13;
<p>Triggered when the battery starts or stops charging</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>You can update the UI when these events occur. Make sure you have a reference to the <code>battery</code> object, then add event listeners (see <a data-type="xref" href="#example14-3">Example 14-3</a>).</p>&#13;
<div data-type="example" id="example14-3">&#13;
<h5><span class="label">Example 14-3. </span>Listening for battery events</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">battery</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'levelchange'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">batteryLevelItem</code><code class="p">.</code><code class="nx">textContent</code> <code class="o">=</code> <code class="sb">`</code><code class="si">${</code><code class="nx">battery</code><code class="p">.</code><code class="nx">level</code> <code class="o">*</code> <code class="mi">100</code><code class="si">}</code><code class="sb">%`</code><code class="p">;</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="nx">battery</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'chargingchange'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">batteryChargingItem</code><code class="p">.</code><code class="nx">textContent</code> <code class="o">=</code> <code class="nx">battery</code><code class="p">.</code><code class="nx">charging</code> <code class="o">?</code> <code class="s1">'Charging'</code> <code class="o">:</code> <code class="s1">'Not charging'</code><code class="p">;</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>Now your battery status stays updated. If you unplug your laptop, the charging status changes from “Charging” to “Not charging.”</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id201">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>At the time of writing, some browsers don’t support this API at all. You can use the code in <a data-type="xref" href="#example14-4">Example 14-4</a> to check if the Battery Status API is supported on the user’s browser.</p>&#13;
<div data-type="example" id="example14-4">&#13;
<h5><span class="label">Example 14-4. </span>Checking for Battery Status API support</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="k">if</code> <code class="p">(</code><code class="s1">'getBattery'</code> <code class="k">in</code> <code class="nx">navigator</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="c1">// request the battery status here</code>&#13;
<code class="p">}</code> <code class="k">else</code> <code class="p">{</code>&#13;
  <code class="c1">// it's not supported</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>There are some additional properties available in the <code>battery</code> object, too. These include:</p>&#13;
<dl>&#13;
<dt><code>chargingTime</code></dt>&#13;
<dd>&#13;
<p>The number of seconds remaining until the battery is fully charged, if the battery is charging. If the battery is not charging, this has the value <code>Infinity</code>.</p>&#13;
</dd>&#13;
<dt><code>dischargingTime</code></dt>&#13;
<dd>&#13;
<p>The number of seconds remaining until the battery is fully discharged, if the battery is not charging. If the battery is not discharging, this has the value <code>Infinity</code>.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>These two properties also have their own <code>change</code> events that you can listen for, called <code>chargingtimechange</code> and <code>dischargingtimechange</code>, respectively.</p>&#13;
&#13;
<p>There are many things you can do with the information provided by the Battery Status API. For example, if the battery level is low, you can disable background tasks or other power-intensive operations. Or, it could even be something as simple as letting the user know they should save their changes because the device’s battery level is low.</p>&#13;
&#13;
<p>You could also use it to show a simple battery status indicator. If you have a series of icons representing different battery states (fully charged, not charging, charging, low charge) you could keep the displayed icon up to date by listening to the change events<a data-startref="ix_14-device-integration-asciidoc2" data-type="indexterm" id="id1151"/><a data-startref="ix_14-device-integration-asciidoc1" data-type="indexterm" id="id1152"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Reading the Network Status" data-type="sect1"><div class="sect1" id="id588">&#13;
<h1>Reading the Network Status</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id202">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="device integration" data-secondary="reading network status" data-type="indexterm" id="id1153"/><a data-primary="network connection, reading status of" data-type="indexterm" id="id1154"/><a data-primary="Network Information API" data-type="indexterm" id="id1155"/><a data-primary="network status API, reading" data-type="indexterm" id="id1156"/>You want to know how fast the user’s network connection is.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id589">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the Network Information API to get data about the user’s network connection (see <a data-type="xref" href="#example14-5">Example 14-5</a>).</p>&#13;
<div data-type="example" id="example14-5">&#13;
<h5><span class="label">Example 14-5. </span>Checking the network capabilities</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="k">if</code> <code class="p">(</code><code class="nx">navigator</code><code class="p">.</code><code class="nx">connection</code><code class="p">.</code><code class="nx">effectiveType</code> <code class="o">===</code> <code class="s1">'4g'</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="c1">// User can perform high-bandwidth activities.</code>&#13;
<code class="p">}</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/krDAV">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id590">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The network information is contained in the <code>navigator.connection</code> object. To get an approximation of the network connection capabilities, you can check the <code>navigator.connection.effectiveType</code> property. At the time of writing, the possible values for <code>navigator.connection.effectiveType</code> based on download speed are:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>slow-2g</code>: Up to 50 Kbps</p>&#13;
</li>&#13;
<li>&#13;
<p><code>2g</code>: Up to 70 Kbps</p>&#13;
</li>&#13;
<li>&#13;
<p><code>3g</code>: Up to 700 Kbps</p>&#13;
</li>&#13;
<li>&#13;
<p><code>4g</code>: 700 Kbps and above</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>These values are calculated based on the measurement of real user data. The specification states that these values may be updated in the future. You can use these values to determine, approximately, the network capabilities of the device. For example, an <code>effectiveType</code> of <code>slow-2g</code> probably cannot handle high-bandwidth activities like HD video streaming.</p>&#13;
&#13;
<p>Should the network connection change while the page is open, the <code>navigator.connection</code> object can trigger a <code>change</code> event. You can listen for this event and adjust your app based on the new network connection information that was received.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Getting the Device Location" data-type="sect1"><div class="sect1" id="id591">&#13;
<h1>Getting the Device Location</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id203">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="device integration" data-secondary="getting device location" data-type="indexterm" id="ix_14-device-integration-asciidoc3"/><a data-primary="Geolocation API" data-type="indexterm" id="ix_14-device-integration-asciidoc4"/><a data-primary="location,of device" data-secondary="getting" data-type="indexterm" id="ix_14-device-integration-asciidoc5"/>You want to get the device’s location.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id592">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the Geolocation API to get the position in latitude and longitude. The Geolocation API exposes the <code>navigator.geolocation</code> object, which is used to request the user’s location with the <code>getCurrentPosition</code> method. This is a callback-based API. <code>getCurrentPosition</code> takes two arguments. The first argument is the success callback, and the second is the error callback (see <a data-type="xref" href="#code_requestLocation">Example 14-6</a>).</p>&#13;
<div data-type="example" id="code_requestLocation">&#13;
<h5><span class="label">Example 14-6. </span>Requesting the device location</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">navigator</code><code class="p">.</code><code class="nx">geolocation</code><code class="p">.</code><code class="nx">getCurrentPosition</code><code class="p">(</code><code class="nx">position</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Latitude: '</code> <code class="o">+</code> <code class="nx">position</code><code class="p">.</code><code class="nx">coords</code><code class="p">.</code><code class="nx">latitude</code><code class="p">);</code>&#13;
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'Longitude: '</code> <code class="o">+</code> <code class="nx">position</code><code class="p">.</code><code class="nx">coords</code><code class="p">.</code><code class="nx">longitude</code><code class="p">);</code>&#13;
<code class="p">},</code> <code class="nx">error</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="c1">// Either the user denied permission, or the device location could not</code>&#13;
  <code class="c1">// be determined.</code>&#13;
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">error</code><code class="p">);</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>This API requires permission from the user. The first time you call <code>getCurrentPosition</code>, the browser asks the user for permission to share their location. If the user does not grant permission, the geolocation request fails and the browser calls the error callback.</p>&#13;
&#13;
<p>If you want to check for permission ahead of time, to avoid having to catch an error, you can use the Permissions API to check its status (see <a data-type="xref" href="#example14-7">Example 14-7</a>).</p>&#13;
<div data-type="example" id="example14-7">&#13;
<h5><span class="label">Example 14-7. </span>Checking for geolocation permission</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">permission</code> <code class="o">=</code> <code class="nx">await</code> <code class="nx">navigator</code><code class="p">.</code><code class="nx">permissions</code><code class="p">.</code><code class="nx">query</code><code class="p">({</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'geolocation'</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>The returned permission object has a <code>state</code> property that can have one of the values <code>granted</code>, <code>denied</code>, or <code>prompt</code>. If the state is <code>denied</code>, you know the user has already been prompted and they declined, so you shouldn’t bother trying to get their location because it will fail.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id204">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>There are a few ways the browser can try to detect a user’s location. It can attempt to use the device’s GPS, or it may use information about the user’s WiFi connection or IP address. In some cases, such as when the user is using a VPN, IP-based geolocation may not return the correct location for the user’s device.</p>&#13;
&#13;
<p>The Geolocation API has very good browser support, so you don’t need to check for feature support unless you are targeting old browsers.</p>&#13;
&#13;
<p>In addition to the coordinates, the <code>position</code> object contains some other interesting information that may not be available on all devices:</p>&#13;
<dl>&#13;
<dt><code>altitude</code></dt>&#13;
<dd>&#13;
<p>The device’s altitude above sea level, in meters</p>&#13;
</dd>&#13;
<dt><code>heading</code></dt>&#13;
<dd>&#13;
<p>The device’s compass heading, in degrees</p>&#13;
</dd>&#13;
<dt><code>speed</code></dt>&#13;
<dd>&#13;
<p>The velocity of the device, if it is moving, in meters per second</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>You can also watch for changes in the device’s location by calling <code>navigator.geolocation.watchCurrentPosition</code>. The browser calls the callback that you pass to this method periodically when the location changes, providing updated coordinates.</p>&#13;
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id1157">&#13;
<h1>Geolocation Versus Geocoding</h1>&#13;
<p><a data-primary="geolocation, geocoding versus" data-type="indexterm" id="id1158"/>The Geolocation API can only get the device’s coordinates (latitude and longitude). It can’t determine the state, city, or specific address you are at. For this, you need a <em>geocoding</em> API, which is not built into the browser. There are many external geocoding APIs available from vendors such as Microsoft and Google. Geocoding is the process of taking an address and converting it to latitude and longitude. <a data-primary="reverse geocoding" data-type="indexterm" id="id1159"/>Some of these services can also do <em>reverse geocoding</em>, which takes latitude and longitude coordinates and converts them into an address<a data-startref="ix_14-device-integration-asciidoc5" data-type="indexterm" id="id1160"/><a data-startref="ix_14-device-integration-asciidoc4" data-type="indexterm" id="id1161"/><a data-startref="ix_14-device-integration-asciidoc3" data-type="indexterm" id="id1162"/>.</p>&#13;
</div></aside>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Showing the Device Location on a Map" data-type="sect1"><div class="sect1" id="id593">&#13;
<h1>Showing the Device Location on a Map</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id205">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="device integration" data-secondary="showing device location on a map" data-type="indexterm" id="ix_14-device-integration-asciidoc6"/><a data-primary="Google Maps API" data-type="indexterm" id="ix_14-device-integration-asciidoc7"/><a data-primary="location,of device" data-secondary="showing on a map" data-type="indexterm" id="ix_14-device-integration-asciidoc8"/>You want to show a map of the device’s location.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id594">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a service like Google Maps API or OpenStreetMaps to generate a map, passing the latitude and longitude coordinates from the Geolocation API.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>For this recipe, you need to sign up for a Google Maps API key. You can find instructions to sign up for an API key <a href="https://oreil.ly/9Uujk">on the Google Developers website</a>.</p>&#13;
</div>&#13;
&#13;
<p>This example shows how to embed a map with the Google Maps Embed API. You can use the Google Maps Embed API by embedding an <code>iframe</code> element with a specially crafted URL. The URL must contain:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>The type of map (for this example, you need a <code>place</code> map)</p>&#13;
</li>&#13;
<li>&#13;
<p>Your API key</p>&#13;
</li>&#13;
<li>&#13;
<p>The geolocation coordinates</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>Request the device location, and in the success callback you can create the <code>iframe</code> and add it to the document (see <a data-type="xref" href="#example14-8">Example 14-8</a>.</p>&#13;
<div data-type="example" id="example14-8">&#13;
<h5><span class="label">Example 14-8. </span>Creating a map iframe</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// Assuming you have a placeholder element in the page with the ID 'map'</code>&#13;
<code class="kr">const</code> <code class="nx">map</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#map'</code><code class="p">);</code>&#13;
&#13;
<code class="nx">navigator</code><code class="p">.</code><code class="nx">geolocation</code><code class="p">.</code><code class="nx">getCurrentPosition</code><code class="p">(</code><code class="nx">position</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="p">{</code> <code class="nx">latitude</code><code class="p">,</code> <code class="nx">longitude</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">position</code><code class="p">.</code><code class="nx">coords</code><code class="p">;</code>&#13;
&#13;
  <code class="c1">// Adjust the iframe size as desired.</code>&#13;
  <code class="kr">const</code> <code class="nx">iframe</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'iframe'</code><code class="p">);</code>&#13;
  <code class="nx">iframe</code><code class="p">.</code><code class="nx">width</code> <code class="o">=</code> <code class="mi">450</code><code class="p">;</code>&#13;
  <code class="nx">iframe</code><code class="p">.</code><code class="nx">height</code> <code class="o">=</code> <code class="mi">250</code><code class="p">;</code>&#13;
&#13;
  <code class="c1">// The map type is part of the URL path.</code>&#13;
  <code class="kr">const</code> <code class="nx">url</code> <code class="o">=</code> <code class="k">new</code> <code class="nx">URL</code><code class="p">(</code><code class="s1">'https://www.google.com/maps/embed/v1/place'</code><code class="p">);</code>&#13;
&#13;
  <code class="c1">// The 'key' parameter contains your API key.</code>&#13;
  <code class="nx">url</code><code class="p">.</code><code class="nx">searchParams</code><code class="p">.</code><code class="nx">append</code><code class="p">(</code><code class="s1">'key'</code><code class="p">,</code> <code class="s1">'YOUR_GOOGLE_MAPS_API_KEY'</code><code class="p">);</code>&#13;
&#13;
  <code class="c1">// The 'q' parameter contains the latitude and longitude coordinates</code>&#13;
  <code class="c1">// separated by a comma.</code>&#13;
  <code class="nx">url</code><code class="p">.</code><code class="nx">searchParams</code><code class="p">.</code><code class="nx">append</code><code class="p">(</code><code class="s1">'q'</code><code class="p">,</code> <code class="sb">`</code><code class="si">${</code><code class="nx">latitude</code><code class="si">}</code><code class="sb">,</code><code class="si">${</code><code class="nx">longitude</code><code class="si">}</code><code class="sb">`</code><code class="p">);</code>&#13;
  <code class="nx">iframe</code><code class="p">.</code><code class="nx">src</code> <code class="o">=</code> <code class="nx">url</code><code class="p">;</code>&#13;
&#13;
  <code class="nx">map</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">iframe</code><code class="p">);</code>&#13;
<code class="p">});</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id206">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>See <a href="https://oreil.ly/WhO-r">this article from Google</a> to learn more about properly securing a Google Maps API key.</p>&#13;
&#13;
<p>This is just one of many possible map integrations you can use once you have received the device’s location. Google Maps has other types of APIs, and there are other services such as Mapbox or OpenStreetMap. You can also integrate a geocoding API to show a map marker with the actual address<a data-startref="ix_14-device-integration-asciidoc8" data-type="indexterm" id="id1163"/><a data-startref="ix_14-device-integration-asciidoc7" data-type="indexterm" id="id1164"/><a data-startref="ix_14-device-integration-asciidoc6" data-type="indexterm" id="id1165"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Copying and Pasting Text" data-type="sect1"><div class="sect1" id="id595">&#13;
<h1>Copying and Pasting Text</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id207">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="Clipboard API" data-type="indexterm" id="ix_14-device-integration-asciidoc9"/><a data-primary="copying and pasting text" data-type="indexterm" id="ix_14-device-integration-asciidoc10"/><a data-primary="device integration" data-secondary="copying and pasting text" data-type="indexterm" id="ix_14-device-integration-asciidoc11"/><a data-primary="text" data-secondary="copying and pasting" data-type="indexterm" id="ix_14-device-integration-asciidoc12"/>Within a text area, you want to add copy and paste functionality. The user should be able to highlight some text and copy it, and when pasting, it should replace whatever text is selected.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id596">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the Clipboard API to interact with the selected text within the text area. You can add Copy and Paste buttons to your UI that call the corresponding functionality in the Clipboard API.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be fully supported by all browsers yet. See <a href="https://oreil.ly/4i7sm">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
&#13;
<p>To copy the text, get the selection start and end indexes and take that substring of the text area’s value. Then, write that text to the system clipboard (see <a data-type="xref" href="#example14-9">Example 14-9</a>).</p>&#13;
<div data-type="example" id="example14-9">&#13;
<h5><span class="label">Example 14-9. </span>Copying text from a selection</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">async</code> <code class="kd">function</code> <code class="nx">copySelection</code><code class="p">(</code><code class="nx">textarea</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="p">{</code> <code class="nx">selectionStart</code><code class="p">,</code> <code class="nx">selectionEnd</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">textarea</code><code class="p">;</code>&#13;
  <code class="kr">const</code> <code class="nx">selectedText</code> <code class="o">=</code> <code class="nx">textarea</code><code class="p">.</code><code class="nx">value</code><code class="p">.</code><code class="nx">slice</code><code class="p">(</code><code class="nx">selectionStart</code><code class="p">,</code> <code class="nx">selectionEnd</code><code class="p">);</code>&#13;
&#13;
  <code class="k">try</code> <code class="p">{</code>&#13;
    <code class="nx">await</code> <code class="nx">navigator</code><code class="p">.</code><code class="nx">clipboard</code><code class="p">.</code><code class="nx">writeText</code><code class="p">(</code><code class="nx">selectedText</code><code class="p">);</code>&#13;
  <code class="p">}</code> <code class="k">catch</code> <code class="p">(</code><code class="nx">error</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nx">console</code><code class="p">.</code><code class="nx">error</code><code class="p">(</code><code class="s1">'Clipboard error:'</code><code class="p">,</code> <code class="nx">error</code><code class="p">);</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>Pasting is similar, but there’s an extra step. If there is text selected within the text area, you need to remove the selected text and splice in the new text from the clipboard  (see <a data-type="xref" href="#example14-10">Example 14-10</a>). The Clipboard API is asynchronous, so you’ll need to wait on a <code>Promise</code> to receive the value in the system clipboard.</p>&#13;
<div data-type="example" id="example14-10">&#13;
<h5><span class="label">Example 14-10. </span>Pasting text into a selection</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">async</code> <code class="kd">function</code> <code class="nx">pasteToSelection</code><code class="p">(</code><code class="nx">textarea</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="kr">const</code> <code class="nx">currentValue</code> <code class="o">=</code> <code class="nx">textarea</code><code class="p">.</code><code class="nx">value</code><code class="p">;</code>&#13;
  <code class="kr">const</code> <code class="p">{</code> <code class="nx">selectionStart</code><code class="p">,</code> <code class="nx">selectionEnd</code> <code class="p">}</code> <code class="o">=</code> <code class="nx">textarea</code><code class="p">;</code>&#13;
&#13;
  <code class="k">try</code> <code class="p">{</code>&#13;
    <code class="kr">const</code> <code class="nx">clipboardValue</code> <code class="o">=</code> <code class="nx">await</code> <code class="nx">navigator</code><code class="p">.</code><code class="nx">clipboard</code><code class="p">.</code><code class="nx">readText</code><code class="p">();</code>&#13;
    <code class="kr">const</code> <code class="nx">newValue</code> <code class="o">=</code> <code class="nx">currentValue</code><code class="p">.</code><code class="nx">slice</code><code class="p">(</code><code class="mi">0</code><code class="p">,</code> <code class="nx">selectionStart</code><code class="p">)</code>&#13;
    <code class="o">+</code> <code class="nx">clipboardValue</code> <code class="o">+</code> <code class="nx">currentValue</code><code class="p">.</code><code class="nx">slice</code><code class="p">(</code><code class="nx">selectionEnd</code><code class="p">);</code>&#13;
    <code class="nx">textarea</code><code class="p">.</code><code class="nx">value</code> <code class="o">=</code> <code class="nx">newValue</code><code class="p">;</code>&#13;
  <code class="p">}</code> <code class="k">catch</code> <code class="p">(</code><code class="nx">error</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="nx">console</code><code class="p">.</code><code class="nx">error</code><code class="p">(</code><code class="s1">'Clipboard error:'</code><code class="p">,</code> <code class="nx">error</code><code class="p">);</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>This replaces the currently selected text with the text from the clipboard.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id208">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Note that even though you aren’t doing anything with the return value of <code>navigator.clipboard.writeText</code>, you are still awaiting the <code>Promise</code>. This is because you need to handle the case when the <code>Promise</code> is rejected with an error.</p>&#13;
&#13;
<p>Also, when pasting, there are two other scenarios to be aware of:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>If no text is selected but the text area has focus, the text is pasted at the cursor position.</p>&#13;
</li>&#13;
<li>&#13;
<p>If the text area does not have focus, the text is pasted at the end of the text area’s value.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>As you might expect, reading from the system clipboard programmatically can be a privacy concern. As such, it requires user permission. The first time you try to read from the clipboard, the browser asks the user for permission. If they allow it, the &#13;
<span class="keep-together">clipboard</span> operation completes. If they deny the permission, the <code>Promise</code> returned by the Clipboard API is rejected with an error.</p>&#13;
&#13;
<p>If you want to avoid permission errors, you can use the Permissions API to check if the user has granted permission to read from the system clipboard (see <a data-type="xref" href="#example14-11">Example 14-11</a>).</p>&#13;
<div data-type="example" id="example14-11">&#13;
<h5><span class="label">Example 14-11. </span>Checking clipboard read permission</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">permission</code> <code class="o">=</code> <code class="nx">await</code> <code class="nx">navigator</code><code class="p">.</code><code class="nx">permissions</code><code class="p">.</code><code class="nx">query</code><code class="p">({</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'clipboard-read'</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="k">if</code> <code class="p">(</code><code class="nx">permission</code><code class="p">.</code><code class="nx">state</code> <code class="o">!==</code> <code class="s1">'denied'</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="c1">// Continue with the clipboard read operation.</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>The three possible values for <code>permission.state</code> are:</p>&#13;
<dl>&#13;
<dt><code>granted</code></dt>&#13;
<dd>&#13;
<p>The user has already explicitly granted permission.</p>&#13;
</dd>&#13;
<dt><code>denied</code></dt>&#13;
<dd>&#13;
<p>The user has already explicitly denied permission.</p>&#13;
</dd>&#13;
<dt><code>prompt</code></dt>&#13;
<dd>&#13;
<p>The user has not been asked for permission yet.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>If <code>permission.state</code> has the value <code>prompt</code>, the browser automatically prompts the user the first time you attempt to perform a clipboard read operation<a data-startref="ix_14-device-integration-asciidoc12" data-type="indexterm" id="id1166"/><a data-startref="ix_14-device-integration-asciidoc11" data-type="indexterm" id="id1167"/><a data-startref="ix_14-device-integration-asciidoc10" data-type="indexterm" id="id1168"/><a data-startref="ix_14-device-integration-asciidoc9" data-type="indexterm" id="id1169"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Sharing Content with the Web Share API" data-type="sect1"><div class="sect1" id="id597">&#13;
<h1>Sharing Content with the Web Share API</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id209">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="device integration" data-secondary="sharing content with Web Share API" data-type="indexterm" id="id1170"/><a data-primary="Web Share API" data-type="indexterm" id="id1171"/>You want to give the user an easy way to share a link using the native sharing capabilities of their device.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id598">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the Web Share API to share the content.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/1IwEq">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
&#13;
<p>Call <code>navigator.share</code> and pass an object containing the title and URL (see <a data-type="xref" href="#example14-12">Example 14-12</a>). On supported devices and browsers, this brings up a familiar sharing interface that allows them to share the link in various ways.</p>&#13;
<div data-type="example" id="example14-12">&#13;
<h5><span class="label">Example 14-12. </span>Sharing a link</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="k">if</code> <code class="p">(</code><code class="s1">'share'</code> <code class="k">in</code> <code class="nx">navigator</code><code class="p">)</code> <code class="p">{</code>&#13;
  <code class="nx">navigator</code><code class="p">.</code><code class="nx">share</code><code class="p">({</code>&#13;
    <code class="nx">title</code><code class="o">:</code> <code class="s1">'Web API Cookbook'</code><code class="p">,</code>&#13;
    <code class="nx">text</code><code class="o">:</code> <code class="s1">'Check out this awesome site!'</code><code class="p">,</code>&#13;
    <code class="nx">url</code><code class="o">:</code> <code class="s1">'https://browserapis.dev'</code>&#13;
  <code class="p">});</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>From here, the user can create a text message, email, or other communication containing a link to the content.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id599">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>The sharing interface looks different depending on the device and operating system. For example, <a data-type="xref" href="#figure_share">Figure 14-1</a> is a screenshot of the sharing interface on my computer running macOS 14.</p>&#13;
&#13;
<figure class="width-35"><div class="figure" id="figure_share">&#13;
<img alt="The share interface on macOS 14" src="assets/wacb_1401.png"/>&#13;
<h6><span class="label">Figure 14-1. </span>The share interface on macOS 14</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Making the Device Vibrate" data-type="sect1"><div class="sect1" id="id600">&#13;
<h1>Making the Device Vibrate</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id210">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="device integration" data-secondary="vibration" data-type="indexterm" id="ix_14-device-integration-asciidoc13"/><a data-primary="tactile feedback" data-type="indexterm" id="ix_14-device-integration-asciidoc14"/><a data-primary="Vibration API" data-type="indexterm" id="id1172"/>You want to add some tactile feedback to your app, making the user’s device vibrate.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id601">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the Vibration API to programmatically vibrate the device.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/G0d6m">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
&#13;
<p>To perform a single vibration, you can call <code>navigator.vibrate</code> with a single integer argument (the duration of the vibration), as shown in <a data-type="xref" href="#example14-13">Example 14-13</a>.</p>&#13;
<div data-type="example" id="example14-13">&#13;
<h5><span class="label">Example 14-13. </span>Triggering a single vibration</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// A single vibration for 500ms</code>&#13;
<code class="nx">navigator</code><code class="p">.</code><code class="nx">vibrate</code><code class="p">(</code><code class="mi">500</code><code class="p">);</code></pre></div>&#13;
&#13;
<p>You can also trigger a sequence of vibrations by passing an array to <code>navigator.vibrate</code> (see <a data-type="xref" href="#example14-14">Example 14-14</a>). The elements of the array are interpreted as a sequence of vibrations and pauses.</p>&#13;
<div data-type="example" id="example14-14">&#13;
<h5><span class="label">Example 14-14. </span>Vibrating three times</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// Vibrate for 500ms three times, with a 250ms pause in between</code>&#13;
<code class="nx">navigator</code><code class="p">.</code><code class="nx">vibrate</code><code class="p">([</code><code class="mi">500</code><code class="p">,</code> <code class="mi">250</code><code class="p">,</code> <code class="mi">500</code><code class="p">,</code> <code class="mi">250</code><code class="p">,</code> <code class="mi">500</code><code class="p">]);</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id211">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>This API is supported on some devices that don’t vibrate, for example Chrome on a MacBook Pro. For these devices, calling <code>navigator.vibrate</code> has no effect, but it also won’t throw any error.</p>&#13;
&#13;
<p>If a sequence of vibrations is running, you can call <code>navigator.vibrate(0)</code> to cancel any in-progress vibrations.</p>&#13;
&#13;
<p>Like autoplaying videos, you can’t trigger vibration automatically when the page first loads. The user must have interacted with the page in some way before vibration can be done<a data-startref="ix_14-device-integration-asciidoc14" data-type="indexterm" id="id1173"/><a data-startref="ix_14-device-integration-asciidoc13" data-type="indexterm" id="id1174"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Getting the Device Orientation" data-type="sect1"><div class="sect1" id="id602">&#13;
<h1>Getting the Device Orientation</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id212">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="device integration" data-secondary="getting orientation" data-type="indexterm" id="id1175"/><a data-primary="orientation, of device" data-type="indexterm" id="id1176"/>You want to determine if the device is in portrait or landscape orientation.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id603">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the <code>screen.orientation.type</code> property to get the device orientation, or use the <code>screen.orientation.angle</code> property to get the device’s orientation angle relative to its natural orientation.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id213">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><code>screen.orientation.type</code> can have one of four values, depending on the device and its orientation (see <a data-type="xref" href="#figure_orientation">Figure 14-2</a>):</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>portrait-primary</code>: 0 degrees (the natural device position)</p>&#13;
</li>&#13;
<li>&#13;
<p><code>portrait-secondary</code>: 180 degrees</p>&#13;
</li>&#13;
<li>&#13;
<p><code>landscape-primary</code>: 90 degrees</p>&#13;
</li>&#13;
<li>&#13;
<p><code>landscape-secondary</code>: 270 degrees</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<figure><div class="figure" id="figure_orientation">&#13;
<img alt="The different orientation values" src="assets/wacb_1402.png"/>&#13;
<h6><span class="label">Figure 14-2. </span>The different orientation values</h6>&#13;
</div></figure>&#13;
&#13;
<p>The preceding values are for devices such as phones, whose natural orientation is portrait. For other devices whose natural orientation is landscape, like some tablets, the values are reversed:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>landscape-primary</code>: 0 degrees (the natural device position)</p>&#13;
</li>&#13;
<li>&#13;
<p><code>landscape-secondary</code>: 180 degrees</p>&#13;
</li>&#13;
<li>&#13;
<p><code>portrait-primary</code>: 90 degrees</p>&#13;
</li>&#13;
<li>&#13;
<p><code>portrait-secondary</code>: 270 degrees</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>The <code>screen.orientation</code> object also has a <code>change</code> event you can listen for to be notified of changes in the device orientation.<a data-startref="ix_14-device-integration-asciidoc0" data-type="indexterm" id="id1177"/></p>&#13;
</div></section>&#13;
</div></section>&#13;
</div></section></body></html>