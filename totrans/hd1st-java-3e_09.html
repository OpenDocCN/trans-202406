<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 7. Better Living in Objectville: Inheritance and Polymorphism"><div class="chapter" id="better_living_in_objectville_inheritance">
<h1><span class="label">Chapter 7. </span>Better Living in Objectville: Inheritance and Polymorphism</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0167-01.png" alt="image" width="803" height="650"/>
<h6/>
</div></figure>
<p><strong>Plan your programs with the future in mind.</strong> If there were a way to write Java code such that you could take more vacations, how much would it be worth to you? What if you could write code that someone <em>else</em> could extend, <strong>easily</strong>? And if you could write code that was flexible, for those pesky last-minute spec changes, would that be something you’d be interested in? Then this is your lucky day. For just three easy payments of 60 minutes time, you can have all this. When you get on the Polymorphism Plan, you’ll learn the 5 steps to better class design, the 3 tricks to polymorphism, the 8 ways to make flexible code, and if you act now—a bonus lesson on the 4 tips for exploiting inheritance. Don’t delay, an offer this good will give you the design freedom and programming flexibility you deserve. It’s quick, it’s easy, and it’s available now. Start today, and we’ll throw in an extra level of abstraction!</p>
<section data-type="sect1" data-pdf-bookmark="Chair Wars Revisited..."><div class="sect1" id="chair_wars_revisitedhellip">
<h1>Chair Wars Revisited...</h1>
<p><a data-type="indexterm" data-primary="Chair Wars scenario" id="idm46038394832096"/><a data-type="indexterm" data-primary="inheritance" data-seealso="polymorphism" id="idm46038395336416"/><a data-type="indexterm" data-primary="OO (object-oriented) development" data-secondary="inheritance" id="idm46038395334896"/><a data-type="indexterm" data-primary="subclasses" id="idm46038395332848"/><a data-type="indexterm" data-primary="superclass" id="idm46038395331520"/><strong><em>Remember way back in <a data-type="xref" href="ch02.xhtml#a_trip_to_objectville_classes_and_object">Chapter 2</a>, when Laura (procedural programmer) and Brad (OO developer) were vying for the Aeron chair? Let’s look at a few pieces of that story to review the basics of inheritance.</em></strong></p>
<p><strong>LAURA:</strong> You’ve got duplicated code! The rotate procedure is in all four Shape things. It’s a stupid design. You have to maintain four different rotate “methods.” How can that ever be good?</p>
<p><strong>BRAD:</strong> Oh, I guess you didn’t see the final design. Let me show you how OO <strong>inheritance</strong> works, Laura.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0168-01.png" alt="image" width="1476" height="1026"/>
<h6/>
</div></figure>
<p>You can read this as <strong>“Square inherits from Shape”, “Circle inherits from Shape”</strong> and so on. I removed rotate() and playSound() from the other shapes, so now there’s only one copy to maintain.</p>
<p>The Shape class is called the <strong>superclass</strong> of the other four classes. The other four are the <strong>subclasses</strong> of Shape. The subclasses inherit the methods of the superclass. In other words, <em>if the Shape class has the functionality, then the subclasses automatically get that same functionality.</em></p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="What about the Amoeba rotate()?"><div class="sect1" id="what_about_the_amoeba_rotateleft-id00001">
<h1>What about the Amoeba rotate()?</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0169-01.png" alt="image" width="145" height="138"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="instance variables" data-secondary="subclass" id="idm46038394807168"/><a data-type="indexterm" data-primary="overriding methods" id="idm46038394805968"/><a data-type="indexterm" data-primary="overriding methods" data-secondary="superclass" id="idm46038394805136"/><strong>LAURA:</strong> Wasn’t that the whole problem here—that the Amoeba shape had a completely different rotate and playSound procedure?</p>
<p>How can Amoeba do something different if it <em>inherits</em> its functionality from the Shape class?</p>
<p><strong>BRAD:</strong> That’s the last step. The Amoeba class <strong><em>overrides</em></strong> any methods of the Shape class that need specific amoeba behavior. Then at runtime, the JVM knows exactly which rotate() method to run when someone tells the Amoeba to rotate.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0169-02.png" alt="image" width="1006" height="449"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-id00002">
<h5>Brain Power</h5>
<figure class="informal"><div class="figure">
<img src="Images/brain.png" alt="image" width="80" height="71"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0169-03.png" alt="image" width="205" height="295"/>
<h6/>
</div></figure>
<p>How would you represent a house cat and a tiger, in an inheritance structure? Is a domestic cat a specialized version of a tiger? Which would be the subclass, and which would be the superclass? Or are they both subclasses to some <em>other</em> class?</p>
<p>How would you design an inheritance structure? What methods would be overridden?</p>
<p>Think about it. <em>Before</em> you turn the page.</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Understanding Inheritance"><div class="sect1" id="understanding_inheritance">
<h1>Understanding Inheritance</h1>
<p>When you design with inheritance, you put common code in a class and then tell other more specific classes that the common (more abstract) class is their superclass. When one class inherits from another, <strong>the subclass inherits from the superclass.</strong></p>
<p>In Java, we say that the <strong>subclass <em>extends</em> the superclass</strong>. An inheritance relationship means that the subclass inherits the <strong>members</strong> of the superclass. When we say “members of a class,” we mean the instance variables and methods. For example if PantherMan is a subclass of SuperHero, the PantherMan class automatically inherits the instance variables and methods common to all superheroes including <code>suit, tights, specialPower, useSpecialPower()</code>, and so on. But the PantherMan <strong>subclass can add new methods and instance variables of its own, and it can override the methods it inherits from the superclass</strong> SuperHero.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0170-01.png" alt="image" width="616" height="477"/>
<h6/>
</div></figure>
<p>FriedEggMan doesn’t need any behavior that’s unique, so he doesn’t override any methods. The methods and instance variables in SuperHero are sufficient. PantherMan, though, has specific requirements for his suit and special powers, so <code>useSpecialPower()</code> and <code>putOnSuit()</code> are both overridden in the PantherMan class.</p>
<p><strong>Instance variables are not overridden</strong> because they don’t need to be. They don’t define any special behavior, so a subclass can give an inherited instance variable any value it chooses. PantherMan can set his inherited <code>tights</code> to purple, while FriedEggMan sets his to white.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="An inheritance example:"><div class="sect1" id="an_inheritance_example">
<h1>An inheritance example:</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0171-01.png" alt="image" width="542" height="691"/>
<h6/>
</div></figure>
<pre data-type="programlisting">public class Doctor {

  boolean worksAtHospital;

  void treatPatient() {

    // perform a checkup
  }
}</pre>
<hr/>
<pre data-type="programlisting">public class FamilyDoctor extends Doctor {

  boolean makesHouseCalls;

  void giveAdvice() {
    // give homespun advice
  }
}</pre>
<hr/>
<pre data-type="programlisting">public class Surgeon extends Doctor {

  void treatPatient() {
    // perform surgery
  }

  void makeIncision() {
    // make incision (yikes!)
  }
}</pre>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-id00013">
<h5>Sharpen your pencil</h5>
<figure class="informal"><div class="figure">
<img src="Images/pencil.png" alt="image" width="122" height="80"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0171-02.png" alt="image" width="644" height="441"/>
<h6/>
</div></figure>
<p>How many instance variables does Surgeon have? _________</p>
<p>How many instance variables does FamilyDoctor have? ___________</p>
<p>How many methods does Doctor have? ___________</p>
<p>How many methods does Surgeon have? ___________</p>
<p>How many methods does FamilyDoctor have? ___________</p>
<p>Can a FamilyDoctor do treatPatient()? ___________</p>
<p>Can a FamilyDoctor do makeIncision()?</p>
<p><span class="inlineimage"><img src="Images/arr1.png" alt="Images" width="137" height="12"/></span> <strong>Yours to solve.</strong></p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Let’s design the inheritance tree for an Animal simulation program"><div class="sect1" id="letapostrophes_design_the_inheritance_tr">
<h1>Let’s design the inheritance tree for an Animal simulation program</h1>
<p><a data-type="indexterm" data-primary="Animal simulation program" id="idm46038394765424"/><a data-type="indexterm" data-primary="inheritance" data-secondary="Animal simulation program" id="idm46038394764656"/>Imagine you’re asked to design a simulation program that lets the user throw a bunch of different animals into an environment to see what happens. We don’t have to code the thing now; we’re mostly interested in the design.</p>
<p>We’ve been given a list of <em>some</em> of the animals that will be in the program, but not all. We know that each animal will be represented by an object and that the objects will move around in the environment, doing whatever it is that each particular type is programmed to do.</p>
<p><strong><em>And we want other programmers to be able to add new kinds of animals to the program at any time.</em></strong></p>
<p>First we have to figure out the common, abstract characteristics that all animals have, and build those characteristics into a class that all animal classes can extend.</p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1circlea.png" alt="Images" width="23" height="23"/></span> Look for objects that have common attributes and behaviors.</p>
<p><strong>What do these six types have in common? This helps you to abstract out behaviors. (step 2)</strong></p>
<p><strong>How are these types related? This helps you to define the inheritance tree relationships (steps 4-5)</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0172-01.png" alt="image" width="988" height="522"/>
<h6/>
</div></figure>
</li>
</ul>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Using inheritance to avoid duplicating code in subclasses"><div class="sect1" id="using_inheritance_to_avoid_duplicating_c">
<h1>Using inheritance to avoid duplicating code in subclasses</h1>
<p><a data-type="indexterm" data-primary="classes" data-secondary="Animal simulation program" id="idm46038394757488"/><a data-type="indexterm" data-primary="instance variables" data-secondary="Animal simulation program" id="idm46038394756544"/><a data-type="indexterm" data-primary="methods" data-secondary="Animal simulation program" id="idm46038394755472"/>We have five <strong><em>instance variables:</em></strong></p>
<p><strong><em>picture</em></strong> – the filename representing the JPEG of this animal.</p>
<p><strong><em>food</em></strong> – the type of food this animal eats. Right now, there can be only two values: <em>meat</em> or <em>grass</em>.</p>
<p><strong><em>hunger</em></strong> – an int representing the hunger level of the animal. It changes depending on when (and how much) the animal eats.</p>
<p><strong><em>boundaries</em></strong> – values representing the height and width of the “space” (for example, 640 x 480) that the animals will roam around in.</p>
<p><strong><em>location</em></strong> – the X and Y coordinates for where the animal is in the space.</p>
<p>We have four <em><strong>methods:</strong></em></p>
<p><strong><em>makeNoise()</em></strong> – behavior for when the animal is supposed to make noise.</p>
<p><strong><em>eat()</em></strong> – behavior for when the animal encounters its preferred food source, <em>meat</em> or <em>grass</em>.</p>
<p><strong><em>sleep()</em></strong> – behavior for when the animal is considered asleep.</p>
<p><strong><em>roam()</em></strong> – behavior for when the animal is not eating or sleeping (probably just wandering around waiting to bump into a food source or a boundary).</p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1circleb.png" alt="Images" width="23" height="23"/></span> Design a class that represents the common state and behavior.</p></li>
</ul>
<p><strong>These objects are all animals, so we’ll make a common superclass called Animal.</strong></p>
<p><strong>We’ll put in methods and instance variables that all animals might need.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0173-01.png" alt="image" width="787" height="766"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Do all animals eat the same way?"><div class="sect1" id="do_all_animals_eat_the_same_wayquestion">
<h1>Do all animals eat the same way?</h1>
<p><a data-type="indexterm" data-primary="classes" data-secondary="Animal simulation program" id="idm46038394735248"/><a data-type="indexterm" data-primary="instance variables" data-secondary="Animal simulation program" id="idm46038394734272"/><a data-type="indexterm" data-primary="subclasses" data-secondary="method implementation designs for" id="idm46038394733296"/>Assume that we all agree on one thing: the instance variables will work for <em>all</em> Animal types. A lion will have his own value for picture, food (we’re thinking <em>meat</em>), hunger, boundaries, and location. A hippo will have different <em>values</em> for his instance variables, but he’ll still have the same variables that the other Animal types have. Same with dog, tiger, and so on. But what about <em>behavior</em>?</p>
<section data-type="sect2" data-pdf-bookmark="Which methods should we override?"><div class="sect2" id="which_methods_should_we_overridequestion">
<h2>Which methods should we override?</h2>
<p>Does a lion make the same <strong>noise</strong> as a dog? Does a cat <strong>eat</strong> like a hippo? Maybe in <em>your</em> version, but in ours, eating and making noise are Animal-type-specific. We can’t figure out how to code those methods in such a way that they’d work for any animal. OK, that’s not true. We could write the makeNoise() method, for example, so that all it does is play a sound file defined in an instance variable for that type, but that’s not very specialized. Some animals might make different noises for different situations (like one for eating, and another when bumping into an enemy, etc.)</p>
<p>So just as with the Amoeba overriding the Shape class rotate() method, to get more amoeba-specific (in other words, <em>unique</em>) behavior, we’ll have to do the same for our Animal subclasses.</p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1circlec.png" alt="Images" width="23" height="23"/></span> Decide if a subclass needs behaviors (method implementations) that are specific to that particular subclass type.</p>
<p><strong>Looking at the Animal class, we decide that eat() and makeNoise() should be overridden by the individual subclasses.</strong></p></li>
</ul>
<figure class="informal"><div class="figure">
<img src="Images/f0174-01.png" alt="image" width="573" height="343"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0174-02.png" alt="image" width="723" height="308"/>
<h6/>
</div></figure>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Looking for more inheritance opportunities"><div class="sect1" id="looking_for_more_inheritance_opportuniti">
<h1>Looking for more inheritance opportunities</h1>
<p><a data-type="indexterm" data-primary="classes" data-secondary="hierarchy design with inheritance" id="idm46038394710944"/><a data-type="indexterm" data-primary="subclasses" data-secondary="method implementation designs for" id="idm46038394709616"/>The class hierarchy is starting to shape up. We have each subclass override the <em>makeNoise()</em> and <em>eat()</em> methods so that there’s no mistaking a Dog bark from a Cat meow (quite insulting to both parties). And a Hippo won’t eat like a Lion.</p>
<p>But perhaps there’s more we can do. We have to look at the subclasses of Animal and see if two or more can be grouped together in some way, and given code that’s common to only <em>that</em> new group. Wolf and Dog have similarities. So do Lion, Tiger, and Cat.</p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1circled.png" alt="Images" width="23" height="23"/></span> Look for more opportunities to use abstraction, by finding two or more <em>subclasses</em> that might need common behavior.</p>
<p><strong>We look at our classes and see that Wolf and Dog might have some behavior in common, and the same goes for Lion, Tiger, and Cat.</strong></p></li>
</ul>
<figure class="informal"><div class="figure">
<img src="Images/f0175-01.png" alt="image" width="932" height="766"/>
<h6/>
</div></figure>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1circlee.png" alt="Images" width="23" height="23"/></span> Finish the class hierarchy</p>
<p>Since animals already have an organizational hierarchy (the whole kingdom, genus, phylum thing), we can use the level that makes the most sense for class design. We’ll use the biological “families” to organize the animals by making a Feline class and a Canine class.</p>
<p><strong>We decide that Canines could use a common roam() method, because they tend to move in packs. We also see that Felines could use a common roam() method, because they tend to avoid others of their own kind. We’ll let Hippo continue to use its inherited roam() method— the generic one it gets from Animal.</strong></p>
<p><strong>So we’re done with the design for now; we’ll come back to it later in the chapter.</strong></p></li>
</ul>
<figure class="informal"><div class="figure">
<img src="Images/f0176-01.png" alt="image" width="888" height="1127"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Which method is called?"><div class="sect1" id="which_method_is_calledquestion_mark">
<h1>Which method is called?</h1>
<p><a data-type="indexterm" data-primary="methods" data-secondary="working with inheritance" id="idm46038394703616"/><a data-type="indexterm" data-primary="virtual method invocation" id="idm46038394691056"/>The Wolf class has four methods. One inherited from Animal, one inherited from Canine (which is actually an overridden version of a method in class Animal), and two overridden in the Wolf class. When you create a Wolf object and assign it to a variable, you can use the dot operator on that reference variable to invoke all four methods. But which <em>version</em> of those methods gets called?</p>
<figure class="informal"><div class="figure">
<img src="Images/f0177-01.png" alt="image" width="904" height="718"/>
<h6/>
</div></figure>
<p>When you call a method on an object reference, you’re calling the most specific version of the method for that object type.</p>
<p>In other words, <strong><em>the lowest one wins!</em></strong></p>
<p>“Lowest” meaning lowest on the inheritance tree. Canine is lower than Animal, and Wolf is lower than Canine, so invoking a method on a reference to a Wolf object means the JVM starts looking first in the Wolf class. If the JVM doesn’t find a version of the method in the Wolf class, it starts walking back up the inheritance hierarchy until it finds a match.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Designing an Inheritance Tree"><div class="sect1" id="designing_an_inheritance_tree">
<h1>Designing an Inheritance Tree</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0178-02.png" alt="image" width="779" height="293"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0178-01.png" alt="image" width="399" height="271"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-id00014">
<h5>Sharpen your pencil</h5>
<figure class="informal"><div class="figure">
<img src="Images/f0178-03.png" alt="image" width="171" height="180"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="methods" data-secondary="inheritability" id="idm46038394676224"/>Draw an inheritance diagram here.</p>
<p>Find the relationships that make sense. Fill in the last two columns</p>
<figure class="informal"><div class="figure">
<img src="Images/f0178-04.png" alt="image" width="510" height="296"/>
<h6/>
</div></figure>
<p><em>Hint: not everything can be connected to something else.</em></p>
<p><em>Hint: you’re allowed to add to or change the classes listed.</em></p>
<p><span class="inlineimage"><img src="Images/arr1.png" alt="Images" width="137" height="12"/></span> <strong>Yours to solve.</strong></p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00011">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: You said that the JVM starts walking up the inheritance tree, starting at the class type you invoked the method on (like the Wolf example on the previous page). But what happens if the JVM doesn’t ever find a match?</strong></p>
<p><strong>A:</strong> Good question! But you don’t have to worry about that. The compiler guarantees that a particular method is callable for a specific reference type, but it doesn’t say (or care) from which <em>class</em> that method actually comes from at runtime. With the Wolf example, the compiler checks for a sleep() method but doesn’t care that sleep() is actually defined in (and inherited from) class Animal. Remember that if a class <em>inherits</em> a method, it <em>has</em> the method.</p>
<p><em>Where</em> the inherited method is defined (in other words, in which superclass it is defined) makes no difference to the compiler. But at runtime, <strong>the JVM will always pick the right one</strong>. And the right one means <strong><em>the most specific version for that particular object.</em></strong></p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Using IS-A and HAS-A"><div class="sect1" id="using_is-a_and_has-a">
<h1>Using IS-A and HAS-A</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0179-01.png" alt="image" width="621" height="803"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="HAS-A test for inheritance" id="idm46038394666800"/><a data-type="indexterm" data-primary="IS-A test" id="idm46038394665984"/><a data-type="indexterm" data-primary="subclasses" data-secondary="as extensions of superclass" id="idm46038394665248"/><a data-type="indexterm" data-primary="superclass" data-secondary="relationship to subclasses" id="idm46038394664208"/>Remember that when one class inherits from another, we say that the subclass <em>extends</em> the superclass. When you want to know if one thing should extend another, apply the IS-A test.</p>
<p>Triangle IS-A Shape, yeah, that works.</p>
<p>Cat IS-A Feline, that works too.</p>
<p>Surgeon IS-A Doctor, still good.</p>
<p>Tub extends Bathroom, sounds reasonable.</p>
<p><em>Until you apply the IS-A test.</em></p>
<p>To know if you’ve designed your types correctly, ask, “Does it make sense to say type X IS-A type Y?” If it doesn’t, you know there’s something wrong with the design, so if we apply the IS-A test, Tub IS-A Bathroom is definitely false.</p>
<p>What if we reverse it to Bathroom extends Tub? That still doesn’t work, Bathroom IS-A Tub doesn’t work.</p>
<p>Tub and Bathroom <em>are</em> related, but not through inheritance. Tub and Bathroom are joined by a HAS-A relationship. Does it make sense to say “Bathroom HAS-A Tub”? If yes, then it means that Bathroom has a Tub instance variable. In other words, Bathroom has a <em>reference</em> to a Tub, but Bathroom does not <em>extend</em> Tub and vice versa.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0179-02.png" alt="image" width="423" height="226"/>
<h6/>
</div></figure>
<p>Bathroom HAS-A Tub and Tub HAS-A Bubbles.</p>
<p>But nobody inherits from (extends) anybody else.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="But wait! There’s more!"><div class="sect1" id="but_waitexclamation_mark_therea-id00001">
<h1>But wait! There’s more!</h1>
<p>The IS-A test works <em>anywhere</em> in the inheritance tree. If your inheritance tree is well-designed, the IS-A test should make sense when you ask <em>any</em> subclass if it IS-A <em>any</em> of its supertypes.</p>
<p><strong>If class B extends class A, class B IS-A class A.</strong></p>
<p><strong>This is true anywhere in the inheritance tree. If class C extends class B, class C passes the IS-A test for both B <em>and</em> A.</strong></p>
<p>Canine extends Animal</p>
<p>Wolf extends Canine</p>
<p>Wolf extends Animal</p>
<p>Canine IS-A Animal</p>
<p>Wolf IS-A Canine</p>
<p>Wolf IS-A Animal</p>
<figure class="informal"><div class="figure">
<img src="Images/f0180-01.png" alt="image" width="171" height="712"/>
<h6/>
</div></figure>
<p>With an inheritance tree like the one shown here, you’re always allowed to say <strong>“Wolf extends Animal”</strong> or <strong>“Wolf IS-A Animal.”</strong> It makes no difference if Animal is the superclass of the superclass of Wolf. In fact, <strong>as long as Animal is <em>somewhere</em> in the inheritance hierarchy above Wolf, Wolf IS-A Animal will always be true.</strong></p>
<p>The structure of the Animal inheritance tree says to the world:</p>
<p>“Wolf IS-A Canine, so Wolf can do anything a Canine can do. And Wolf IS-A Animal, so Wolf can do anything an Animal can do.”</p>
<p>It makes no difference if Wolf overrides some of the methods in Animal or Canine. As far as the world (of other code) is concerned, a Wolf can do those four methods. <em>How</em> he does them, or <em>in which class they’re overridden</em>, makes no difference. A Wolf can makeNoise(), eat(), sleep(), and roam() because a Wolf extends from class Animal.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="How do you know if you’ve got your inheritance right?"><div class="sect1" id="how_do_you_know_if_youapostropheve_got_y">
<h1>How do you know if you’ve got your inheritance right?</h1>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="make_it_stick-id00001">
<h5>Make it Stick</h5>
<figure class="informal"><div class="figure">
<img src="Images/f0157-02.png" alt="image" width="212" height="200"/>
<h6/>
</div></figure>
<p><em>Roses are red, violets are blue.</em></p>
<p><em><strong>Square</strong> is-a <strong>Shape</strong>, the reverse isn’t true.</em></p>
<p><em>Roses are red, violets are dear.</em></p>
<p><em><strong>Beer</strong> is-a <strong>Drink</strong>, but not all <strong>drinks</strong> are <strong>beer.</strong></em></p>
<p>OK, your turn. Make one that shows the oneway-ness of the IS-A relationship. Remember, if <em>X <strong>extends Y, X IS-A</strong> Y</em> must make sense.</p>
</div></aside>
<p>There’s obviously more to it than what we’ve covered so far, but we’ll look at a lot more OO issues in the next chapter (where we eventually refine and improve on some of the design work we did in <em>this</em> chapter).</p>
<p>For now, though, a good guideline is to use the IS-A test. If “X IS-A Y” makes sense, both classes (X and Y) should probably live in the same inheritance hierarchy. Chances are, they have the same or overlapping behaviors.</p>
<p><strong>Keep in mind that the inheritance IS-A relationship works in only <em>one</em> direction!</strong></p>
<p>Triangle IS-A Shape makes sense, so you can have Triangle extend Shape.</p>
<p>But the reverse—Shape IS-A Triangle—does <em>not</em> make sense, so Shape should not extend Triangle. Remember that the IS-A relationship implies that if X IS-A Y, then X can do anything a Y can do (and possibly more).</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-id00015">
<h5>Sharpen your pencil</h5>
<figure class="informal"><div class="figure">
<img src="Images/pencil.png" alt="image" width="122" height="80"/>
<h6/>
</div></figure>
<p>Put a check next to the relationships that make sense.</p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>Oven extends Kitchen</strong></p></li>
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>Guitar extends Instrument</strong></p></li>
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>Person extends Employee</strong></p></li>
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>Ferrari extends Engine</strong></p></li>
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>FriedEgg extends Food</strong></p></li>
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>Beagle extends Pet</strong></p></li>
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>Container extends Jar</strong></p></li>
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>Metal extends Titanium</strong></p></li>
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>GratefulDead extends Band</strong></p></li>
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>Blonde extends Smart</strong></p></li>
<li><p><span class="inlineimage"><img src="Images/box.png" alt="Images" width="15" height="15"/></span> <strong>Beverage extends Martini</strong></p></li>
</ul>
</div></aside>
<p><span class="inlineimage"><img src="Images/arr1.png" alt="Images" width="137" height="12"/></span> <strong>Yours to solve.</strong></p>
<p><em>Hint: apply the IS-A test</em></p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00012">
<h5>there are no Dumb Questions</h5>
<p><a data-type="indexterm" data-primary="methods" data-secondary="subclasses" id="idm46038394589216"/><a data-type="indexterm" data-primary="subclasses" data-secondary="relationship to superclass" id="idm46038394588016"/><a data-type="indexterm" data-primary="superclass" data-secondary="and no reverse inheritance" id="idm46038394586944"/><a data-type="indexterm" data-primary="super keyword" id="idm46038394585872"/><strong>Q: So we see how a subclass gets to inherit a superclass method, but what if the superclass wants to use the subclass version of the method?</strong></p>
<p><strong>A:</strong> A superclass won’t necessarily <em>know</em> about any of its subclasses. You might write a class and much later someone else comes along and extends it. But even if the superclass creator does know about (and wants to use) a subclass version of a method,  there’s no sort of <em>reverse</em> or <em>backward</em> inheritance. Think about it, children inherit from parents, not the other way around.</p>
<p><strong>Q: In a subclass, what if I want to use BOTH the superclass version and my overriding subclass version of a method?  In other words,  I don’t want to completely <em>replace</em> the superclass version; I just want to add more stuff to it.</strong></p>
<p><strong>A:</strong> You can do this! And it’s an important design feature. Think of the word “extends” as meaning “I want to <em>extend</em> the functionality of the superclass.”</p>
<figure class="informal"><div class="figure">
<img src="Images/f0182-01.png" alt="image" width="607" height="160"/>
<h6/>
</div></figure>
<p>You can design your superclass methods in such a way that they contain method implementations that will work for any subclass, even though the subclasses may still need to “append” more code. In your subclass overriding method, you can call the superclass version using the keyword <code>super</code>. It’s like saying, “first go run the superclass version, then come back and finish with my own code...”</p>
</div></aside>
<p><strong>Who ge ts the Porsche, who ge ts the porcelain? (how to know what a subclass can inherit from it’s superclass)</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0182-02.png" alt="image" width="129" height="140"/>
<h6/>
</div></figure>
<p>A subclass inherits members of the superclass. Members include instance variables and methods, although later in this book we’ll look at other inherited members. A superclass can choose whether or not it wants a subclass to inherit a particular member by the level of access the particular member is given.</p>
<p>There are four access levels that we’ll cover in this book. Moving from most restrictive to least, the four access levels are:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0182-03.png" alt="image" width="449" height="84"/>
<h6/>
</div></figure>
<p><strong>Access levels control <em>who sees what</em></strong>, and are crucial to having well-designed, robust Java code. For now we’ll focus just on public and private. The rules are simple for those two:</p>
<pre data-type="programlisting"><strong>public</strong> members <u><em>are</em></u> inherited
<strong>private</strong> members are <u><em>not</em></u> inherited</pre>
<p>When a subclass inherits a member, it is <strong><em>as if the subclass defined the member itself</em></strong>. In the Shape example, Square inherited the <code>rotate()</code> and <code>playSound()</code> methods and to the outside world (other code) the Square class simply has a <code>rotate()</code> and <code>playSound()</code> method.</p>
<p>The members of a class include the variables and methods defined in the class plus anything inherited from a superclass.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">Note: get more details about default and protected in <a data-type="xref" href="app02.xhtml#appendix_b_the_top_ten-ish_topics_that_d">Appendix B</a>.</span></p>
</div>
</div></section>
<section data-type="sect1" data-pdf-bookmark="When designing with inheritance, are you using or abusing?"><div class="sect1" id="when_designing_with_inheritancecomma_are">
<h1>When designing with inheritance, are you using or abusing?</h1>
<p><a data-type="indexterm" data-primary="inheritance" data-secondary="dos and don’ts" id="idm46038394556192"/><a data-type="indexterm" data-primary="IS-A test" id="idm46038394555216"/>Although some of the reasons behind these rules won’t be revealed until later in this book, for now, simply <em>knowing</em> a few rules will help you build a better inheritance design.</p>
<p><strong>DO</strong> use inheritance when one class <em>is</em> a more specific type of a superclass. Example: Willow is a more specific type of Tree, so Willow <em>extends</em> Tree makes sense.</p>
<p><strong>DO</strong> consider inheritance when you have behavior (implemented code) that should be shared among multiple classes of the same general type. Example: Square, Circle, and Triangle all need to rotate and play sound, so putting that functionality in a superclass Shape might make sense and makes for easier maintenance and extensibility. Be aware, however, that while inheritance is one of the key features of object-oriented programming, it’s not necessarily the best way to achieve behavior reuse. It’ll get you started, and often it’s the right design choice, but design patterns will help you see other more subtle and flexible options. If you don’t know about design patterns, a good follow-on to this book would be <em>Head First Design Patterns.</em></p>
<p><strong>DO NOT</strong> use inheritance just so that you can reuse code from another class, if the relationship between the superclass and subclass violate either of the above two rules. For example, imagine you wrote special printing code in the Animal class and now you need printing code in the Potato class. You might think about making Potato extend Animal so that Potato inherits the printing code. That makes no sense! A Potato is <em>not</em> an Animal! (So the printing code should be in a Printer class that all printable objects can take advantage of via a HAS-A relationship.)</p>
<p><strong>DO NOT</strong> use inheritance if the subclass and superclass do not pass the IS-A test. Always ask yourself if the subclass IS-A more specific type of the superclass. Example: Tea IS-A Beverage makes sense. Beverage IS-A Tea does not.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="bullet_points-id00007">
<h5>BULLET POINTS</h5>
<ul>
<li><p>A subclass <em>extends</em> a superclass.</p></li>
<li><p>A subclass inherits all <em>public</em> instance variables and methods of the superclass, but does not inherit the <em>private</em> instance variables and methods of the superclass.</p></li>
<li><p>Inherited methods can be overridden; instance variables cannot be overridden (although they can be <em>redefined</em> in the subclass, but that’s not the same thing, and there’s almost never a need to do it.)</p></li>
<li><p>Use the IS-A test to verify that your inheritance hierarchy is valid. If X extends Y, then <em>X IS-A Y</em> must make sense.</p></li>
<li><p>The IS-A relationship works in only one direction. A Hippo is an Animal, but not all Animals are Hippos.</p></li>
<li><p>When a method is overridden in a subclass, and that method is invoked on an instance of the subclass, the overridden version of the method is called. (<em>The lowest one wins.</em>)</p></li>
<li><p>If class B extends A, and C extends B, class B IS-A class A, and class C IS-A class B, and class C also IS-A class A.</p></li>
</ul>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="So what does all this inheritance really buy you?"><div class="sect1" id="so_what_does_all_this_inheritance_really">
<h1>So what does all this inheritance really buy you?</h1>
<p><a data-type="indexterm" data-primary="duplicate code, avoiding with inheritance" id="idm46038394549344"/><a data-type="indexterm" data-primary="inheritance" data-secondary="benefits of using" id="idm46038394788592"/><a data-type="indexterm" data-primary="superclass" data-secondary="relationship to subclasses" id="idm46038394526896"/>You get a lot of OO mileage by designing with inheritance. You can get rid of duplicate code by abstracting out the behavior common to a group of classes, and sticking that code in a superclass. That way, when you need to modify it, you have only one place to update, and <em>the change is magically reflected in all the classes that inherit that behavior.</em> Well, there’s no magic involved, but it is pretty simple: make the change and compile the class again. That’s it. <strong>You don’t have to touch the subclasses!</strong></p>
<p><strong>Just deliver the newly changed superclass, and all classes that extend it will automatically use the new version.</strong></p>
<p>A Java program is nothing but a pile of classes, so the subclasses don’t have to be recompiled in order to use the new version of the superclass. As long as the superclass doesn’t <em>break</em> anything for the subclass, everything’s fine. (We’ll discuss what the word “break” means in this context later in the book. For now, think of it as modifying something in the superclass that the subclass is depending on, like a particular method’s arguments, return type, method name, etc.)</p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1circlea.png" alt="Images" width="23" height="23"/></span> <strong>You avoid duplicate code.</strong></p>
<p>Put common code in one place, and let the subclasses inherit that code from a superclass. When you want to change that behavior, you have to modify it in only one place, and everybody else (i.e., all the subclasses) sees the change.</p></li>
<li><p><span class="inlineimage"><img src="Images/1circleb.png" alt="Images" width="23" height="23"/></span> <strong>You define a common protocol for a group of classes.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0184-01.png" alt="image" width="456" height="410"/>
<h6/>
</div></figure></li>
</ul>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Inheritance lets you guarantee that all classes grouped under a certain supertype have all the methods that the supertype has*"><div class="sect1" id="inheritance_lets_you_guarantee_that_all">
<h1>Inheritance lets you guarantee that all classes grouped under a certain supertype have all the methods that the supertype has*</h1>
<p><strong>In other words, you define a common protocol for a set of classes related through inheritance.</strong></p>
<p>When you define methods in a superclass that can be inherited by subclasses, you’re announcing a kind of protocol to other code that says, “All my subtypes (i.e., subclasses) can do these things, with these methods that look like this...”</p>
<p>In other words, you establish a <em>contract.</em></p>
<p>Class Animal establishes a common protocol for all Animal subtypes:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0185-01.png" alt="image" width="472" height="196"/>
<h6/>
</div></figure>
<p>And remember, when we <em>say any Animal</em>, we mean Animal <em>and any class that extends from Animal</em>. That again means, <em>any class that has Animal somewhere above it in the inheritance hierarchy.</em></p>
<p>But we’re not even at the really cool part yet, because we saved the best—<em>polymorphism</em>—for last.</p>
<p>When you define a supertype for a group of classes, <em>any subclass of that supertype can be substituted where the supertype is expected.</em></p>
<p>Say, what?</p>
<p>Don’t worry, we’re nowhere near done explaining it. Two pages from now, you’ll be an expert.</p>
<p><strong>And I care because...</strong></p>
<p>You get to take advantage of polymorphism.</p>
<p><strong>Which matters to me because...</strong></p>
<p>You get to refer to a subclass object using a reference declared as the supertype.</p>
<p><strong>And that means to me...</strong></p>
<p>You get to write really flexible code. Code that’s cleaner (more efficient, simpler). Code that’s not just easier to <em>develop</em>, but also much, much easier to <em>extend</em>, in ways you never imagined at the time you originally wrote your code.</p>
<p>That means you can take that tropical vacation while your co-workers update the program, and your co-workers might not even need your source code.</p>
<p>You’ll see how it works on the next page.</p>
<p>We don’t know about you, but personally, we find the whole tropical vacation thing particularly motivating.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0185-02.png" alt="image" width="101" height="143"/>
<h6/>
</div></figure>
<p>* When we say “all the methods,” we mean “all the inheritable methods,” which for now actually means “all the <em>public</em> methods,” although later we’ll refine that definition a bit more.</p>
<p><a data-type="indexterm" data-primary="assignment" data-secondary="object" id="idm46038394499296"/><a data-type="indexterm" data-primary="declarations" data-secondary="object" id="idm46038394493184"/><a data-type="indexterm" data-primary="objects" data-secondary="assignment" id="idm46038394492192"/><a data-type="indexterm" data-primary="objects" data-secondary="declaring" id="idm46038394491088"/><strong>To see how polymorphism works, we have to step back and look at the way we normally declare a reference and create an object...</strong></p>
<p><strong>The 3 steps of object declaration and assignment</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0186-01.png" alt="image" width="388" height="72"/>
<h6/>
</div></figure>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1circlea.png" alt="Images" width="23" height="23"/></span> <strong>Declare a reference variable</strong></p>
<pre data-type="programlisting"><strong>Dog myDog</strong> = <span style="color:#9D9EA0;">new Dog();</span></pre>
<p>Tells the JVM to allocate space for a reference variable. The reference variable is, forever, of type Dog. In other words, a remote control that has buttons to control a Dog, but not a Cat or a Button or a Socket.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0186-02.png" alt="image" width="75" height="149"/>
<h6/>
</div></figure></li>
<li><p><span class="inlineimage"><img src="Images/1circleb.png" alt="Images" width="23" height="23"/></span> <strong>Create an object</strong></p>
<pre data-type="programlisting"><span style="color:#9D9EA0;">Dog myDog</span> = new Dog();</pre>
<p>Tells the JVM to allocate space for a new Dog object on the garbage collectible heap.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0186-03.png" alt="image" width="161" height="198"/>
<h6/>
</div></figure></li>
<li><p><span class="inlineimage"><img src="Images/1circlec.png" alt="Images" width="23" height="23"/></span> <strong>Link the object and the reference</strong></p>
<pre data-type="programlisting"><span style="color:#9D9EA0;">Dog myDog</span> = <span style="color:#9D9EA0;">new Dog();</span></pre>
<p>Assigns the new Dog to the reference variable myDog. In other words, <strong><em>program the remote control.</em></strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0186-04.png" alt="image" width="279" height="314"/>
<h6/>
</div></figure></li>
</ul>
<p><a data-type="indexterm" data-primary="reference variables" data-secondary="polymorphism" id="idm46038394467632"/><strong>The important point is that the reference type AND the object type are the same.</strong></p>
<p><strong>In this example, both are <u>Dog.</u></strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0187-01.png" alt="image" width="574" height="388"/>
<h6/>
</div></figure>
<p><strong>But with polymorphism, the reference type and the object type can be <em>different.</em></strong></p>
<pre data-type="programlisting"><strong><u>Animal</u> myDog = new <u>Dog</u>();</strong></pre>
<figure class="informal"><div class="figure">
<img src="Images/f0187-02.png" alt="image" width="574" height="390"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="arrays" data-secondary="polymorphic" id="idm46038394459136"/><a data-type="indexterm" data-primary="IS-A test" id="idm46038394457968"/><a data-type="indexterm" data-primary="polymorphism" data-secondary="reference and object types as different" id="idm46038394457136"/><a data-type="indexterm" data-primary="superclass" data-secondary="reference type as" id="idm46038394456064"/><strong>With polymorphism, the reference type can be a superclass of the actual object type.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0188-01.png" alt="image" width="498" height="375"/>
<h6/>
</div></figure>
<p>When you declare a reference variable, any object that passes the IS-A test for the type of the reference can be assigned to that variable. In other words, anything that <em>extends</em> the declared reference variable type can be <em>assigned</em> to the reference variable. <strong><em>This lets you do things like make polymorphic arrays.</em></strong></p>
<p><strong>OK, OK maybe an example will help.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0188-02.png" alt="image" width="924" height="628"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="arguments" data-secondary="polymorphic" id="idm46038394448128"/><a data-type="indexterm" data-primary="polymorphism" data-secondary="arguments and return types" id="idm46038394447152"/><a data-type="indexterm" data-primary="return types" data-secondary="polymorphic" id="idm46038394446112"/><strong>But wait! There’s more!</strong></p>
<p><strong>You can have polymorphic <u>arguments</u> and <u>return</u> types.</strong></p>
<p>If you can declare a reference variable of a supertype, say, Animal, and assign a subclass object to it, say, Dog, think of how that might work when the reference is an argument to a method...</p>
<figure class="informal"><div class="figure">
<img src="Images/f0189-01.png" alt="image" width="930" height="895"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0190-01.png" alt="image" width="885" height="626"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="subclasses" data-secondary="and polymorphism" id="idm46038394439056"/><strong>With polymorphism, you can write code that doesn’t have to change when you introduce new subclass types into the program.</strong></p>
<p>Remember that Vet class? If you write that Vet class using arguments declared as type <em>Animal</em>, your code can handle any Animal <em>subclass</em>. That means if others want to take advantage of your Vet class, all they have to do is make sure <em>their</em> new Animal types extend class Animal. The Vet methods will still work, even though the Vet class was written without any knowledge of the new Animal subtypes the Vet will be working on.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-id00003">
<h5>Brain Power</h5>
<figure class="informal"><div class="figure">
<img src="Images/brain.png" alt="image" width="80" height="71"/>
<h6/>
</div></figure>
<p>Why is polymorphism guaranteed to work this way? Why is it always safe to assume that any <em>subclass</em> type will have the methods you think you’re calling on the <em>superclass</em> type (the superclass reference type you’re using the dot operator on)?</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00013">
<h5>there are no Dumb Questions</h5>
<p><a data-type="indexterm" data-primary="access control" data-secondary="and subclasses" id="idm46038394427104"/><a data-type="indexterm" data-primary="classes" data-secondary="inner" data-see="inner classes" id="idm46038394426464"/><a data-type="indexterm" data-primary="constructors" data-secondary="private" id="idm46038394425696"/><a data-type="indexterm" data-primary="final keyword" data-secondary="classes" id="idm46038394424720"/><a data-type="indexterm" data-primary="final keyword" data-secondary="methods" id="idm46038394423744"/><a data-type="indexterm" data-primary="inheritance" data-secondary="keeping trees shallow" id="idm46038394422736"/><a data-type="indexterm" data-primary="inheritance trees" id="idm46038394421632"/><a data-type="indexterm" data-primary="inner classes" id="idm46038394420800"/><a data-type="indexterm" data-primary="methods" data-secondary="final" id="idm46038394419968"/><a data-type="indexterm" data-primary="non-public class" id="idm46038394418864"/><a data-type="indexterm" data-primary="private constructor" id="idm46038394418032"/><a data-type="indexterm" data-primary="security" id="idm46038394417200"/><a data-type="indexterm" data-primary="security" data-secondary="and final classes" id="idm46038394416368"/><a data-type="indexterm" data-primary="String class" id="idm46038394415264"/><a data-type="indexterm" data-primary="subclasses" data-secondary="depth of, best practices" id="idm46038394414432"/><a data-type="indexterm" data-primary="subclasses" data-secondary="limitations on" id="idm46038394413360"/><strong>Q: Are there any practical limits on the levels of subclassing? How deep can you go?</strong></p>
<p><strong>A:</strong> If you look in the Java API, you’ll see that most inheritance hierarchies are wide but not deep. Most are no more than one or two levels deep, although there are exceptions (especially in the GUI classes). You’ll come to realize that it usually makes more sense to keep your inheritance trees shallow, but there isn’t a hard limit (well, not one that you’d ever run into).</p>
<p><strong>Q: Hey, I just thought of something...if you don’t have access to the source code for a class but you want to change the way a method of that class works, could you use subclassing to do that? To extend the “bad” class and override the method with your own better code?</strong></p>
<p><strong>A:</strong> Yep. That’s one cool feature of OO, and sometimes it saves you from having to rewrite the class from scratch or track down the programmer who hid the source code.</p>
<p><strong>Q: Can you extend <em>any</em> class? Or is it like class members where if the class is private you can’t inherit it...</strong></p>
<p><strong>A:</strong> There’s no such thing as a private class, except in a very special case called an <em>inner</em> class, which we haven’t looked at yet. But there <em>are</em> three things that can prevent a class from being subclassed.</p>
<p>The first is access control. Even though a class <em>can’t</em> be marked <code>private</code>, a class <em>can</em> be non-public (what you get if you don’t declare the class as <code>public</code>). A non-public class can be subclassed only by classes in the same package as the class. Classes in a different package won’t be able to subclass (or even <em>use</em>, for that matter) the non-public class.</p>
<p>The second thing that stops a class from being subclassed is the keyword modifier <code>final</code>. A final class means that it’s the end of the inheritance line. Nobody, ever, can extend a final class.</p>
<p>The third issue is that if a class has only <code>private</code> constructors (we’ll look at constructors in <a data-type="xref" href="ch09.xhtml#life_and_death_of_an_object_constructors">Chapter 9</a>), it can’t be subclassed.</p>
<p><strong>Q: Why would you ever want to make a final class? What advantage would there be in preventing a class from being subclassed?</strong></p>
<p><strong>A:</strong> Typically, you won’t make your classes final. But if you need security—the security of knowing that the methods will always work the way that you wrote them (because they can’t be overridden),  a final class will give you that. A lot of classes in the Java API are final for that reason. The String class, for example, is final because, well, imagine the havoc if somebody came along and changed the way Strings behave!</p>
<p><strong>Q: Can you make a <em>method</em> final, without making the whole <em>class</em> final?</strong></p>
<p><strong>A:</strong> If you want to protect a specific method from being overridden, mark the <em>method</em> with the <code>final</code> modifier. Mark the whole <em>class</em> as final if you want to guarantee that <em>none</em> of the methods in that class will ever be overridden.</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Keeping the contract: rules for overriding"><div class="sect1" id="keeping_the_contract_rules_for_overridin">
<h1>Keeping the contract: rules for overriding</h1>
<p><a data-type="indexterm" data-primary="access control" data-secondary="polymorphism" id="idm46038394383600"/><a data-type="indexterm" data-primary="access levels" id="idm46038394382960"/><a data-type="indexterm" data-primary="arguments" data-secondary="polymorphic" id="idm46038394382384"/><a data-type="indexterm" data-primary="contract" data-secondary="public methods as" id="idm46038394381504"/><a data-type="indexterm" data-primary="overriding methods" data-secondary="rules to keep contract" id="idm46038394380400"/><a data-type="indexterm" data-primary="return types" data-secondary="polymorphic" id="idm46038394379296"/><a data-type="indexterm" data-primary="superclass" data-secondary="contract rules" id="idm46038394378192"/><a data-type="indexterm" data-primary="superclass" data-secondary="overriding methods from" id="idm46038394377088"/>When you override a method from a superclass, you’re agreeing to fulfill the contract. The contract that says, for example, “I take no arguments and I return a boolean.” In other words, the arguments and return types of your overriding method must look to the outside world <em>exactly</em> like the overridden method in the superclass.</p>
<p><strong>The methods <em>are</em> the contract.</strong></p>
<p>If polymorphism is going to work, the Toaster’s version of the overridden method from Appliance has to work at runtime. Remember, the compiler looks at the reference type to decide whether you can call a particular method on that reference.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0192-01.png" alt="image" width="429" height="66"/>
<h6/>
</div></figure>
<p>With an Appliance reference to a Toaster, the compiler cares only if class <em>Appliance</em> has the method you’re invoking on an Appliance reference. But at runtime, the JVM does not look at the <strong>reference</strong> type (<em>Appliance</em>) but at the actual <em>Toaster</em> <strong>object</strong> on the heap.</p>
<p>So if the compiler has already approved the method call, the only way it can work is if the overriding method has the same arguments and return types. Otherwise, someone with an Appliance reference will call turnOn() as a no-arg method, even though there’s a version in Toaster that takes an int. Which one is called at runtime? The one in Appliance. In other words, <strong><em>the turnOn(int level) method in Toaster is not an override!</em></strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0192-02.png" alt="image" width="385" height="515"/>
<h6/>
</div></figure>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="Images" width="20" height="21"/></span> <strong>Arguments must be the same, and return types must be compatible.</strong></p>
<p>The contract of superclass defines how other code can use a method. Whatever the superclass takes as an argument, the subclass overriding the method must use that same argument. And whatever the superclass declares as a return type, the overriding method must declare either the same type or a subclass type. Remember, a subclass object is guaranteed to be able to do anything its superclass declares, so it’s safe to return a subclass where the superclass is expected.</p></li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="Images" width="20" height="21"/></span> <strong>The method can’t be less accessible.</strong></p>
<p>That means the access level must be the same, or friendlier. You can’t, for example, override a public method and make it private. What a shock that would be to the code invoking what it <em>thinks</em> (at compile time) is a public method, if suddenly at runtime the JVM slammed the door shut because the overriding version called at runtime is private!</p>
<p>So far we’ve learned about two access levels: private and public. The other two are in <a data-type="xref" href="app02.xhtml#appendix_b_the_top_ten-ish_topics_that_d">Appendix B</a>. There’s also another rule about overriding related to exception handling, but we’ll wait until <a data-type="xref" href="ch13.xhtml#risky_behavior_exception_handling">Chapter 13</a>, <em>Risky Behavior</em>, to cover that.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0192-03.png" alt="image" width="411" height="439"/>
<h6/>
</div></figure></li>
</ul>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Overloading a method"><div class="sect1" id="overloading_a_method">
<h1>Over<u>load</u>ing a method</h1>
<p><a data-type="indexterm" data-primary="access levels" id="idm46038394355296"/><a data-type="indexterm" data-primary="methods" data-secondary="overloading" id="idm46038394354672"/><a data-type="indexterm" data-primary="overloading methods" id="idm46038394353696"/><a data-type="indexterm" data-primary="return types" data-secondary="overloaded methods" id="idm46038394352960"/>Method overloading is nothing more than having two methods with the same name but different argument lists. Period. There’s no polymorphism involved with overloaded methods!</p>
<p>Overloading lets you make multiple versions of a method, with different argument lists, for convenience to the callers. For example, if you have a method that takes only an int, the calling code has to convert, say, a double into an int before calling your method. But if you overloaded the method with another version that takes a double, then you’ve made things easier for the caller. You’ll see more of this when we look into constructors in <a data-type="xref" href="ch09.xhtml#life_and_death_of_an_object_constructors">Chapter 9</a>, <em>Life and Death of an Object.</em></p>
<p>Since an overloading method isn’t trying to fulfill the polymorphism contract defined by its superclass, overloaded methods have much more flexibility.</p>
<p><span style="color:#9D9EA0;">An overloaded method is just a different method that happens to have the same met hod name. It has nothing to do with inheritance and polymorphism. An over<u>loaded</u> met hod is NOT the same as an overridd<u>en me</u>thod.</span></p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/1.png" alt="Images" width="20" height="21"/></span> <strong>The return types can be different.</strong></p>
<p>You can’t change ONLY the return type.</p></li>
<li><p><span class="inlineimage"><img src="Images/2.png" alt="Images" width="20" height="21"/></span> <strong>You can’t change ONLY the return type.</strong></p>
<p>If only the return type is different, it’s not a valid over<em>load</em>—the compiler will assume you’re trying to override the method. And even <em>that</em> won’t be legal unless the return type is a subtype of the return type declared in the superclass. To overload a method, you MUST change the argument list, although you <em>can</em> change the return type to anything.</p></li>
<li><p><span class="inlineimage"><img src="Images/3.png" alt="Images" width="20" height="21"/></span> <strong>You <em>can</em> vary the access levels in any direction.</strong></p>
<p>You’re free to overload a method with a method that’s more restrictive. It doesn’t matter, since the new method isn’t obligated to fulfill the contract of the overloaded method.</p>
<p><strong>Legal examples of method overloading:</strong></p>
<pre data-type="programlisting">public class Overloads {
  String uniqueID;

  public <strong>int</strong> addNums<strong>(int a, int b)</strong> {
    return a + b;
  }

  public <strong>double</strong> addNums<strong>(double a, double b)</strong> {
    return a + b;
  }

  public void setUniqueID<strong>(String theID)</strong> {
    // lots of validation code, and then:
    uniqueID = theID;
  }

  public void setUniqueID<strong>(int ssNumber)</strong> {
    String numString = "" + ssNumber;
    setUniqueID(numString);
  }
}</pre></li>
</ul>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Exercise"><div class="sect1" id="exercise-id000011">
<h1>Exercise</h1>
<figure class="informal"><div class="figure">
<img src="Images/common-03.png" alt="image" width="100" height="85"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Mixed Messages"><div class="sect2" id="mixed_messages-id0100006">
<h2>Mixed Messages</h2>
<figure class="informal"><div class="figure">
<img src="Images/common-04.png" alt="image" width="110" height="75"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Mixed Messages" id="idm46038394330656"/>A short Java program is listed below. One block of the program is missing! Your challenge is to match the candidate block of code (on the left), with the output that you’d see if the block were inserted. Not all the lines of output will be used, and some of the lines of output might be used more than once. Draw lines connecting the candidate blocks of code with their matching command-line output.</p>
<p><strong>The program:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0194-01.png" alt="image" width="986" height="488"/>
<h6/>
</div></figure>
<p><strong>Code candidates:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0194-02.png" alt="image" width="117" height="329"/>
<h6/>
</div></figure>
<p><strong>Output:</strong></p>
<pre data-type="programlisting">A’s m1, A’s m2, C’s m3, 6

B’s m1, A’s m2, A’s m3,

A’s m1, B’s m2, A’s m3,

B’s m1, A’s m2, C’s m3, 13

B’s m1, C’s m2, A’s m3,

B’s m1, A’s m2, C’s m3, 6

A’s m1, A’s m2, C’s m3, 13</pre>
<p><span class="inlineimage"><img src="Images/arr1.png" alt="Images" width="137" height="12"/></span> <strong>Answers in <a data-type="xref" href="#mixed_messages_left_parenthesisfro-id200">“Mixed Messages”</a>.</strong></p>
</div></section>
<section data-type="sect2" data-pdf-bookmark="BE the Compiler"><div class="sect2" id="exercise-id000012">
<h2>BE the Compiler</h2>
<p><strong/></p>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Be the..." id="idm46038394316528"/><strong>Which of the A-B pairs of methods listed on the right, if inserted into the classes on the left, would compile and produce the output shown? (The A method inserted into class Monster, the B method inserted into class Vampire.)</strong></p>
<pre data-type="programlisting"><strong>public class MonsterTestDrive {</strong>

  <strong>public static void main(String[] args) {</strong>
    <strong>Monster[] monsters = new Monster[3];</strong>
    <strong>monsters[0] = new Vampire();</strong>
    <strong>monsters[1] = new Dragon();</strong>
    <strong>monsters[2] = new Monster();</strong>
    <strong>for (int i = 0; i &lt; monsters.length; i++) {</strong>
      <strong>monsters[i].frighten(i);</strong>
    <strong>}</strong>
  <strong>}</strong>
<strong>}</strong>

<strong>class Monster {</strong>
  <span class="inlineimage"><img src="Images/a.png" alt="Images" width="20" height="20"/></span>
<strong>}</strong>

<strong>class Vampire extends Monster {</strong>
  <span class="inlineimage"><img src="Images/b.png" alt="Images" width="20" height="20"/></span>
<strong>}</strong>

<strong>class Dragon extends Monster {</strong>
  <strong>boolean frighten(int degree) {</strong>
    <strong>System.out.println("breathe fire");</strong>
    <strong>return true;</strong>
  <strong>}</strong>
<strong>}</strong></pre>
<figure class="informal"><div class="figure">
<img src="Images/f0195-02.png" alt="image" width="305" height="170"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0195-01.png" alt="image" width="367" height="793"/>
<h6/>
</div></figure>
<p><span class="inlineimage"><img src="Images/arr1.png" alt="Images" width="137" height="12"/></span> <strong>Answers in <a data-type="xref" href="#be_the_compiler_left_parenthesisfro-0001">“BE the Compiler”</a>.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/common-04.png" alt="image" width="110" height="75"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="pool_puzzle-id00003">
<h5>Pool Puzzle</h5>
<figure class="informal"><div class="figure">
<img src="Images/common-06.png" alt="image" width="147" height="133"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="puzzles" data-secondary="Pool Puzzle" id="idm46038394286048"/>Your <strong><em>job</em></strong> is to take code snippets from the pool and place them into the blank lines in the code. You may use the same snippet more than once, and you might not need to use all the snippets. Your <strong><em>goal</em></strong> is to make a set of classes that will compile and run together as a program. Don’t be fooled—this one’s harder than it looks.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0196-01a.png" alt="image" width="1465" height="777"/>
<h6/>
</div></figure>
<p><strong>OUTPUT:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0196-01.png" alt="image" width="388" height="45"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0196-02.png" alt="image" width="946" height="374"/>
<h6/>
</div></figure>
<p><span class="inlineimage"><img src="Images/arr1.png" alt="Images" width="137" height="12"/></span> <strong>Answers in <a data-type="xref" href="#pool_puzzle_left_parenthesisfrom_page_19">“Pool Puzzle”</a>.</strong></p>
</div></aside>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Exercise Solutions"><div class="sect1" id="exercise_solutions-id00004">
<h1>Exercise Solutions</h1>
<figure class="informal"><div class="figure">
<img src="Images/common-03.png" alt="image" width="100" height="85"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0197-01.png" alt="image" width="220" height="365"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="BE the Compiler"><div class="sect2" id="be_the_compiler_left_parenthesisfro-0001">
<h2>BE the Compiler</h2>
<p>(from <a data-type="xref" href="#exercise-id000012">“BE the Compiler”</a>)</p>
<p>Set 1 <strong>will</strong> work.</p>
<p>Set 2 <strong>will not</strong> compile because of Vampire’s return type (int).</p>
<p>The Vampire’s frighten() method (B) is not a legal override OR overload of Monster’s frighten() method. Changing ONLY the return type is not enough to make a valid overload, and since an int is not compatible with a boolean, the method is not a valid override. (Remember, if you change ONLY the return type, it must be to a return type that is compatible with the superclass version’s return type, and then it’s an override.)</p>
<p>Sets 3 and 4 <strong>will</strong> compile but produce:</p>
<p><code>arrrgh</code></p>
<p><code>breathe fire</code></p>
<p><code>arrrgh</code></p>
<p>Remember, class Vampire did not override class Monster’s frighten() method. (The frighten() method in Vampire’s set 4 takes a byte, not an int.)</p>
<p><strong>Code candidates:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/common-04.png" alt="image" width="110" height="75"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Mixed Messages"><div class="sect2" id="mixed_messages_left_parenthesisfro-id200">
<h2>Mixed Messages</h2>
<p>(from <a data-type="xref" href="#mixed_messages-id0100006">“Mixed Messages”</a>)</p>
<figure class="informal"><div class="figure">
<img src="Images/f0197-02.png" alt="image" width="607" height="318"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Pool Puzzle"><div class="sect2" id="pool_puzzle_left_parenthesisfrom_page_19">
<h2>Pool Puzzle</h2>
<p>(from <a data-type="xref" href="#pool_puzzle-id00003">“Pool Puzzle”</a>)</p>
<figure class="informal"><div class="figure">
<img src="Images/common-04.png" alt="image" width="110" height="75"/>
<h6/>
</div></figure>
<pre data-type="programlisting">public class Rowboat <strong>extends Boat</strong> {
   public <strong>void</strong> rowTheBoat() {
      System.out.print("stroke natasha");
   }
}
public class <strong>Boat</strong> {
   private int <strong>length ;</strong>
   <strong>public</strong> void <strong>setLength</strong> ( <strong>int len</strong> ) {
         length = len;
   }
   public int getLength() {
      <strong>return length ;</strong>
   }
   public <strong>void</strong> move() {
      System.out.print(<strong>"drift "</strong>);
   }
}



public class TestBoats {
   <strong>public static void</strong> main(String[] args){
      <strong>Boat</strong> b1 = new Boat();
      Sailboat b2 = new <strong>Sailboat</strong>();
      Rowboat <strong>b3</strong> = new Rowboat();
      b2.setLength(32);
      b1<strong>.move();</strong>
      b3<strong>.move();</strong>
      <strong>b2</strong>.move();
   }
}
public class <strong>Sailboat extends</strong> Boat {
   public <strong>void move</strong>() {
      System.out.print(<strong>"hoist sail "</strong>);
   }
}</pre>
<p><strong>OUTPUT:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0198-01.png" alt="image" width="388" height="44"/>
<h6/>
</div></figure>
</div></section>
</div></section>
</div></section></div></body></html>