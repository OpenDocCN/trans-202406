<html><head></head><body><section data-pdf-bookmark="Chapter 3. Composing Components" data-type="chapter" epub:type="chapter"><div class="chapter" id="unique_chapter_id_03">&#13;
<h1><span class="label">Chapter 3. </span>Composing Components</h1>&#13;
&#13;
&#13;
<p>In the previous chapter, you learned the fundamentals of Vue and how to write a Vue component with common directives using Options API. You are now ready to deep dive into the next level: composing more complex Vue components with reactivity and hooks.</p>&#13;
&#13;
<p>This chapter introduces the Vue Single File Component (SFC) standard, component lifecycle hooks, and other advanced reactive features such as computed properties, watchers, methods, and refs. You will also learn to use slots to dynamically render different parts of the component while maintaining the component’s structure with styles. By the end of this chapter, you will be able to write complex Vue components in your application.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Vue Single File Component Structure" data-type="sect1"><div class="sect1" id="sfc">&#13;
<h1>Vue Single File Component Structure</h1>&#13;
&#13;
<p>Vue introduces a new file format standard, Vue SFC, denoted by the <code>.vue</code> extension. With SFC, you can write the HTML template code, the JavaScript logic, and the CSS stylings for a component in the same file, each in its dedicated code section. A Vue SFC contains three essential code sections<a data-primary=".vue extension for Single-File Component" data-primary-sortas="vue extension for Single-File Component" data-type="indexterm" id="id709"/><a data-primary="CSS" data-secondary="Single File Component structure and" data-type="indexterm" id="ix-comp-comp1"/><a data-primary="style" data-secondary="Vue SFCs" data-type="indexterm" id="ix-comp-comp1a"/><a data-primary="SFC (Single-File Component)" data-secondary="structure" data-type="indexterm" id="ix-comp-comp2"/>:</p>&#13;
<dl>&#13;
<dt>Template</dt>&#13;
<dd>&#13;
<p>This HTML code block renders the UI view of the component. It should only appear <em>once</em> per component at the highest level element<a data-primary="template section, Vue SFCs" data-type="indexterm" id="id710"/>.</p>&#13;
</dd>&#13;
<dt>Script</dt>&#13;
<dd>&#13;
<p>This JavaScript code block contains the component’s main logic and only appears <em>a maximum of once</em> per component file<a data-primary="script section, Vue SFCs" data-type="indexterm" id="id711"/>.</p>&#13;
</dd>&#13;
<dt>Style</dt>&#13;
<dd>&#13;
<p>This CSS code block contains the stylings for the component. It is optional and can appear as <em>many times</em> as required per component file<a data-primary="style section, Vue SFCs" data-type="indexterm" id="id712"/>.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p><a data-type="xref" href="#example_03_01">Example 3-1</a> is an example of an SFC file structure for a Vue component named <code>MyFirstComponent</code>.</p>&#13;
<div data-type="example" id="example_03_01">&#13;
<h5><span class="label">Example 3-1. </span>SFC structure of <code>MyFirstComponent</code> component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
 <code class="p">&lt;</code><code class="nt">h2</code> <code class="na">class</code><code class="o">=</code><code class="s">"heading"</code><code class="p">&gt;</code>I am a a Vue component<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w"> </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'MyFistComponent'</code><code class="p">,</code><code class="w"/>&#13;
<code class="p">};</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">style</code><code class="p">&gt;</code>&#13;
<code class="nc">.heading</code> <code class="p">{</code>&#13;
  <code class="k">font-size</code><code class="o">:</code> <code class="m">16px</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
<code class="nt">&lt;/style&gt;</code></pre></div>&#13;
&#13;
<p>We can also refactor a non-SFC component code into SFC, as shown in <a data-type="xref" href="#figure_03_01">Figure 3-1</a><a data-primary="components" data-secondary="refactoring into SFCs" data-type="indexterm" id="id713"/><a data-primary="SFC (Single-File Component)" data-secondary="refactoring regular components into" data-type="indexterm" id="id714"/>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_01">&#13;
<img alt="Example of a Vue component created with single file component concept" src="assets/lvue_0301.png"/>&#13;
<h6><span class="label">Figure 3-1. </span>Refactoring the component from non-SFC format to SFC format</h6>&#13;
</div></figure>&#13;
&#13;
<p class="pagebreak-before">As <a data-type="xref" href="#figure_03_01">Figure 3-1</a> shows, we perform the following refactoring:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Move the HTML code presented as the string value of the <code>template</code> field into the <code>&lt;template&gt;</code> section of the Single File Component.</p>&#13;
</li>&#13;
<li>&#13;
<p>Move the rest of <code>MyFirstComponent</code> logic into the <code>&lt;script&gt;</code> section of the Single File Component, as part of the <code>export default {}</code> object.</p>&#13;
</li>&#13;
</ul>&#13;
<div data-type="tip"><h1>Tip for Using TypeScript</h1>&#13;
<p>You should add the attribute <code>lang="ts"</code> for TypeScript to the <code>&lt;script&gt;</code> syntax, as <code>&lt;script lang="ts"&gt;</code> , so the Vue engine knows to handle the code format accordingly<a data-primary="components" data-secondary="TypeScript support" data-type="indexterm" id="id715"/><a data-primary="lang=&quot;ts&quot; attribute" data-type="indexterm" id="id716"/><a data-primary="TypeScript" data-secondary="components and support for" data-type="indexterm" id="id717"/><a data-primary="TypeScript" data-secondary="Single-File Component format and" data-type="indexterm" id="id718"/><a data-primary="type validation" data-secondary="Single-File Component format and" data-type="indexterm" id="id719"/><a data-primary="SFC (Single-File Component)" data-secondary="trans-compiling and" data-type="indexterm" id="id720"/>.</p>&#13;
</div>&#13;
&#13;
<p>Since the <code>.vue</code> file format is a unique extension standard, you need to use a special build tool (compiler/transpiler) such as Webpack, Rollup, etc., to pre-compile the relevant files into proper JavaScript and CSS for serving on the browser side. When creating a new project with Vite, Vite already sets up these tools as part of the scaffolding process. You then can import the component as an ES module and declare it as internal <code>components</code> to use in other component files<a data-primary="" data-startref="ix-comp-comp1" data-type="indexterm" id="id721"/><a data-primary="" data-startref="ix-comp-comp1a" data-type="indexterm" id="id722"/><a data-primary="compiling" data-secondary="Single-File Components and" data-type="indexterm" id="id723"/><a data-primary="SFC (Single-File Component)" data-secondary="compiling and" data-type="indexterm" id="id724"/>.</p>&#13;
&#13;
<p>Following is an example of importing <code>MyFirstComponent</code> located in the <code>components</code> directory to use in the <code>App.vue</code> component<a data-primary="SFC (Single-File Component)" data-secondary="importing" data-type="indexterm" id="id725"/>:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="nx">MyFirstComponent</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'./components/MyFirstComponent.vue'</code><code class="p">;</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w"> </code><code class="nx">components</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">MyFirstComponent</code><code class="p">,</code><code class="w"/>&#13;
<code class="w"> </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">}</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre>&#13;
&#13;
<p>As <a data-type="xref" href="#example_03_04">Example 3-2</a> shows, you can use the imported component by referring to its name, either by CamelCase or snake case, in the <code>template</code> section:</p>&#13;
<div data-type="example" id="example_03_04">&#13;
<h5><span class="label">Example 3-2. </span>How to use the imported component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
 <code class="p">&lt;</code><code class="nt">my-first-component</code> <code class="p">/&gt;</code>&#13;
 <code class="p">&lt;</code><code class="nt">MyFirstComponent</code> <code class="p">/&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p class="pagebreak-before">This code generates the <code>MyFirstComponent</code> component’s content twice, as shown in <a data-type="xref" href="#figure_03_02">Figure 3-2</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_02">&#13;
<img alt="How the component is rendered with repetitive content from its nested components" src="assets/lvue_0302.png"/>&#13;
<h6><span class="label">Figure 3-2. </span><code>MyFirstComponent</code> output</h6>&#13;
</div></figure>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>A component’s <code>template</code> in <a data-type="xref" href="#example_03_04">Example 3-2</a> contains two root elements. This fragmentation capability is available only in Vue 3.x onward<a data-primary="root elements" data-type="indexterm" id="id726"/>.</p>&#13;
</div>&#13;
&#13;
<p>We learned how to create and use a Vue component using the SFC format. As you have noticed, we define <code>lang="ts"</code> in the <code>script</code> tag to inform the Vue engine about our usage of TypeScript. And thus, the Vue engine will apply stricter type validation on any code or expressions presented in the <code>script</code> and <code>template</code> sections of the component.</p>&#13;
&#13;
<p>However, to fully enjoy TypeScript’s benefits in Vue, we need to use the <code>defineComponent()</code> method when defining a component, which we will learn in the next section<a data-primary="defineComponent()" data-type="indexterm" id="id727"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using defineComponent() for TypeScript Support" data-type="sect1"><div class="sect1" id="define_component">&#13;
<h1>Using defineComponent() for TypeScript Support</h1>&#13;
&#13;
<p>The <code>defineComponent()</code> method is a wrapper function that accepts an object of configurations and returns the same thing with type inference for defining a component.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The <code>defineComponent()</code> method is available only in Vue 3.x onward and relevant only when TypeScript is required.</p>&#13;
</div>&#13;
&#13;
<p><a data-type="xref" href="#example_03_03">Example 3-3</a> illustrates using <code>defineComponent()</code> to define a component.</p>&#13;
<div data-type="example" id="example_03_03">&#13;
<h5><span class="label">Example 3-3. </span>Defining a component with <code>defineComponent()</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h2</code> <code class="na">class</code><code class="o">=</code><code class="s">"heading"</code><code class="p">&gt;</code>{{ message }}<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="p">;</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'MyMessageComponent'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">message</code><code class="o">:</code><code class="w"> </code><code class="s1">'Welcome to Vue 3!'</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">}</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">});</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>If you use VSCode as your IDE, and have <a href="https://oreil.ly/lmnvd">Volar extension</a> installed, you will see the type of <code>message</code> as <code>string</code> when hovering on <code>message</code> in the <code>template</code> section, as shown in <a data-type="xref" href="#figure_03_03">Figure 3-3</a><a data-primary="Volar" data-type="indexterm" id="id728"/><a data-primary="VSCode" data-secondary="TypeScript support" data-type="indexterm" id="id729"/>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_03">&#13;
<img alt="Type of string generated for the message property of MyMessageComponent when hovering on the message word inside the template section" src="assets/lvue_0303.png"/>&#13;
<h6><span class="label">Figure 3-3. </span>Generated type for <code>message</code> property of <code>MyMessageComponent</code> displayed on hover</h6>&#13;
</div></figure>&#13;
&#13;
<p>You should use <code>defineComponent()</code> for TypeScript support only in complex components such as accessing a component’s properties through <code>this</code> instance. Otherwise, you can use the standard method for defining an SFC component.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>In this book, you will see a combination of the traditional component definition approach and <code>defineComponent()</code> when suitable. You are free to decide which method works best for you.</p>&#13;
</div>&#13;
&#13;
<p>Next, we will explore the lifecycle of a component and its hooks<a data-primary="" data-startref="ix-comp-comp2" data-type="indexterm" id="id730"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Component Lifecycle Hooks" data-type="sect1"><div class="sect1" id="component_lifecycle_03">&#13;
<h1>Component Lifecycle Hooks</h1>&#13;
&#13;
<p>The lifecycle of a Vue component starts when Vue instantiates the component and ends when destroying the component instance (or unmounting)<a data-primary="lifecycle hooks" data-secondary="understanding" data-type="indexterm" id="ix-comp-comp3"/>.</p>&#13;
&#13;
<p>Vue divides the component’s lifecycle into the phases (<a data-type="xref" href="#figure_03_33">Figure 3-4</a>).</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_33">&#13;
<img alt="A diagram flowchart of the lifecycle of a Vue component" src="assets/lvue_0304.png"/>&#13;
<h6><span class="label">Figure 3-4. </span>Flow graph of a Vue component lifecycle</h6>&#13;
</div></figure>&#13;
<dl>&#13;
<dt>Initialize phase</dt>&#13;
<dd>&#13;
<p>The Vue renderer loads the component’s option configurations and prepares for the component instance creation<a data-primary="initialize phase, components' life cycle" data-type="indexterm" id="id731"/>.</p>&#13;
</dd>&#13;
<dt>Creating phase</dt>&#13;
<dd>&#13;
<p>The Vue renderer creates the component instance. If the template requires compiling, there will be an additional step to compile it before moving forward to the next phase<a data-primary="creating phase, components' life cycle" data-type="indexterm" id="id732"/>.</p>&#13;
</dd>&#13;
<dt>First render phase</dt>&#13;
<dd>&#13;
<p>The Vue renderer creates and inserts the DOM nodes for the component in its DOM tree<a data-primary="first render phase, components' life cycle" data-type="indexterm" id="id733"/><a data-primary="rendering" data-secondary="phases and components' life cycle" data-type="indexterm" id="id734"/>.</p>&#13;
</dd>&#13;
<dt>Mounting phase</dt>&#13;
<dd>&#13;
<p>The component’s nested elements are already mounted and attached to the component’s DOM tree, as seen in <a data-type="xref" href="#figure_03_04">Figure 3-5</a>. The Vue renderer then attaches the component to its parent container. From this phase onward, you have access to the component’s <code>$el</code> property, representing its DOM node<a data-primary="mounting" data-secondary="phase in components' life cycle" data-type="indexterm" id="id735"/><a data-primary=".$el property" data-primary-sortas="el property" data-type="indexterm" id="id736"/><a data-primary="mounting" data-secondary="order for components" data-type="indexterm" id="id737"/><a data-primary="order" data-secondary="mounting components" data-type="indexterm" id="id738"/>.</p>&#13;
</dd>&#13;
<dt>Updating phase</dt>&#13;
<dd>&#13;
<p>Only relevant if the component’s reactive data changes. Here the Vue renderer re-renders the DOM nodes for the component with the new data and performs a patch update. Similar to the mounting phase, the update process finishes with the child elements first and then the component itself<a data-primary="updating phase, components' life cycle" data-type="indexterm" id="id739"/>.</p>&#13;
</dd>&#13;
<dt>Unmounting phase</dt>&#13;
<dd>&#13;
<p>The Vue renderer detaches the component from the DOM and destroys the instance and all its reactive data effects. This phase is the last phase of the lifecycle, happening when the component is no longer in use in the application. Similar to the updating and mounting stages, a component can only unmount itself after all its children are unmounted<a data-primary="unmounting phase, components' life cycle" data-type="indexterm" id="id740"/>.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<figure><div class="figure" id="figure_03_04">&#13;
<img alt="A diagram showing how the mounting order of a component and its children, noting from 1 to 3" src="assets/lvue_0305.png"/>&#13;
<h6><span class="label">Figure 3-5. </span>Mounting order for a component and its children</h6>&#13;
</div></figure>&#13;
&#13;
<p>Vue allows you to attach some events to specific transitions between these lifecycle phases for better component flow control. We call these events lifecycle hooks. The lifecycle hooks available in Vue are described in the following sections.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="setup" data-type="sect2"><div class="sect2" id="setup_hook_03">&#13;
<h2>setup</h2>&#13;
&#13;
<p><code>setup</code> is the first event hook before the component’s lifecycle starts. This hook runs <em>once</em> before Vue instantiates the component. At this phase, no component instance exists; hence <em>there is no access</em> to <code>this</code><a data-primary="this" data-secondary="setup hook and" data-type="indexterm" id="id741"/><a data-primary="setup hook" data-secondary="using" data-type="indexterm" id="ix-comp-comp4"/><a data-primary="lifecycle hooks" data-secondary="using" data-type="indexterm" id="ix-comp-comp5"/><a data-primary="lifecycle hooks" data-seealso="setup hook" data-type="indexterm" id="id742"/>:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">export</code> <code class="k">default</code> <code class="p">{</code>&#13;
  <code class="nx">setup</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'setup hook'</code><code class="p">)</code>&#13;
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="k">this</code><code class="p">)</code> <code class="c1">// undefined</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code></pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>An alternative to the <code>setup</code> hook is adding the <code>setup</code> attribute to the <code>script</code> tag section of the component (<code>&lt;script setup&gt;</code>)<a data-primary="setup attribute" data-type="indexterm" id="id743"/><a data-primary="setup hook" data-secondary="vs. setup attribute" data-secondary-sortas="setup attribute" data-type="indexterm" id="id744"/>.</p>&#13;
</div>&#13;
&#13;
<p>The <code>setup</code> hook is mainly for use with the Composition API (we will learn more in <a data-type="xref" href="ch05.html#unique_chapter_id_06">Chapter 5</a>). Its syntax is<a data-primary="Composition API" data-secondary="setup hook and" data-type="indexterm" id="id745"/><a data-primary="setup hook" data-secondary="Composition API and" data-type="indexterm" id="id746"/><a data-primary="setup hook" data-secondary="syntax" data-type="indexterm" id="id747"/>:</p>&#13;
&#13;
<pre data-type="programlisting">setup(props, context) {&#13;
  // ...&#13;
}</pre>&#13;
&#13;
<p><code>setup()</code> takes two arguments:</p>&#13;
<dl>&#13;
<dt><code>props</code></dt>&#13;
<dd>&#13;
<p>An object that contains all the props passed to the component, declared using the <code>props</code> field of the component’s options object. Each of <code>props</code>’s properties is reactive data. You don’t need to return <code>props</code> as part of the <code>setup()</code> return object<a data-primary="props" data-secondary="setup hook" data-type="indexterm" id="id748"/>.</p>&#13;
</dd>&#13;
<dt><code>context</code></dt>&#13;
<dd>&#13;
<p>A non-reactive object that contains the component’s context, such as <code>attrs</code>, <code>slots</code>, <code>emit</code>, and <code>expose</code><a data-primary="context" data-secondary="setup hook" data-type="indexterm" id="id749"/>.</p>&#13;
</dd>&#13;
</dl>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>If you use <code>&lt;script setup&gt;</code>, you need to use <code>defineProps()</code> to define and access these props. See <a data-type="xref" href="ch04.html#declaring-props-defineProps">“Declaring Props Using defineProps() and withDefaults()”</a><a data-primary="props" data-secondary="defining" data-type="indexterm" id="id750"/><a data-primary="defineProps()" data-type="indexterm" id="id751"/>.</p>&#13;
</div>&#13;
&#13;
<p><code>setup()</code> returns an object that contains all the references to the component’s internal reactive state and methods and any static data. Suppose you use <code>&lt;script setup&gt;</code>; you don’t need to return anything. In that case, Vue will automatically translate all the variables and functions declared within this syntax into the appropriate <code>setup()</code> return object during compilation. You then can access them in the template or other parts of the component’s options object using the <code>this</code> keyword.</p>&#13;
&#13;
<p><a data-type="xref" href="#example_03_37">Example 3-4</a> shows using <code>setup()</code> hook to define a component that prints out a static message.</p>&#13;
<div data-type="example" id="example_03_37">&#13;
<h5><span class="label">Example 3-4. </span>Defining a component with the <code>setup()</code> hook</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">import</code> <code class="p">{</code> <code class="nx">defineComponent</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'vue'</code><code class="p">;</code>&#13;
&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="nx">setup</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="kr">const</code> <code class="nx">message</code> <code class="o">=</code> <code class="s1">'Welcome to Vue 3!'</code>&#13;
    <code class="k">return</code> <code class="p">{</code>&#13;
      <code class="nx">message</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">})</code></pre></div>&#13;
&#13;
<p>Note here that <code>message</code> is not reactive data. To make it reactive, you must wrap it with the <code>ref()</code> function from the Composition API. We will learn more about this in <a data-type="xref" href="ch05.html#ref_function_06">“Handling Data with ref() and reactive()”</a>. Also, we no longer need to define <code>message</code> as part of the <code>data()</code> object, reducing the amount of undesired reactive data in a component<a data-primary="reactivity" data-secondary="setup hook and" data-type="indexterm" id="id752"/>.</p>&#13;
&#13;
<p>Alternatively, as <a data-type="xref" href="#example_03_38">Example 3-5</a> shows, you can write the previous component using the <code>&lt;script setup&gt;</code> syntax.</p>&#13;
<div data-type="example" id="example_03_38">&#13;
<h5><span class="label">Example 3-5. </span>Defining a component with <code>&lt;script setup&gt;</code> syntax</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code> <code class="na">setup</code> <code class="na">lang</code><code class="o">=</code><code class="s">'ts'</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="kd">const</code><code class="w"> </code><code class="nx">message</code><code class="w"> </code><code class="o">=</code><code class="w"> </code><code class="s1">'Welcome to Vue 3!'</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>One great thing about using <code>&lt;script setup&gt;</code> instead of <code>setup()</code> is that it has built-in TypeScript support. As a result, there is no need for <code>defineComponent()</code>, and writing components takes less code<a data-primary="TypeScript" data-secondary="setup hook and" data-type="indexterm" id="id753"/>.</p>&#13;
&#13;
<p>When using <code>setup()</code> hook, you can also combine with the <code>h()</code> render function to return a renderer for the component based on the <code>props</code> and <code>context</code> arguments, as <a data-type="xref" href="#example_03_39">Example 3-6</a> shows<a data-primary="rendering" data-secondary="h() render function with setup hook" data-type="indexterm" id="id754"/><a data-primary="h()" data-secondary="setup hook with" data-type="indexterm" id="id755"/>.</p>&#13;
<div data-type="example" id="example_03_39">&#13;
<h5><span class="label">Example 3-6. </span>Defining a component with the <code>setup()</code> hook and <code>h()</code> render function</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">import</code> <code class="p">{</code> <code class="nx">defineComponent</code><code class="p">,</code> <code class="nx">h</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'vue'</code><code class="p">;</code>&#13;
&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="nx">setup</code><code class="p">(</code><code class="nx">props</code><code class="p">,</code> <code class="nx">context</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="kr">const</code> <code class="nx">message</code> <code class="o">=</code> <code class="s1">'Welcome to Vue 3!'</code>&#13;
    <code class="k">return</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="nx">h</code><code class="p">(</code><code class="s1">'div'</code><code class="p">,</code> <code class="nx">message</code><code class="p">)</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">})</code></pre></div>&#13;
&#13;
<p>It is helpful to use <code>setup()</code> with <code>h()</code> when you want to create a component that renders a different static DOM structure based on the props passed to it or a stateless functional component (<a data-type="xref" href="#figure_35_03">Figure 3-6</a> shows the output of <a data-type="xref" href="#example_03_39">Example 3-6</a> in the Vue tab of Chrome Devtools).</p>&#13;
&#13;
<figure><div class="figure" id="figure_35_03">&#13;
<img alt="The output of the stateless component using h() render function" src="assets/lvue_0306.png"/>&#13;
<h6><span class="label">Figure 3-6. </span>How the stateless component using the <code>h()</code> render function looks in Vue Devtools</h6>&#13;
</div></figure>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>From this point on, we will use <code>&lt;script setup&gt; syntax</code> to demonstrate use cases component’s <code>setup()</code> hook due to its simplicity, whenever applicable<a data-primary="" data-startref="ix-comp-comp4" data-type="indexterm" id="id756"/>.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="beforeCreate" data-type="sect2"><div class="sect2" id="id143">&#13;
<h2>beforeCreate</h2>&#13;
&#13;
<p><code>beforeCreate</code> runs <em>before</em> the Vue renderer creates the component instance. Here the Vue engine has initialized the component but hasn’t yet triggered the <code>data()</code> function or calculated any <code>computed</code> properties. Thus, there is no reactive data available<a data-primary="beforeCreate() hook" data-secondary="Options API" data-type="indexterm" id="id757"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="created" data-type="sect2"><div class="sect2" id="id144">&#13;
<h2>created</h2>&#13;
&#13;
<p>This hook runs <em>after</em> the Vue engine creates the component instance. At this stage, the component instance exists with reactive data, watchers, computed properties, and defined methods. However, the Vue engine hasn’t yet mounted it to the DOM.</p>&#13;
&#13;
<p>The <code>created</code> hook runs <em>before the first render</em> of the component. It helps perform any task that requires <code>this</code> to be available, such as loading data from an external resource into the component<a data-primary="created() hook" data-secondary="using" data-type="indexterm" id="id758"/><a data-primary="this" data-secondary="created hook and" data-type="indexterm" id="id759"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="beforeMount" data-type="sect2"><div class="sect2" id="id37">&#13;
<h2>beforeMount</h2>&#13;
&#13;
<p>This hook runs after <code>created</code>. Here the Vue render has created the component instance and compiled its template for rendering before the first render of the &#13;
<span class="keep-together">component</span><a data-primary="beforeMount() hook" data-type="indexterm" id="id760"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="mounted" data-type="sect2"><div class="sect2" id="id145">&#13;
<h2>mounted</h2>&#13;
&#13;
<p>This hook runs after the first render of the component. At this phase, the component’s rendered DOM node is available for you to access through the ++ property. You can use this hook to perform additional side-effect calculations with the component’s DOM node<a data-primary="mounted() hook" data-secondary="using" data-type="indexterm" id="id761"/><a data-primary="mounting" data-secondary="mounted hook" data-type="indexterm" id="id762"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="beforeUpdate" data-type="sect2"><div class="sect2" id="id38">&#13;
<h2>beforeUpdate</h2>&#13;
&#13;
<p>The Vue renderer updates the component’s DOM tree when the local data state changes. This hook runs <em>after</em> the update process starts, and you can still use it to modify the component’s state internally<a data-primary="beforeUpdate() hook" data-type="indexterm" id="id763"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="updated" data-type="sect2"><div class="sect2" id="id39">&#13;
<h2>updated</h2>&#13;
&#13;
<p>This hook runs after the Vue renderer updates the component’s DOM tree<a data-primary="updated() hook" data-type="indexterm" id="id764"/>.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><code>updated</code>, <code>beforeUpdate</code>, <code>beforeMount</code> and <code>mounted</code> hooks are not available in server-side rendering (SSR)<a data-primary="server-side rendering" data-secondary="lifecycle hooks and" data-type="indexterm" id="id765"/><a data-primary="lifecycle hooks" data-secondary="Server-Side Rendering (SSR) and" data-type="indexterm" id="id766"/>.</p>&#13;
</div>&#13;
&#13;
<p>Use this hook with caution <em>since it runs after any DOM update occurs to the &#13;
<span class="keep-together">component</span></em>.</p>&#13;
<div data-type="warning" epub:type="warning"><h1>Update local state inside updated hook</h1>&#13;
<p>You <em>must not</em> mutate the component’s local data state in this hook.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="beforeUnmount" data-type="sect2"><div class="sect2" id="id40">&#13;
<h2>beforeUnmount</h2>&#13;
&#13;
<p>This hook runs before the Vue renderer starts unmounting the component. At this point, the component’s DOM node <code>$el</code> is still available<a data-primary="beforeUnmount() hook" data-type="indexterm" id="id767"/><a data-primary=".$el property" data-primary-sortas="el property" data-type="indexterm" id="id768"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="unmounted" data-type="sect2"><div class="sect2" id="id41">&#13;
<h2>unmounted</h2>&#13;
&#13;
<p>This hook runs after the unmounting process completes successfully and the component instance is no longer available. This hook can clean up additional observers or effects, such as DOM event listeners<a data-primary="unmounted() hook" data-type="indexterm" id="id769"/><a data-primary="cleanup" data-secondary="unmounted hook and" data-type="indexterm" id="id770"/>.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>In Vue 2.x, you should use <code>beforeDestroy</code> and <code>destroyed</code> in place of <code>beforeUnmount</code> and <code>mounted</code>, respectively<a data-primary="beforeDestroy() hook" data-type="indexterm" id="id771"/><a data-primary="destroyed hook" data-type="indexterm" id="id772"/>.</p>&#13;
&#13;
<p><code>beforeUnmounted</code> and <code>unmounted</code> hooks are not available in server-side rendering (SSR).</p>&#13;
</div>&#13;
&#13;
<p>In summary, we can redraw our component’s lifecycle diagram with the lifecycle hooks, as in <a data-type="xref" href="#figure_03_05">Figure 3-7</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_05">&#13;
<img alt="A diagram flowchart of the lifecycle of a Vue component with hooks" src="assets/lvue_0307.png"/>&#13;
<h6><span class="label">Figure 3-7. </span>Flowchart of a Vue component lifecycle with hooks</h6>&#13;
</div></figure>&#13;
&#13;
<p class="pagebreak-before">We can experiment with the execution order for each lifecycle hook with the component in <a data-type="xref" href="#example_03_36">Example 3-7</a><a data-primary="beforeCreate() hook" data-secondary="in lifecycle diagram" data-secondary-sortas="lifecycle diagram" data-type="indexterm" id="id773"/><a data-primary="components" data-secondary="lifecycle diagram with hooks" data-type="indexterm" id="id774"/><a data-primary="created() hook" data-secondary="in lifecycle diagram" data-secondary-sortas="lifecycle diagram" data-type="indexterm" id="id775"/><a data-primary="mounted() hook" data-secondary="in lifecycle diagram" data-secondary-sortas="lifecycle diagram" data-type="indexterm" id="id776"/><a data-primary="setup hook" data-secondary="in lifecycle diagram" data-secondary-sortas="lifecycle diagram" data-type="indexterm" id="id777"/><a data-primary="lifecycle hooks" data-secondary="diagram" data-type="indexterm" id="id778"/><a data-primary="lifecycle hooks" data-secondary="order of" data-type="indexterm" id="ix-comp-comp6"/><a data-primary="order" data-secondary="lifecycle hooks" data-type="indexterm" id="ix-comp-comp6a"/>.</p>&#13;
<div data-type="example" id="example_03_36">&#13;
<h5><span class="label">Example 3-7. </span>Console log of lifecycle hooks</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">h2</code> <code class="na">class</code><code class="o">=</code><code class="s">"heading"</code><code class="p">&gt;</code>I am {{message}}<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">input</code> <code class="na">v-model</code><code class="o">=</code><code class="s">"message"</code> <code class="na">type</code><code class="o">=</code><code class="s">"text"</code> <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter your name"</code> <code class="p">/&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="w">  </code><code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w"/>&#13;
&#13;
<code class="w">  </code><code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'MyFistComponent'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">message</code><code class="o">:</code><code class="w"> </code><code class="s1">''</code><code class="w"/>&#13;
<code class="w">      </code><code class="p">}</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">setup</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'setup hook triggered!'</code><code class="p">)</code><code class="w"/>&#13;
<code class="w">      </code><code class="k">return</code><code class="w"> </code><code class="p">{}</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">beforeCreate</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'beforeCreate hook triggered!'</code><code class="p">)</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">created</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'created hook triggered!'</code><code class="p">)</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">beforeMount</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'beforeMount hook triggered!'</code><code class="p">)</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">mounted</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'mounted hook triggered!'</code><code class="p">)</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">beforeUpdate</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'beforeUpdate hook triggered!'</code><code class="p">)</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">updated</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'updated hook triggered!'</code><code class="p">)</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">beforeUnmount</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'beforeUnmount hook triggered!'</code><code class="p">)</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">});</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p class="pagebreak-before">When we run this code in the browser’s Inspector console, we will see the output shown in <a data-type="xref" href="#figure_03_06">Figure 3-8</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_06">&#13;
<img alt="Console log output for the above component in the first render" src="assets/lvue_0308.png"/>&#13;
<h6><span class="label">Figure 3-8. </span>Console log output hook order for <code>MyFirstComponent</code> in the first render</h6>&#13;
</div></figure>&#13;
&#13;
<p>When we change the value of the <code>message</code> property, the component re-renders, and the console outputs as shown in <a data-type="xref" href="#figure_03_07">Figure 3-9</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_07">&#13;
<img alt="Console log output for the above component in the second render" src="assets/lvue_0309.png"/>&#13;
<h6><span class="label">Figure 3-9. </span>Only <code>beforeUpdate</code> and updated hooks are triggered on the second render</h6>&#13;
</div></figure>&#13;
&#13;
<p>We can also review this lifecycle order in the Timeline tab—Performance section of Vue Devtools, as in <a data-type="xref" href="#figure_03_08">Figure 3-10</a> for the first render<a data-primary="Vue Devtools" data-secondary="viewing lifecycle order" data-type="indexterm" id="id779"/>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_08">&#13;
<img alt="Timeline for the above component in the first render" src="assets/lvue_0310.png"/>&#13;
<h6><span class="label">Figure 3-10. </span>Timeline for <code>MyFirstComponent</code> in the first render</h6>&#13;
</div></figure>&#13;
&#13;
<p class="pagebreak-before">And when the component re-renders, the Vue Devtools tab displays the timeline event records as in <a data-type="xref" href="#figure_03_09">Figure 3-11</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_09">&#13;
<img alt="Timeline for the above component in the second render" src="assets/lvue_0311.png"/>&#13;
<h6><span class="label">Figure 3-11. </span>Timeline for <code>MyFirstComponent</code> in the second render</h6>&#13;
</div></figure>&#13;
&#13;
<p>Each of the previous lifecycle hooks can be beneficial. In <a data-type="xref" href="#right_hook_for_the_right_table">Table 3-1</a>, you will find the most common use cases per hook<a data-primary="lifecycle hooks" data-secondary="when to use" data-type="indexterm" id="id780"/><a data-primary="mounted() hook" data-secondary="using" data-type="indexterm" id="id781"/><a data-primary="beforeCreate() hook" data-secondary="Options API" data-type="indexterm" id="id782"/><a data-primary="created() hook" data-secondary="vs. mounted()" data-secondary-sortas="mounted" data-type="indexterm" id="id783"/><a data-primary="mounting" data-secondary="mounted hook" data-type="indexterm" id="id784"/>.</p>&#13;
<table id="right_hook_for_the_right_table">&#13;
<caption><span class="label">Table 3-1. </span>Using the right hook for the right purpose</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Lifecycle hook</th>&#13;
<th>Use case</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>beforeCreate</code></p></td>&#13;
<td><p>When you need to load external logic <em>without</em> modifying the component’s data.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>created</code></p></td>&#13;
<td><p>When you need to load external data into the component. This hook is preferable to the <code>mounted</code> one for reading or writing data from external resources.</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>mounted</code></p></td>&#13;
<td><p>When you need to perform any DOM manipulation or access the component’s DOM node <code>this.$el</code>.</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
<p>To this point, we have learned the component’s lifecycle order and its available hooks. Next, we will look at how to create and organize common component logic into methods with the <code>method</code> property<a data-primary="" data-startref="ix-comp-comp3" data-type="indexterm" id="id785"/><a data-primary="" data-startref="ix-comp-comp5" data-type="indexterm" id="id786"/><a data-primary="" data-startref="ix-comp-comp6" data-type="indexterm" id="id787"/><a data-primary="" data-startref="ix-comp-comp6a" data-type="indexterm" id="id788"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Methods" data-type="sect1"><div class="sect1" id="id42">&#13;
<h1>Methods</h1>&#13;
&#13;
<p>Methods are logic that does not depend on the component’s data, even though we can access the component’s local state using a <code>this</code> instance within a method. Components’ methods are functions defined within the <code>methods</code> property. As <a data-type="xref" href="#example_03_13">Example 3-8</a> shows, we can define a method to reverse the <code>message</code> property<a data-primary="methods property" data-type="indexterm" id="id789"/><a data-primary="components" data-secondary="methods" data-type="indexterm" id="ix-comp-comp7"/><a data-primary="methods" data-secondary="understanding" data-type="indexterm" id="ix-comp-comp7a"/>.</p>&#13;
<div data-type="example" id="example_03_13">&#13;
<h5><span class="label">Example 3-8. </span>Defining a method to reverse the <code>message</code> property</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'ReversedMessage'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">message</code><code class="o">:</code><code class="w"> </code><code class="s1">''</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">};</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">methods</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">reverseMessage</code><code class="p">()</code><code class="o">:</code><code class="nx">string</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="k">return</code><code class="w"> </code><code class="k">this</code><code class="p">.</code><code class="nx">message</code><code class="p">.</code><code class="nx">split</code><code class="p">(</code><code class="s1">''</code><code class="p">).</code><code class="nx">reverse</code><code class="p">().</code><code class="nx">join</code><code class="p">(</code><code class="s1">''</code><code class="p">)</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="p">});</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p><a data-type="xref" href="#example_03_14">Example 3-9</a> shows how we can use the <code>reverseMessage</code> method in the component’s template.</p>&#13;
<div data-type="example" id="example_03_14">&#13;
<h5><span class="label">Example 3-9. </span>Output the reversed message on the template</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h2</code> <code class="na">class</code><code class="o">=</code><code class="s">"heading"</code><code class="p">&gt;</code>I am {{reverseMessage()}}<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">input</code> <code class="na">v-model</code><code class="o">=</code><code class="s">"message"</code> <code class="na">type</code><code class="o">=</code><code class="s">"text"</code> <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter your message"</code> <code class="p">/&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>When a user inputs a message’s value in the browser, we see the output in <a data-type="xref" href="#figure_03_10">Figure 3-12</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_10">&#13;
<img alt="A screenshot displays a reversed message based on the Hello Vue message" src="assets/lvue_0312.png"/>&#13;
<h6><span class="label">Figure 3-12. </span>Reversed message based on the value of <code>message</code></h6>&#13;
</div></figure>&#13;
&#13;
<p>You can also modify the <code>reverseMessage</code> method to accept a string argument, making it more reusable and less dependent on <code>this.message</code>, as in <a data-type="xref" href="#example_03_15">Example 3-10</a>.</p>&#13;
<div class="pagebreak-before" data-type="example" id="example_03_15">&#13;
<h5><span class="label">Example 3-10. </span>Defining a method to reverse a string</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'MyFistComponent'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">message</code><code class="o">:</code><code class="w"> </code><code class="s1">''</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">};</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">methods</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">reverseMessage</code><code class="p">(</code><code class="nx">message</code><code class="o">:</code><code class="w"> </code><code class="nx">string</code><code class="p">)</code><code class="o">:</code><code class="nx">string</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="k">return</code><code class="w"> </code><code class="nx">message</code><code class="p">.</code><code class="nx">split</code><code class="p">(</code><code class="s1">''</code><code class="p">).</code><code class="nx">reverse</code><code class="p">().</code><code class="nx">join</code><code class="p">(</code><code class="s1">''</code><code class="p">)</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="p">});</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>And in the <code>template</code> section, we refactor <a data-type="xref" href="#example_03_14">Example 3-9</a> and pass <code>message</code> as input parameter for the <code>reverseMessage</code> method:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h2</code> <code class="na">class</code><code class="o">=</code><code class="s">"heading"</code><code class="p">&gt;</code>I am {{reverseMessage(message)}}<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">input</code> <code class="na">v-model</code><code class="o">=</code><code class="s">"message"</code> <code class="na">type</code><code class="o">=</code><code class="s">"text"</code> <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter your message"</code> <code class="p">/&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre>&#13;
&#13;
<p>The output stays the same as in <a data-type="xref" href="#figure_03_10">Figure 3-12</a>.</p>&#13;
&#13;
<p>Also, we can trigger a component’s method within its other properties or lifecycle hooks using the <code>this</code> instance. For example, we can split <code>reverseMessage</code> into two smaller methods, <code>reverse()</code> and <code>arrToString()</code>, as in the following code:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="cm">/**... */</code>&#13;
  <code class="nx">methods</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">reverse</code><code class="p">(</code><code class="nx">message</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code><code class="nx">string</code><code class="p">[]</code> <code class="p">{</code>&#13;
      <code class="k">return</code> <code class="nx">message</code><code class="p">.</code><code class="nx">split</code><code class="p">(</code><code class="s1">''</code><code class="p">).</code><code class="nx">reverse</code><code class="p">()</code>&#13;
    <code class="p">},</code>&#13;
    <code class="nx">arrToString</code><code class="p">(</code><code class="nx">arr</code><code class="o">:</code> <code class="nx">string</code><code class="p">[])</code><code class="o">:</code><code class="nx">string</code> <code class="p">{</code>&#13;
      <code class="k">return</code> <code class="nx">arr</code><code class="p">.</code><code class="nx">join</code><code class="p">(</code><code class="s1">''</code><code class="p">)</code>&#13;
    <code class="p">},</code>&#13;
    <code class="nx">reverseMessage</code><code class="p">(</code><code class="nx">message</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code><code class="o">:</code><code class="nx">string</code> <code class="p">{</code>&#13;
      <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">arrToString</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">reverse</code><code class="p">(</code><code class="nx">message</code><code class="p">))</code>&#13;
    <code class="p">},</code>&#13;
  <code class="p">},</code></pre>&#13;
&#13;
<p>Methods are beneficial in keeping your component’s logic organized. Vue triggers a method only when it is relevant (such as being called in the template as in <a data-type="xref" href="#example_03_14">Example 3-9</a>), allowing us to compute a new data value from local data dynamically. However, for methods, Vue does not cache the result of every trigger, and it will always rerun the method whenever a re-render occurs. Thus, in scenarios where you need to calculate new data, it is better to use computed properties, which we will explore next<a data-primary="" data-startref="ix-comp-comp7" data-type="indexterm" id="id790"/><a data-primary="" data-startref="ix-comp-comp7a" data-type="indexterm" id="id791"/><a data-primary="caching" data-secondary="methods" data-type="indexterm" id="id792"/><a data-primary="methods" data-secondary="vs. computed properties" data-secondary-sortas="computed properties" data-type="indexterm" id="id793"/><a data-primary="methods" data-secondary="triggering" data-type="indexterm" id="id794"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Computed Properties" data-type="sect1"><div class="sect1" id="id43">&#13;
<h1>Computed Properties</h1>&#13;
&#13;
<p>Computed properties are Vue’s unique features that allow you to calculate new reactive data properties from any reactive data of a component. Each computed property is a function that returns a value and resides within the <code>computed</code> property field<a data-primary="components" data-secondary="computed properties" data-type="indexterm" id="ix-comp-comp8"/><a data-primary="computed properties" data-type="indexterm" id="ix-comp-comp8a"/><a data-primary="computed property field" data-type="indexterm" id="ix-comp-comp8b"/><a data-primary="properties" data-secondary="computed" data-type="indexterm" id="ix-comp-comp8c"/>.</p>&#13;
&#13;
<p><a data-type="xref" href="#example_03_05">Example 3-11</a> shows how we define a newly computed property, <code>reversedMessage</code>, which returns the component’s local data <code>message</code> in reversed order.</p>&#13;
<div data-type="example" id="example_03_05">&#13;
<h5><span class="label">Example 3-11. </span>A computed property that returns the component’s local message in reversed order</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">import</code> <code class="p">{</code> <code class="nx">defineComponent</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'vue'</code>&#13;
&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'ReversedMessage'</code><code class="p">,</code>&#13;
  <code class="nx">data</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="p">{</code>&#13;
      <code class="nx">message</code><code class="o">:</code> <code class="s1">'Hello Vue!'</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">},</code>&#13;
  <code class="nx">computed</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">reversedMessage</code><code class="p">()</code> <code class="p">{</code>&#13;
      <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">message</code><code class="p">.</code><code class="nx">split</code><code class="p">(</code><code class="s1">''</code><code class="p">).</code><code class="nx">reverse</code><code class="p">().</code><code class="nx">join</code><code class="p">(</code><code class="s1">''</code><code class="p">)</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">})</code></pre></div>&#13;
&#13;
<p>You can access <code>reversedMessage</code> computed with the same approach as any component’s local data. <a data-type="xref" href="#example_03_02">Example 3-12</a> shows how we can output the calculated <code>reversed</code>&#13;
<span class="keep-together"><code>Message</code></span> based on the input value of <code>message</code>.</p>&#13;
<div data-type="example" id="example_03_02">&#13;
<h5><span class="label">Example 3-12. </span>Computed property example</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h2</code> <code class="na">class</code><code class="o">=</code><code class="s">"heading"</code><code class="p">&gt;</code>I am {{ reversedMessage }}<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">input</code> <code class="na">v-model</code><code class="o">=</code><code class="s">"message"</code> <code class="na">type</code><code class="o">=</code><code class="s">"text"</code> <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter your message"</code> <code class="p">/&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p><a data-type="xref" href="#example_03_02">Example 3-12</a> has the same output as in <a data-type="xref" href="#figure_03_10">Figure 3-12</a>.</p>&#13;
&#13;
<p>You can also track the computed property in the Components tab of the Vue Devtools (<a data-type="xref" href="#figure_03_11">Figure 3-13</a>).</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_11">&#13;
<img alt="A screenshot shows the computed properties in Components tab of the Vue Devtools" src="assets/lvue_0313.png"/>&#13;
<h6><span class="label">Figure 3-13. </span>Computed properties <code>reversedMessage</code> in the Components tab</h6>&#13;
</div></figure>&#13;
&#13;
<p>Similarly, you can access a computed property’s value in the component’s logic through the <code>this</code> instance as its local data property. You can also calculate a new computed property based on the computed property’s value. As <a data-type="xref" href="#example_06_03">Example 3-13</a> shows, we can add the length of the <code>reversedMessage</code> property value into a new property, <code>reversedMessageLength</code><a data-primary="this" data-secondary="accessing computed property's value" data-type="indexterm" id="id795"/>.</p>&#13;
<div data-type="example" id="example_06_03">&#13;
<h5><span class="label">Example 3-13. </span>Adding <code>reversedMessageLength</code> computed property</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">import</code> <code class="p">{</code> <code class="nx">defineComponent</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'vue'</code>&#13;
&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="cm">/**... */</code>&#13;
  <code class="nx">computed</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">reversedMessage</code><code class="p">()</code> <code class="p">{</code>&#13;
      <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">message</code><code class="p">.</code><code class="nx">split</code><code class="p">(</code><code class="s1">''</code><code class="p">).</code><code class="nx">reverse</code><code class="p">().</code><code class="nx">join</code><code class="p">(</code><code class="s1">''</code><code class="p">)</code>&#13;
    <code class="p">},</code>&#13;
    <code class="nx">reversedMessageLength</code><code class="p">()</code> <code class="p">{</code>&#13;
      <code class="k">return</code> <code class="k">this</code><code class="p">.</code><code class="nx">reversedMessage</code><code class="p">.</code><code class="nx">length</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">})</code></pre></div>&#13;
&#13;
<p>The Vue engine automatically caches the value of computed properties and re-computes the value only when related reactive data changes. As in <a data-type="xref" href="#example_03_02">Example 3-12</a>, Vue will update the value of <code>reversedMessage</code> computed property only when <code>message</code> changes. If you want to display or reuse the <code>reversedMessage</code> value in another location within the component, Vue will not need to recalculate its value<a data-primary="caching" data-secondary="computed properties" data-type="indexterm" id="id796"/><a data-primary="performance" data-secondary="computed properties" data-type="indexterm" id="id797"/>.</p>&#13;
&#13;
<p>Using computed properties helps organize complex data modification into reusable data blocks. Thus, it reduces the amount of code required and keeps code clean while improving your component’s performance. Using computed properties also allows you to quickly set up an automatic watcher for any reactive data property, by having them appear in the implementation logic of the computed property function<a data-primary="performance" data-secondary="watchers" data-type="indexterm" id="id798"/>.</p>&#13;
&#13;
<p>However, in some scenarios, this automatic watcher mechanism can create overhead to keep the component’s performance stable. In such cases, we can consider using watchers through the <code>watch</code> property field of the component<a data-primary="" data-startref="ix-comp-comp8" data-type="indexterm" id="id799"/><a data-primary="" data-startref="ix-comp-comp8a" data-type="indexterm" id="id800"/><a data-primary="" data-startref="ix-comp-comp8b" data-type="indexterm" id="id801"/><a data-primary="" data-startref="ix-comp-comp8c" data-type="indexterm" id="id802"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Watchers" data-type="sect1"><div class="sect1" id="id44">&#13;
<h1>Watchers</h1>&#13;
&#13;
<p>Watchers allow you to programmatically watch for changes in any reactive data property of a component and handle them. Each watcher is a function that receives two arguments: the new value (<code>newValue</code>) and the current value (<code>oldValue</code>) of the observed data. It then performs any logic based on these two input parameters. We define a watcher for reactive data by adding it to the <code>watch</code> property field of the component’s options, following this syntax<a data-primary="Options API" data-secondary="watchers" data-type="indexterm" id="ix-comp-comp9"/><a data-primary="watchers" data-secondary="using" data-type="indexterm" id="ix-comp-comp9b"/><a data-primary="watch property" data-type="indexterm" id="ix-comp-comp10a"/>:</p>&#13;
&#13;
<pre data-type="programlisting">watch: {&#13;
  'reactiveDataPropertyName'(newValue, oldValue) {&#13;
    // do something&#13;
  }&#13;
}</pre>&#13;
&#13;
<p>You need to replace the <code>reactiveDataPropertyName</code> with the name of the target component’s data that we want to observe.</p>&#13;
&#13;
<p><a data-type="xref" href="#example_03_07">Example 3-14</a> shows how we define a new watcher to observe for changes in the component’s local data <code>message</code>.</p>&#13;
<div data-type="example" id="example_03_07">&#13;
<h5><span class="label">Example 3-14. </span>A watcher that observes for changes in the component’s local message</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">export</code> <code class="k">default</code> <code class="p">{</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'MyFirstComponent'</code><code class="p">,</code>&#13;
  <code class="nx">data</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="p">{</code>&#13;
      <code class="nx">message</code><code class="o">:</code> <code class="s1">'Hello Vue!'</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">},</code>&#13;
  <code class="nx">watch</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">message</code><code class="p">(</code><code class="nx">newValue</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">oldValue</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>&#13;
      <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`new value: </code><code class="si">${</code><code class="nx">newValue</code><code class="si">}</code><code class="sb">, old value: </code><code class="si">${</code><code class="nx">oldValue</code><code class="si">}</code><code class="sb">`</code><code class="p">)</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>In this example, we have defined a <code>message</code> watcher that observes changes in the &#13;
<span class="keep-together"><code>message</code></span> property. The Vue engine triggers the watcher whenever the value of &#13;
<span class="keep-together"><code>message</code></span> changes. <a data-type="xref" href="#figure_03_12">Figure 3-14</a> shows the console log output for this watcher.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_12">&#13;
<img alt="A screenshot shows the console log output whenever the message changes, with new value first and old value second" src="assets/lvue_0314.png"/>&#13;
<h6><span class="label">Figure 3-14. </span>Console log output when the message changes</h6>&#13;
</div></figure>&#13;
&#13;
<p>We can implement the <code>reservedMessage</code> in <a data-type="xref" href="#example_03_05">Example 3-11</a> using a watcher on &#13;
<span class="keep-together"><code>message</code></span> and <code>data()</code> field instead of computed properties, as seen in <a data-type="xref" href="#example_03_08">Example 3-15</a>.</p>&#13;
<div data-type="example" id="example_03_08">&#13;
<h5><span class="label">Example 3-15. </span>A watcher that observes for changes in the component’s local message and updates the value of <code>reversedMessage</code></h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">import</code> <code class="p">{</code> <code class="nx">defineComponent</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'vue'</code>&#13;
&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'MyFirstComponent'</code><code class="p">,</code>&#13;
  <code class="nx">data</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="p">{</code>&#13;
      <code class="nx">message</code><code class="o">:</code> <code class="s1">'Hello Vue!'</code><code class="p">,</code>&#13;
      <code class="nx">reversedMessage</code><code class="o">:</code> <code class="s1">'Hello Vue!'</code><code class="p">.</code><code class="nx">split</code><code class="p">(</code><code class="s1">''</code><code class="p">).</code><code class="nx">reverse</code><code class="p">().</code><code class="nx">join</code><code class="p">(</code><code class="s1">''</code><code class="p">)</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">},</code>&#13;
  <code class="nx">watch</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">message</code><code class="p">(</code><code class="nx">newValue</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">oldValue</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>&#13;
      <code class="k">this</code><code class="p">.</code><code class="nx">reversedMessage</code> <code class="o">=</code> <code class="nx">newValue</code><code class="p">.</code><code class="nx">split</code><code class="p">(</code><code class="s1">''</code><code class="p">).</code><code class="nx">reverse</code><code class="p">().</code><code class="nx">join</code><code class="p">(</code><code class="s1">''</code><code class="p">)</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">})</code></pre></div>&#13;
&#13;
<p>The output remains the same as in <a data-type="xref" href="#figure_03_10">Figure 3-12</a>. However, this approach is not recommended in this specific case, as it is less efficient than using computed properties.</p>&#13;
<div class="pagebreak-before" data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Side effects are any additional logic triggered by the watcher or within the computed property. Side effects can impact the component’s performance; you should handle them with caution<a data-primary="side effects" data-secondary="computed properties" data-type="indexterm" id="id803"/><a data-primary="side effects" data-secondary="watchers" data-type="indexterm" id="id804"/><a data-primary="watchers" data-secondary="side effects" data-type="indexterm" id="id805"/><a data-primary="properties" data-secondary="computed" data-type="indexterm" id="id806"/><a data-primary="computed properties" data-type="indexterm" id="id807"/>.</p>&#13;
</div>&#13;
&#13;
<p>You can assign the handler function directly to the watcher name. The Vue engine will automatically call the handler with a set of default configurations for watchers. However, you can also pass an object to the watcher’s name to customize the watcher’s behavior, using the fields in <a data-type="xref" href="#watcher_objects_fields_table">Table 3-2</a><a data-primary="flush, watcher field" data-type="indexterm" id="id808"/><a data-primary="handler watcher field" data-type="indexterm" id="id809"/><a data-primary="immediate, watcher field" data-type="indexterm" id="id810"/><a data-primary="deep, watcher field" data-type="indexterm" id="ix-comp-comp11"/>.</p>&#13;
<table id="watcher_objects_fields_table">&#13;
<caption><span class="label">Table 3-2. </span>The watcher object’s fields</caption>&#13;
<thead>&#13;
<tr>&#13;
<th>Watcher’s field</th>&#13;
<th>Description</th>&#13;
<th>Accepted type</th>&#13;
<th>Default value</th>&#13;
<th>Required?</th>&#13;
</tr>&#13;
</thead>&#13;
<tbody>&#13;
<tr>&#13;
<td><p><code>handler</code></p></td>&#13;
<td><p>The callback function to trigger when the target data’s value changes.</p></td>&#13;
<td><p>function</p></td>&#13;
<td><p>N/A</p></td>&#13;
<td><p>Yes</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>deep</code></p></td>&#13;
<td><p>Indicates whether Vue should observe for changes in the nested properties of the target data (if any).</p></td>&#13;
<td><p>boolean</p></td>&#13;
<td><p><code>false</code></p></td>&#13;
<td><p>No</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>immediate</code></p></td>&#13;
<td><p>Indicates whether to trigger the handler immediately after mounting the component.</p></td>&#13;
<td><p>boolean</p></td>&#13;
<td><p><code>false</code></p></td>&#13;
<td><p>No</p></td>&#13;
</tr>&#13;
<tr>&#13;
<td><p><code>flush</code></p></td>&#13;
<td><p>Indicates the timing order of the handler’s execution. By default, Vue triggers the handler before updating the Vue component.</p></td>&#13;
<td><p>pre, post</p></td>&#13;
<td><p><code>pre</code></p></td>&#13;
<td><p>No</p></td>&#13;
</tr>&#13;
</tbody>&#13;
</table>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Observing for Changes in Nested Properties" data-type="sect2"><div class="sect2" id="id45">&#13;
<h2>Observing for Changes in Nested Properties</h2>&#13;
&#13;
<p>The <code>deep</code> option field allows you to observe changes in all nested properties. Take a <code>user</code> object data in a <code>UserWatcherComponent</code> component with two nested properties: <code>name</code> and <code>age</code>, for instance. We define a <code>user</code> watcher that observes for changes in the <code>user</code> object’s nested properties using the <code>deep</code> option field, as in <a data-type="xref" href="#example_03_09">Example 3-16</a><a data-primary="nested properties, watchers" data-type="indexterm" id="ix-comp-comp12"/><a data-primary="properties" data-secondary="nested properties and watchers" data-type="indexterm" id="ix-comp-comp12a"/>.</p>&#13;
<div data-type="example" id="example_03_09">&#13;
<h5><span class="label">Example 3-16. </span>A watcher that observes for changes in the user object’s nested properties</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">import</code> <code class="p">{</code> <code class="nx">defineComponent</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'vue'</code>&#13;
&#13;
<code class="nx">type</code> <code class="nx">User</code> <code class="o">=</code> <code class="p">{</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code>&#13;
  <code class="nx">age</code><code class="o">:</code> <code class="nx">number</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'UserWatcherComponent'</code><code class="p">,</code>&#13;
  <code class="nx">data</code><code class="p">()</code><code class="o">:</code> <code class="p">{</code> <code class="nx">user</code><code class="o">:</code> <code class="nx">User</code> <code class="p">}</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="p">{</code>&#13;
      <code class="nx">user</code><code class="o">:</code> <code class="p">{</code>&#13;
        <code class="nx">name</code><code class="o">:</code> <code class="s1">'John'</code><code class="p">,</code>&#13;
        <code class="nx">age</code><code class="o">:</code> <code class="mi">30</code>&#13;
      <code class="p">}</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">},</code>&#13;
  <code class="nx">watch</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">user</code><code class="o">:</code> <code class="p">{</code>&#13;
      <code class="nx">handler</code><code class="p">(</code><code class="nx">newValue</code><code class="o">:</code> <code class="nx">User</code><code class="p">,</code> <code class="nx">oldValue</code><code class="o">:</code> <code class="nx">User</code><code class="p">)</code> <code class="p">{</code>&#13;
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">({</code> <code class="nx">newValue</code><code class="p">,</code> <code class="nx">oldValue</code> <code class="p">})</code>&#13;
      <code class="p">},</code>&#13;
      <code class="nx">deep</code><code class="o">:</code> <code class="kc">true</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">})</code></pre></div>&#13;
&#13;
<p>As <a data-type="xref" href="#example_03_10">Example 3-17</a> shows, in the template section of the <code>UserWatcherComponent</code> component, we receive the input for the <code>user</code> object’s fields, <code>name</code> and <code>age</code>.</p>&#13;
<div data-type="example" id="example_03_10">&#13;
<h5><span class="label">Example 3-17. </span>Template section for the <code>UserWatcherComponent</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">label</code> <code class="na">for</code><code class="o">=</code><code class="s">"name"</code><code class="p">&gt;</code>Name:&#13;
        <code class="p">&lt;</code><code class="nt">input</code> <code class="na">v-model</code><code class="o">=</code><code class="s">"user.name"</code> <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter your name"</code> <code class="na">id</code><code class="o">=</code><code class="s">"name"</code> <code class="p">/&gt;</code>&#13;
      <code class="p">&lt;/</code><code class="nt">label</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">label</code> <code class="na">for</code><code class="o">=</code><code class="s">"age"</code><code class="p">&gt;</code>Age:&#13;
        <code class="p">&lt;</code><code class="nt">input</code> <code class="na">v-model</code><code class="o">=</code><code class="s">"user.age"</code> <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter your age"</code> <code class="na">id</code><code class="o">=</code><code class="s">"age"</code> <code class="p">/&gt;</code>&#13;
      <code class="p">&lt;/</code><code class="nt">label</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>In this case, the Vue engine triggers the <code>user</code> watcher whenever the value of <code>user.name</code> or <code>user.age</code> changes. <a data-type="xref" href="#figure_03_13">Figure 3-15</a> shows the console log output for this watcher when we change the value of <code>user.name</code>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_13">&#13;
<img alt="A screenshot shows the console log output whenever the user object's nested properties change, with new value first and old value second" src="assets/lvue_0315.png"/>&#13;
<h6><span class="label">Figure 3-15. </span>Console log output when the user object’s nested properties change</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-type="xref" href="#figure_03_13">Figure 3-15</a> shows the new and old value of <code>user</code> is identical. This happens because the <code>user</code> object is still the same instance and only its <code>name</code> field’s value changed.</p>&#13;
&#13;
<p>Also, once we turn on the <code>deep</code> flag, the Vue engine will traverse all the properties of the <code>user</code> object and their nested properties, then observe for changes in them. Thus, it may cause performance issues when the <code>user</code> object structure contains a more complex internal data structure. In this case, it’s better to specify which nested properties you wish to monitor, as shown in <a data-type="xref" href="#example_03_11">Example 3-18</a><a data-primary="performance" data-secondary="watchers" data-type="indexterm" id="id811"/>.</p>&#13;
<div data-type="example" id="example_03_11">&#13;
<h5><span class="label">Example 3-18. </span>A watcher that observes for changes in the user’s name</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">//...</code>&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="c1">//...</code>&#13;
  <code class="nx">watch</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="s1">'user.name'</code><code class="o">:</code> <code class="p">{</code>&#13;
      <code class="nx">handler</code><code class="p">(</code><code class="nx">newValue</code><code class="o">:</code> <code class="nx">string</code><code class="p">,</code> <code class="nx">oldValue</code><code class="o">:</code> <code class="nx">string</code><code class="p">)</code> <code class="p">{</code>&#13;
        <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">({</code> <code class="nx">newValue</code><code class="p">,</code> <code class="nx">oldValue</code> <code class="p">})</code>&#13;
      <code class="p">},</code>&#13;
    <code class="p">},</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>Here we observe changes only in <code>user.name</code> property. <a data-type="xref" href="#figure_03_14">Figure 3-16</a> shows the console log output for this watcher.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_14">&#13;
<img alt="A screenshot shows the console log output whenever the user object's name changes, with new value first and old value second" src="assets/lvue_0316.png"/>&#13;
<h6><span class="label">Figure 3-16. </span>Console log outputs only when the user object’s name changes</h6>&#13;
</div></figure>&#13;
&#13;
<p>You can use the dot-delimited path approach to enable watching a specific child property, regardless of how deeply nested it is. For example, if the <code>user</code> has this:</p>&#13;
&#13;
<pre data-type="programlisting">type User = {&#13;
  name: string;&#13;
  age: number;&#13;
  address: {&#13;
    street: string;&#13;
    city: string;&#13;
    country: string;&#13;
    zip: string;&#13;
  };&#13;
}</pre>&#13;
&#13;
<p>Suppose you need to watch for changes in <code>user.address.city</code>; you can do so by using <em>“user.address.city”</em> as the watcher name, and so on. By taking this approach, you can avoid undesired performance issues on deep watching and narrow the scope of the watcher to only the properties you need<a data-primary="" data-startref="ix-comp-comp10a" data-type="indexterm" id="id812"/><a data-primary="" data-startref="ix-comp-comp11" data-type="indexterm" id="id813"/><a data-primary="" data-startref="ix-comp-comp12" data-type="indexterm" id="id814"/><a data-primary="" data-startref="ix-comp-comp12a" data-type="indexterm" id="id815"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using the this.$watch() Method" data-type="sect2"><div class="sect2" id="id46">&#13;
<h2>Using the this.$watch() Method</h2>&#13;
&#13;
<p>In most cases, the <code>watch</code> option is enough to handle your watcher needs. However, there are scenarios where you don’t want to enable certain watchers when not necessary. For instance, you may want to enable the <code>user.address.city</code> watcher only when the <code>user</code> object’s <code>address</code> property is not <code>null</code>. In this case, you can use the <code>this.$watch()</code> method to create the watcher upon creating the component &#13;
<span class="keep-together">conditionally</span><a data-primary="this.$watch() method" data-type="indexterm" id="ix-comp-comp13"/><a data-primary="watchers" data-secondary="conditional watchers with this.$watch()" data-type="indexterm" id="ix-comp-comp13a"/>.</p>&#13;
&#13;
<p>The <code>this.$watch()</code> method accepts the following parameters:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Name of the target data to watch as a string</p>&#13;
</li>&#13;
<li>&#13;
<p>The callback function as a watcher’s handler to trigger when the target data’s value changes</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p><code>this.$watch()</code> returns a function you can call to stop the watcher. The code in <a data-type="xref" href="#example_03_12">Example 3-19</a> shows how to use the <code>this.$watch()</code> method to create a watcher that observes for changes in <code>user.address.city</code>.</p>&#13;
<div data-type="example" id="example_03_12">&#13;
<h5><span class="label">Example 3-19. </span>A watcher that observes for changes in city field in the user’s address</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">import</code><code> </code><code class="p">{</code><code> </code><code class="nx">defineComponent</code><code> </code><code class="p">}</code><code> </code><code class="nx">from</code><code> </code><code class="s2">"vue"</code><code class="p">;</code><code>&#13;
</code><code class="kr">import</code><code> </code><code class="nx">type</code><code> </code><code class="p">{</code><code> </code><code class="nx">WatchStopHandle</code><code> </code><code class="p">}</code><code> </code><code class="nx">from</code><code> </code><code class="s2">"vue"</code><code class="p">;</code><code>&#13;
&#13;
</code><code class="c1">//...&#13;
</code><code class="kr">export</code><code> </code><code class="k">default</code><code> </code><code class="nx">defineComponent</code><code class="p">(</code><code class="p">{</code><code>&#13;
  </code><code class="nx">name</code><code class="o">:</code><code> </code><code class="s2">"UserWatcherComponent"</code><code class="p">,</code><code>&#13;
  </code><code class="nx">data</code><code class="p">(</code><code class="p">)</code><code class="o">:</code><code> </code><code class="p">{</code><code> </code><code class="nx">user</code><code class="o">:</code><code> </code><code class="nx">User</code><code class="p">;</code><code> </code><code class="nx">stopWatchingAddressCity</code><code class="o">?</code><code class="o">:</code><code> </code><code class="nx">WatchStopHandle</code><code> </code><code class="p">}</code><code> </code><code class="p">{</code><code>&#13;
    </code><code class="k">return</code><code> </code><code class="p">{</code><code>&#13;
      </code><code class="nx">user</code><code class="o">:</code><code> </code><code class="p">{</code><code>&#13;
        </code><code class="nx">name</code><code class="o">:</code><code> </code><code class="s2">"John"</code><code class="p">,</code><code>&#13;
        </code><code class="nx">age</code><code class="o">:</code><code> </code><code class="mi">30</code><code class="p">,</code><code>&#13;
        </code><code class="nx">address</code><code class="o">:</code><code> </code><code class="p">{</code><code>&#13;
          </code><code class="nx">street</code><code class="o">:</code><code> </code><code class="s2">"123 Main St"</code><code class="p">,</code><code>&#13;
          </code><code class="nx">city</code><code class="o">:</code><code> </code><code class="s2">"New York"</code><code class="p">,</code><code>&#13;
          </code><code class="nx">country</code><code class="o">:</code><code> </code><code class="s2">"USA"</code><code class="p">,</code><code>&#13;
          </code><code class="nx">zip</code><code class="o">:</code><code> </code><code class="s2">"10001"</code><code class="p">,</code><code>&#13;
        </code><code class="p">}</code><code class="p">,</code><code>&#13;
      </code><code class="p">}</code><code class="p">,</code><code>&#13;
      </code><code class="nx">stopWatchingAddressCity</code><code class="o">:</code><code> </code><code class="kc">undefined</code><code class="p">,</code><code> </code><a class="co" href="#callout_composing_components_CO1-1" id="co_composing_components_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
    </code><code class="p">}</code><code class="p">;</code><code>&#13;
  </code><code class="p">}</code><code class="p">,</code><code>&#13;
  </code><code class="nx">created</code><code class="p">(</code><code class="p">)</code><code> </code><code class="p">{</code><code>&#13;
    </code><code class="k">if</code><code> </code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">user</code><code class="p">.</code><code class="nx">address</code><code class="p">)</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_composing_components_CO1-2" id="co_composing_components_CO1-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
      </code><code class="k">this</code><code class="p">.</code><code class="nx">stopWatchingAddressCity</code><code> </code><code class="o">=</code><code> </code><code class="k">this</code><code class="p">.</code><code class="nx">$watch</code><code class="p">(</code><code>&#13;
        </code><code class="s2">"user.address.city"</code><code class="p">,</code><code>&#13;
        </code><code class="p">(</code><code class="nx">newValue</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">,</code><code> </code><code class="nx">oldValue</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">)</code><code> </code><code class="o">=&gt;</code><code> </code><code class="p">{</code><code>&#13;
          </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="p">{</code><code> </code><code class="nx">newValue</code><code class="p">,</code><code> </code><code class="nx">oldValue</code><code> </code><code class="p">}</code><code class="p">)</code><code class="p">;</code><code>&#13;
        </code><code class="p">}</code><code>&#13;
      </code><code class="p">)</code><code class="p">;</code><code>&#13;
    </code><code class="p">}</code><code>&#13;
  </code><code class="p">}</code><code class="p">,</code><code>&#13;
  </code><code class="nx">beforeUnmount</code><code class="p">(</code><code class="p">)</code><code> </code><code class="p">{</code><code>&#13;
    </code><code class="k">if</code><code> </code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">stopWatchingAddressCity</code><code class="p">)</code><code> </code><code class="p">{</code><code> </code><a class="co" href="#callout_composing_components_CO1-3" id="co_composing_components_CO1-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
      </code><code class="k">this</code><code class="p">.</code><code class="nx">stopWatchingAddressCity</code><code class="p">(</code><code class="p">)</code><code class="p">;</code><code>&#13;
    </code><code class="p">}</code><code>&#13;
  </code><code class="p">}</code><code class="p">,</code><code>&#13;
</code><code class="p">}</code><code class="p">)</code><code class="p">;</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_composing_components_CO1-1" id="callout_composing_components_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Define a <code>stopWatchingAddressCity</code> property for storing the watcher’s return function.</p></dd>&#13;
<dt><a class="co" href="#co_composing_components_CO1-2" id="callout_composing_components_CO1-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>Create a watcher for <code>user.address.city</code> only when the <code>user</code> object’s <code>address</code> object property is available.</p></dd>&#13;
<dt><a class="co" href="#co_composing_components_CO1-3" id="callout_composing_components_CO1-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>Before unmounting the component, trigger the <code>stopWatchingAddressCity</code> function to stop the watcher if relevant.</p></dd>&#13;
</dl>&#13;
&#13;
<p>Using this approach, we can limit the number of unnecessary watchers created, such as the watcher for <code>user.address.city</code> when <code>user.address</code> doesn’t exist.</p>&#13;
&#13;
<p>Next, we will look at another interesting feature of Vue, the <code>slot</code> component<a data-primary="" data-startref="ix-comp-comp9" data-type="indexterm" id="id816"/><a data-primary="" data-startref="ix-comp-comp9b" data-type="indexterm" id="id817"/><a data-primary="" data-startref="ix-comp-comp13" data-type="indexterm" id="id818"/><a data-primary="" data-startref="ix-comp-comp13a" data-type="indexterm" id="id819"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="The Power of Slots" data-type="sect1"><div class="sect1" id="id47">&#13;
<h1>The Power of Slots</h1>&#13;
&#13;
<p>Building a component is about more than just its data and logic. We often want to maintain the current component’s sense and existing design but still allow users to modify parts of the UI template. This flexibility is crucial when building a customizable component library in any framework. Fortunately, Vue offers the <code>&lt;slot&gt;</code> component to allow us to dynamically replace the default UI design for an element when needed<a data-primary="components" data-secondary="slots" data-type="indexterm" id="ix-comp-comp14"/><a data-primary="slots" data-secondary="understanding" data-type="indexterm" id="ix-comp-comp14a"/><a data-primary="slots" data-secondary="basic slots" data-type="indexterm" id="ix-comp-comp15"/>.</p>&#13;
&#13;
<p>For instance, let’s build a layout component <code>ListLayout</code> to render a list of items, with each item having the following type:</p>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">interface</code> <code class="nx">Item</code> <code class="p">{</code>&#13;
  <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="nx">string</code>&#13;
  <code class="nx">description</code><code class="o">:</code> <code class="nx">string</code>&#13;
  <code class="nx">thumbnail</code><code class="o">?:</code> <code class="nx">string</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>For each item in the list, by default, the layout component should render its name and description, as shown in <a data-type="xref" href="#example_03_30">Example 3-20</a>.</p>&#13;
<div data-type="example" id="example_03_30">&#13;
<h5><span class="label">Example 3-20. </span>The first template implementation of the <code>ListLayout</code> component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">ul</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">li</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item"</code> <code class="na">v-for</code><code class="o">=</code><code class="s">"item in items"</code> <code class="na">:key</code><code class="o">=</code><code class="s">"item.id"</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__name"</code><code class="p">&gt;</code>{{ item.name }}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__description"</code><code class="p">&gt;</code>{{ item.description }}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">li</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">ul</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>We also define a sample list of items to render for <code>ListLayout</code> in its <code>script</code> section (<a data-type="xref" href="#example_03_33">Example 3-21</a>).</p>&#13;
<div data-type="example" id="example_03_33">&#13;
<h5><span class="label">Example 3-21. </span>The script section of the <code>ListLayout</code> component</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">import</code> <code class="p">{</code> <code class="nx">defineComponent</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'vue'</code>&#13;
&#13;
<code class="c1">//...</code>&#13;
&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'ListLayout'</code><code class="p">,</code>&#13;
  <code class="nx">data</code><code class="p">()</code><code class="o">:</code> <code class="p">{</code> <code class="nx">items</code><code class="o">:</code> <code class="nx">Item</code><code class="p">[]</code> <code class="p">}</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="p">{</code>&#13;
      <code class="nx">items</code><code class="o">:</code> <code class="p">[</code>&#13;
        <code class="p">{</code>&#13;
          <code class="nx">id</code><code class="o">:</code> <code class="mi">1</code><code class="p">,</code>&#13;
          <code class="nx">name</code><code class="o">:</code> <code class="s2">"Item 1"</code><code class="p">,</code>&#13;
          <code class="nx">description</code><code class="o">:</code> <code class="s2">"This is item 1"</code><code class="p">,</code>&#13;
          <code class="nx">thumbnail</code><code class="o">:</code>&#13;
<code class="s2">"https://res.cloudinary.com/mayashavin/image/upload/v1643005666/Demo/supreme_pizza"</code><code class="p">,</code>&#13;
        <code class="p">},</code>&#13;
        <code class="p">{</code>&#13;
          <code class="nx">id</code><code class="o">:</code> <code class="mi">2</code><code class="p">,</code>&#13;
          <code class="nx">name</code><code class="o">:</code> <code class="s2">"Item 2"</code><code class="p">,</code>&#13;
          <code class="nx">description</code><code class="o">:</code> <code class="s2">"This is item 2"</code><code class="p">,</code>&#13;
          <code class="nx">thumbnail</code><code class="o">:</code>&#13;
<code class="s2">"https://res.cloudinary.com/mayashavin/image/upload/v1643005666/Demo/hawaiian_pizza"</code><code class="p">,</code>&#13;
        <code class="p">},</code>&#13;
        <code class="p">{</code>&#13;
          <code class="nx">id</code><code class="o">:</code> <code class="mi">3</code><code class="p">,</code>&#13;
          <code class="nx">name</code><code class="o">:</code> <code class="s2">"Item 3"</code><code class="p">,</code>&#13;
          <code class="nx">description</code><code class="o">:</code> <code class="s2">"This is item 3"</code><code class="p">,</code>&#13;
          <code class="nx">thumbnail</code><code class="o">:</code>&#13;
<code class="s2">"https://res.cloudinary.com/mayashavin/image/upload/v1643005666/Demo/pina_colada_pizza"</code><code class="p">,</code>&#13;
        <code class="p">},</code>&#13;
      <code class="p">]</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">})</code></pre></div>&#13;
&#13;
<p class="pagebreak-before"><a data-type="xref" href="#figure_03_30">Figure 3-17</a> shows the default rendered UI of a single item using the previous template (<a data-type="xref" href="#example_03_30">Example 3-20</a>) and data (<a data-type="xref" href="#example_03_33">Example 3-21</a>).</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_30">&#13;
<img alt="A screenshot shows the sample UI layout of the item in ListLayout component" src="assets/lvue_0317.png"/>&#13;
<h6><span class="label">Figure 3-17. </span>A sample UI layout of the item in the <code>ListLayout</code> component</h6>&#13;
</div></figure>&#13;
&#13;
<p>Based on this default UI, we can then offer users an option to customize each item’s UI. To do so, we wrap the code block within a <code>li</code> element with a <code>slot</code> element, as shown in <a data-type="xref" href="#example_03_31">Example 3-22</a>.</p>&#13;
<div data-type="example" id="example_03_31">&#13;
<h5><span class="label">Example 3-22. </span><code>ListLayout</code> component with <code>slot</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">ul</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">li</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item"</code> <code class="na">v-for</code><code class="o">=</code><code class="s">"item in items"</code> <code class="na">:key</code><code class="o">=</code><code class="s">"item.id"</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">slot</code> <code class="na">:item</code><code class="o">=</code><code class="s">"item"</code><code class="p">&gt;</code>&#13;
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__name"</code><code class="p">&gt;</code>{{ item.name }}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__description"</code><code class="p">&gt;</code>{{ item.description }}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;/</code><code class="nt">slot</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">li</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">ul</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>Notice how we bind the <code>item</code> variable received for each <code>v-for</code> iteration to the same <code>item</code> prop attribute of the <code>slot</code> component using <code>:</code> syntax. By doing so, we ensure the <code>slot</code> provides access to the same <code>item</code> data to its descendants<a data-primary="bindings" data-secondary="slots" data-type="indexterm" id="id820"/><a data-primary="context" data-secondary="slots and sharing data" data-type="indexterm" id="id821"/><a data-primary="slots" data-secondary="binding" data-type="indexterm" id="id822"/><a data-primary="v-for" data-secondary="binding slots" data-type="indexterm" id="id823"/><a data-primary="slots" data-secondary="sharing data context" data-type="indexterm" id="id824"/>.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The <code>slot</code> component doesn’t share the same data context with its host component (such as <code>ListLayout</code>). If you want to access any data property of the host component, you need to pass it as a prop to <code>slot</code> using <code>v-bind</code> syntax. We will learn more about giving props to nested elements in <a data-type="xref" href="ch04.html#ch04_nested_components">“Nested Components and Data Flow in Vue”</a><a data-primary="v-bind" data-secondary="slots" data-type="indexterm" id="id825"/>.</p>&#13;
</div>&#13;
&#13;
<p class="pagebreak-before">However, we need more than having <code>item</code> available for the custom template content to make it work. In the parent component of <code>ListLayout</code>, we add <code>v-slot</code> directive to <code>&lt;ListLayout&gt;</code> tag to get access to the <code>item</code> passed to its <code>slot</code> component, following the syntax below:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">ListLayout</code> <code class="na">v-slot</code><code class="o">=</code><code class="s">"{ item }"</code><code class="p">&gt;</code>&#13;
  <code class="cm">&lt;!-- Custom template content --&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">ListLayout</code><code class="p">&gt;</code></pre>&#13;
&#13;
<p>Here we use the object destructuring syntax <code>{ item }</code> to create a scoped slot reference to the data property we want to access. Then we can use <code>item</code> directly on our custom template content, as in <a data-type="xref" href="#example_03_32">Example 3-23</a><a data-primary="object dereferencing syntax and scoped slots" data-type="indexterm" id="id826"/><a data-primary="scoped slots" data-type="indexterm" id="id827"/><a data-primary="scoped styling components" data-secondary="slots and" data-type="indexterm" id="id828"/><a data-primary="slots" data-secondary="scoped slots" data-type="indexterm" id="id829"/>.</p>&#13;
<div data-type="example" id="example_03_32">&#13;
<h5><span class="label">Example 3-23. </span>Compose <code>ProductItemList</code> from <code>ListLayout</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- ProductItemList.vue --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"app"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">ListLayout</code> <code class="na">v-slot</code><code class="o">=</code><code class="s">"{ item }"</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">img</code>&#13;
        <code class="na">v-if</code><code class="o">=</code><code class="s">"item.thumbnail"</code>&#13;
        <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__thumbnail"</code>&#13;
        <code class="na">:src</code><code class="o">=</code><code class="s">"item.thumbnail"</code>&#13;
        <code class="na">:alt</code><code class="o">=</code><code class="s">"item.name"</code>&#13;
        <code class="na">width</code><code class="o">=</code><code class="s">"200"</code>&#13;
      <code class="p">/&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__name"</code><code class="p">&gt;</code>{{ item.name }}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">ListLayout</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>In <a data-type="xref" href="#example_03_32">Example 3-23</a>, we change the UI to display a thumbnail image and the item’s name only. You can see the result in <a data-type="xref" href="#figure_03_16">Figure 3-21</a>.</p>&#13;
&#13;
<p>This example is the most straightforward use case for the <code>slot</code> component when we want to enable customization in a single slot in the element. But what about more complex scenarios like a product card component containing a thumbnail, the main description area, and an area of actions, each of which requires customization? For such a case, we still can take advantage of the power of <code>slot</code>, with naming capability.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_31">&#13;
<img alt="A screenshot shows the UI layout of ProductItemList component" src="assets/lvue_0318.png"/>&#13;
<h6><span class="label">Figure 3-18. </span>The UI layout of the <code>ProductItemList</code> component</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using Named Slots with Template Tag and &#10;v-slot Attribute" data-type="sect1"><div class="sect1" id="id48">&#13;
<h1>Using Named Slots with Template Tag and &#13;
<span class="keep-together">v-slot Attribute</span></h1>&#13;
&#13;
<p>In <a data-type="xref" href="#example_03_31">Example 3-22</a>, we only enable customization for the UI of the item’s name and description as a single slot. To split the customization into several slot sections for a thumbnail, the main description area, and a footer of actions, we use <code>slot</code> with the attribute <code>name</code>, as in <a data-type="xref" href="#example_03_34">Example 3-24</a><a data-primary="named slots" data-type="indexterm" id="ix-comp-comp16"/><a data-primary="slots" data-secondary="named" data-type="indexterm" id="ix-comp-comp16a"/><a data-primary="name attribute, named slots" data-type="indexterm" id="ix-comp-comp16b"/><a data-primary="v-slot" data-secondary="named slots" data-type="indexterm" id="ix-comp-comp16c"/>.</p>&#13;
<div class="pagebreak-before" data-type="example" id="example_03_34">&#13;
<h5><span class="label">Example 3-24. </span><code>ListLayout</code> component with named slots</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">ul</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">li</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item"</code> <code class="na">v-for</code><code class="o">=</code><code class="s">"item in items"</code> <code class="na">:key</code><code class="o">=</code><code class="s">"item.id"</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">slot</code> <code class="na">name</code><code class="o">=</code><code class="s">"thumbnail"</code> <code class="na">:item</code><code class="o">=</code><code class="s">"item"</code> <code class="p">/&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">slot</code> <code class="na">name</code><code class="o">=</code><code class="s">"main"</code> <code class="na">:item</code><code class="o">=</code><code class="s">"item"</code><code class="p">&gt;</code>&#13;
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__name"</code><code class="p">&gt;</code>{{ item.name }}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__description"</code><code class="p">&gt;</code>{{ item.description }}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;/</code><code class="nt">slot</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">slot</code> <code class="na">name</code><code class="o">=</code><code class="s">"actions"</code> <code class="na">:item</code><code class="o">=</code><code class="s">"item"</code> <code class="p">/&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">li</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">ul</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>We assigned each slot with the names <code>thumbnail</code>, <code>main</code>, and <code>actions</code>, respectively. And for the <code>main</code> slot, we add a fallback content template to display the item’s name and description.</p>&#13;
&#13;
<p>When we want to pass the custom content to a specific slot, we wrap the content with a <code>template</code> tag. Then we pass the name declaring the desired slot (<code>slot-name</code> for example) to the <code>v-slot</code> directive of the <code>template</code>, following the syntax<a data-primary="template tag, named slots" data-type="indexterm" id="ix-comp-comp16d"/>:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code> <code class="na">v-slot:slot-name</code><code class="p">&gt;</code>&#13;
  <code class="cm">&lt;!-- Custom content --&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre>&#13;
&#13;
<p>We can also use the shorthand syntax <code>#</code> instead of <code>v-slot</code><a data-primary="pound sign ( ) for v-slot" data-type="indexterm" id="id830"/><a data-primary="(pound sign) for v-slot" data-type="indexterm" id="id831"/><a data-primary="v-slot" data-secondary="pound sign (#) for" data-type="indexterm" id="id832"/>:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code> <code class="err">#</code><code class="na">slot-name</code><code class="p">&gt;</code>&#13;
  <code class="cm">&lt;!-- Custom content --&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>From here on, we will use the syntax <code>#</code> to denote <code>v-slot</code> when using with the <code>template</code> tag.</p>&#13;
</div>&#13;
&#13;
<p>Like using <code>v-slot</code> on the component tag, we can also give access to the slot’s data:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code> <code class="err">#</code><code class="na">slot-name</code><code class="o">=</code><code class="s">"mySlotProps"</code><code class="p">&gt;</code>&#13;
  <code class="cm">&lt;!--&lt;div&gt; Slot data: {{ mySlotProps }}&lt;/div&gt;--&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre>&#13;
<div class="pagebreak-before" data-type="warning" epub:type="warning"><h1>Using multiple slots</h1>&#13;
<p>For multiple slots, you <em>must</em> use the <code>v-slot</code> directive for each relevant <code>template</code> tag, and <em>not</em> on the component tag. Otherwise, Vue will throw an error.</p>&#13;
</div>&#13;
&#13;
<p>Let’s go back to our <code>ProductItemList</code> component (<a data-type="xref" href="#example_03_32">Example 3-23</a>) and refactor the component to render the following custom content sections for the product item:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>A thumbnail image</p>&#13;
</li>&#13;
<li>&#13;
<p>An action button for adding the product to the cart</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p><a data-type="xref" href="#example_03_35">Example 3-25</a> shows how to implement that using <code>template</code> and <code>v-slot</code>.</p>&#13;
<div data-type="example" id="example_03_35">&#13;
<h5><span class="label">Example 3-25. </span>Compose <code>ProductItemList</code> with named slot</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- ProductItemList.vue --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"app"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">ListLayout</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">template</code> <code class="err">#</code><code class="na">thumbnail</code><code class="o">=</code><code class="s">"{ item }"</code><code class="p">&gt;</code>&#13;
        <code class="p">&lt;</code><code class="nt">img</code>&#13;
          <code class="na">v-if</code><code class="o">=</code><code class="s">"item.thumbnail"</code>&#13;
          <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__thumbnail"</code>&#13;
          <code class="na">:src</code><code class="o">=</code><code class="s">"item.thumbnail"</code>&#13;
          <code class="na">:alt</code><code class="o">=</code><code class="s">"item.name"</code>&#13;
          <code class="na">width</code><code class="o">=</code><code class="s">"200"</code>&#13;
        <code class="p">/&gt;</code>&#13;
      <code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">template</code> <code class="err">#</code><code class="na">actions</code><code class="p">&gt;</code>&#13;
        <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__footer"</code><code class="p">&gt;</code>&#13;
          <code class="p">&lt;</code><code class="nt">button</code> <code class="na">class</code><code class="o">=</code><code class="s">"list-layout__item__footer__button"</code><code class="p">&gt;</code>Add to cart<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
        <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">ListLayout</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>The code results in the output shown in <a data-type="xref" href="#figure_03_32">Figure 3-19</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_32">&#13;
<img alt="A screenshot shows the UI layout of ProductItemList component" src="assets/lvue_0319.png"/>&#13;
<h6><span class="label">Figure 3-19. </span>Output of <code>ProductItemList</code> with customized slot content</h6>&#13;
</div></figure>&#13;
&#13;
<p>And that’s it. You are ready to use slots to customize your UI components. With slots, you can now create some basic standard reusable layouts for your application, such as a page layout with a header and footer, a side panel layout, or a modal component that can be a dialog or notification. You will then find how handy slots are in keeping your code organized and reusable.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Using <code>slot</code> also means the browser won’t apply all relevant scoped styles defined in the component. To enable this functionality, see <a data-type="xref" href="#slotted_style">“Applying Scoped Styles to Slot Content”</a><a data-primary="components" data-secondary="scoped styling components" data-type="indexterm" id="id833"/><a data-primary="scoped styling components" data-secondary="slots and" data-type="indexterm" id="id834"/><a data-primary="slots" data-secondary="scoped styles and" data-type="indexterm" id="id835"/><a data-primary="style" data-secondary="scoped styling components" data-type="indexterm" id="id836"/>.</p>&#13;
</div>&#13;
&#13;
<p>Next, we will learn how to access the mounted component instance or a DOM element using refs<a data-primary="" data-startref="ix-comp-comp14" data-type="indexterm" id="id837"/><a data-primary="" data-startref="ix-comp-comp14a" data-type="indexterm" id="id838"/><a data-primary="" data-startref="ix-comp-comp16" data-type="indexterm" id="id839"/><a data-primary="" data-startref="ix-comp-comp16a" data-type="indexterm" id="id840"/><a data-primary="" data-startref="ix-comp-comp16b" data-type="indexterm" id="id841"/><a data-primary="" data-startref="ix-comp-comp16c" data-type="indexterm" id="id842"/><a data-primary="" data-startref="ix-comp-comp16d" data-type="indexterm" id="id843"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Understanding Refs" data-type="sect1"><div class="sect1" id="id49">&#13;
<h1>Understanding Refs</h1>&#13;
&#13;
<p>While Vue typically handles most of the DOM interactions for you, for some scenarios you may need to directly access a DOM element within a component for further manipulation. For instance, you may want to open a modal dialog when the user clicks a button or focus on a specific input field when mounting the component. In such cases, you can use the <code>ref</code> attribute to access the target DOM element instance<a data-primary="components" data-secondary="refs" data-type="indexterm" id="ix-comp-comp17"/><a data-primary="DOM (Document Object Model)" data-secondary="accessing with refs attribute" data-type="indexterm" id="ix-comp-comp17a"/><a data-primary="ref attribute, accessing DOM" data-type="indexterm" id="ix-comp-comp17b"/>.</p>&#13;
&#13;
<p>The <code>ref</code> is a Vue built-in attribute that allows you to receive a direct reference to a DOM element or a mounted child instance. In the <code>template</code> section, you assign the value of the <code>ref</code> attribute to a string representing the reference name on the target element. <a data-type="xref" href="#example_03_27_1">Example 3-26</a> shows how to create a <code>messageRef</code>, which refers to the DOM element <code>input</code>.</p>&#13;
<div data-type="example" id="example_03_27_1">&#13;
<h5><span class="label">Example 3-26. </span>An input component with a ref attribute assigned to <code>messageRef</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">input</code> <code class="na">type</code><code class="o">=</code><code class="s">"text"</code> <code class="na">ref</code><code class="o">=</code><code class="s">"messageRef"</code> <code class="na">placeholder</code><code class="o">=</code><code class="s">"Enter a message"</code> <code class="p">/&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>You can then access the <code>messageRef</code> in the <code>script</code> section to manipulate the <code>input</code> element through a <code>this.$refs.messageRef</code> instance. The reference instance &#13;
<span class="keep-together"><code>messageRef</code></span> will have all the properties and methods of the <code>input</code> element. For instance, you can use <code>this.$refs.messageRef.focus()</code> to focus on the <code>input</code> element programmatically.</p>&#13;
<div data-type="warning" epub:type="warning"><h1>Accessing the ref attribute</h1>&#13;
<p>The <code>ref</code> attribute is accessible only <em>after</em> mounting the component.</p>&#13;
</div>&#13;
&#13;
<p>The reference instance contains all the properties and methods of a specific DOM element or the child component instance, depending on the target element type. In a scenario where you use the <code>ref</code> attribute on a looped element using <code>v-for</code>, the reference instance will be the array containing the looped elements without order<a data-primary="iterating" data-secondary="with v-for" data-secondary-sortas="v-for" data-type="indexterm" id="id844"/><a data-primary="v-for" data-secondary="refs and" data-type="indexterm" id="id845"/>.</p>&#13;
&#13;
<p>Take a list of tasks, for instance. As <a data-type="xref" href="#example_03_16">Example 3-27</a> shows, you can use the <code>ref</code> attribute to access the list of tasks.</p>&#13;
<div data-type="example" id="example_03_16">&#13;
<h5><span class="label">Example 3-27. </span>A list of tasks with a ref attribute assigned to <code>taskListRef</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">ul</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">li</code> <code class="na">v-for</code><code class="o">=</code><code class="s">"(task, index) in tasks"</code> <code class="na">:key</code><code class="o">=</code><code class="s">"task.id"</code> <code class="na">ref</code><code class="o">=</code><code class="s">"tasksRef"</code><code class="p">&gt;</code>&#13;
        {{title}} {{index}}: {{task.description}}&#13;
      <code class="p">&lt;/</code><code class="nt">li</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">ul</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s2">"vue"</code><code class="p">;</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s2">"TaskListComponent"</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">tasks</code><code class="o">:</code><code class="w"> </code><code class="p">[{</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="s1">'task01'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">description</code><code class="o">:</code><code class="w"> </code><code class="s1">'Buy groceries'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="p">},</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="s1">'task02'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">description</code><code class="o">:</code><code class="w"> </code><code class="s1">'Do laundry'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="p">},</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="s1">'task03'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">description</code><code class="o">:</code><code class="w"> </code><code class="s1">'Watch Moonknight'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="p">}],</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">title</code><code class="o">:</code><code class="w"> </code><code class="s1">'Task'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">};</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">});</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>Once Vue mounts the <code>TaskListComponent</code>, you can see the <code>tasksRef</code> contains three <code>li</code> DOM elements and nested in <code>refs</code> property of the component instance, as seen in the Vue Devtools screenshot in <a data-type="xref" href="#figure_03_15">Figure 3-20</a>.</p>&#13;
&#13;
<p>You can now use <code>this.$refs.tasksRef</code> to access the list of the task elements and perform further modification when needed.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p><code>ref</code> can also accept a function as its value, by adding a prefix, <code>:</code>, to it (<code>:ref</code>). The function accepts the reference instance as its input parameter<a data-primary="functions" data-secondary="as refs" data-secondary-sortas="refs" data-type="indexterm" id="id846"/><a data-primary=":ref, for functions as refs" data-primary-sortas="ref, for functions" data-type="indexterm" id="id847"/>.</p>&#13;
</div>&#13;
&#13;
<p>We have learned about the <code>ref</code> attribute and how it can be helpful in many real-world challenges, such as building a reusable modal system (see <a data-type="xref" href="ch04.html#ch04_modal_teleport">“Implementing a Modal with Teleport and the &lt;dialog&gt; Element”</a>). The following section will explore how to create and share standard configurations across components with mixins<a data-primary="" data-startref="ix-comp-comp17" data-type="indexterm" id="id848"/><a data-primary="" data-startref="ix-comp-comp17a" data-type="indexterm" id="id849"/><a data-primary="" data-startref="ix-comp-comp17b" data-type="indexterm" id="id850"/>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_15">&#13;
<img alt="Vue Devtools showing the tasksRef reference instance with three li elements" src="assets/lvue_0320.png"/>&#13;
<h6><span class="label">Figure 3-20. </span>Vue Devtools showing the <code>tasksRef</code> reference instance</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Sharing Component Configuration with Mixins" data-type="sect1"><div class="sect1" id="id50">&#13;
<h1>Sharing Component Configuration with Mixins</h1>&#13;
&#13;
<p>In reality, it is not uncommon for some components to share similar data and behaviors, such as a cafe and a dining restaurant component. Both elements share the logic of making reservations and accepting payments, but each has unique features. In such scenarios, you can use the <code>mixins</code> property to share the standard functionalities across these two components<a data-primary="components" data-secondary="mixins" data-type="indexterm" id="ix-comp-comp18"/><a data-primary="configuring" data-secondary="components, sharing configuration with mixins" data-type="indexterm" id="ix-comp-comp18a"/><a data-primary="mixins" data-type="indexterm" id="ix-comp-comp18b"/><a data-primary="mixins property" data-type="indexterm" id="ix-comp-comp18c"/>.</p>&#13;
&#13;
<p>For instance, you can create a <code>restaurantMixin</code> object that contains the standard functionalities of the two components, <code>DiningComponent</code> and <code>CafeComponent</code>, as in <a data-type="xref" href="#example_03_17">Example 3-28</a>.</p>&#13;
<div data-type="example" id="example_03_17">&#13;
<h5><span class="label">Example 3-28. </span>A <code>restaurantMixin</code> mixin object</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="cm">/** mixins/restaurantMixin.ts */</code>&#13;
<code class="kr">import</code> <code class="p">{</code> <code class="nx">defineComponent</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'vue'</code>&#13;
&#13;
<code class="kr">export</code> <code class="kr">const</code> <code class="nx">restaurantMixin</code> <code class="o">=</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="nx">data</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="p">{</code>&#13;
      <code class="nx">menu</code><code class="o">:</code> <code class="p">[],</code>&#13;
      <code class="nx">reservations</code><code class="o">:</code> <code class="p">[],</code>&#13;
      <code class="nx">payments</code><code class="o">:</code> <code class="p">[],</code>&#13;
      <code class="nx">title</code><code class="o">:</code> <code class="s1">'Restaurant'</code><code class="p">,</code>&#13;
    <code class="p">};</code>&#13;
  <code class="p">},</code>&#13;
  <code class="nx">methods</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">makeReservation</code><code class="p">()</code> <code class="p">{</code>&#13;
      <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Reservation made"</code><code class="p">);</code>&#13;
    <code class="p">},</code>&#13;
    <code class="nx">acceptPayment</code><code class="p">()</code> <code class="p">{</code>&#13;
      <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Payment accepted"</code><code class="p">);</code>&#13;
    <code class="p">},</code>&#13;
  <code class="p">},</code>&#13;
  <code class="nx">created</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="sb">`Welcome to </code><code class="si">${</code><code class="k">this</code><code class="p">.</code><code class="nx">title</code><code class="si">}</code><code class="sb">`</code><code class="p">);</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>You can then use the <code>restaurantMixin</code> object in the <code>mixins</code> property of <code>Dining</code>&#13;
<span class="keep-together"><code>Component</code></span>, as seen in <a data-type="xref" href="#example_03_18">Example 3-29</a>.</p>&#13;
<div data-type="example" id="example_03_18">&#13;
<h5><span class="label">Example 3-29. </span>Using the <code>restaurantMixin</code> mixins property of the <code>DiningComponent</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="cm">&lt;!-- components/DiningComponent.vue --&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h1</code><code class="p">&gt;</code>{{title}}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">button</code> <code class="err">@</code><code class="na">click</code><code class="o">=</code><code class="s">"getDressCode"</code><code class="p">&gt;</code>getDressCode<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">button</code> <code class="err">@</code><code class="na">click</code><code class="o">=</code><code class="s">"makeReservation"</code><code class="p">&gt;</code>Make a reservation<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">button</code> <code class="err">@</code><code class="na">click</code><code class="o">=</code><code class="s">"acceptPayment"</code><code class="p">&gt;</code>Accept a payment<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">'ts'</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">restaurantMixin</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'@/mixins/restaurantMixin'</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'DiningComponent'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">mixins</code><code class="o">:</code><code class="w"> </code><code class="p">[</code><code class="nx">restaurantMixin</code><code class="p">],</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">title</code><code class="o">:</code><code class="w"> </code><code class="s1">'Dining'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">menu</code><code class="o">:</code><code class="w"> </code><code class="p">[</code><code class="w"/>&#13;
<code class="w">        </code><code class="p">{</code><code class="w"> </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="s1">'menu01'</code><code class="p">,</code><code class="w"> </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'Steak'</code><code class="w"> </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">        </code><code class="p">{</code><code class="w"> </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="s1">'menu02'</code><code class="p">,</code><code class="w"> </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'Salad'</code><code class="w"> </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">        </code><code class="p">{</code><code class="w"> </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="s1">'menu03'</code><code class="p">,</code><code class="w"> </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'Pizza'</code><code class="w"> </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">      </code><code class="p">],</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">};</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">methods</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">getDressCode</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s2">"Dress code: Casual"</code><code class="p">);</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">created</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'DiningComponent component created!'</code><code class="p">);</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">});</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p><a data-type="xref" href="#example_03_19">Example 3-30</a> shows the similar <code>CafeComponent</code>.</p>&#13;
<div data-type="example" id="example_03_19">&#13;
<h5><span class="label">Example 3-30. </span>Using the <code>restaurantMixin</code> mixins property of the <code>CafeComponent</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="cm">&lt;!-- components/CafeComponent.vue --&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h1</code><code class="p">&gt;</code>{{title}}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>Open time: 8am - 4pm<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">ul</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">li</code> <code class="na">v-for</code><code class="o">=</code><code class="s">"menuItem in menu"</code> <code class="na">:key</code><code class="o">=</code><code class="s">"menuItem.id"</code><code class="p">&gt;</code>&#13;
      {{menuItem.name}}&#13;
    <code class="p">&lt;/</code><code class="nt">li</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">ul</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">button</code> <code class="err">@</code><code class="na">click</code><code class="o">=</code><code class="s">"acceptPayment"</code><code class="p">&gt;</code>Pay<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">'ts'</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">restaurantMixin</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'@/mixins/restaurantMixin'</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'CafeComponent'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">mixins</code><code class="o">:</code><code class="w"> </code><code class="p">[</code><code class="nx">restaurantMixin</code><code class="p">],</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">title</code><code class="o">:</code><code class="w"> </code><code class="s1">'Cafe'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">menu</code><code class="o">:</code><code class="w"> </code><code class="p">[{</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="s1">'menu01'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'Coffee'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">price</code><code class="o">:</code><code class="w"> </code><code class="mf">5</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="p">},</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="s1">'menu02'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'Tea'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">price</code><code class="o">:</code><code class="w"> </code><code class="mf">3</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="p">},</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="s1">'menu03'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'Cake'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">price</code><code class="o">:</code><code class="w"> </code><code class="mf">7</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="p">}],</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">};</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">created</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'CafeComponent component created!'</code><code class="p">);</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">});</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>Upon creating the components, the Vue engine will merge the mixin logic into the component, with the component’s data declaration taking precedence. In Examples <a data-type="xref" data-xrefstyle="select:labelnumber" href="#example_03_18">3-29</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#example_03_19">3-30</a>, the <code>DiningComponent</code> and <code>CafeComponent</code> will have the same properties, <code>menu</code>, <code>reservations</code>, <code>payments</code>, and <code>title</code>, but with different values. Also, the methods and hooks declared in <code>restaurantMixin</code> will be available to both components. It is similar to the inheritance pattern, though the component doesn’t override the mixin hooks’ behavior. Instead, the Vue engine calls the mixin’s hooks first, then the component’s hooks<a data-primary="hooks" data-secondary="mixins and" data-type="indexterm" id="id851"/><a data-primary="lifecycle hooks" data-secondary="order of" data-type="indexterm" id="id852"/><a data-primary="methods" data-secondary="mixins and" data-type="indexterm" id="id853"/><a data-primary="order" data-secondary="lifecycle hooks and mixins" data-type="indexterm" id="id854"/>.</p>&#13;
&#13;
<p>When Vue mounts the <code>DiningComponent</code>, you will see the output in <a data-type="xref" href="#figure_03_16">Figure 3-21</a> in the browser console.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_16">&#13;
<img alt="Output of the DiningComponent showing the created hook of restaurantMixin called first, then the DiningComponent's created hook" src="assets/lvue_0321.png"/>&#13;
<h6><span class="label">Figure 3-21. </span>Output order of console log of the <code>DiningComponent</code></h6>&#13;
</div></figure>&#13;
&#13;
<p>Similarly, when Vue mounts the <code>CafeComponent</code>, you will see the output in <a data-type="xref" href="#figure_03_17">Figure 3-22</a> in the browser console.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_17">&#13;
<img alt="Output of the CafeComponent showing the created hook of restaurantMixin called first, then the CafeComponent's created hook" src="assets/lvue_0322.png"/>&#13;
<h6><span class="label">Figure 3-22. </span>Output order of console log of the <code>CafeComponent</code></h6>&#13;
</div></figure>&#13;
&#13;
<p>Note that <code>title</code> value has changed between the two components, while Vue triggers the <code>created</code> hook of the <code>restaurantMixin</code> first, followed by the one declared on the element itself.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The order of merging and triggering the hooks for multiple mixins is according to the order of the mixins array. Vue <em>always</em> calls the component’s hooks last. Consider this order when putting multiple mixins together.</p>&#13;
</div>&#13;
&#13;
<p>If you open the Vue Devtools, you will see the <code>restaurantMixin</code> is not visible, and the <code>DiningComponent</code> and <code>CafeComponent</code> are with their own data properties, as shown in Figures <a data-type="xref" data-xrefstyle="select:labelnumber" href="#figure_03_18">3-23</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="#figure_03_19">3-24</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_18">&#13;
<img alt="Vue Devtools showing the DiningComponent" src="assets/lvue_0323.png"/>&#13;
<h6><span class="label">Figure 3-23. </span>Vue Devtools showing the <code>DiningComponent</code></h6>&#13;
</div></figure>&#13;
&#13;
<figure><div class="figure" id="figure_03_19">&#13;
<img alt="Vue Devtools showing the CafeComponent" src="assets/lvue_0324.png"/>&#13;
<h6><span class="label">Figure 3-24. </span>Vue Devtools showing the <code>CafeComponent</code></h6>&#13;
</div></figure>&#13;
&#13;
<p>Mixins are great for sharing common logic between components and keeping your code organized. However, too many mixins can confuse other developers in understanding and debugging, and in most cases, are considered bad practice. We recommend validating your use case before choosing mixins over alternatives, such as the Composition API (<a data-type="xref" href="ch05.html#unique_chapter_id_06">Chapter 5</a>).</p>&#13;
&#13;
<p>At this point, we have explored how to compose components’ logic using advanced features in <code>template</code> and <code>script</code> sections. Next, let’s learn how to make your component beautiful with Vue’s built-in styling features in the <code>style</code> section<a data-primary="" data-startref="ix-comp-comp18" data-type="indexterm" id="id855"/><a data-primary="" data-startref="ix-comp-comp18a" data-type="indexterm" id="id856"/><a data-primary="" data-startref="ix-comp-comp18b" data-type="indexterm" id="id857"/><a data-primary="" data-startref="ix-comp-comp18c" data-type="indexterm" id="id858"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Scoped Styling Components" data-type="sect1"><div class="sect1" id="id51">&#13;
<h1>Scoped Styling Components</h1>&#13;
&#13;
<p>Like a regular HTML page structure, we can define CSS stylings for an SFC component using the <code>&lt;style&gt;</code> tag<a data-primary="components" data-secondary="scoped styling components" data-type="indexterm" id="ix-comp-comp19"/><a data-primary="CSS" data-secondary="scoped styling components" data-type="indexterm" id="ix-comp-comp19a"/><a data-primary="scoped styling components" data-secondary="using" data-type="indexterm" id="ix-comp-comp19b"/><a data-primary="style" data-secondary="scoped styling components" data-type="indexterm" id="ix-comp-comp19c"/><a data-primary="style tag" data-type="indexterm" id="ix-comp-comp20"/>:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">style</code><code class="p">&gt;</code>&#13;
<code class="nt">h1</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="nb">red</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
<code class="nt">&lt;/style&gt;</code></pre>&#13;
&#13;
<p>The <code>&lt;style&gt;</code> section usually comes last in the order of a Vue SFC component and can appear multiple times. Upon mounting the component to the DOM, the Vue engine will apply the CSS styles defined within the <code>&lt;style&gt;</code> tag to all the elements or matched DOM selectors within the application. In other words, all CSS rules that appeared in the <code>&lt;style&gt;</code> of a component apply globally once mounted. Take the HeadingComponent shown in <a data-type="xref" href="#example_03_28">Example 3-31</a>, which renders a heading title with some stylings<a data-primary="CSS" data-secondary="order of style tags" data-type="indexterm" id="id859"/><a data-primary="order" data-secondary="CSS styles" data-type="indexterm" id="id860"/><a data-primary="style" data-secondary="order of style tags" data-type="indexterm" id="id861"/><a data-primary="CSS" data-seealso="animations; style; transitions" data-type="indexterm" id="id862"/>.</p>&#13;
<div data-type="example" id="example_03_28">&#13;
<h5><span class="label">Example 3-31. </span>Using the <code>&lt;style&gt;</code> tag in <code>HeadingComponent</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h1</code> <code class="na">class</code><code class="o">=</code><code class="s">"heading"</code><code class="p">&gt;</code>{{title}}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">p</code> <code class="na">class</code><code class="o">=</code><code class="s">"description"</code><code class="p">&gt;</code>{{description}}<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">'ts'</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'HeadingComponent'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">title</code><code class="o">:</code><code class="w"> </code><code class="s1">'Welcome to Vue Restaurant'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">description</code><code class="o">:</code><code class="w"> </code><code class="s1">'A Vue.js project to learn Vue.js'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">};</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="p">};</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">style</code><code class="p">&gt;</code>&#13;
<code class="nc">.heading</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="m">#178c0e</code><code class="p">;</code>&#13;
  <code class="k">font-size</code><code class="o">:</code> <code class="m">2em</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="nc">.description</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="m">#b76210</code><code class="p">;</code>&#13;
  <code class="k">font-size</code><code class="o">:</code> <code class="m">1em</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
<code class="nt">&lt;/style&gt;</code></pre></div>&#13;
&#13;
<p>In <a data-type="xref" href="#example_03_28">Example 3-31</a>, we created two CSS class selectors: <code>heading</code> and <code>description</code> for <code>h1</code> and <code>p</code> elements of the component, respectively. When Vue mounts the component, the browser will paint these elements with the appropriate styles, as seen in <a data-type="xref" href="#figure_03_20">Figure 3-25</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_20">&#13;
<img alt="The heading element has a red color and a big font size, while the description element has a light gray color and small font size" src="assets/lvue_0325.png"/>&#13;
<h6><span class="label">Figure 3-25. </span>The <code>HeadingComponent</code> with styles applied</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-type="xref" href="#example_03_20">Example 3-32</a> shows adding a <code>span</code> element with the same <code>heading</code> class selector outside <code>HeadingComponent</code> in the parent component <code>App.vue</code>.</p>&#13;
<div data-type="example" id="example_03_20">&#13;
<h5><span class="label">Example 3-32. </span>Adding the same class selector to the parent component <code>App.vue</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- App.vue --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">section</code> <code class="na">class</code><code class="o">=</code><code class="s">"wrapper"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">HeadingComponent</code> <code class="p">/&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">span</code> <code class="na">class</code><code class="o">=</code><code class="s">"heading"</code><code class="p">&gt;</code>This is a span element in App.vue component<code class="p">&lt;/</code><code class="nt">span</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">section</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>The browser then still applies the same styles to the <code>span</code> element, as shown in <a data-type="xref" href="#figure_03_21">Figure 3-26</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_21">&#13;
<img alt="A screenshot shows the span element and h1 element in the browser have red color and same font size" src="assets/lvue_0326.png"/>&#13;
<h6><span class="label">Figure 3-26. </span>The span element in <code>App.vue</code> has the same CSS styles as the <code>h1</code> element in the <code>HeadingComponent</code></h6>&#13;
</div></figure>&#13;
&#13;
<p>But if we don’t use the <code>HeadingComponent</code>, or it does not yet exist in the application on run-time, the <code>span</code> element will not have the CSS rules of the <code>heading</code> class &#13;
<span class="keep-together">selector</span><a data-primary="" data-startref="ix-comp-comp20" data-type="indexterm" id="id863"/>.</p>&#13;
&#13;
<p>To avoid such a scenario and to have better control of style rules and selectors, Vue offers a unique feature, the <code>scoped</code> attribute. With the <code>&lt;style scoped&gt;</code> tag, Vue ensures the CSS rules will apply to relevant elements within the component and not leak them to the rest of the application. Vue achieved this mechanism by performing these steps<a data-primary="data-v and scoped styling components" data-type="indexterm" id="id864"/>:</p>&#13;
<ol>&#13;
<li>&#13;
<p>Add a randomly generated data attribute on the target element tag with the prefix syntax <code>data-v</code>.</p>&#13;
</li>&#13;
<li>&#13;
<p>Transform the CSS selectors defined in the <code>&lt;style scoped&gt;</code> tag to include the generated data attribute.</p>&#13;
</li>&#13;
&#13;
</ol>&#13;
&#13;
<p>Let’s see how this works in practice. In <a data-type="xref" href="#example_03_21">Example 3-33</a>, we add the <code>scoped</code> attribute to the <code>&lt;style&gt;</code> tag of the <code>HeadingComponent</code>.</p>&#13;
<div data-type="example" id="example_03_21">&#13;
<h5><span class="label">Example 3-33. </span>Adding the scoped attribute to the <code>&lt;style&gt;</code> tag of <code>HeadingComponent</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- HeadingComponent.vue --&gt;</code>&#13;
<code class="cm">&lt;!--...--&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">style</code> <code class="na">scoped</code><code class="p">&gt;</code>&#13;
<code class="nc">.heading</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="m">#178c0e</code><code class="p">;</code>&#13;
  <code class="k">font-size</code><code class="o">:</code> <code class="m">2em</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="nc">.description</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="m">#b76210</code><code class="p">;</code>&#13;
  <code class="k">font-size</code><code class="o">:</code> <code class="m">1em</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
<code class="nt">&lt;/style&gt;</code></pre></div>&#13;
&#13;
<p>The <code>span</code> element defined in <code>App.vue</code> (<a data-type="xref" href="#example_03_20">Example 3-32</a>) will not have the same CSS styles as the <code>h1</code> element in <code>HeadingComponent</code>, as shown in <a data-type="xref" href="#figure_03_22">Figure 3-27</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_22">&#13;
<img alt="A screenshot shows the span element and h1 element in the browser have different colors and font sizes" src="assets/lvue_0327.png"/>&#13;
<h6><span class="label">Figure 3-27. </span>The span element in <code>App.vue</code> now has default black color</h6>&#13;
</div></figure>&#13;
&#13;
<p>When you open the Elements tab in the browser’s Developer Tools, you can see the <code>h1</code> and <code>p</code> elements now have the <code>data-v-xxxx</code> attribute, as shown in <a data-type="xref" href="#figure_03_23">Figure 3-28</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_23">&#13;
<img alt="The h1 and p elements in HeadingComponent have the data-v-xxxx attribute" src="assets/lvue_0328.png"/>&#13;
<h6><span class="label">Figure 3-28. </span>The <code>h1</code> and <code>p</code> elements in <code>HeadingComponent</code> have the <code>data-v-xxxx</code> attribute</h6>&#13;
</div></figure>&#13;
&#13;
<p>And if you select the <code>h1</code> element and look at its styles on the right panel, you can see that the CSS selector <code>.heading</code> has become <code>.heading[data-v-xxxx]</code>, as shown in <a data-type="xref" href="#figure_03_24">Figure 3-29</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_24">&#13;
<img alt="The CSS selector .heading is transformed to .heading[data-v-xxxx]" src="assets/lvue_0329.png"/>&#13;
<h6><span class="label">Figure 3-29. </span>The CSS selector <code>.heading</code> is transformed to <code>.heading[data-v-xxxx]</code></h6>&#13;
</div></figure>&#13;
&#13;
<p>I strongly recommend you start working with the <code>scoped</code> attribute in your components as a good coding habit to avoid undesirable CSS bugs when your project grows.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The browser follows <a href="https://oreil.ly/x4iOg">the CSS specificity</a> when deciding which order to apply the styles. Because Vue’s scoped mechanism uses attribute selectors <code>[data-v-xxxx]</code>, using the <code>.heading</code> selector solely is not enough to override the component’s styles from the parent.</p>&#13;
</div>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Applying CSS to a Child Component in Scoped Styles" data-type="sect2"><div class="sect2" id="id52">&#13;
<h2>Applying CSS to a Child Component in Scoped Styles</h2>&#13;
&#13;
<p>Beginning with Vue 3.x, you can override or extend the styles of a child component from the parent with a scoped style by using the <code>:deep()</code> pseudo-class. For example, as <a data-type="xref" href="#example_03_22">Example 3-34</a> shows, we can override the scoped styles of paragraph element <code>p</code> in the <code>HeadingComponent</code> from its parent <code>App</code><a data-primary=":deep() and scoped styles" data-primary-sortas="deep() and scoped" data-type="indexterm" id="id865"/><a data-primary="scoped styling components" data-secondary="child components and" data-type="indexterm" id="id866"/><a data-primary="scoped styling components" data-secondary="overriding" data-type="indexterm" id="id867"/>.</p>&#13;
<div data-type="example" id="example_03_22">&#13;
<h5><span class="label">Example 3-34. </span>Overriding the scoped styles of paragraph element <code>p</code> in the <code>Heading</code>&#13;
<span class="keep-together"><code>Component</code></span> from its parent <code>App</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- App.vue --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">section</code> <code class="na">class</code><code class="o">=</code><code class="s">"wrapper"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">HeadingComponent</code> <code class="p">/&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">span</code> <code class="na">class</code><code class="o">=</code><code class="s">"heading"</code><code class="p">&gt;</code>This is a span element in App.vue component<code class="p">&lt;/</code><code class="nt">span</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">section</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">style</code> <code class="na">scoped</code><code class="p">&gt;</code>&#13;
<code class="nc">.wrapper</code> <code class="nd">:deep</code><code class="o">(</code><code class="nt">p</code><code class="o">)</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="m">#000</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
<code class="nt">&lt;/style&gt;</code></pre></div>&#13;
&#13;
<p>The <code>p</code> element in the <code>HeadingComponent</code> will have the color black instead of its scoped color, <code>#b76210</code>, as shown in <a data-type="xref" href="#figure_03_25">Figure 3-30</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_25">&#13;
<img alt="The p element in HeadingComponent has the color of black instead of its scoped color #b76210" src="assets/lvue_0330.png"/>&#13;
<h6><span class="label">Figure 3-30. </span>The p element in <code>HeadingComponent</code> has the color black</h6>&#13;
</div></figure>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The browser will apply the newly defined CSS rules to any <code>p</code> elements nested in any child component of <code>App</code> and its children.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Applying Scoped Styles to Slot Content" data-type="sect2"><div class="sect2" id="slotted_style">&#13;
<h2>Applying Scoped Styles to Slot Content</h2>&#13;
&#13;
<p>By design, any styles defined in the <code>&lt;style scoped&gt;</code> tag is relevant only to the component’s default <code>template</code> itself. Vue won’t be able to transform any slotted content to include the <code>data-v-xxxx</code> attribute. To style any slotted content, you can use the <code>:slot([CSS selector])</code> pseudo-class or create a dedicated <code>style</code> section for them on the parent level and keep the code organized<a data-primary="scoped styling components" data-secondary="slots and" data-type="indexterm" id="id868"/><a data-primary=":slot() and scoped styles" data-primary-sortas="slot() and scoped styles" data-type="indexterm" id="id869"/><a data-primary="slots" data-secondary="scoped styles and" data-type="indexterm" id="id870"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Accessing a Component’s Data Value in Style Tag with &#10;v-bind() Pseudo-Class" data-type="sect2"><div class="sect2" id="id146">&#13;
<h2>Accessing a Component’s Data Value in Style Tag with &#13;
<span class="keep-together">v-bind() Pseudo-Class</span></h2>&#13;
&#13;
<p>We often need to access the component’s data value and bind that value to a valid CSS property, such as changing dark or light mode or theme color for an application based on the user’s preference. For such use cases, we use the pseudo-class <code>v-bind()</code><a data-primary="CSS" data-secondary="accessing data values with v-bind" data-type="indexterm" id="id871"/><a data-primary="style" data-secondary="accessing data values with v-bind" data-type="indexterm" id="id872"/><a data-primary="v-bind" data-secondary="styling and" data-type="indexterm" id="id873"/>.</p>&#13;
&#13;
<p><code>v-bind()</code> accepts the component’s data property and JavaScript expressions as a string for its only argument. For example, we can change the color of the <code>h1</code> element in the <code>HeadingComponent</code> based on the value of the <code>titleColor</code> data property, as shown in <a data-type="xref" href="#example_03_23">Example 3-35</a>.</p>&#13;
<div data-type="example" id="example_03_23">&#13;
<h5><span class="label">Example 3-35. </span>Changing the color of the <code>h1</code> element based on the value of the <code>titleColor</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- HeadingComponent.vue --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h1</code> <code class="na">class</code><code class="o">=</code><code class="s">"heading"</code><code class="p">&gt;</code>{{title}}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">p</code> <code class="na">class</code><code class="o">=</code><code class="s">"description"</code><code class="p">&gt;</code>{{description}}<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">'ts'</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="c1">//...</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="c1">//...</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">titleColor</code><code class="o">:</code><code class="w"> </code><code class="s2">"#178c0e"</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">};</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="p">};</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">style</code> <code class="na">scoped</code><code class="p">&gt;</code>&#13;
<code class="nc">.heading</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="n">v</code><code class="o">-</code><code class="n">bind</code><code class="p">(</code><code class="n">titleColor</code><code class="p">);</code>&#13;
  <code class="k">font-size</code><code class="o">:</code> <code class="m">2em</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
<code class="nt">&lt;/style&gt;</code></pre></div>&#13;
&#13;
<p>The <code>v-bind()</code> pseudo-class then transforms the value of the <code>titleColor</code> data property into an inline hashed CSS variable, as shown in <a data-type="xref" href="#figure_03_26">Figure 3-31</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_26">&#13;
<img alt="The value of the titleColor data property is now a hashed CSS property in inline style" src="assets/lvue_0331.png"/>&#13;
<h6><span class="label">Figure 3-31. </span>The value of the <code>titleColor</code> data property is now a hashed CSS property in inline style</h6>&#13;
</div></figure>&#13;
&#13;
<p>Let’s open the Elements tab in the browser’s Developer Tools and look at the element’s styles. You can see the generated color property for the <code>.heading</code> selector remains static and has the same value as the developed hashed CSS property of <code>titleColor</code> (<a data-type="xref" href="#figure_03_27">Figure 3-32</a>).</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_27">&#13;
<img alt="The generated color property for the .heading selector has the same value as the generated hashed CSS property of titleColor" src="assets/lvue_0332.png"/>&#13;
<h6><span class="label">Figure 3-32. </span>The generated color property for the .heading selector has the same value as the generated hashed CSS property of <code>titleColor</code></h6>&#13;
</div></figure>&#13;
&#13;
<p><code>v-bind()</code> helps retrieve a component’s data value and then bind the desired CSS property to that dynamic value. However, this is only one-way binding. If you want to retrieve the defined CSS styles in the <code>template</code> for binding to the template’s elements, you need to use CSS Modules, which we will cover in the next section.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Styling Components with CSS Modules" data-type="sect1"><div class="sect1" id="id54">&#13;
<h1>Styling Components with CSS Modules</h1>&#13;
&#13;
<p>Another alternative for scoping your CSS styles per component is to use CSS Modules.<sup><a data-type="noteref" href="ch03.html#id874" id="id874-marker">1</a></sup> CSS Modules is an approach that allows you to write CSS styles regularly and then consume them as a JavaScript object (<em>module</em>) in our <code>template</code> and <code>script</code> &#13;
<span class="keep-together">sections</span><a data-primary="CSS" data-secondary="CSS Modules" data-type="indexterm" id="ix-comp-comp21"/><a data-primary="CSS Modules" data-type="indexterm" id="ix-comp-comp21a"/><a data-primary="module attribute, CSS Modules" data-type="indexterm" id="ix-comp-comp21b"/><a data-primary="scoped styling components" data-secondary="with CSS Modules" data-secondary-sortas="CSS Modules" data-type="indexterm" id="ix-comp-comp21c"/><a data-primary="style" data-secondary="CSS modules" data-type="indexterm" id="ix-comp-comp21d"/>.</p>&#13;
&#13;
<p>To start using CSS Modules in a Vue SFC Component, you need to add the <code>module</code> attribute to the <code>style</code> tag, as shown in our <code>HeadingComponent</code> in <a data-type="xref" href="#example_03_24">Example 3-36</a>.</p>&#13;
<div data-type="example" id="example_03_24">&#13;
<h5><span class="label">Example 3-36. </span>Using CSS Modules in <code>HeadingComponent</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- HeadingComponent.vue --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">style</code> <code class="na">module</code><code class="p">&gt;</code>&#13;
<code class="nc">.heading</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="m">#178c0e</code><code class="p">;</code>&#13;
  <code class="k">font-size</code><code class="o">:</code> <code class="m">2em</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="nc">.description</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="m">#b76210</code><code class="p">;</code>&#13;
  <code class="k">font-size</code><code class="o">:</code> <code class="m">1em</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
<code class="nt">&lt;/style&gt;</code></pre></div>&#13;
&#13;
<p>Now you will have access to these CSS selectors as fields of a <code>$style</code> property object of the component. We can remove the static class names <code>heading</code> and <code>description</code> assigned for <code>h1</code> and <code>p</code>, respectively, in the <code>template</code> section. Instead, we will bind the classes of these elements to the relevant fields of the <code>$style</code> object (<a data-type="xref" href="#example_03_25">Example 3-37</a>)<a data-primary="$style property, scoped styles" data-primary-sortas="style property, scoped" data-type="indexterm" id="id875"/>.</p>&#13;
<div data-type="example" id="example_03_25">&#13;
<h5><span class="label">Example 3-37. </span>Binding classes dynamically with $style object</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- HeadingComponent.vue --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h1</code> <code class="na">:class</code><code class="o">=</code><code class="s">"$style.heading"</code><code class="p">&gt;</code>{{title}}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">p</code> <code class="na">:class</code><code class="o">=</code><code class="s">"$style.description"</code><code class="p">&gt;</code>{{description}}<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>The output on the browser stays the same as <a data-type="xref" href="#figure_03_22">Figure 3-27</a>. However, when looking at the relevant elements on the Elements tab in the browser’s Developer Tools, you will see Vue has hashed the generated class names to keep the styles scoped within the component, as in <a data-type="xref" href="#figure_03_28">Figure 3-33</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_03_28">&#13;
<img alt="Vue hashes the class names" src="assets/lvue_0333.png"/>&#13;
<h6><span class="label">Figure 3-33. </span>The generated class names <code>heading</code> and <code>description</code> are now hashed</h6>&#13;
</div></figure>&#13;
&#13;
<p>Additionally, you can rename the CSS style object <code>$style</code> by assigning a name to the <code>module</code> attribute, as shown in <a data-type="xref" href="#example_03_26">Example 3-38</a>.</p>&#13;
<div data-type="example" id="example_03_26">&#13;
<h5><span class="label">Example 3-38. </span>Renaming the CSS style object $style to <code>headerClasses</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- HeadingComponent.vue --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">style</code> <code class="na">module</code><code class="o">=</code><code class="s">"headerClasses"</code><code class="p">&gt;</code>&#13;
<code class="nc">.heading</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="m">#178c0e</code><code class="p">;</code>&#13;
  <code class="k">font-size</code><code class="o">:</code> <code class="m">2em</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="nc">.description</code> <code class="p">{</code>&#13;
  <code class="k">color</code><code class="o">:</code> <code class="m">#b76210</code><code class="p">;</code>&#13;
  <code class="k">font-size</code><code class="o">:</code> <code class="m">1em</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
<code class="nt">&lt;/style&gt;</code></pre></div>&#13;
&#13;
<p>And in the <code>template</code> section, you can bind the classes of the <code>h1</code> and <code>p</code> elements to the <code>headerClasses</code> object instead (<a data-type="xref" href="#example_03_27">Example 3-39</a>).</p>&#13;
<div data-type="example" id="example_03_27">&#13;
<h5><span class="label">Example 3-39. </span>Binding classes dynamically with <code>headerClasses</code> object</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="cm">&lt;!-- HeadingComponent.vue --&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h1</code> <code class="na">:class</code><code class="o">=</code><code class="s">"headerClasses.heading"</code><code class="p">&gt;</code>{{title}}<code class="p">&lt;/</code><code class="nt">h1</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">p</code> <code class="na">:class</code><code class="o">=</code><code class="s">"headerClasses.description"</code><code class="p">&gt;</code>{{description}}<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>If you are using <code>&lt;script setup&gt;</code> or <code>setup()</code> function in your component (<a data-type="xref" href="ch05.html#unique_chapter_id_06">Chapter 5</a>), you can use the <code>useCssModule()</code> hook to access the instance of the style object. This function accepts the name of the style object as its only argument<a data-primary="useCssModule()" data-type="indexterm" id="id876"/>.</p>&#13;
</div>&#13;
&#13;
<p>The component now has a more isolated design than when using the <code>scoped</code> attribute in the <code>style</code> tag. The code looks more organized, and it is more challenging to override this component’s styles from outside since Vue hashes the relevant CSS selectors randomly. Nevertheless, depending on your project’s requirements, one approach may be better than the other, or it might be crucial to combine both <code>scoped</code> and &#13;
<span class="keep-together"><code>module</code></span> attributes to achieve the desired result<a data-primary="" data-startref="ix-comp-comp19" data-type="indexterm" id="id877"/><a data-primary="" data-startref="ix-comp-comp19a" data-type="indexterm" id="id878"/><a data-primary="" data-startref="ix-comp-comp19b" data-type="indexterm" id="id879"/><a data-primary="" data-startref="ix-comp-comp19c" data-type="indexterm" id="id880"/><a data-primary="" data-startref="ix-comp-comp21" data-type="indexterm" id="id881"/><a data-primary="" data-startref="ix-comp-comp21a" data-type="indexterm" id="id882"/><a data-primary="" data-startref="ix-comp-comp21b" data-type="indexterm" id="id883"/><a data-primary="" data-startref="ix-comp-comp21c" data-type="indexterm" id="id884"/><a data-primary="" data-startref="ix-comp-comp21d" data-type="indexterm" id="id885"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Summary" data-type="sect1"><div class="sect1" id="id356">&#13;
<h1>Summary</h1>&#13;
&#13;
<p>In this chapter, we learned how to create a Vue component in the SFC standard and use <code>defineComponent()</code> to enable TypeScript support for the Vue application fully. We also learned to use <code>slots</code> to create a reusable component with isolated styles and shared mixin configurations in different contexts. We have explored further composing components using the component’s lifecycle hooks, <code>computed</code>, <code>methods</code>, and <code>watch</code> properties in the Options API. Next, we will build on these foundations to create custom events and develop the interactions between components with the &#13;
<span class="keep-together">provide/inject patterns</span>.</p>&#13;
</div></section>&#13;
<div data-type="footnotes"><p data-type="footnote" id="id874"><sup><a href="ch03.html#id874-marker">1</a></sup> <a href="https://oreil.ly/YQ6IJ">CSS Modules</a> started as an open source project for React.</p></div></div></section></body></html>