<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 8. Serious Polymorphism: Interfaces and Abstract Classes"><div class="chapter" id="serious_polymorphism_interfaces_and_abst">
<h1><span class="label">Chapter 8. </span>Serious Polymorphism: Interfaces and Abstract Classes</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0199-01.png" alt="image" width="675" height="489"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="abstract classes" data-secondary="and polymorphism" id="idm46038394225952"/><a data-type="indexterm" data-primary="interfaces" id="idm46038394224784"/><strong>Inheritance is just the beginning.</strong> To exploit polymorphism, we need interfaces (and not the GUI kind). We need to go beyond simple inheritance to a level of flexibility and extensibility you can get only by designing and coding to interface specifications.  Some of the coolest parts of Java wouldn’t even be possible without interfaces, so even if you don’t design with them yourself, you still have to use them. But you’ll <em>want</em> to design with them. You’ll <em>need</em> to design with them. <strong><em>You’ll</em></strong> wonder how you ever lived without them. What’s an interface? It’s a 100% abstract class. What’s an abstract class? It’s a class that can’t be instantiated. What’s that good for? You’ll see in just a few moments. But if you think about the end of the previous chapter, and how we used polymorphic arguments so that a single Vet method could take Animal subclasses of all types, well, that was just scratching the surface. Interfaces are the <strong><em>poly</em></strong> in polymorphism. The <strong><em>ab</em></strong> in abstract. The <strong><em>caffeine</em></strong> in Java.</p>
<section data-type="sect1" data-pdf-bookmark="Did we forget about something when we designed this?"><div class="sect1" id="did_we_forget_about_something_when_we_de">
<h1>Did we forget about something when we designed this?</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0200-01.png" alt="image" width="845" height="1128"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="Animal simulation program" id="idm46038394211104"/>The class structure isn’t too bad. We’ve designed it so that duplicate code is kept to a minimum, and we’ve overridden the methods that we think should have subclass-specific implementations. We’ve made it nice and flexible from a polymorphic perspective, because we can design Animal-using programs with Animal arguments (and array declarations) so that any Animal subtype—<strong><em>including those we never imagined at the time we wrote our code</em></strong>—can be passed in and used at runtime. We’ve put the common protocol for all Animals (the four methods that we want the world to know all Animals have) in the Animal superclass, and we’re ready to start making new Lions and Tigers and Hippos.</p>
<p><strong>We know we can say:</strong></p>
<pre data-type="programlisting">Wolf aWolf = new Wolf();</pre>
<figure class="informal"><div class="figure">
<img src="Images/f0201-01.png" alt="image" width="1032" height="367"/>
<h6/>
</div></figure>
<p><strong>And we know we can say:</strong></p>
<pre data-type="programlisting">Animal aHippo = new Hippo();</pre>
<figure class="informal"><div class="figure">
<img src="Images/f0201-02.png" alt="image" width="1058" height="367"/>
<h6/>
</div></figure>
<p><strong>But here’s where it gets weird:</strong></p>
<pre data-type="programlisting">Animal anim = new <u>Animal</u>();</pre>
<figure class="informal"><div class="figure">
<img src="Images/f0201-03.png" alt="image" width="1058" height="422"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="abstract classes" id="idm46038394202896"/><a data-type="indexterm" data-primary="abstract class modifier" id="idm46038394202160"/><a data-type="indexterm" data-primary="classes" data-secondary="abstract" data-see="abstract classes" id="idm46038394201360"/><a data-type="indexterm" data-primary="classes" data-secondary="concrete" id="idm46038394199984"/><a data-type="indexterm" data-primary="concrete classes" id="idm46038394198880"/><a data-type="indexterm" data-primary="polymorphism" id="idm46038394198048"/><a data-type="indexterm" data-primary="polymorphism" data-secondary="abstract classes" id="idm46038394197216"/><strong>What does a new Animal() object <em>look</em> like?</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0202-01.png" alt="image" width="1083" height="562"/>
<h6/>
</div></figure>
<p><strong>What are the instance variable values?</strong></p>
<p><strong>Some classes just should <u><em>not</em></u> be instantiated!</strong></p>
<p>It makes sense to create a Wolf object or a Hippo object or a Tiger object, but what exactly <em>is</em> an Animal object? What shape is it? What color, size, number of legs...</p>
<p>Trying to create an object of type Animal is like <strong>a nightmare Star Trek™ transporter accident.</strong> The one where somewhere in the beam-me-up process something bad happened to the buffer.</p>
<p>But how do we deal with this? We <em>need</em> an Animal class, for inheritance and polymorphism. But we want programmers to instantiate only the less abstract <em>subclasses</em> of class Animal, not Animal itself. We want Tiger objects and Lion objects, <strong><em>not Animal objects.</em></strong></p>
<p>Fortunately, there’s a simple way to prevent a class from ever being instantiated. In other words, to stop anyone from saying “<code><strong>new</strong></code>” on that type. By marking the class as <code><strong>abstract</strong></code>, the compiler will stop any code, anywhere, from ever creating an instance of that type.</p>
<p>You can still use that abstract type as a reference type. In fact, that’s a big part of why you have that abstract class in the first place (to use it as a polymorphic argument or return type, or to make a polymorphic array).</p>
<p>When you’re designing your class inheritance structure, you have to decide which classes are <em>abstract</em> and which are <em>concrete</em>. Concrete classes are those that are specific enough to be instantiated. A <em>concrete</em> class just means that it’s OK to make objects of that type.</p>
<p>Making a class abstract is easy—put the keyword <code><strong>abstract</strong></code> before the class declaration:</p>
<pre data-type="programlisting"><strong><span style="background-color:#C4C5C7;">abstract</span> class Canine extends Animal {</strong>
   <strong>public void roam() { }</strong>
<strong>}</strong></pre>
</div></section>
<section data-type="sect1" data-pdf-bookmark="The compiler won’t let you instantiate an abstract class"><div class="sect1" id="the_compiler_wonapostrophet_let_you_inst">
<h1>The compiler won’t let you instantiate an abstract class</h1>
<p><a data-type="indexterm" data-primary="subclasses" data-secondary="as instantiators under abstract classes" id="idm46038394177440"/>An abstract class means that nobody can ever make a new instance of that class. You can still use that abstract class as a declared reference type, for the purpose of polymorphism, but you don’t have to worry about somebody making objects of that type. The compiler <em>guarantees</em> it.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0203-01.png" alt="image" width="513" height="326"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0203-02.png" alt="image" width="859" height="342"/>
<h6/>
</div></figure>
<p>An <strong>abstract class</strong> has virtually* no use, no value, no purpose in life, unless it is <em><strong>extended.</strong></em></p>
<p>With an abstract class, it’s the <strong>instances of a <em>subclass</em></strong> of your abstract class that’s doing the work at runtime</p>
<p>*There is an exception to this—an abstract class can have static members (see <a data-type="xref" href="ch10.xhtml#numbers_matter_numbers_and_statics">Chapter 10</a>).</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Abstract vs. Concrete"><div class="sect1" id="abstract_vsdot_concrete">
<h1>Abstract vs. Concrete</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0204-01.png" alt="image" width="1008" height="873"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="GUI" data-secondary="abstract classes in" id="idm46038394171504"/>A class that’s not abstract is called a <em>concrete</em> class. In the Animal inheritance tree, if we make Animal, Canine, and Feline abstract, that leaves Hippo, Wolf, Dog, Tiger, Lion, and Cat as the concrete subclasses.</p>
<p>Flip through the Java API and you’ll find a lot of abstract classes, especially in the GUI library. What does a GUI Component look like? The Component class is the superclass of GUI-related classes for things like buttons, text areas, scrollbars, dialog boxes, you name it. You don’t make an instance of a generic <em>Component</em> and put it on the screen; you make a JButton. In other words, you instantiate only a <em>concrete subclass</em> of Component, but never Component itself.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-id00004">
<h5>Brain Power</h5>
<figure class="informal"><div class="figure">
<img src="Images/brain.png" alt="image" width="80" height="71"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0204-02.png" alt="image" width="854" height="705"/>
<h6/>
</div></figure>
<p><strong>Abstract or concrete?</strong></p>
<p>How do you know when a class should be abstract? <strong><em>Wine</em></strong> is probably abstract. But what about <strong><em>Red</em></strong> and <strong><em>White</em></strong>? Again probably abstract (for some of us, anyway). But at what point in the hierarchy do things become concrete?</p>
<p>Do you make <strong><em>PinotNoir</em></strong> concrete, or is it abstract too? It looks like the Camelot Vineyards 1997 Pinot Noir is probably concrete no matter what. But how do you know for sure?</p>
<p>Look at the Animal inheritance tree above. Do the choices we’ve made for which classes are abstract and which are concrete seem appropriate? Would you change anything about the Animal inheritance tree (other than adding more Animals, of course)?</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Abstract methods"><div class="sect1" id="abstract_methods">
<h1>Abstract methods</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0205-02.png" alt="image" width="293" height="495"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="abstract methods" id="idm46038394150944"/><a data-type="indexterm" data-primary="declarations" data-secondary="method" id="idm46038394150208"/><a data-type="indexterm" data-primary="methods" data-secondary="abstract" id="idm46038394149232"/><a data-type="indexterm" data-primary="polymorphism" data-secondary="methods" id="idm46038394148256"/>Besides classes, you can mark <em>methods</em> abstract, too. An abstract class means the class must be <em>extended</em>; an abstract method means the method must be <em>overridden</em>. You might decide that some (or all) behaviors in an abstract class don’t make any sense unless they’re implemented by a more specific subclass. In other words, you can’t think of any generic method implementation that could possibly be useful for subclasses. What would a generic eat() method look like?</p>
<p><strong>An abstract method has no body!</strong></p>
<p>Because you’ve already decided there isn’t any code that would make sense in the abstract method, you won’t put in a method body. So no curly braces— just end the declaration with a semicolon.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0205-01.png" alt="image" width="367" height="101"/>
<h6/>
</div></figure>
<p><strong>If you declare an abstract <em>method</em>, you MUST mark the <em>class</em> abstract as well. You can’t have an abstract method in a non-abstract class.</strong></p>
<p>If you put even a single abstract method in a class, you have to make the class abstract. But you <em>can</em> mix both abstract and non-abstract methods in the abstract class.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00014">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: What is the <em>point</em> of an abstract method? I thought the whole point of an abstract class was to have common code that could be inherited by subclasses.</strong></p>
<p><strong>A:</strong> Inheritable method implementations (in other words,  methods with actual <em>bodies</em>) are A Good Thing to put in a superclass. <em>When it makes sense.</em> And in an abstract class, it often <em>doesn’t</em> make sense, because you can’t come up with any generic code that subclasses would find useful. The point of an abstract method is that even though you haven’t put in any actual method code, you’ve still defined part of the <em>protocol</em> for a group of subtypes (subclasses).</p>
<p><strong>Q: Which is good because...</strong></p>
<p><strong>A:</strong> Polymorphism! Remember, what you want is the ability to use a superclass type (often abstract) as a method argument, return type, or array type. That way, you get to add new subtypes (like a new Animal subclass) to your program without having to rewrite (or add) new methods to deal with those new types. Imagine how you’d have to change the Vet class, if it didn’t use Animal as its argument type for methods. You’d have to have a separate method for every single Animal subclass! One that takes a Lion, one that takes a Wolf, one that takes a...you get the idea. So with an abstract method, you’re saying, “All subtypes of this type have THIS method” for the benefit of polymorphism.</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="You MUST implement all abstract methods"><div class="sect1" id="you_must_implement_all_abstract_methods">
<h1>You MUST implement all abstract methods</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0206-01.png" alt="image" width="513" height="438"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="behavior of an object" data-see="methods" id="idm46038394125504"/><a data-type="indexterm" data-primary="inheritance" data-secondary="implementing abstract methods" id="idm46038394122896"/><a data-type="indexterm" data-primary="methods" data-secondary="non-abstract methods with abstract classes" id="idm46038394121824"/><strong><em>Implementing</em> an abstract method is just like <em>overriding</em> a method.</strong></p>
<p>Abstract methods don’t have a body; they exist solely for polymorphism. That means the first concrete class in the inheritance tree must implement <em>all</em> abstract methods.</p>
<p>You can, however, pass the buck by being abstract yourself. If both Animal and Canine are abstract, for example, and both have abstract methods, class Canine does not have to implement the abstract methods from Animal. But as soon as we get to the first concrete subclass, like Dog, that subclass must implement <em>all</em> of the abstract methods from both Animal and Canine.</p>
<p>But remember that an abstract class can have both abstract and <em>non</em>-abstract methods, so Canine, for example, could implement an abstract method from Animal, so that Dog didn’t have to. But if Canine says nothing about the abstract methods from Animal, Dog has to implement all of Animal’s abstract methods.</p>
<p>When we say “you must implement the abstract method,” that means you <em>must provide a body.</em> That means you must create a non-abstract method in your class with the same method signature (name and arguments) and a return type that is compatible with the declared return type of the abstract method. What you put <em>in</em> that method is up to you. All Java cares about is that the method is <em>there</em>, in your concrete subclass.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="sharpen_your_pencil-id00016">
<h5>Sharpen your pencil</h5>
<figure class="informal"><div class="figure">
<img src="Images/f0207-01.png" alt="image" width="128" height="84"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="Sharpen Your Pencil" id="idm46038394108224"/><span class="inlineimage"><img src="Images/arr1.png" alt="Images" width="137" height="12"/></span> <strong>Yours to solve.</strong></p>
<p><strong>Abstract versus Concrete classes</strong></p>
<p>Let’s put all this abstract rhetoric into some concrete use. In the middle column we’ve listed some classes. Your job is to imagine applications where the listed class might be concrete, and applications where the listed class might be abstract. We took a shot at the first few to get you going. For example, class Tree would be abstract in a tree nursery program, where differences between an Oak and an Aspen matter. But in a golf simulation program, Tree might be a concrete class (perhaps a subclass of Obstacle), because the program doesn’t care about or distinguish between different types of trees. (There’s no one right answer; it depends on your design.)</p>
<figure class="informal"><div class="figure">
<img src="Images/f0207-02.png" alt="image" width="900" height="956"/>
<h6/>
</div></figure>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Polymorphism in action"><div class="sect1" id="polymorphism_in_action">
<h1>Polymorphism in action</h1>
<p><a data-type="indexterm" data-primary="abstract classes" data-secondary="and polymorphism" id="idm46038394102400"/><a data-type="indexterm" data-primary="polymorphism" data-secondary="abstract classes" id="idm46038394101168"/>Let’s say that we want to write our <em>own</em> kind of list class, one that will hold Dog objects, but pretend for a moment that we don’t know about the ArrayList class. For the first pass, we’ll give it just an add() method. We’ll use a simple Dog array (Dog[]) to keep the added Dog objects, and give it a length of 5. When we reach the limit of 5 Dog objects, you can still call the add() method, but it won’t do anything. If we’re <em>not</em> at the limit, the add() method puts the Dog in the array at the next available index position and then increments that next available index (nextIndex).</p>
<p><strong>Building our own Dog-specific list</strong></p>
<p><strong>(Perhaps the world’s worst attempt at making our own ArrayList kind of class, from scratch.)</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0208-01.png" alt="image" width="1318" height="673"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Uh-oh, now we need to keep Cats, too"><div class="sect1" id="uh-ohcomma_now_we_need_to_keep_catscomma">
<h1>Uh-oh, now we need to keep Cats, too</h1>
<p>We have a few options here:</p>
<p>1. Make a separate class, MyCatList, to hold Cat objects. Pretty clunky.</p>
<p>2. Make a single class, DogAndCatList, that keeps two different arrays as instance variables and has two different add() methods: addCat(Cat c) and addDog(Dog d). Another clunky solution.</p>
<p>3. Make a heterogeneous AnimalList class that takes <em>any</em> kind of Animal subclass (since we know that if the spec changed to add Cats, sooner or later we’ll have some <em>other</em> kind of animal added as well). We like this option best, so let’s change our class to make it more generic, to take Animals instead of just Dogs. We’ve highlighted the key changes (the logic is the same, of course, but the type has changed from Dog to Animal everywhere in the code).</p>
<p><strong>Building our own <u>Animal</u>-specific list</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0209-01.png" alt="image" width="1409" height="901"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0209-02.png" alt="image" width="486" height="241"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="What about non-Animals? Why not make a class generic enough to take anything?"><div class="sect1" id="what_about_non-animalsquestion_mark_why">
<h1>What about non-Animals? Why not make a class generic enough to take <u>anything?</u></h1>
<figure class="informal"><div class="figure">
<img src="Images/f0210-01.png" alt="image" width="496" height="1001"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="classes" data-secondary="Object superclass" id="idm46038394067136"/><a data-type="indexterm" data-primary="Object class" id="idm46038394066160"/><a data-type="indexterm" data-primary="polymorphism" data-secondary="Object class" id="idm46038394065424"/>You know where this is heading. We want to change the type of the array, along with the add() method argument, to something <em>above</em> Animal. Something even <em>more</em> generic, <em>more</em> abstract than Animal. But how can we do it? We don’t <em>have</em> a superclass for Animal.</p>
<p>Then again, maybe we do...</p>
<p><strong>Every class in Java extends class Object.</strong></p>
<p>Class Object is the mother of all classes; it’s the superclass of <em>everything.</em></p>
<p>Even if you take advantage of polymorphism, you still have to create a class with methods that take and return <em>your</em> polymorphic type. Without a common superclass for everything in Java, there’d be no way for the developers of Java to create classes with methods that could take <em>your</em> custom types...<em>types they never knew about when they wrote the library class.</em></p>
<p>So you were making subclasses of class Object from the very beginning and you didn’t even know it. <strong><em>Every class you write extends Object,</em></strong> without your ever having to say it. But you can think of it as though a class you write looks like this:</p>
<pre data-type="programlisting">  public class Dog <strong>extends Object</strong> { }</pre>
<p>But wait a minute, Dog <em>already</em> extends something, <em>Canine</em>. That’s OK. The compiler will make <em>Canine</em> extend Object instead. Except <em>Canine</em> extends Animal. No problem, then the compiler will just make <em>Animal</em> extend Object.</p>
<p><strong>Any class that doesn’t <em>explicitly</em> extend another class, <em>implicitly</em> extends <span style="color:#9D9EA0;">Object.</span></strong></p>
<p>So, since Dog extends Canine, it doesn’t <em>directly</em> extend Object (although it does extend it indirectly), and the same is true for Canine, but Animal <em>does</em> directly extend Object.</p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="So what’s in this ultra-super-megaclass Object?"><div class="sect1" id="so_whatapostrophes_in_this_ultra-super-m">
<h1>So what’s in this ultra-super-megaclass Object?</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0211-01.png" alt="image" width="513" height="398"/>
<h6/>
</div></figure>
<p>If you were Java, what behavior would you want <em>every</em> object to have? Hmmmm...let’s see...how about a method that lets you find out if one object is equal to another object? What about a method that can tell you the actual class type of that object? Maybe a method that gives you a hashcode for the object, so you can use the object in hashtables (we’ll talk about Java’s hashtables later). Oh, here’s a good one—a method that prints out a String message for that object.</p>
<p>And what do you know? As if by magic, class Object does indeed have methods for those four things. That’s not all, though, but these are the ones we really care about.</p>
<p><span class="inlineimage"><img src="Images/1.png" alt="Images" width="20" height="21"/></span> <strong>equals(Object o)</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0211-02.png" alt="image" width="705" height="463"/>
<h6/>
</div></figure>
<p><span class="inlineimage"><img src="Images/2.png" alt="Images" width="20" height="21"/></span> <strong>getClass()</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0211-03.png" alt="image" width="733" height="261"/>
<h6/>
</div></figure>
<p><span class="inlineimage"><img src="Images/3.png" alt="Images" width="20" height="21"/></span> <strong>hashCode()</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0211-04.png" alt="image" width="678" height="262"/>
<h6/>
</div></figure>
<p><span class="inlineimage"><img src="Images/4.png" alt="Images" width="20" height="20"/></span> <strong>toString()</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0211-05.png" alt="image" width="530" height="424"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00015">
<h5>there are no Dumb Questions</h5>
<p><a data-type="indexterm" data-primary="methods" data-secondary="and type Object’s role in code" id="idm46038394021936"/><a data-type="indexterm" data-primary="objects" data-secondary="of type Object" id="idm46038394020720"/><a data-type="indexterm" data-primary="overriding methods" data-secondary="Object class" id="idm46038394019616"/><strong>Q: Is class Object abstract?</strong></p>
<p><strong>A:</strong> No. Well, not in the formal Java sense anyway. Object is a non-abstract class because it’s got method implementation code that all classes can inherit and use out of the box, without having to override the methods.</p>
<p><strong>Q: Then <em>can</em> you override the methods in Object?</strong></p>
<p><strong>A:</strong> Some of them. But some of them are marked <code>final</code>, which means you can’t override them.  You’re encouraged (strongly) to override hashCode(), equals(), and toString() in your own classes, and you’ll learn how to do that a little later in the book. But some of the methods, like getClass(), do things that must work in a specific, guaranteed way.</p>
<p><strong>Q: HOW can you let somebody make an Object object? Isn’t that just as weird as making an Animal object?</strong></p>
<p><strong>A:</strong> Good question! Why is it acceptable to  make a new Object instance? Because sometimes you just want a generic object to use as, well, as an object. A <em>lightweight</em> object. For now, just stick that on the back burner and assume that you will rarely make objects of type Object, even though you <em>can</em>.</p>
<p><strong>Q: So is it fair to say that the main purpose for type Object is so that you can use it for a polymorphic argument and return type?</strong></p>
<p><strong>A:</strong> The Object class serves <em>two</em> main purposes: to act as a polymorphic type for methods that need to work on any class that you or anyone else makes, and to provide <em>real</em> method code that all objects in Java need at runtime (and putting them in class Object means all other classes inherit them). Some of the most important methods in Object are related to threads, and we’ll see those later in the book.</p>
<p><strong>Q: If it’s so good to use polymorphic types, why don’t you just make ALL your methods take and return type Object?</strong></p>
<p><strong>A:</strong> Ahhhh...think about what would happen.  For one thing, you would defeat the whole point of  “<em>type-safety,”</em> one of Java’s greatest protection mechanisms for your code. With type-safety, Java guarantees that you won’t ask the wrong object to do something you <em>meant</em> to ask of another object type. Like, ask a <em>Ferrari</em> (which you think is a <em>Toaster</em>) to <em>cook itself.</em></p>
<p>But the truth is, you <em>don’t</em> have to worry about that fiery Ferrari scenario, even if you <em>do</em> use Object references for everything. Because when objects are referred to by an Object reference type, Java <em>thinks</em> it’s referring to an instance of type Object. And that means the only methods you’re allowed to call on that object are the ones declared in class Object! So if you were to say:</p>
<pre data-type="programlisting"><strong>Object o = new Ferrari();</strong>
<strong>o.goFast(); //Not legal!</strong></pre>
<p>You wouldn’t even make it past the compiler.</p>
<p>Because Java is a strongly typed language, the compiler checks to make sure that you’re calling a method on an object that’s actually capable of <em>responding</em>. In other words, you can call a method on an object reference <em>only</em> if the class of the reference type actually <em>has</em> the method. We’ll cover this in much greater detail a little later, so don’t worry if the picture isn’t crystal clear.</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Using polymorphic references of type Object has a price..."><div class="sect1" id="using_polymorphic_references_of_type_obj">
<h1>Using polymorphic references of type Object has a price...</h1>
<p><a data-type="indexterm" data-primary="ArrayList" data-secondary="containing references of type Object" id="idm46038394008800"/><a data-type="indexterm" data-primary="reference variables" data-secondary="and objects of type Object" id="idm46038394008160"/>Before you run off and start using type Object for all your ultra-flexible argument and return types, you need to consider a little issue of using type Object as a reference. And keep in mind that we’re not talking about making instances of type Object; we’re talking about making instances of some other type, but using a reference of type Object.</p>
<p>When you put an object into an ArrayList<strong>&lt;Dog&gt;</strong>, it goes in as a Dog and comes out as a Dog:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0213-01.png" alt="image" width="1382" height="261"/>
<h6/>
</div></figure>
<p>But what happens when you declare it as ArrayList<strong>&lt;Object&gt;</strong>? If you want to make an ArrayList that will literally take any kind of Object, you declare it like this:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0213-02.png" alt="image" width="1477" height="204"/>
<h6/>
</div></figure>
<p>But what happens when you try to get the Dog object and assign it to a Dog reference?</p>
<figure class="informal"><div class="figure">
<img src="Images/f0213-03.png" alt="image" width="1475" height="130"/>
<h6/>
</div></figure>
<p><strong><em>Everything comes out of an ArrayList&lt;Object&gt; as a reference of type Object, regardless of what the actual object is or what the reference type was when you added the object to the list.</em></strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0213-04.png" alt="image" width="1477" height="587"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="When a Dog won’t act like a Dog"><div class="sect1" id="when_a_dog_wonapostrophet_act_like_a_dog">
<h1>When a Dog won’t act like a Dog</h1>
<p>The problem with having everything treated polymorphically as an Object is that the objects <em>appear</em> to lose (but not permanently) their true essence. <em>The Dog appears to lose its dogness</em>. Let’s see what happens when we pass a Dog to a method that returns a reference to the same Dog object, but declares the return type as type Object rather than Dog.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0214-01.png" alt="image" width="628" height="549"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0214-02.png" alt="image" width="1399" height="455"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0214-03.png" alt="image" width="1426" height="345"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0214-04.png" alt="image" width="1414" height="282"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Objects don’t bark"><div class="sect1" id="objects_donapostrophet_bark">
<h1>Objects don’t bark</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0215-01.png" alt="image" width="587" height="483"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="methods" data-secondary="and type Object’s role in code" id="idm46038393977712"/><a data-type="indexterm" data-primary="reference variables" data-secondary="calling methods by" id="idm46038393976368"/>So now we know that when an object is referenced by a variable declared as type Object, it can’t be assigned to a variable declared with the actual object’s type. And we know that this can happen when a return type or argument is declared as type Object, as would be the case, for example, when the object is put into an ArrayList of type Object using ArrayList&lt;Object&gt;. But what are the implications of this? Is it a problem to have to use an Object reference variable to refer to a Dog object? Let’s try to call Dog methods on our Dog-That-Compiler-Thinks-Is-An-Object:</p>
<figure class="informal"><div class="figure">
<img src="Images/f0215-02.png" alt="image" width="1220" height="326"/>
<h6/>
</div></figure>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><strong>The compiler decides whether you can call a method based on the <u><em>reference</em></u> type, not the actual object type.</strong></p>
</div>
<p>Even if you <em>know</em> the object is capable (“...but it really <em>is</em> a Dog, honest...”), the compiler sees it only as a generic Object. For all the compiler knows, you put a Button object out there. Or a Microwave object. Or some other thing that really doesn’t know how to bark.</p>
<p>The compiler checks the class of the <em>reference</em> type—not the <em>object</em> type—to see if you can call a method using that reference.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0215-03.png" alt="image" width="793" height="706"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0216-01.png" alt="image" width="929" height="821"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Get in touch with your inner Object"><div class="sect1" id="get_in_touch_with_your_inner_object">
<h1>Get in touch with your inner Object</h1>
<p><a data-type="indexterm" data-primary="inheritance" data-secondary="relationship to objects" id="idm46038393961632"/>An object contains <em>everything</em> it inherits from each of its superclasses. That means <em>every</em> object—regardless of its actual class type—is <em>also</em> an instance of class Object. That means any object in Java can be treated not just as a Dog, Button, or Snowboard, but also as an Object. When you say <code><strong>new Snowboard()</strong></code>, you get a single object on the heap—a Snowboard object—but that Snowboard wraps itself around an inner core representing the Object (capital “O”) portion of itself.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0216-02.png" alt="image" width="534" height="694"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0216-03.png" alt="image" width="587" height="579"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Polymorphism means “many forms.”"><div class="sect1" id="polymorphism_means_quotation_markmany_fo">
<h1><em>Polymorphism</em> means “many forms.”</h1>
<p><a data-type="indexterm" data-primary="reference variables" data-secondary="and objects of type Object" id="idm46038393952400"/><strong>You can treat a Snowboard as a Snowboard or as an Object.</strong></p>
<p>If a reference is like a remote control, the remote control takes on more and more buttons as you move down the inheritance tree. A remote control (reference) of type Object has only a few buttons— the buttons for the exposed methods of class Object. But a remote control of type Snowboard includes all the buttons from class Object, plus any new buttons (for new methods) of class Snowboard. The more specific the class, the more buttons it may have.</p>
<p>Of course that’s not always true; a subclass might not add any new methods, but simply override the methods of its superclass. The key point is that even if the object is of type Snowboard, an Object <em>reference</em> to the Snowboard <em>object</em> can’t see the Snowboardspecific methods.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm46038394006768">
<p><strong>When you put an object in an ArrayList&lt;Object&gt;, you can treat it only as an Object, regardless of the type it was when you put it in.</strong></p>
<p><strong>When you get a reference from an ArrayList&lt;Object&gt;, the reference is always of type <em>Object.</em></strong></p>
<p><strong>That means you get an <em>Object</em> remote control.</strong></p>
</div></aside>
<figure class="informal"><div class="figure">
<img src="Images/f0217-02.png" alt="image" width="1503" height="859"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0218-01.png" alt="image" width="513" height="815"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Casting an object reference back to its real type."><div class="sect2" id="casting_an_object_reference">
<h2>Casting an object reference back to its <em>real</em> type.</h2>
<figure class="informal"><div class="figure">
<img src="Images/f0218-03.png" alt="image" width="369" height="211"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0218-02.png" alt="image" width="506" height="970"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="casting" id="idm46038393930768"/><a data-type="indexterm" data-primary="reference variables" data-secondary="casting" id="idm46038393929856"/>It’s really still a Dog <em>object</em>, but if you want to call Dogspecific methods, you need a <em>reference</em> declared as type Dog. If you’re <em>sure*</em> the object is really a Dog, you can make a new Dog reference to it by copying the Object reference, and forcing that copy to go into a Dog reference variable, using a cast (Dog). You can use the new <em>Dog</em> reference to call <em>Dog</em> methods.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0218-04.png" alt="image" width="654" height="546"/>
<h6/>
</div></figure>
<p>*If you’re <em>not</em> sure it’s a Dog, you can use the <code>instanceof</code> operator to check. Because if you’re wrong when you do the cast, you’ll get a ClassCastException at runtime and come to a grinding halt.</p>
<pre data-type="programlisting">   if (o instanceof Dog) {
      Dog d = (Dog) o;
   }</pre>
<p><a data-type="indexterm" data-primary="contract" data-secondary="public methods as" id="idm46038394011792"/><strong>So now you’ve seen how much Java cares about the methods in the class of the <u>reference</u> variable.</strong></p>
<p><strong>You can call a method on an object only if the class of the reference variable has that method.</strong></p>
<p><strong>Think of the public methods in your class as your contract, your promise to the outside world about the things you can do.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0219-01.png" alt="image" width="373" height="763"/>
<h6/>
</div></figure>
<p>When you write a class, you almost always <em>expose</em> some of the methods to code outside the class. To <em>expose</em> a method means you make a method <em>accessible</em>, usually by marking it public.</p>
<p>Imagine this scenario: you’re writing code for a small business accounting program. A custom application for Simon’s Surf Shop. The good re-user that you are, you found an Account class that appears to meet your needs perfectly, according to its documentation, anyway. Each account instance represents an individual customer’s account with the store. So there you are minding your own business invoking the <em>credit()</em> and <em>debit()</em> methods on an Account object when you realize you need to get a balance on an account. No problem—there’s a <em>getBalance()</em> method that should do nicely.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0219-02.png" alt="image" width="278" height="295"/>
<h6/>
</div></figure>
<p>Except...when you invoke the <em>getBalance()</em> method, the whole thing blows up at runtime. Forget the documentation, the class does not have that method. Yikes!</p>
<p>But that won’t happen to you, because every time you use the dot operator on a reference (a.doStuff()), the compiler looks at the <em>reference</em> type (the type “a” was declared to be) and checks that class to guarantee the class has the method, and that the method does indeed take the argument you’re passing and return the kind of value you’re expecting to get back.</p>
<p><strong>Just remember that the compiler checks the class of the <em>reference</em> variable, not the class of the actual <em>object</em> at the other end of the reference.</strong></p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="What if you need to change the contract?"><div class="sect1" id="what_if_you_need_to_change_the_contractq">
<h1>What if you need to change the contract?</h1>
<p><a data-type="indexterm" data-primary="contract" id="idm46038394119040"/><a data-type="indexterm" data-primary="contract" data-secondary="modifying class tree" id="idm46038394118112"/><a data-type="indexterm" data-primary="inheritance trees" id="idm46038394117008"/><a data-type="indexterm" data-primary="PetShop program" id="idm46038393905584"/>OK, pretend you’re a Dog. Your Dog class isn’t the <em>only</em> contract that defines who you are. Remember, you inherit accessible (which usually means <em>public</em>) methods from all of your superclasses.</p>
<p>True, your Dog class defines a contract.</p>
<p>But not <em>all</em>  of your contract.</p>
<p><strong>Everything in class <em>Canine</em> is part of your contract.</strong></p>
<p><strong>Everything in class <em>Animal</em> is part of your contract.</strong></p>
<p><strong>Everything in class <em>Object</em> is part of your contract.</strong></p>
<p>According to the IS-A test, you <em>are</em> each of those things—Canine, Animal, and Object.</p>
<p>But what if the person who designed your class had in mind the Animal simulation program, and now he wants to use you (class Dog) for a Science Fair Tutorial on Animal objects.</p>
<p>That’s OK, you’re probably reusable for that.</p>
<p>But what if later he wants to use you for a PetShop program? <em>You don’t have any <strong>Pet</strong> behaviors.</em> A Pet needs methods like <em>beFriendly()</em> and <em>play()</em>.</p>
<p>OK, now pretend you’re the Dog class programmer. No problem, right? Just add some more methods to the Dog class. You won’t be breaking anyone else’s code by <em>adding</em> methods, since you aren’t touching the <em>existing</em> methods that someone else’s code might be calling on Dog objects.</p>
<p>Can you see any drawbacks to that approach (adding Pet methods to the Dog class)?</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="brain_power-id00005">
<h5>Brain Power</h5>
<figure class="informal"><div class="figure">
<img src="Images/brain.png" alt="image" width="80" height="71"/>
<h6/>
</div></figure>
<p>Think about what <strong>YOU</strong> would do if <strong>YOU</strong> were the Dog class programmer and needed to modify the Dog so that it could do Pet things, too. We know that simply adding new Pet behaviors (methods) to the Dog class will work, and won’t break anyone else’s code.</p>
<p>But...this is a PetShop program. It has more than just Dogs!  And what if someone wants to use your Dog class for a program that has <em>wild</em> Dogs? What do you think your options might be, and without worrying about how Java handles things, just try to imagine how you’d <em>like</em> to solve the problem of modifying some of your Animal classes to include Pet behaviors.</p>
<p>Stop right now and think about it, <strong>before you look at the next page</strong> where we begin to reveal <em>everything</em>.*</p>
<p>*(Thus rendering the whole exercise completely useless, robbing you of your One Big Chance to burn some brain calories.)</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Let’s explore some design options for reusing some of our existing classes in a PetShop program"><div class="sect1" id="letapostrophes_explore_some_design_optio">
<h1>Let’s explore some design options for reusing some of our existing classes in a PetShop program</h1>
<p><a data-type="indexterm" data-primary="classes" data-secondary="PetShop program class tree modifications" id="idm46038393881024"/>On the next few pages, we’re going to walk through some possibilities. We’re not yet worried about whether Java can actually <em>do</em> what we come up with. We’ll cross that bridge once we have a good idea of some of the trade-offs.</p>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000017">
<p><span class="inlineimage"><img src="Images/1.png" alt="Images" width="20" height="21"/></span> <strong>Option one</strong></p>
<p>We take the easy path and put pet methods in class Animal.</p>
<p><strong>Pros:</strong></p>
<p>All the Animals will instantly inherit the pet behaviors. We won’t have to touch the existing Animal subclasses at all, and any Animal subclasses created in the future will also get to take advantage of inheriting those methods. That way, class Animal can be used as the polymorphic type in any program that wants to treat the Animals as pets.</p>
<p><strong>Cons:</strong></p>
<p>So...when was the last time y ou saw a Hippo at a pet shop? Lion? Wolf? Could be dangerous to give nonpets pet methods.</p>
<p>Also, we almost certainly WILL have to touch the pet classes like Dog and Cat, because (in our house, anyway) Dogs and Cats tend to implement pet behaviors VERY differently.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0221-01.png" alt="image" width="986" height="1009"/>
<h6/>
</div></figure>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000018">
<p><a data-type="indexterm" data-primary="abstract methods" id="idm46038393867712"/><a data-type="indexterm" data-primary="declarations" data-secondary="method" id="idm46038393866960"/><a data-type="indexterm" data-primary="methods" data-secondary="abstract" id="idm46038393865856"/><span class="inlineimage"><img src="Images/2.png" alt="Images" width="20" height="21"/></span> <strong>Option two</strong></p>
<p>We start with Option One, putting the pet methods in class Animal, but we make the methods abstract , forcing the Animal subclasses to override them.</p>
<p><strong>Pros:</strong></p>
<p>That would give us all the benefits of option one, but with - out the drawback of having non- pet Animals running around with pet methods (like beFriendly()). All Animal classes would have the method (because it’s in class Animal), but because it’s abstract, the non-pet Animal classes won’t inherit any functionality. All classes MUST override the methods, but they can make the methods “ do-nothings.”</p>
<figure class="informal"><div class="figure">
<img src="Images/f0222-01.png" alt="image" width="991" height="1270"/>
<h6/>
</div></figure>
<p><strong>Cons:</strong></p>
<p>Because the pet methods in the Animal class are all abstract, the concrete Animal subclasses are forced to implement all of them. (Remember, all abstract methods MUST be implemented by the first concrete subclass down the inheritance tree.) What a waste of time! You have to sit there and ty pe in each and every pet method into each and every concrete nonpet class, and all future subclasses as well. And while this does solve the problem of non-pets actually DOING pet things (as they would if they inherited pet functionality from class Animal), the contract is bad. Every non-pet class would be announcing to the world that it, too, has those pet methods, even though the methods wouldn’t actually DO anything when called.</p>
<p>This approach doesn’t look good at all. It just seems wrong to stuff everything into class Animal that more than one Animal ty pe might need, UNLESS it applies to ALL Animal subclasses.</p>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id00000019">
<p><span class="inlineimage"><img src="Images/3.png" alt="Images" width="20" height="21"/></span> <strong>Option three</strong></p>
<p>Put the pet methods ONLY in the classes where they belong.</p>
<p><strong>Pros:</strong></p>
<p>No more worries about Hippos greeting y ou at the door or licking your face. The methods are where they belong, and ONLY where they belong. Dogs can implement the methods and Cats can implement the methods, but nobody else has to know about them.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0223-01.png" alt="image" width="986" height="1084"/>
<h6/>
</div></figure>
<p><strong>Cons:</strong></p>
<p>Two Big Problems with this approach. First off, you’d have to agree to a protocol, and all programmers of pet Animal classes now and in the future would have to KNOW about the protocol. By protocol, we mean the exact methods that we’ve decided all pets should have. The pet contract without any thing to back it up. But what if one of the programmers gets it just a tiny bit wrong? Like, a method takes a String when it was supposed to take an int? Or they named it doFriendly() instead of beFriendly()? Since it isn’t in a contract, the compiler has no way to check you to see if you’ve implemented the methods correctly. Someone could easily come along to use the pet Animal classes and find that not all of them work quite right.</p>
<p>And second, you don’t get to use polymorphism for the pet methods. Every class that needs to use pet behaviors would have to know about each and every class! In other words, you can’t use Animal as the polymorphic type now, because the compiler won’t let you call a Pet method on an Animal reference (even if it’s really a Dog object) because class Animal doesn’t have the method.</p>
</div></aside>
<p><a data-type="indexterm" data-primary="multiple inheritance problem" id="idm46038393846272"/><a data-type="indexterm" data-primary="superclass" data-secondary="and multiple inheritance" id="idm46038393842320"/><strong>So what we REALLY need is:</strong></p>
<ul style="list-style-type:none">
<li><p><span class="inlineimage"><img src="Images/enter.png" alt="Images" width="14" height="17"/></span> A way to have pet behavior in <strong>just</strong> the pet classes</p></li>
<li><p><span class="inlineimage"><img src="Images/enter.png" alt="Images" width="14" height="17"/></span> A way to guarantee that all pet classes have all of the same methods defined (same name, same arguments, same return types, no missing methods, etc.), without having to cross your fingers and hope all the programmers get it right</p></li>
<li><p><span class="inlineimage"><img src="Images/enter.png" alt="Images" width="14" height="17"/></span> A way to take advantage of polymorphism so that all pets can have their pet methods called, without having to use arguments, return types, and arrays for each and every pet class</p></li>
</ul>
<p><strong>It looks like we need <u>TWO</u> superclasses at the top.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0224-01.png" alt="image" width="1382" height="1027"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="DDD (Deadly Diamond of Death)" id="idm46038393829216"/>There’s just one problem with the “two superclasses” approach...</p>
<p><strong>It’s called “multiple inheritance,” and it can be a Really Bad Thing.</strong></p>
<p>That is, if it were possible to do in Java.</p>
<p>But it isn’t, because multiple inheritance has a problem known as The Deadly Diamond of Death.</p>
<p><strong>Deadly Diamond of Death</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0225-01.png" alt="image" width="1431" height="728"/>
<h6/>
</div></figure>
<p>A language that allows the Deadly Diamond of Death can lead to some ugly complexities, because you have to have special rules to deal with the potential ambiguities. And extra rules means extra work for you both in <em>learning</em> those rules and watching out for those “special cases.” Java is supposed to be <em>simple</em> , with consistent rules that don’t blow up under some scenarios. So Java (unlike C++) protects you from having to think about the Deadly Diamond of Death. But that brings us back to the original problem! <em>How do we handle the Animal/Pet thing?</em></p>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Interface to the rescue!"><div class="sect1" id="interface_to_the_rescueexclamation_mark">
<h1>Interface to the rescue!</h1>
<p><a data-type="indexterm" data-primary="abstract classes" data-secondary="interface implementation" id="idm46038393822288"/><a data-type="indexterm" data-primary="abstract methods" id="idm46038393821088"/><a data-type="indexterm" data-primary="interface keyword" id="idm46038393820352"/><a data-type="indexterm" data-primary="interfaces" data-secondary="polymorphism" id="idm46038393819616"/><a data-type="indexterm" data-primary="methods" data-secondary="abstract" id="idm46038393818560"/><a data-type="indexterm" data-primary="polymorphism" data-secondary="interface implementation" id="idm46038393817456"/>Java gives you a solution. An <em>interface</em> . Not a <em>GUI</em> interface, not the generic use of the <em>word</em> interface as in, “That’s the public interface for the Button class API,” but the Java <em>keyword</em> <code>interface</code>.</p>
<p>A Java interface solves your multiple inheritance problem by giving you much of the polymorphic <em>benefits</em> of multiple inheritance without the pain and suffering from the Deadly Diamond of Death (DDD).</p>
<p>The way in which interfaces side-step the DDD is surprisingly simple: <strong><em>make all the methods abstract!</em></strong> That way, the subclass <strong><em>must</em></strong> implement the methods (remember, abstract methods <em>must</em> be implemented by the first concrete subclass), so at runtime the JVM isn’t confused about <em>which</em> of the two inherited versions it’s supposed to call.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0226-01.png" alt="image" width="413" height="355"/>
<h6/>
</div></figure>
<p><strong>A Java interface is like a 100% pure abstract class.</strong></p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p><span style="color:#9D9EA0;">All methods in an interface are abstract, so any class that IS-A Pet MUST implement (i.e., override) the methods of Pet.</span></p>
</div>
<p><strong>To <u>DEFINE</u> an interface:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0226-02.png" alt="image" width="686" height="166"/>
<h6/>
</div></figure>
<p><strong>To <u>IMPLEMENT</u> an interface:</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0226-03.png" alt="image" width="1121" height="235"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Making and implementing the Pet interface"><div class="sect1" id="making_and_implementing_the_pet_interfac">
<h1>Making and implementing the Pet interface</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0227-01.png" alt="image" width="1354" height="486"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0227-02.png" alt="image" width="1331" height="522"/>
<h6/>
</div></figure>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00016">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: Wait a minute, interfaces don’t really give you multiple inheritance, because you can’t put any implementation code in them. If all the methods are abstract, what does an interface really buy you?</strong></p>
<p><strong>A:</strong> Well, actually...there are cases where interfaces can have implementation code (static and default methods, for example), but we’re not going to go into them here.</p>
<p>The main purpose of interfaces is polymorphism, polymorphism, polymorphism. Interfaces are the ultimate in flexibility, because if you use interfaces instead of concrete classes (or even abstract classes) as arguments and return types, you can pass anything that implements that interface. And with an interface, a class doesn’t have to come from just one inheritance tree. A class can extend one class, and implement an interface. But another class might implement the same interface, yet come from a completely different inheritance tree! So you get to treat an object <em>by the role it plays</em>, rather than by the class type from which it was instantiated.</p>
<p>In fact, if you write your code using interfaces, you don’t even have to give anyone a superclass to extend. You can just give them the interface and say, “Here, I don’t care what kind of class inheritance structure you come from, just implement this interface and you’ll be good to go.”</p>
</div></aside>
<p><a data-type="indexterm" data-primary="classes" data-secondary="implementing multiple interfaces" id="idm46038393892608"/><strong>Classes from <em>different</em> inheritance trees can implement the same interface.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0228-01.png" alt="image" width="1477" height="945"/>
<h6/>
</div></figure>
<p>When you use a <em>class</em> as a polymorphic type (like an array of type Animal or a method that takes a Canine argument), the objects you can stick in that type must be from the same inheritance tree. But not just anywhere in the inheritance tree; the objects must be from a class that is a subclass of the polymorphic type. An argument of type Canine can accept a Wolf and a Dog, but not a Cat or a Hippo.</p>
<p>But when you use an <strong><em>interface</em></strong> as a polymorphic type (like an array of Pets), the objects can be from <em>anywhere</em> in the inheritance tree. The only requirement is that the objects are from a class that <em>implements</em> the interface. Allowing classes in different inheritance trees to implement a common interface is crucial in the Java API. Do you want an object to be able to save its state to a file? Implement the Serializable interface. Do you need objects to run their methods in a separate thread of execution? Implement Runnable. You get the idea. You’ll learn more about Serializable and Runnable in later chapters, but for now, remember that classes from <em>any</em> place in the inheritance tree might need to implement those interfaces. Nearly <em>any</em> class might want to be saveable or runnable.</p>
<p><strong>Better still, a class can implement <em>multiple</em> interfaces!</strong></p>
<p>A Dog object IS-A Canine, and IS-A Animal, and IS-A Object, all through inheritance. But a Dog IS-A Pet through interface implementation, and the Dog might implement other interfaces as well. You could say:</p>
<pre data-type="programlisting"><strong>public class Dog extends Animal implements</strong>
<strong>Pet, Saveable, Paintable { ... }</strong></pre>
<figure class="informal"><div class="figure">
<img src="Images/f0229-01.png" alt="image" width="733" height="703"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="abstract classes" data-secondary="conditions for using" id="idm46038393770816"/><a data-type="indexterm" data-primary="classes" data-secondary="conditions for making" id="idm46038393770176"/><a data-type="indexterm" data-primary="subclasses" data-secondary="conditions for making" id="idm46038393769312"/><strong>How do you know whether to make a class, a subclass, an <em>abstract</em> class, or an interface?</strong></p>
<ul>
<li><p>Make a class that doesn’t extend anything (other than Object) when your new class doesn’t pass the IS-A test for any other type.</p></li>
<li><p>Make a subclass (in other words, <em>extend</em> a class) only when you need to make a <em><strong>more specific</strong></em> version of a class and need to override or add new behaviors.</p></li>
<li><p>Use an abstract class when you want to define a <em><strong>template</strong></em> for a group of subclasses, and you have at least <em>some</em> implementation code that all subclasses could use. Make the class abstract when you want to guarantee that nobody can make objects of that type.</p></li>
<li><p>Use an interface when you want to define a <strong><em>role</em></strong> that other classes can play, regardless of where those classes are in the inheritance tree.</p></li>
</ul>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Invoking the superclass version of a method"><div class="sect1" id="invoking_the_superclass_version_of_a_met">
<h1>Invoking the superclass version of a method</h1>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00017">
<h5>there are no Dumb Questions</h5>
<p><a data-type="indexterm" data-primary="methods" data-secondary="superclass" id="idm46038393757824"/><a data-type="indexterm" data-primary="overriding methods" data-secondary="superclass" id="idm46038393757024"/><a data-type="indexterm" data-primary="superclass" data-secondary="invoking superclass version of method" id="idm46038393755936"/><strong>Q: What if you make a concrete subclass and you need to override a method, but you want the behavior in the superclass version of the method? In other words, what if you don’t need to <em>replace</em> the method with an override, but you just want to <em>add</em> to it with some additional specific code.</strong></p>
<p><strong>A:</strong> Ahhh...think about the meaning of the word <em>extends</em>. One area of good OO design looks at how to design concrete code that’s <em>meant</em> to be overridden. In other words, you write method code in, say, an abstract class, that does work that’s generic enough to support typical concrete implementations. But, the concrete code isn’t enough to handle <em>all</em> of the subclass-specific work. So the subclass overrides the method and <em>extends</em> it by adding the rest of the code. The keyword super lets you invoke a superclass version of an overridden method, from within the subclass.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0230-01.png" alt="image" width="826" height="733"/>
<h6/>
</div></figure>
<figure class="informal"><div class="figure">
<img src="Images/f0230-02.png" alt="image" width="1246" height="689"/>
<h6/>
</div></figure>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="bullet_points-id00008">
<h5>BULLET POINTS</h5>
<ul>
<li><p><a data-type="indexterm" data-primary="ArrayList" data-secondary="casting" id="idm46038393744096"/>When you don’t want a class to be instantiated (in other words, you don’t want anyone to make a new object of that class type), mark the class with the <code><strong>abstract</strong></code> keyword.</p></li>
<li><p>An abstract class can have both abstract and non-abstract methods.</p></li>
<li><p>If a class has even <em>one</em> abstract method, the class must be marked abstract.</p></li>
<li><p>An abstract method has no body, and the declaration ends with a semicolon (no curly braces).</p></li>
<li><p>All abstract methods must be implemented in the first concrete subclass in the inheritance tree.</p></li>
<li><p>Every class in Java is either a direct or indirect subclass of class <strong>Object</strong> (java.lang.Object).</p></li>
<li><p>Methods can be declared with Object arguments and/or return types.</p></li>
<li><p>You can call methods on an object <em>only</em> if the methods are in the class (or interface) used as the <em>reference</em> variable type, regardless of the actual <em>object</em> type. So, a reference variable of type Object can be used only to call methods defined in class Object, regardless of the type of the object to which the reference refers.</p></li>
<li><p>When a method is invoked, it will use the object type’s implementation of that method.</p></li>
<li><p>A reference variable of type Object can’t be assigned to any other reference type without a <em>cast</em>. A cast can be used to assign a reference variable of one type to a reference variable of a subtype, but at runtime the cast will fail if the object on the heap is NOT of a type compatible with the cast.</p>
<p>Example: <code><strong>Dog d = (Dog) x.getObject(aDog);</strong></code></p></li>
<li><p>All objects come out of an ArrayList&lt;Object&gt; as type Object (meaning, they can be referenced only by an Object reference variable, unless you use a <em>cast</em>).</p></li>
<li><p>Multiple inheritance is not allowed in Java, because of the problems associated with the Deadly Diamond of Death. That means you can extend only one class (i.e., you can have only one immediate superclass).</p></li>
<li><p>Create an interface using the <code><strong>interface</strong></code> keyword instead of the word <code><strong>class</strong></code>.</p></li>
<li><p>Implement an interface using the keyword <code><strong>implements</strong></code>.</p>
<p>Example: <code><strong>Dog implements Pet</strong></code></p></li>
<li><p>Your class can implement multiple interfaces.</p></li>
<li><p>A class that implements an interface <em>must</em> implement all the methods of the interface, except default and static methods (which we’ll see in <a data-type="xref" href="ch12.xhtml#lambdas_and_streams_whatcomma_not_how_la">Chapter 12</a>).</p></li>
<li><p>To invoke the superclass version of a method from a subclass that’s overridden the method, use the <code><strong>super</strong></code> keyword. Example: <code><strong>super.</strong>runReport();</code></p></li>
</ul>
</div></aside>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="there_are_no_dumb_questions-id00018">
<h5>there are no Dumb Questions</h5>
<p><strong>Q: There’s still something strange here...you never explained how it is that ArrayList&lt;Dog&gt; gives back Dog references that don’t need to be cast. What’s the special trick going on when you say ArrayList&lt;Dog&gt;?</strong></p>
<p><strong>A:</strong> You’re right for calling it a special trick. In fact, it is a special trick that ArrayList&lt;Dog&gt; gives back Dogs without you having to do any cast, since it looks like ArrayList methods don’t know anything about Dogs, or any type besides Object.</p>
<p>The short answer is that <em>the compiler puts in the cast for you!</em> When you say ArrayList&lt;Dog&gt;, there is no special class that has methods to take and return Dog objects, but instead the &lt;Dog&gt; is a signal to the compiler that you want the compiler to let you put ONLY Dog objects in and to stop you if you try to add any other type to the list. And since the compiler stops you from adding anything but Dogs to the ArrayList, the compiler also knows that it’s safe to cast anything that comes out of that ArrayList to a Dog reference. In other words, using ArrayList&lt;Dog&gt; saves you from having to cast the Dog you get back. But it’s much more important than that... because remember, a cast can fail at runtime, and wouldn’t you rather have your errors happen at compile time rather than, say, when your customer is using it for something critical?</p>
<p>But there’s a lot  more to this story, and we’ll get into all the details in <a data-type="xref" href="ch11.xhtml#data_structures_collections_and_generics">Chapter 11</a>, <em>Data Structures</em>.</p>
</div></aside>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Exercise"><div class="sect1" id="exercise-id000013">
<h1>Exercise</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0418-01.png" alt="image" width="100" height="85"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="What’s the Picture?" id="idm46038396586176"/>Here’s your chance to demonstrate your artistic abilities.  On the left you’ll find sets of class and interface declarations.  Your job is to draw the associated class diagrams on the right.  We did the first one for you. Use a dashed line for “implements” and a solid line for “extends.”</p>
<figure class="informal"><div class="figure">
<img src="Images/f0232-02.png" alt="image" width="1420" height="1478"/>
<h6/>
</div></figure>
<p><span class="inlineimage"><img src="Images/arr1.png" alt="Images" width="137" height="12"/></span> <strong>Answers in <a data-type="xref" href="#whatapostrophes_the_picture_question_mar">“What’s the Picture ?”</a>.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0418-01.png" alt="image" width="100" height="85"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="exercises" data-secondary="What’s the Declaration?" id="idm46038393708832"/>On the left you’ll find sets of class diagrams. Your job is to turn these into valid Java declarations. We did number 1 for you (and it was a tough one).</p>
<figure class="informal"><div id="id00110001" class="figure">
<img src="Images/f0233-01.png" alt="image" width="1442" height="1553"/>
<h6/>
</div></figure>
<p><span class="inlineimage"><img src="Images/arr1.png" alt="Images" width="137" height="12"/></span> <strong>Answers in <a data-type="xref" href="#whatapostrophes_the_declaration_question">“What’s the Declaration?”</a>.</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0234-01.png" alt="image" width="200" height="136"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="Pool Puzzle"><div class="sect2" id="pool_puzzle-id00004">
<h2>Pool Puzzle</h2>
<figure class="informal"><div class="figure">
<img src="Images/f0234-02.png" alt="image" width="234" height="213"/>
<h6/>
</div></figure>
<p><a data-type="indexterm" data-primary="puzzles" data-secondary="Pool Puzzle" id="idm46038393697632"/>Your <strong><em>job</em></strong> is to take code snippets from the pool and place them into the blank lines in the code and output. You <strong>may</strong> use the same snippet more than once, and you won’t need to use all the snippets. Your <strong><em>goal</em></strong> is to make a set of classes that will compile and run and produce the output listed.</p>
<figure class="informal"><div class="figure">
<img src="Images/f0234-03.png" alt="image" width="1485" height="1378"/>
<h6/>
</div></figure>
<p><span class="inlineimage"><img src="Images/arr1.png" alt="Images" width="137" height="12"/></span> <strong>Answers in <a data-type="xref" href="#pool_puzzle_left_parenthesis_from_page_2">“Pool Puzzle”</a>.</strong></p>
</div></section>
</div></section>
<section data-type="sect1" data-pdf-bookmark="Exercise Solutions"><div class="sect1" id="exercise_solutions-id000300">
<h1>Exercise Solutions</h1>
<figure class="informal"><div class="figure">
<img src="Images/f0418-01.png" alt="image" width="100" height="85"/>
<h6/>
</div></figure>
<section data-type="sect2" data-pdf-bookmark="What’s the Picture ?"><div class="sect2" id="whatapostrophes_the_picture_question_mar">
<h2>What’s the Picture ?</h2>
<p>(from <a data-type="xref" href="#exercise-id000013">“Exercise”</a>)</p>
<p/>
<figure class="informal"><div class="figure">
<img src="Images/f0235-01.png" alt="image" width="531" height="1291"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="What’s the Declaration?"><div class="sect2" id="whatapostrophes_the_declaration_question">
<h2>What’s the Declaration?</h2>
<p>(from <a data-type="xref" href="#id00110001">Figure </a>)</p>
<p><strong>2.</strong> <span style="color:#9D9EA0;">public abstract class Top { }</span></p>
<p><span style="color:#9D9EA0;">public class Tip extends Top { }</span></p>
<p><strong>3.</strong> <span style="color:#9D9EA0;">public abstract class Fee { }</span></p>
<p><span style="color:#9D9EA0;">public abstract class Fi extends Fee { }</span></p>
<p><strong>4.</strong> <span style="color:#9D9EA0;">public interface Foo { }</span></p>
<p><span style="color:#9D9EA0;">public class Bar implements Foo { }</span></p>
<p><span style="color:#9D9EA0;">public class Baz extends Bar { }</span></p>
<p><strong>5.</strong> <span style="color:#9D9EA0;">public interface Zeta { }</span></p>
<p><span style="color:#9D9EA0;">public class Alpha implements Zeta { }</span></p>
<p><span style="color:#9D9EA0;">public interface Beta { }</span></p>
<p><span style="color:#9D9EA0;">public class Delta extends Alpha implements Beta { }</span></p>
<p><strong>key</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0235-02.png" alt="image" width="369" height="297"/>
<h6/>
</div></figure>
</div></section>
<section data-type="sect2" data-pdf-bookmark="Pool Puzzle"><div class="sect2" id="pool_puzzle_left_parenthesis_from_page_2">
<h2>Pool Puzzle</h2>
<p>(from <a data-type="xref" href="#pool_puzzle-id00004">“Pool Puzzle”</a>)</p>
<figure class="informal"><div class="figure">
<img src="Images/f0236-01.png" alt="image" width="133" height="91"/>
<h6/>
</div></figure>
<pre data-type="programlisting"><strong>interface</strong> Nose {
    <strong>public int iMethod() ;</strong>
}

abstract class Picasso implements <strong>Nose</strong> {
  <strong>public int iMethod()</strong> {
    return 7;
  }
}

class <strong>Clowns extends Picasso</strong> { }

class <strong>Acts extends Picasso</strong> {
  <strong>public int iMethod()</strong> {
   return 5;
 }
}</pre>
<pre data-type="programlisting">public <strong>class Of76</strong> extends Clowns {
  public static void main(String[] args) {
    <strong>Nose[] i = new Nose [3] ;</strong>
    i[0] = new <strong>Acts() ;</strong>
    i[1] = new <strong>Clowns() ;</strong>
    i[2] = new <strong>Of76() ;</strong>
    for (int x = 0; x &lt; 3; x++) {
      System.out.println<strong>(i[x].iMethod()</strong>
             + " " + <strong>i[x].</strong>getClass());
    }
  }
}</pre>
<p><strong>Output</strong></p>
<figure class="informal"><div class="figure">
<img src="Images/f0236-03.png" alt="image" width="391" height="209"/>
<h6/>
</div></figure>
</div></section>
</div></section>
</div></section></div></body></html>