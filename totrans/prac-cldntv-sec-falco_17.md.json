["```\n$ ln -s ~ /proc/evillink\n$ ln -s ~ /bin/evillink\n$ ln -s ~ /etc/evillink\n```", "```\n$ sysdig -w evillinks.scap\n```", "```\n$ sysdig -r evillinks.scap\n```", "```\n$ sysdig -w evillinks.scap proc.name=ln\n```", "```\n$ sysdig -r evillinks.scap\n```", "```\n2313 11:21:22.782601383 1 ln (23859) > symlinkat \n2314 11:21:22.782662611 1 ln (23859) < symlinkat res=0 target=/home/foo \nlinkdirfd=-100(AT_FDCWD) linkpath=/etc/evillink\n```", "```\n(evt.type=symlink or evt.type=symlinkat) and (\n  evt.arg.linkpath startswith /proc/ or \n  evt.arg.linkpath startswith /bin/ or \n  evt.arg.linkpath startswith /etc/\n)\n```", "```\n$ sysdig -r evillinks.scap \\\n  \"(evt.type=symlink or evt.type=symlinkat) and \\\n   (evt.arg.linkpath startswith /proc/ or \\\n   evt.arg.linkpath startswith /bin/ or \\\n   evt.arg.linkpath startswith /etc/)\"\n438 11:21:13.204948767 2 ln (23814) < symlinkat res=-2(ENOENT) target=/home/foo \nlinkdirfd=-100(AT_FDCWD) linkpath=/proc/evillink \n1679 11:21:19.420360948 0 ln (23850) < symlinkat res=0 target=/home/foo \nlinkdirfd=-100(AT_FDCWD) linkpath=/bin/evillink \n2314 11:21:22.782662611 1 ln (23859) < symlinkat res=0 target=/home/foo \nlinkdirfd=-100(AT_FDCWD) linkpath=/etc/evillink\n```", "```\na symlink was created in a sensitive directory (link=%evt.arg.linkpath, \ntarget=%evt.arg.target, cmd=%proc.cmdline)\n```", "```\n$ sysdig -r evillinks.scap \\\n  -p\"a symlink was created in a sensitive directory \\\n  (link=%evt.arg.linkpath, target=%evt.arg.target, cmd=%proc.cmdline)\" \\\n  \"(evt.type=symlink or evt.type=symlinkat) and \\\n  (evt.arg.linkpath startswith /proc/ or \\\n  evt.arg.linkpath startswith /bin/ or \\\n  evt.arg.linkpath startswith /etc/)\"\na symlink was created in a sensitive directory (link=/proc/evillink, \ntarget=/home/foo, cmd=ln -s /home/foo /proc/evillink)\na symlink was created in a sensitive directory (link=/bin/evillink, \ntarget=/home/foo, cmd=ln -s /home/foo /bin/evillink)\na symlink was created in a sensitive directory (link=/etc/evillink, \ntarget=/home/foo, cmd=ln -s /home/foo /etc/evillink)\n```", "```\n- rule: Symlink in a Sensitive Directory\n  desc: >\n    Detect the creation of a symbolic link \n    in a sensitive directory like /etc or /bin.\n  condition: > \n    (evt.type=symlink or evt.type=symlinkat) and (\n      evt.arg.linkpath startswith /proc/ or \n      evt.arg.linkpath startswith /bin/ or \n      evt.arg.linkpath startswith /etc/)\n  output: >\n    a symlink was created in a sensitive directory \n    (link=%evt.arg.linkpath, target=%evt.arg.target, cmd=%proc.cmdline)\n  priority: WARNING\n```", "```\n$ falco -r symlink.yaml -e evillinks.scap\n2022-02-05T01:09:23+0000: Falco version 0.31.0 (driver version \n319368f1ad778691164d33d59945e00c5752cd27)\n2022-02-05T01:09:23+0000: Falco initialized with configuration file \n/etc/falco/falco.yaml\n2022-02-05T01:09:23+0000: Loading rules from file symlink.yaml:\n2022-02-05T01:09:23+0000: Reading system call events from file: evillinks.scap\n2022-02-04T19:21:13.204948767+0000: Warning a symlink was created in a \nsensitive directory (link=/proc/evillink, target=/home/foo, cmd=ln -s /home/foo \n/proc/evillink)\n2022-02-04T19:21:19.420360948+0000: Warning a symlink was created in a \nsensitive directory (link=/bin/evillink, target=/home/foo, cmd=ln -s /home/foo \n/bin/evillink)\n2022-02-04T19:21:22.782662611+0000: Warning a symlink was created in a \nsensitive directory (link=/etc/evillink, target=/home/foo, cmd=ln -s /home/foo \n/etc/evillink)\nEvents detected: 3\nRule counts by severity:\n   WARNING: 3\nTriggered rules by rule name:\n   Symlink in a Sensitive Directory: 3\nSyscall event drop monitoring:\n   - event drop detected: 0 occurrences\n   - num times actions taken: 0\n```", "```\n- macro: sensitive_sylink_dir\n  condition: >\n    (evt.arg.linkpath startswith /proc/ or \n     evt.arg.linkpath startswith /bin/ or \n     evt.arg.linkpath startswith /etc/)\n\n- macro: create_symlink\n  condition: (evt.type=symlink or evt.type=symlinkat)\n\n- rule: Symlink in a Sensitive Directory\n  desc: > \n    Detect the creation of a symbolic link\n    in a sensitive directory like /etc or /bin.\n  condition:  create_symlink and sensitive_sylink_dir\n  output: >\n    a symlink was created in a sensitive directory \n    (link=%evt.arg.linkpath, target=%evt.arg.target, cmd=%proc.cmdline)\n  priority: WARNING\n```", "```\n- list: symlink_syscalls\n  items: [symlink, symlinkat]\n- list: sensitive_dirs\n  items: [/proc/, /bin/, /etc/]\n\n- macro: create_symlink\n  condition: (evt.type in (symlink_syscalls))\n- macro: sensitive_sylink_dir\n  condition: (evt.arg.linkpath pmatch (sensitive_dirs))\n\n- rule: Symlink in a Sensitive Directory\n  desc: >\n    Detect the creation of a symbolic link \n    in a sensitive directory like /etc or /bin.\n  condition:  create_symlink and sensitive_sylink_dir\n  output: >\n    a symlink was created in a sensitive directory\n    (link=%evt.arg.linkpath, target=%evt.arg.target, cmd=%proc.cmdline)\n  priority: WARNING\n```", "```\n- rule: Write below rpm database\n  desc: an attempt to write to the rpm database by any non-rpm related program\n  condition: >\n    fd.name startswith /var/lib/rpm and open_write\n    and not rpm_procs\n    and not ansible_running_python\n    and not python_running_chef\n    and not exe_running_docker_save\n    and not amazon_linux_running_python_yum\n    and not user_known_write_rpm_database_activities\n  output: >\n    Rpm database opened for writing by a non-rpm program \n    (command=%proc.cmdline file=%fd.name \n    parent=%proc.pname pcmdline=%proc.pcmdline\n    container_id=%container.id image=%container.image.repository)\n  priority: ERROR\n  tags: [filesystem, software_mgmt, mitre_persistence]\n```", "```\nproc.name=p1\n```", "```\nproc.name=p1 or proc.name=p2 or proc.name=p3 or proc.name=p4 or proc.name=p5\n```"]