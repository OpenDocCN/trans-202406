<!DOCTYPE html>
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.w3.org/2002/06/xhtml2/ http://www.w3.org/MarkUp/SCHEMA/xhtml2.xsd" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<link href="Styles/Style00.css" rel="stylesheet" type="text/css" />
<link href="Styles/Style01.css" rel="stylesheet" type="text/css" />

<style type="text/css">body{margin:1em;background-color:transparent!important;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}</style></head>
<body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 5. JSX"><div class="chapter" id="ch5">
<h1><span class="label">Chapter 5. </span>JSX</h1>


<p>You’ve already seen JSX in action in the previous chapters. You <a data-type="indexterm" data-primary="JSX (JavaScript XML)" id="ch5_term2"/><a data-type="indexterm" data-primary="JavaScript" data-secondary="JSX and" id="idm45779439939584"/><a data-type="indexterm" data-primary="XML" id="idm45779439938736"/>know it’s all about writing JavaScript expressions containing XML that looks very much like HTML. For example:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">const</code> <code class="nx">hi</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code><code class="nx">Hello</code><code class="o">&lt;/</code><code class="nx">h1</code><code class="o">&gt;;</code></pre>

<p>And you <a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="curly braces, use of" id="idm45779439932112"/><a data-type="indexterm" data-primary="{} (curly braces)" id="idm45779439931264"/><a data-type="indexterm" data-primary="curly braces ({})" id="idm45779439930592"/>know you can always “interrupt the flow” of XML by including more JavaScript expressions wrapped in curly braces:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">const</code> <code class="nx">planet</code> <code class="o">=</code> <code class="s1">'Earth'</code><code class="o">;</code>
<code class="kd">const</code> <code class="nx">hi</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code><code class="nx">Hello</code> <code class="nx">people</code> <code class="nx">of</code> <code class="o">&lt;</code><code class="nx">em</code><code class="o">&gt;</code><code class="p">{</code><code class="nx">planet</code><code class="p">}</code><code class="o">&lt;/</code><code class="nx">em</code><code class="o">&gt;!&lt;/</code><code class="nx">h1</code><code class="o">&gt;;</code></pre>

<p>That’s true even if the expressions happen to be conditions, loops, or more JSX:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">const</code> <code class="nx">rock</code> <code class="o">=</code> <code class="mi">3</code><code class="o">;</code>
<code class="kd">const</code> <code class="nx">planet</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">em</code><code class="o">&gt;</code><code class="p">{</code><code class="nx">rock</code> <code class="o">===</code> <code class="mi">3</code> <code class="o">?</code> <code class="s1">'Earth'</code> <code class="o">:</code> <code class="s1">'Some other place'</code><code class="p">}</code><code class="o">&lt;/</code><code class="nx">em</code><code class="o">&gt;;</code>
<code class="kd">const</code> <code class="nx">hi</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code><code class="nx">Hello</code> <code class="nx">people</code> <code class="nx">of</code> <code class="p">{</code><code class="nx">planet</code><code class="p">}</code><code class="o">!&lt;/</code><code class="nx">h1</code><code class="o">&gt;;</code></pre>

<p>In this chapter, you’ll to learn more about JSX and explore some features that may surprise and/or delight you.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>To see the examples above in action, load <em>05.01.hellojsx.html</em> from the book’s repo. The file is also an illustration of how you can have several React applications on the same page.</p>
</div>






<section data-type="sect1" data-pdf-bookmark="A Couple Tools"><div class="sect1" id="idm45779439782496">
<h1>A Couple Tools</h1>

<p>To experiment and <a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="learning tools for" id="ch5_term1"/>get familiar with the JSX transforms, you can <a data-type="indexterm" data-primary="Babel" id="idm45779439779392"/>play with the <span class="keep-together">live editor</span> at <a class="orm:hideurl" href="https://babeljs.io/repl"><em>https://babeljs.io/repl</em></a> (shown in <a data-type="xref" href="#FIG0501">Figure 5-1</a>). Make sure you check the <span class="keep-together">“Prettify”</span> option for better readability of the result.</p>

<figure><div id="FIG0501" class="figure">
<img src="Images/rur2_0501.png" alt="rur2 0501" width="600" height="239"/>
<h6><span class="label">Figure 5-1. </span>Babel as a live JSX transformation tool</h6>
</div></figure>

<p>As you can see in <a data-type="xref" href="#FIG0502">Figure 5-2</a>, the JSX transform is lightweight and simple: the JSX <a data-type="indexterm" data-primary="Hello World app" id="idm45779439771984"/><a data-type="indexterm" data-primary="React.createElement() function" id="idm45779439771312"/>source of “Hello world!” from <a data-type="xref" href="ch01.xhtml#ch1">Chapter 1</a> becomes a series of calls to <code>React​.crea⁠teElement()</code>, using the function syntax React works with. It’s just JavaScript, so it’s easy to read and understand.</p>

<figure><div id="FIG0502" class="figure">
<img src="Images/rur2_0502.png" alt="rur2 0502" width="600" height="242"/>
<h6><span class="label">Figure 5-2. </span>“Hello World” transformed</h6>
</div></figure>

<p>Another online <a data-type="indexterm" data-primary="HTML" data-secondary="HTML-to-JSX compiler" id="idm45779439766640"/>tool you may find helpful when learning JSX or transitioning an existing app’s markup from HTML is the <a href="https://magic.reactjs.net/htmltojsx.htm">HTML-to-JSX compiler</a> (shown in <a data-type="xref" href="#FIG0503">Figure 5-3</a>).</p>

<figure><div id="FIG0503" class="figure">
<img src="Images/rur2_0503.png" alt="rur2 0503" width="600" height="207"/>
<h6><span class="label">Figure 5-3. </span>HTML-to-JSX tool</h6>
</div></figure>

<p>Now, on to some of the <a data-type="indexterm" data-startref="ch5_term1" id="idm45779439761376"/>particularities of JSX.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Whitespace in JSX"><div class="sect1" id="idm45779439760384">
<h1>Whitespace in JSX</h1>

<p>Whitespace in <a data-type="indexterm" data-primary="HTML" data-secondary="whitespace and" id="idm45779439758720"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="whitespace in" id="ch5_term3"/><a data-type="indexterm" data-primary="whitespace in JSX" id="ch5_term4"/>JSX is similar to HTML but not identical. For example, if you have this JSX:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">Example1</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="mi">1</code><code class="p">}</code> <code class="nx">plus</code> <code class="p">{</code><code class="mi">2</code><code class="p">}</code> <code class="nx">is</code>   <code class="p">{</code><code class="mi">3</code><code class="p">}</code>
    <code class="o">&lt;/</code><code class="nx">h1</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>

<p>When React <a data-type="indexterm" data-primary="rendering" data-secondary="of whitespace" data-secondary-sortas="whitespace" id="ch5_term5"/>renders it in the browser (you can inspect the resulting HTML in the browser’s dev tools), the generated HTML looks like this:</p>

<pre data-type="programlisting" data-code-language="html"><code class="nt">&lt;h1&gt;</code>1 plus 2 is   3<code class="nt">&lt;/h1&gt;</code></pre>

<p>This is effectively an <code>h1</code> DOM node with five children, which are text element nodes with content: “1”, “plus”, “2”, “is” and “3”, which renders as “1 plus 2 is 3.” Exactly as you’d expect in HTML, multiple spaces become one when rendered in the browser, as depicted in <a data-type="xref" href="#FIG0504">Figure 5-4</a>.</p>

<figure><div id="FIG0504" class="figure">
<img src="Images/rur2_0504.png" alt="rur2 0504" width="600" height="396"/>
<h6><span class="label">Figure 5-4. </span>Rendering whitespace (see <em>05.02.whitespace.html</em> in the repo)</h6>
</div></figure>

<p>However, in this next example:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">Example2</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="mi">1</code><code class="p">}</code>
      <code class="nx">plus</code>
      <code class="p">{</code><code class="mi">2</code><code class="p">}</code>
      <code class="nx">is</code>
      <code class="p">{</code><code class="mi">3</code><code class="p">}</code>
    <code class="o">&lt;/</code><code class="nx">h1</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>

<p>…you end up with:</p>

<pre data-type="programlisting" data-code-language="html"><code class="nt">&lt;h1&gt;</code>
  1plus2is3
<code class="nt">&lt;/h1&gt;</code></pre>

<p>As you can see, all the whitespace is trimmed, so the end result displayed in the browser is “1plus2is3.” You can always add space where you need it with <code>{' '}</code> or turn the literal strings into expressions and add the space there. In other words, any of these work:</p>

<pre data-type="programlisting" data-code-language="actionscript" class="pagebreak-before"><code class="kd">function</code> <code class="nx">Example3</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="cm">/* space expressions */</code><code class="p">}</code>
      <code class="p">{</code><code class="mi">1</code><code class="p">}</code>
      <code class="p">{</code><code class="s1">' '</code><code class="p">}</code><code class="nx">plus</code><code class="p">{</code><code class="s1">' '</code><code class="p">}</code>
      <code class="p">{</code><code class="mi">2</code><code class="p">}</code>
      <code class="p">{</code><code class="s1">' '</code><code class="p">}</code><code class="nx">is</code><code class="p">{</code><code class="s1">' '</code><code class="p">}</code>
      <code class="p">{</code><code class="mi">3</code><code class="p">}</code>
    <code class="o">&lt;/</code><code class="nx">h1</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">Example4</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="cm">/* space glued to string expressions */</code><code class="p">}</code>
      <code class="p">{</code><code class="mi">1</code><code class="p">}</code>
      <code class="p">{</code><code class="s1">' plus '</code><code class="p">}</code>
      <code class="p">{</code><code class="mi">2</code><code class="p">}</code>
      <code class="p">{</code><code class="s1">' is '</code><code class="p">}</code>
      <code class="p">{</code><code class="mi">3</code><code class="p">}</code>
    <code class="o">&lt;/</code><code class="nx">h1</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Comments in JSX"><div class="sect1" id="idm45779439759792">
<h1>Comments in JSX</h1>

<p>In the preceding <a data-type="indexterm" data-startref="ch5_term3" id="idm45779439506448"/><a data-type="indexterm" data-startref="ch5_term4" id="idm45779439505712"/><a data-type="indexterm" data-startref="ch5_term5" id="idm45779439505040"/><a data-type="indexterm" data-primary="comments in JSX" id="idm45779439504368"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="comments in" id="idm45779439469248"/>examples, you see how a new concept sneaked in—adding comments to JSX markup.</p>

<p>Because the expressions wrapped in <code>{}</code> are just JavaScript, you can easily add multiline comments using <code>/* comment */</code>. You can also add single-line comments using <span class="keep-together"><code>// comment</code></span>, but you have to make sure the closing <code>}</code> of the expression is on a separate line so it’s not considered part of the comment:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="o">&lt;</code><code class="nx">h1</code><code class="o">&gt;</code>
  <code class="p">{</code><code class="cm">/* multiline comment */</code><code class="p">}</code>
  <code class="p">{</code><code class="cm">/*</code>
<code class="cm">    multi</code>
<code class="cm">    line</code>
<code class="cm">    comment</code>
<code class="cm">    */</code><code class="p">}</code>
  <code class="p">{</code>
    <code class="c1">// single line</code>
  <code class="p">}</code>
  <code class="nx">Hello</code><code class="o">!</code>
<code class="o">&lt;/</code><code class="nx">h1</code><code class="o">&gt;</code></pre>

<p>Because <code>{// comment}</code> is not working (the <code>}</code> is now commented out), there’s little benefit to using single-line comments. You can keep your comments consistent and stick to multiline comments in all cases.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="HTML Entities"><div class="sect1" id="idm45779439446544">
<h1>HTML Entities</h1>

<p>You can use <a data-type="indexterm" data-primary="HTML" data-secondary="entities, JSX use of" id="ch5_term6"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="HTML entities in" id="ch5_term7"/>HTML entities in JSX like so:</p>

<pre data-type="programlisting" data-code-language="xml"><code class="nt">&lt;h2&gt;</code>
  More info <code class="ni">&amp;raquo;</code>
<code class="nt">&lt;/h2&gt;</code></pre>

<p>This example produces a “double right angle quote,” as shown in <a data-type="xref" href="#FIG0505">Figure 5-5</a>.</p>

<figure><div id="FIG0505" class="figure">
<img src="Images/rur2_0505.png" alt="rur2 0505" width="284" height="92"/>
<h6><span class="label">Figure 5-5. </span>HTML entity in JSX</h6>
</div></figure>

<p>However, if you <a data-type="indexterm" data-primary="double-encoding with HTML entities" id="idm45779439386176"/>use the entity as part of an expression, you will run into double-encoding issues. In this example, the HTML gets encoded:</p>

<pre data-type="programlisting" data-code-language="xml"><code class="nt">&lt;h2&gt;</code>
  {"More info <code class="ni">&amp;raquo;</code>"}
<code class="nt">&lt;/h2&gt;</code></pre>

<p>You can see the result in <a data-type="xref" href="#FIG0506">Figure 5-6</a>.</p>

<figure><div id="FIG0506" class="figure">
<img src="Images/rur2_0506.png" alt="rur2 0506" width="422" height="84"/>
<h6><span class="label">Figure 5-6. </span>Double-encoded HTML entity</h6>
</div></figure>

<p>To prevent the double-encoding, you <a data-type="indexterm" data-primary="Unicode versions of HTML entities" id="idm45779439349600"/>can use the Unicode version of the HTML entity, which in this case is <code>\u00bb</code> (see <a href="https://dev.w3.org/html5/html-author/charref"><em class="hyperlink">https://dev.w3.org/html5/html-author/charref</em></a>):</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="o">&lt;</code><code class="nx">h2</code><code class="o">&gt;</code>
  <code class="p">{</code><code class="s2">"More info \u00bb"</code><code class="p">}</code>
<code class="o">&lt;/</code><code class="nx">h2</code><code class="o">&gt;</code></pre>

<p>For convenience, you can <a data-type="indexterm" data-primary="constants, HTML entities as" id="idm45779439359632"/>define a constant somewhere at the top of your module together with any common spacing. For example:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">const</code> <code class="nx">RAQUO</code> <code class="o">=</code> <code class="s1">' \u00bb'</code><code class="o">;</code></pre>

<p class="pagebreak-before">Then use the constant anywhere you need, for example:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="o">&lt;</code><code class="nx">h2</code><code class="o">&gt;</code>
  <code class="p">{</code><code class="s2">"More info"</code> <code class="o">+</code> <code class="nx">RAQUO</code><code class="p">}</code>
<code class="o">&lt;/</code><code class="nx">h2</code><code class="o">&gt;</code>
<code class="o">&lt;</code><code class="nx">h2</code><code class="o">&gt;</code>
  <code class="p">{</code><code class="s2">"More info"</code><code class="p">}{</code><code class="nx">RAQUO</code><code class="p">}</code>
<code class="o">&lt;/</code><code class="nx">h2</code><code class="o">&gt;</code></pre>








<section data-type="sect2" data-pdf-bookmark="Anti-XSS"><div class="sect2" id="idm45779439288384">
<h2>Anti-XSS</h2>

<p>You may be wondering <a data-type="indexterm" data-primary="cross-site scripting (XSS)" id="idm45779439265232"/><a data-type="indexterm" data-primary="XSS (cross-site scripting)" id="idm45779439264528"/>why you have to jump through hoops to use HTML entities. There’s a good reason that outweighs the drawbacks: you need to fight cross-site scripting (XSS).</p>

<p>React escapes <a data-type="indexterm" data-primary="React" data-secondary="safeguards against impurities" id="idm45779439263152"/><a data-type="indexterm" data-primary="malicious input, protection from" id="idm45779439262128"/><a data-type="indexterm" data-primary="inputs" data-secondary="protection from malicious" id="idm45779439261440"/>all strings to prevent a class of XSS attacks. So when you ask the user to give you some input and they provide a malicious string, React protects you. Take this user input, for example:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">const</code> <code class="nx">firstname</code> <code class="o">=</code>
  <code class="s1">'John&lt;scr'</code><code class="o">+</code><code class="s1">'ipt src="https://evil/co.js"&gt;&lt;/scr'</code><code class="o">+</code><code class="s1">'ipt&gt;'</code><code class="o">;</code></pre>

<p>Under some circumstances, you may end up writing this into the DOM. For example:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="nx">document</code><code class="p">.</code><code class="nx">write</code><code class="p">(</code><code class="nx">firstname</code><code class="p">);</code></pre>

<p>This is a disaster, because the page reads “John,” but the <code>&lt;script&gt;</code> tag loads a potentially malicious JavaScript from a third-party web site, likely owned by a criminal. This compromises your app and, in turn, the users that trust you.</p>

<p>React protects you in cases like this out of the box. React escapes the content of <code>firstname</code> when you do the following (as shown in <a data-type="xref" href="#FIG0507">Figure 5-7</a>):</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">Example</code><code class="p">()</code> <code class="p">{</code>
  <code class="kd">const</code> <code class="nx">firstname</code> <code class="o">=</code>
    <code class="s1">'John&lt;scr'</code> <code class="o">+</code> <code class="s1">'ipt src="https://evil/co.js"&gt;&lt;/scr'</code> <code class="o">+</code> <code class="s1">'ipt&gt;'</code><code class="o">;</code>
  <code class="k">return</code> <code class="o">&lt;</code><code class="nx">h2</code><code class="o">&gt;</code><code class="nx">Hello</code> <code class="p">{</code><code class="nx">firstname</code><code class="p">}</code><code class="o">!&lt;/</code><code class="nx">h2</code><code class="o">&gt;;</code>
<code class="p">}</code></pre>

<figure><div id="FIG0507" class="figure">
<img src="Images/rur2_0507.png" alt="rur2 0507" width="600" height="40"/>
<h6><span class="label">Figure 5-7. </span>Escaping strings (see <em>05.05.antixss.html</em> in the repo)</h6>
</div></figure>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Spread Attributes"><div class="sect1" id="idm45779439446080">
<h1>Spread Attributes</h1>

<p>JSX borrows <a data-type="indexterm" data-startref="ch5_term6" id="idm45779439153648"/><a data-type="indexterm" data-startref="ch5_term7" id="idm45779439152912"/><a data-type="indexterm" data-primary="ECMAScript" data-secondary="spread operator in" id="idm45779439152240"/><a data-type="indexterm" data-primary="attributes, spread" id="ch5_term8"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="spread attributes in" id="ch5_term9"/><a data-type="indexterm" data-primary="spread operator/attributes" id="ch5_term10"/><a data-type="indexterm" data-primary="properties (props)" data-secondary="defining" id="ch5_term11"/>a feature from ECMAScript called the <em>spread operator</em> and adopts it as a convenience when defining properties.</p>

<p>Imagine you have a collection of attributes you want to pass to an <code>&lt;a&gt;</code> component:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">const</code> <code class="nx">attr</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">href</code><code class="o">:</code> <code class="s1">'https://example.org'</code><code class="o">,</code>
  <code class="nx">target</code><code class="o">:</code> <code class="s1">'_blank'</code><code class="o">,</code>
<code class="p">};</code></pre>

<p>You can always do it like so:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="k">return</code> <code class="p">(</code>
  <code class="o">&lt;</code><code class="nx">a</code>
    <code class="nx">href</code><code class="o">=</code><code class="p">{</code><code class="nx">attr</code><code class="p">.</code><code class="nx">href</code><code class="p">}</code>
    <code class="nx">target</code><code class="o">=</code><code class="p">{</code><code class="nx">attr</code><code class="p">.</code><code class="nx">target</code><code class="p">}</code><code class="o">&gt;</code>
    <code class="nx">Hello</code>
  <code class="o">&lt;/</code><code class="nx">a</code><code class="o">&gt;</code>
<code class="p">);</code></pre>

<p>But this feels like a lot of boilerplate code. By using spread attributes, you can accomplish this in just one line:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="k">return</code> <code class="o">&lt;</code><code class="nx">a</code> <code class="p">{...</code><code class="nx">attr</code><code class="p">}</code><code class="o">&gt;</code><code class="nx">Hello</code><code class="o">&lt;/</code><code class="nx">a</code><code class="o">&gt;;</code></pre>

<p>In the example above (see <em>05.06.spread.html</em> in the repo), you have an object of attributes you want to define ahead of time, maybe some of them conditionally. Another common use for spread attributes is when you get this object of attributes from the outside—often from a parent component. Let’s see how that case plays out.</p>








<section data-type="sect2" data-pdf-bookmark="Parent-to-Child Spread Attributes"><div class="sect2" id="idm45779439055760">
<h2>Parent-to-Child Spread Attributes</h2>

<p>Imagine you’re <a data-type="indexterm" data-primary="child-parent data communication" id="ch5_term12"/><a data-type="indexterm" data-primary="parent-child data communication" id="ch5_term13"/><a data-type="indexterm" data-primary="parent-to-child spread attributes" id="ch5_term14"/><a data-type="indexterm" data-primary="FancyLink component example" id="ch5_term15"/>building a <code>FancyLink</code> component that uses a regular <code>&lt;a&gt;</code> behind the scenes. You want your component to accept all the attributes that <code>&lt;a&gt;</code> does (<code>href</code>, <code>target</code>, <code>rel</code>, etc.) plus some more that are not part of HTML proper (say, <code>variant</code>). People can use your component like so:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="o">&lt;</code><code class="nx">FancyLink</code>
  <code class="nx">href</code><code class="o">=</code><code class="s2">"https://example.org"</code>
  <code class="nx">rel</code><code class="o">=</code><code class="s2">"canonical"</code>
  <code class="nx">target</code><code class="o">=</code><code class="s2">"_blank"</code>
  <code class="nx">variant</code><code class="o">=</code><code class="s2">"small"</code><code class="o">&gt;</code>
  <code class="nx">Follow</code> <code class="nx">me</code>
<code class="o">&lt;/</code><code class="nx">FancyLink</code><code class="o">&gt;</code></pre>

<p>How can your component take advantage of spread attributes and avoid redefining all the properties of <code>&lt;a&gt;</code>?</p>

<p>Here’s one approach where your app may allow only 3 sizes for links and you let the users of the component specify the desired size via the custom <code>variant</code> property. You do the sizing magic with the help of a <code>switch</code> statement and CSS classes. Then you pass all of the other properties to <code>&lt;a&gt;</code>:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">FancyLink</code><code class="p">(</code><code class="nx">props</code><code class="p">)</code> <code class="p">{</code>
  <code class="kd">const</code> <code class="nx">classes</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'link-core'</code><code class="p">];</code>
  <code class="k">switch</code> <code class="p">(</code><code class="nx">props</code><code class="p">.</code><code class="nx">variant</code><code class="p">)</code> <code class="p">{</code>
    <code class="k">case</code> <code class="s1">'small'</code><code class="o">:</code>
      <code class="nx">classes</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="s1">'link-small'</code><code class="p">);</code>
      <code class="k">break</code><code class="o">;</code>
    <code class="k">case</code> <code class="s1">'huge'</code><code class="o">:</code>
      <code class="nx">classes</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="s1">'link-huge'</code><code class="p">);</code>
      <code class="k">break</code><code class="o">;</code>
    <code class="k">default</code><code class="o">:</code>
      <code class="nx">classes</code><code class="p">.</code><code class="nx">push</code><code class="p">(</code><code class="s1">'link-default'</code><code class="p">);</code>
  <code class="p">}</code>

  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">a</code> <code class="p">{...</code><code class="nx">props</code><code class="p">}</code> <code class="nx">className</code><code class="o">=</code><code class="p">{</code><code class="nx">classes</code><code class="p">.</code><code class="nx">join</code><code class="p">(</code><code class="s1">' '</code><code class="p">)}</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="nx">props</code><code class="p">.</code><code class="nx">children</code><code class="p">}</code>
    <code class="o">&lt;/</code><code class="nx">a</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Did you <a data-type="indexterm" data-primary="props.children" id="idm45779438966400"/>notice the use of <code>props.children</code>? This is a convenient way of allowing any number of children to be passed over to your component, which you can access when composing your UI. In the case of the <code>FancyLink</code> component, the following is perfectly valid:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="o">&lt;</code><code class="nx">FancyLink</code><code class="o">&gt;</code>
  <code class="o">&lt;</code><code class="nx">span</code><code class="o">&gt;</code><code class="nx">Follow</code> <code class="nx">me</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
<code class="o">&lt;/</code><code class="nx">FancyLink</code><code class="o">&gt;</code></pre>
</div>

<p>In the preceding snippet, you do your custom work based on the value of the <code>variant</code> property, then simply carry over all the properties to <code>&lt;a&gt;</code>. This includes the <code>variant</code> property, which will appear in the resulting DOM, although the browser has no use for it.</p>

<p>You can do a <a data-type="indexterm" data-primary="cloning" data-secondary="of props" data-secondary-sortas="props" id="idm45779438810256"/><a data-type="indexterm" data-primary="copying data" id="idm45779438808976"/>little better and not pass around unnecessary properties by cloning the props passed to you and removing the ones the browser will ignore anyway. Something like:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">FancyLink</code><code class="p">(</code><code class="nx">props</code><code class="p">)</code> <code class="p">{</code>
  <code class="kd">const</code> <code class="nx">classes</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'link-core'</code><code class="p">];</code>
  <code class="k">switch</code> <code class="p">(</code><code class="nx">props</code><code class="p">.</code><code class="nx">variant</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// same as before...</code>
  <code class="p">}</code>

  <code class="kd">const</code> <code class="nx">attribs</code> <code class="o">=</code> <code class="nb">Object</code><code class="p">.</code><code class="nx">assign</code><code class="p">({}</code><code class="o">,</code> <code class="nx">props</code><code class="p">);</code> <code class="c1">// shallow clone</code>
  <code class="nx">delete</code> <code class="nx">attribs</code><code class="p">.</code><code class="nx">variant</code><code class="o">;</code>

  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">a</code> <code class="p">{...</code><code class="nx">attribs</code><code class="p">}</code> <code class="nx">className</code><code class="o">=</code><code class="p">{</code><code class="nx">classes</code><code class="p">.</code><code class="nx">join</code><code class="p">(</code><code class="s1">' '</code><code class="p">)}</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="nx">props</code><code class="p">.</code><code class="nx">children</code><code class="p">}</code>
    <code class="o">&lt;/</code><code class="nx">a</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>

<p>Another way to do the <a data-type="indexterm" data-primary="JavaScript" data-secondary="shallow cloning in" id="idm45779438803968"/><a data-type="indexterm" data-primary="shallow cloning" id="idm45779438803120"/>shallow cloning is to use the JavaScript spread operator:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">attribs</code> <code class="o">=</code> <code class="p">{...</code><code class="nx">props</code><code class="p">};</code></pre>

<p>Additionally, you can clone only the props you’ll pass to the browser and at the same time assign the other ones to local variables (thus removing the need to delete them afterward), all in a single line:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="p">{</code><code class="nx">variant</code><code class="p">,</code> <code class="p">...</code><code class="nx">attribs</code><code class="p">}</code> <code class="o">=</code> <code class="nx">props</code><code class="p">;</code></pre>

<p>So the end result for the <code>FancyLink</code> could look <a data-type="indexterm" data-startref="ch5_term8" id="idm45779438669264"/><a data-type="indexterm" data-startref="ch5_term9" id="idm45779438668656"/><a data-type="indexterm" data-startref="ch5_term10" id="idm45779438636752"/><a data-type="indexterm" data-startref="ch5_term11" id="idm45779438636080"/><a data-type="indexterm" data-startref="ch5_term12" id="idm45779438635408"/><a data-type="indexterm" data-startref="ch5_term13" id="idm45779438634736"/><a data-type="indexterm" data-startref="ch5_term14" id="idm45779438634064"/><a data-type="indexterm" data-startref="ch5_term15" id="idm45779438633392"/>like so (see <em>05.07.fancylink.html</em> in the repo):</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">FancyLink</code><code class="p">(</code><code class="nx">props</code><code class="p">)</code> <code class="p">{</code>
  <code class="kd">const</code> <code class="p">{</code><code class="nx">variant</code><code class="o">,</code> <code class="p">...</code><code class="nx">attribs</code><code class="p">}</code> <code class="o">=</code> <code class="nx">props</code><code class="o">;</code>
  <code class="kd">const</code> <code class="nx">classes</code> <code class="o">=</code> <code class="p">[</code><code class="s1">'link-core'</code><code class="p">];</code>
  <code class="k">switch</code> <code class="p">(</code><code class="nx">variant</code><code class="p">)</code> <code class="p">{</code>
    <code class="c1">// same as before...</code>
  <code class="p">}</code>

  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">a</code> <code class="p">{...</code><code class="nx">attribs</code><code class="p">}</code> <code class="nx">className</code><code class="o">=</code><code class="p">{</code><code class="nx">classes</code><code class="p">.</code><code class="nx">join</code><code class="p">(</code><code class="s1">' '</code><code class="p">)}</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="nx">props</code><code class="p">.</code><code class="nx">children</code><code class="p">}</code>
    <code class="o">&lt;/</code><code class="nx">a</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Returning Multiple Nodes in JSX"><div class="sect1" id="idm45779439154976">
<h1>Returning Multiple Nodes in JSX</h1>

<p>You always <a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="returning multiple nodes in" id="ch5_term16"/><a data-type="indexterm" data-primary="nodes in JSX, returning multiple" id="ch5_term17"/>have to return a single node (or an array) from your render function. Returning two nodes is not allowed. In other words, this is an error:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="c1">// Syntax error:</code>
<code class="c1">//   Adjacent JSX elements must be wrapped in an enclosing tag</code>
<code class="kd">function</code> <code class="nx">InvalidExample</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">span</code><code class="o">&gt;</code>
      <code class="nx">Hello</code>
    <code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
    <code class="o">&lt;</code><code class="nx">span</code><code class="o">&gt;</code>
      <code class="nx">World</code>
    <code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>








<section data-type="sect2" data-pdf-bookmark="A Wrapper"><div class="sect2" id="idm45779438518928">
<h2>A Wrapper</h2>

<p>The fix is <a data-type="indexterm" data-primary="wrappers" id="idm45779438499168"/>trivial—just wrap all the nodes in another component such as a <code>&lt;div&gt;</code> (and add a space between the “Hello” and “World” while you’re at it):</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">Example</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">div</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">span</code><code class="o">&gt;</code><code class="nx">Hello</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="s1">' '</code><code class="p">}</code>
      <code class="o">&lt;</code><code class="nx">span</code><code class="o">&gt;</code><code class="nx">World</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
    <code class="o">&lt;/</code><code class="nx">div</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="A Fragment"><div class="sect2" id="idm45779438460736">
<h2>A Fragment</h2>

<p>To remove the need for an extra wrapper element, newer <a data-type="indexterm" data-primary="fragments, wrappers as" id="idm45779438442544"/><a data-type="indexterm" data-primary="React.Fragment" id="idm45779438441840"/>versions of React added <em>fragments</em>, which are wrappers that do not add additional DOM nodes when the component is rendered.</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">FragmentExample</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">React</code><code class="p">.</code><code class="nx">Fragment</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">span</code><code class="o">&gt;</code><code class="nx">Hello</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="s1">' '</code><code class="p">}</code>
      <code class="o">&lt;</code><code class="nx">span</code><code class="o">&gt;</code><code class="nx">World</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
    <code class="o">&lt;/</code><code class="nx">React</code><code class="p">.</code><code class="nx">Fragment</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>

<p>Furthermore, the <code>React.Fragment</code> part can be omitted and these empty elements also work:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">FragmentExample</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;&gt;</code>
      <code class="o">&lt;</code><code class="nx">span</code><code class="o">&gt;</code><code class="nx">Hello</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="s1">' '</code><code class="p">}</code>
      <code class="o">&lt;</code><code class="nx">span</code><code class="o">&gt;</code><code class="nx">World</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
    <code class="o">&lt;/&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>At the time of <a data-type="indexterm" data-primary="Babel" id="idm45779438320544"/><a data-type="indexterm" data-primary="&lt;&gt;&lt;/&gt; syntax for React.Fragment" id="idm45779438319872"/>writing this <code>&lt;&gt;&lt;/&gt;</code> syntax is not supported by the <span class="keep-together">in-browser</span> version of Babel and you need to spell out <code>React​.Frag⁠ment</code>.</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="An Array"><div class="sect2" id="idm45779438317168">
<h2>An Array</h2>

<p>Another option is to <a data-type="indexterm" data-primary="arrays in JSX, multiple nodes in" id="idm45779438315568"/>return an <em>array</em> of nodes, as long as the nodes in the array have proper <code>key</code> attributes. Note the required commas after every element of the array.</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">ArrayExample</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">[</code>
    <code class="o">&lt;</code><code class="nx">span</code> <code class="nx">key</code><code class="o">=</code><code class="s2">"a"</code><code class="o">&gt;</code><code class="nx">Hello</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;,</code>
    <code class="s1">' '</code><code class="o">,</code>
    <code class="o">&lt;</code><code class="nx">span</code> <code class="nx">key</code><code class="o">=</code><code class="s2">"b"</code><code class="o">&gt;</code><code class="nx">World</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;,</code>
    <code class="s1">'!'</code>
  <code class="p">];</code>
<code class="p">}</code></pre>

<p>As you see, you can also sneak in whitespace and other strings in the array, and these don’t need a <code>key</code>. In a way, this is similar to accepting any number of children passed from the parent and propagating them over in your render <a data-type="indexterm" data-startref="ch5_term16" id="idm45779438255696"/><a data-type="indexterm" data-startref="ch5_term17" id="idm45779438255088"/>function:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">ChildrenExample</code><code class="p">(</code><code class="nx">props</code><code class="p">)</code> <code class="p">{</code>
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">props</code><code class="p">.</code><code class="nx">children</code><code class="p">.</code><code class="nx">length</code><code class="p">);</code> <code class="c1">// 4</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">div</code><code class="o">&gt;</code>
      <code class="p">{</code><code class="nx">props</code><code class="p">.</code><code class="nx">children</code><code class="p">}</code>
    <code class="o">&lt;/</code><code class="nx">div</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code>

<code class="nx">ReactDOM</code><code class="p">.</code><code class="nx">render</code><code class="p">(</code>
  <code class="o">&lt;</code><code class="nx">ChildrenExample</code><code class="o">&gt;</code>
    <code class="o">&lt;</code><code class="nx">span</code> <code class="nx">key</code><code class="o">=</code><code class="s2">"greet"</code><code class="o">&gt;</code><code class="nx">Hello</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
    <code class="p">{</code><code class="s1">' '</code><code class="p">}</code>
    <code class="o">&lt;</code><code class="nx">span</code> <code class="nx">key</code><code class="o">=</code><code class="s2">"world"</code><code class="o">&gt;</code><code class="nx">World</code><code class="o">&lt;/</code><code class="nx">span</code><code class="o">&gt;</code>
    <code class="o">!</code>
  <code class="o">&lt;/</code><code class="nx">ChildrenExample</code><code class="o">&gt;,</code>
  <code class="nx">document</code><code class="p">.</code><code class="nx">getElementById</code><code class="p">(</code><code class="s1">'app'</code><code class="p">)</code>
<code class="p">);</code></pre>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Differences Between JSX and HTML"><div class="sect1" id="idm45779438214816">
<h1>Differences Between JSX and HTML</h1>

<p>JSX should <a data-type="indexterm" data-primary="XML" id="idm45779438108928"/><a data-type="indexterm" data-primary="HTML" data-secondary="versus JSX" data-secondary-sortas="JSX" id="ch5_term18"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="versus HTML" data-secondary-sortas="HTML" id="ch5_term19"/>look familiar—it’s just like HTML, except it’s stricter as it’s XML. And it has the added benefits of providing an easy way to add dynamic values, loops, and conditions (just wrap them in <code>{}</code>).</p>

<p>To start <a data-type="indexterm" data-primary="HTML" data-secondary="HTML-to-JSX compiler" id="idm45779438104176"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="learning tools for" id="idm45779438103168"/>with JSX, you can always use the <a href="https://magic.reactjs.net/htmltojsx.htm">HTML-to-JSX compiler</a>, but the sooner you start typing your very own JSX, the better. Let’s consider the few differences between HTML and JSX that may surprise you.</p>

<p>Some of these differences were touched upon in previous chapters, but let’s quickly review them again.</p>








<section data-type="sect2" data-pdf-bookmark="No class, What for?"><div class="sect2" id="idm45779438100592">
<h2>No class, What for?</h2>

<p>Instead of the <code>class</code> and <code>for</code> attributes (both reserved words in ECMAScript), you <a data-type="indexterm" data-primary="className versus class attribute" id="idm45779438098080"/><a data-type="indexterm" data-primary="htmlFor (JSX)" id="idm45779438097408"/>need to use <code>className</code> and <code>htmlFor</code>:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="c1">// Warning: Invalid DOM property `class`. Did you mean `className`?</code>
<code class="c1">// Warning: Invalid DOM property `for`. Did you mean `htmlFor`?</code>
<code class="kd">const</code> <code class="nx">em</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">em</code> <code class="kd">class</code><code class="o">=</code><code class="s2">"important"</code> <code class="o">/&gt;;</code>
<code class="kd">const</code> <code class="nx">label</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">label</code> <code class="k">for</code><code class="o">=</code><code class="s2">"thatInput"</code> <code class="o">/&gt;;</code>

<code class="c1">// OK</code>
<code class="kd">const</code> <code class="nx">em</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">em</code> <code class="nx">className</code><code class="o">=</code><code class="s2">"important"</code> <code class="o">/&gt;;</code>
<code class="kd">const</code> <code class="nx">label</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">label</code> <code class="nx">htmlFor</code><code class="o">=</code><code class="s2">"thatInput"</code> <code class="o">/&gt;;</code></pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="style Is an Object"><div class="sect2" id="idm45779438094256">
<h2>style Is an Object</h2>

<p>The <code>style</code> attribute <a data-type="indexterm" data-primary="style attribute, JSX versus HTML for" id="idm45779438022064"/>takes an object value, not a semicolon-separated string as in regular HTML. And the <a data-type="indexterm" data-primary="camelCase attributes" id="idm45779438021184"/><a data-type="indexterm" data-primary="CSS" data-secondary="properties" id="idm45779438020512"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="camelCase syntax for" id="idm45779438019568"/>names of the CSS properties are camelCase, not dash-delimited:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="c1">// Error: The `style` prop expects a mapping from style properties to values</code>
<code class="kd">function</code> <code class="nx">InvalidStyle</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="o">&lt;</code><code class="nx">em</code> <code class="nx">style</code><code class="o">=</code><code class="s2">"font-size: 2em; line-height: 1.6"</code> <code class="o">/&gt;;</code>
<code class="p">}</code>

<code class="c1">// OK</code>
<code class="kd">function</code> <code class="nx">ValidStyle</code><code class="p">()</code> <code class="p">{</code>
  <code class="kd">const</code> <code class="nx">styles</code> <code class="o">=</code> <code class="p">{</code>
    <code class="nx">fontSize</code><code class="o">:</code> <code class="s1">'2em'</code><code class="o">,</code>
    <code class="nx">lineHeight</code><code class="o">:</code> <code class="s1">'1.6'</code><code class="o">,</code>
  <code class="p">};</code>
  <code class="k">return</code> <code class="o">&lt;</code><code class="nx">em</code> <code class="nx">style</code><code class="o">=</code><code class="p">{</code><code class="nx">styles</code><code class="p">}</code><code class="o">&gt;</code><code class="nx">Valid</code> <code class="nx">style</code><code class="o">&lt;/</code><code class="nx">em</code><code class="o">&gt;;</code>
<code class="p">}</code>

<code class="c1">// inline is also OK</code>
<code class="c1">// note the double curly braces:</code>
<code class="c1">// one for the dynamic value in JSX, one for the JS object</code>
<code class="kd">function</code> <code class="nx">InlineStyle</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">em</code> <code class="nx">style</code><code class="o">=</code><code class="p">{{</code><code class="nx">fontSize</code><code class="o">:</code> <code class="s1">'2em'</code><code class="o">,</code> <code class="nx">lineHeight</code><code class="o">:</code> <code class="s1">'1.6'</code><code class="p">}}</code><code class="o">&gt;</code><code class="nx">Inline</code> <code class="nx">style</code><code class="o">&lt;/</code><code class="nx">em</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Closing Tags"><div class="sect2" id="idm45779438018064">
<h2>Closing Tags</h2>

<p>In HTML <a data-type="indexterm" data-primary="tags, JSX versus HTML closing of" id="idm45779437897056"/>some tags don’t need to be closed; in JSX (XML) they all do:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="c1">// NO-NO</code>
<code class="c1">// no unclosed tags, even though they are fine in HTML</code>
<code class="kd">const</code> <code class="nx">gimmeabreak</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">br</code><code class="o">&gt;;</code>
<code class="kd">const</code> <code class="nx">list</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">ul</code><code class="o">&gt;&lt;</code><code class="nx">li</code><code class="o">&gt;</code><code class="nx">item</code><code class="o">&lt;/</code><code class="nx">ul</code><code class="o">&gt;;</code>
<code class="kd">const</code> <code class="nx">meta</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">meta</code> <code class="nx">charset</code><code class="o">=</code><code class="s2">"utf-8"</code><code class="o">&gt;;</code>

<code class="c1">// OK</code>
<code class="kd">const</code> <code class="nx">gimmeabreak</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">br</code> <code class="o">/&gt;;</code>
<code class="kd">const</code> <code class="nx">list</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">ul</code><code class="o">&gt;&lt;</code><code class="nx">li</code><code class="o">&gt;</code><code class="nx">item</code><code class="o">&lt;/</code><code class="nx">li</code><code class="o">&gt;&lt;/</code><code class="nx">ul</code><code class="o">&gt;;</code>
<code class="kd">const</code> <code class="nx">meta</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">meta</code> <code class="nx">charSet</code><code class="o">=</code><code class="s2">"utf-8"</code> <code class="o">/&gt;;</code>

<code class="c1">// or</code>
<code class="kd">const</code> <code class="nx">meta</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">meta</code> <code class="nx">charSet</code><code class="o">=</code><code class="s2">"utf-8"</code><code class="o">&gt;&lt;/</code><code class="nx">meta</code><code class="o">&gt;;</code></pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="camelCase Attributes"><div class="sect2" id="idm45779437892320">
<h2>camelCase Attributes</h2>

<p>Did you spot the <code>charset</code> versus <code>charSet</code> in the preceding snippet? All <a data-type="indexterm" data-primary="camelCase attributes" id="idm45779437781264"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="camelCase syntax for" id="idm45779437780560"/><a data-type="indexterm" data-primary="onClick handler" id="idm45779437779616"/>attributes in JSX need to be camelCase. This is a common source of confusion when starting out—you might type <code>onclick</code> and notice that nothing happens until you go back and change it to <code>onClick</code>:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="c1">// Warning: Invalid event handler property `onclick`. Did you mean `onClick`?</code>
<code class="kd">const</code> <code class="nx">a</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">a</code> <code class="nx">onclick</code><code class="o">=</code><code class="s2">"reticulateSplines()"</code> <code class="o">/&gt;;</code>

<code class="c1">// OK</code>
<code class="kd">const</code> <code class="nx">a</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">a</code> <code class="nx">onClick</code><code class="o">=</code><code class="p">{</code><code class="nx">reticulateSplines</code><code class="p">}</code> <code class="o">/&gt;;</code></pre>

<p>Exceptions to this rule are all <code>data-</code> and <code>aria-</code> prefixed attributes, for which JSX does not require <a data-type="indexterm" data-startref="ch5_term18" id="idm45779437757440"/><a data-type="indexterm" data-startref="ch5_term19" id="idm45779437756768"/>camelCase.</p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Namespaced Components"><div class="sect1" id="idm45779437755712">
<h1>Namespaced Components</h1>

<p>Sometimes you <a data-type="indexterm" data-primary="namespacing components" id="idm45779437753920"/>may want to have a single object that returns several components. This can be used to accomplish what is sometimes referred to as <em>namespacing</em>, where all components of a library have the same prefix. For example a <code>Library</code> object can contain a <code>Reader</code> and <code>Book</code> components:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">Library</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">Book</code><code class="p">({</code><code class="nx">id</code><code class="p">})</code> <code class="p">{</code>
    <code class="k">return</code> <code class="sb">`Book </code><code class="si">${</code><code class="nx">id</code><code class="si">}</code><code class="sb">`</code><code class="p">;</code>
  <code class="p">},</code>
  <code class="nx">Reader</code><code class="p">({</code><code class="nx">id</code><code class="p">})</code> <code class="p">{</code>
    <code class="k">return</code> <code class="sb">`Reader </code><code class="si">${</code><code class="nx">id</code><code class="si">}</code><code class="sb">`</code><code class="p">;</code>
  <code class="p">},</code>
<code class="p">};</code></pre>

<p>These are <a data-type="indexterm" data-primary="dot notation" id="idm45779437719712"/>then referred to using a <em>dot notation</em>:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="o">&lt;</code><code class="nx">Library</code><code class="p">.</code><code class="nx">Reader</code> <code class="nx">id</code><code class="o">=</code><code class="p">{</code><code class="mi">456</code><code class="p">}</code> <code class="sr">/&gt; is reading &lt;Library.Book id={123} /</code><code class="o">&gt;</code></pre>
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="idm45779437640160">
<h5>A Closer Look at ECMAScript Shortcuts</h5>
<p>The <code>Library</code> object uses a few relatively <a data-type="indexterm" data-primary="ECMAScript" data-secondary="shortcuts with" id="ch5_term20"/>new additions to ECMAScript that are worth pointing out. These have already appeared in this book, but it’s worth spending a moment to review the syntax.</p>
<dl>
<dt>Object shorthand notation</dt>
<dd>
<p>First, <a data-type="indexterm" data-primary="object shorthand notation" id="idm45779437651296"/>object shorthand notation is used to produce a structure similar to the <span class="keep-together">following</span>:</p>

<pre data-type="programlisting" data-code-language="javascript" class="pagebreak-before"><code class="kr">const</code> <code class="nx">a</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">method</code><code class="p">()</code> <code class="p">{},</code>
  <code class="nx">another</code><code class="p">()</code> <code class="p">{},</code>
<code class="p">};</code></pre>

<p>…which is a shorter way to express:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">a</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">method</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{},</code>
  <code class="nx">another</code><code class="o">:</code> <code class="kd">function</code><code class="p">()</code> <code class="p">{},</code>
<code class="p">};</code></pre>
</dd>
<dt>Destructuring assignment</dt>
<dd>
<p>Another <a data-type="indexterm" data-primary="destructuring assignment" id="idm45779437570560"/>syntax feature is destructuring assignment, which is used to write the following:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="nx">Book</code><code class="p">({</code><code class="nx">id</code><code class="p">})</code> <code class="p">{</code>
<code class="p">}</code></pre>

<p>…as a shorter version of:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="nx">Book</code><code class="p">(</code><code class="nx">props</code><code class="p">)</code> <code class="p">{</code>
  <code class="kr">const</code> <code class="nx">id</code> <code class="o">=</code> <code class="nx">props</code><code class="p">.</code><code class="nx">id</code><code class="p">;</code>
<code class="p">}</code></pre>
</dd>
<dt>Template strings</dt>
<dd>
<p>And <a data-type="indexterm" data-primary="template strings in ECMAScript" id="idm45779437500688"/>finally, <em>template strings</em>:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="k">return</code> <code class="sb">`Book </code><code class="si">${</code><code class="nx">id</code><code class="si">}</code><code class="sb">`</code><code class="p">;</code></pre>

<p>…as a succinct alternative to string concatenation:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="k">return</code> <code class="s1">'Book '</code> <code class="o">+</code> <code class="nx">id</code><code class="p">;</code></pre>

<p>In this case, the template string is not any shorter, but it becomes more convenient the more strings you need to <a data-type="indexterm" data-startref="ch5_term20" id="idm45779437470528"/>concatenate.</p>
</dd>
</dl>
</div></aside>
</div></section>













<section data-type="sect1" data-pdf-bookmark="JSX and Forms"><div class="sect1" id="idm45779437469648">
<h1>JSX and Forms</h1>

<p>There are some differences between JSX and HTML when working with forms. Let’s take a look.</p>








<section data-type="sect2" data-pdf-bookmark="onChange Handler"><div class="sect2" id="idm45779437467904">
<h2>onChange Handler</h2>

<p>When using form elements, <a data-type="indexterm" data-primary="textareas" data-secondary="onChange Handler with" id="idm45779437439968"/><a data-type="indexterm" data-primary="inputs" data-secondary="text fields for" id="ch5_term21"/><a data-type="indexterm" data-primary="text fields" id="ch5_term22"/><a data-type="indexterm" data-primary="onChange() event handler" id="ch5_term23"/><a data-type="indexterm" data-primary="events handlers" id="ch5_term24"/><a data-type="indexterm" data-primary="forms, JSX and" id="ch5_term25"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="forms in" id="ch5_term26"/>users change the values of the input elements when interacting with them. In React, you can subscribe to such changes via the <code>onChange</code> attribute. This is much more convenient than dealing with the various form elements in pure DOM. Also when typing in <code>textarea</code>s and <code>&lt;input type="text"&gt;</code> fields, <code>onChange</code> fires as the user types, which is easier to work with rather than firing when the element loses focus. This means no more subscribing to all sorts of mouse and keyboard events just to monitor typing changes.</p>

<p>Consider an example form that has a text input and two radio buttons. A <a data-type="indexterm" data-primary="changeHandler() function" id="idm45779437430208"/>change handler simply logs where the change happens and what the element’s new value is. As you see you can also have an overall form handler that fires when anything in the form changes. You can use this if you want to handle all the form’s changes in one central location.</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">changeHandler</code><code class="p">(</code><code class="nx">which</code><code class="o">,</code> <code class="nx">event</code><code class="p">)</code> <code class="p">{</code>
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code>
    <code class="err">`</code><code class="nx">onChange</code> <code class="nx">called</code> <code class="nx">on</code> <code class="nx">the</code> <code class="nx">$</code><code class="p">{</code><code class="nx">which</code><code class="p">}</code> <code class="k">with</code> <code class="nx">value</code> <code class="s2">"${event.target.value}"</code><code class="err">`</code><code class="o">,</code>
  <code class="p">);</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="nx">ExampleForm</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">form</code> <code class="nx">onChange</code><code class="o">=</code><code class="p">{</code><code class="nx">changeHandler</code><code class="p">.</code><code class="nx">bind</code><code class="p">(</code><code class="kc">null</code><code class="o">,</code> <code class="s1">'form'</code><code class="p">)}</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">label</code><code class="o">&gt;</code>
        <code class="nx">Type</code> <code class="nx">here</code><code class="o">:</code>
        <code class="o">&lt;</code><code class="nx">br</code> <code class="o">/&gt;</code>
        <code class="o">&lt;</code><code class="nx">input</code> <code class="nx">type</code><code class="o">=</code><code class="s2">"text"</code> <code class="nx">onChange</code><code class="o">=</code><code class="p">{</code><code class="nx">changeHandler</code><code class="p">.</code><code class="nx">bind</code><code class="p">(</code><code class="kc">null</code><code class="o">,</code> <code class="s1">'text input'</code><code class="p">)}</code> <code class="o">/&gt;</code>
      <code class="o">&lt;/</code><code class="nx">label</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">div</code><code class="o">&gt;</code><code class="nx">Make</code> <code class="nx">your</code> <code class="nx">pick</code><code class="o">:&lt;/</code><code class="nx">div</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">label</code><code class="o">&gt;</code>
        <code class="o">&lt;</code><code class="nx">input</code>
          <code class="nx">type</code><code class="o">=</code><code class="s2">"radio"</code>
          <code class="nx">name</code><code class="o">=</code><code class="s2">"pick"</code>
          <code class="nx">value</code><code class="o">=</code><code class="s2">"option1"</code>
          <code class="nx">onChange</code><code class="o">=</code><code class="p">{</code><code class="nx">changeHandler</code><code class="p">.</code><code class="nx">bind</code><code class="p">(</code><code class="kc">null</code><code class="o">,</code> <code class="s1">'radio 1'</code><code class="p">)}</code>
        <code class="o">/&gt;</code>
        <code class="nx">Option</code> <code class="mi">1</code>
      <code class="o">&lt;/</code><code class="nx">label</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">label</code><code class="o">&gt;</code>
        <code class="o">&lt;</code><code class="nx">input</code>
          <code class="nx">type</code><code class="o">=</code><code class="s2">"radio"</code>
          <code class="nx">name</code><code class="o">=</code><code class="s2">"pick"</code>
          <code class="nx">value</code><code class="o">=</code><code class="s2">"option2"</code>
          <code class="nx">onChange</code><code class="o">=</code><code class="p">{</code><code class="nx">changeHandler</code><code class="p">.</code><code class="nx">bind</code><code class="p">(</code><code class="kc">null</code><code class="o">,</code> <code class="s1">'radio 2'</code><code class="p">)}</code>
        <code class="o">/&gt;</code>
        <code class="nx">Option</code> <code class="mi">2</code>
      <code class="o">&lt;/</code><code class="nx">label</code><code class="o">&gt;</code>
    <code class="o">&lt;/</code><code class="nx">form</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>

<p>You can play live with the example <em>05.11.forms.onchange.html</em> in the book’s repo. When you type <code><strong>x</strong></code> in the text input, the change handler is called twice because it’s assigned once to the input and once to the form. In the console you’ll see:</p>

<pre data-type="programlisting">onChange called on the text input with value "x"
onChange called on the form with value "x"</pre>

<p class="pagebreak-before">Same <a data-type="indexterm" data-primary="inputs" data-secondary="radio" id="idm45779437198880"/><a data-type="indexterm" data-primary="radio inputs" id="idm45779437197904"/>for the radio buttons. Clicking “Option 1” logs to the console:</p>

<pre data-type="programlisting">onChange called on the radio 1 with value "option1"
onChange called on the form with value "option1"</pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="value Versus defaultValue"><div class="sect2" id="idm45779437196208">
<h2>value Versus defaultValue</h2>

<p>In HTML, if <a data-type="indexterm" data-primary="HTML" data-secondary="versus JSX" data-secondary-sortas="JSX" id="ch5_term27"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="versus HTML" data-secondary-sortas="HTML" id="ch5_term28"/><a data-type="indexterm" data-primary="inputs" data-secondary="value or defaultValue of" id="ch5_term29"/><a data-type="indexterm" data-primary="value property" id="ch5_term31"/>you have <code>&lt;input id="i" value="hello" /&gt;</code> and then change the value by typing “bye,” you have:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="nx">i</code><code class="p">.</code><code class="nx">value</code><code class="o">;</code> <code class="c1">// "bye"</code>
<code class="nx">i</code><code class="p">.</code><code class="nx">getAttribute</code><code class="p">(</code><code class="s1">'value'</code><code class="p">);</code> <code class="c1">// "hello"</code></pre>

<p>In React, <a data-type="indexterm" data-primary="event.target.value" id="idm45779437181328"/><a data-type="indexterm" data-primary="target.value" id="idm45779437180720"/><a data-type="indexterm" data-primary="defaultValue property" id="ch5_term30"/>the <code>value</code> property (accessible via <code>event.target.value</code> in an event handler) always has the up-to-date content of the text input. If you want to specify an initial default value, you can use the <code>defaultValue</code> prop.</p>

<p>In the following snippet, you <a data-type="indexterm" data-primary="inputs" data-secondary="prefilled text for" id="idm45779437177056"/><a data-type="indexterm" data-primary="prefilled text for inputs" id="idm45779437176080"/>have an <code>&lt;input&gt;</code> component with a prefilled “hello” content and <code>onChange</code> handler. Appending “!” to the end of “hello” results in <code>value</code> being “hello!” and <code>defaultValue</code> remaining “hello” (see <em>05.12.forms.value.html</em> in the repo):</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">changeHandler</code><code class="p">({</code><code class="nx">target</code><code class="p">})</code> <code class="p">{</code>
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'value: '</code><code class="o">,</code> <code class="nx">target</code><code class="p">.</code><code class="nx">value</code><code class="p">);</code>
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="s1">'defaultValue: '</code><code class="o">,</code> <code class="nx">target</code><code class="p">.</code><code class="nx">defaultValue</code><code class="p">);</code>
<code class="p">}</code>

<code class="kd">function</code> <code class="nx">ExampleForm</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">form</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">label</code><code class="o">&gt;</code>
        <code class="nx">Type</code> <code class="nx">here</code><code class="o">:</code> <code class="o">&lt;</code><code class="nx">input</code> <code class="nx">defaultValue</code><code class="o">=</code><code class="s2">"hello"</code> <code class="nx">onChange</code><code class="o">=</code><code class="p">{</code><code class="nx">changeHandler</code><code class="p">}</code> <code class="o">/&gt;</code>
      <code class="o">&lt;/</code><code class="nx">label</code><code class="o">&gt;</code>
    <code class="o">&lt;/</code><code class="nx">form</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="&lt;textarea&gt; Value"><div class="sect2" id="idm45779437140976">
<h2>&lt;textarea&gt; Value</h2>

<p>For consistency <a data-type="indexterm" data-startref="ch5_term21" id="idm45779437048144"/><a data-type="indexterm" data-startref="ch5_term22" id="idm45779437047504"/><a data-type="indexterm" data-startref="ch5_term23" id="idm45779437046800"/><a data-type="indexterm" data-primary="textareas" data-secondary="defaultValue property of" id="idm45779437046128"/>with text inputs, React’s version of <code>&lt;textarea&gt;</code> also takes a <code>defaultValue</code> property. It keeps <code>target.value</code> up to date while <code>defaultValue</code> remains the original. If you go HTML-style and use a child of the <code>textarea</code> to define a value (not recommended and React will give you a warning), it will be treated as if it was a <code>defaultValue</code>.</p>

<p>The whole reason HTML <code>&lt;textarea&gt;</code> (as defined by W3C) takes a child as its value is so that developers can use new lines in the input. However React, being all JavaScript, doesn’t suffer from this limitation. When you need a new line, you just use <code>\n</code>.</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">ExampleTextarea</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">form</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">label</code><code class="o">&gt;</code>
        <code class="nx">Type</code> <code class="nx">here</code><code class="o">:</code><code class="p">{</code><code class="s1">' '</code><code class="p">}</code>
        <code class="o">&lt;</code><code class="nx">textarea</code>
          <code class="nx">defaultValue</code><code class="o">=</code><code class="p">{</code><code class="s1">'hello\nworld'</code><code class="p">}</code>
          <code class="nx">onChange</code><code class="o">=</code><code class="p">{</code><code class="nx">changeHandler</code><code class="p">}</code>
        <code class="o">/&gt;</code><code class="p">{</code><code class="s1">' '</code><code class="p">}</code>
      <code class="o">&lt;/</code><code class="nx">label</code><code class="o">&gt;</code>
    <code class="o">&lt;/</code><code class="nx">form</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>

<p>Note that you <a data-type="indexterm" data-primary="\n (new line)" id="idm45779437039424"/><a data-type="indexterm" data-primary="new line (\n)" id="idm45779436967504"/><a data-type="indexterm" data-primary="JavaScript" data-secondary="newline in" id="idm45779436966896"/>need to use a JavaScript literal <code>{'hello\nworld'}</code>. Otherwise if you use a literal string property value (e.g., <code>defaultValue="hello\nworld"</code>) you don’t have access to the special newline meaning of <code>\n</code>.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="&lt;select&gt; Value"><div class="sect2" id="idm45779436964576">
<h2>&lt;select&gt; Value</h2>

<p>When you <a data-type="indexterm" data-primary="&lt;option selected&gt; input" data-primary-sortas="option selected input" id="idm45779436962912"/><a data-type="indexterm" data-primary="&lt;select&gt; value input" data-primary-sortas="select value input" id="ch5_term32"/>use a <code>&lt;select&gt;</code> input in HTML, you specify preselected entries using <code>&lt;option selected&gt;</code>, like so:</p>

<pre data-type="programlisting" data-code-language="html"><code class="c">&lt;!-- old school HTML --&gt;</code>
<code class="nt">&lt;select&gt;</code>
  <code class="nt">&lt;option</code> <code class="na">value=</code><code class="s">"stay"</code><code class="nt">&gt;</code>Should I stay<code class="nt">&lt;/option&gt;</code>
  <code class="nt">&lt;option</code> <code class="na">value=</code><code class="s">"move"</code> <code class="na">selected</code><code class="nt">&gt;</code>or should I go<code class="nt">&lt;/option&gt;</code>
<code class="nt">&lt;/select&gt;</code></pre>

<p>In React, you specify <code>value</code> or <code>defaultValue</code> property of the <code>&lt;select&gt;</code> element:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="c1">// React/JSX</code>
<code class="kd">function</code> <code class="nx">ExampleSelect</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">form</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">select</code> <code class="nx">defaultValue</code><code class="o">=</code><code class="s2">"move"</code> <code class="nx">onChange</code><code class="o">=</code><code class="p">{</code><code class="nx">changeHandler</code><code class="p">}</code><code class="o">&gt;</code>
        <code class="o">&lt;</code><code class="nx">option</code> <code class="nx">value</code><code class="o">=</code><code class="s2">"stay"</code><code class="o">&gt;</code><code class="nx">Should</code> <code class="nx">I</code> <code class="nx">stay</code><code class="o">&lt;/</code><code class="nx">option</code><code class="o">&gt;</code>
        <code class="o">&lt;</code><code class="nx">option</code> <code class="nx">value</code><code class="o">=</code><code class="s2">"move"</code><code class="o">&gt;</code><code class="nx">or</code> <code class="nx">should</code> <code class="nx">I</code> <code class="nx">go</code><code class="o">&lt;/</code><code class="nx">option</code><code class="o">&gt;</code>
      <code class="o">&lt;/</code><code class="nx">select</code><code class="o">&gt;</code>
    <code class="o">&lt;/</code><code class="nx">form</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>React warns you if you get mixed up and set the <code>selected</code> attribute of an <code>&lt;option&gt;</code>.</p>
</div>

<p class="pagebreak-before">Working with <a data-type="indexterm" data-primary="multiselects with preselected values" id="idm45779436829408"/>multiselects is similar, only you provide an array of preselected values:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">ExampleMultiSelect</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">form</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">select</code>
        <code class="nx">defaultValue</code><code class="o">=</code><code class="p">{[</code><code class="s1">'stay'</code><code class="o">,</code> <code class="s1">'move'</code><code class="p">]}</code>
        <code class="nx">multiple</code><code class="o">=</code><code class="p">{</code><code class="kc">true</code><code class="p">}</code>
        <code class="nx">onChange</code><code class="o">=</code><code class="p">{</code><code class="nx">selectHandler</code><code class="p">}</code><code class="o">&gt;</code>
        <code class="o">&lt;</code><code class="nx">option</code> <code class="nx">value</code><code class="o">=</code><code class="s2">"stay"</code><code class="o">&gt;</code><code class="nx">Should</code> <code class="nx">I</code> <code class="nx">stay</code><code class="o">&lt;/</code><code class="nx">option</code><code class="o">&gt;</code>
        <code class="o">&lt;</code><code class="nx">option</code> <code class="nx">value</code><code class="o">=</code><code class="s2">"move"</code><code class="o">&gt;</code><code class="nx">or</code> <code class="nx">should</code> <code class="nx">I</code> <code class="nx">go</code><code class="o">&lt;/</code><code class="nx">option</code><code class="o">&gt;</code>
        <code class="o">&lt;</code><code class="nx">option</code> <code class="nx">value</code><code class="o">=</code><code class="s2">"trouble"</code><code class="o">&gt;</code><code class="nx">If</code> <code class="nx">I</code> <code class="nx">stay</code> <code class="nx">it</code> <code class="nx">will</code> <code class="nx">be</code> <code class="nx">trouble</code><code class="o">&lt;/</code><code class="nx">option</code><code class="o">&gt;</code>
      <code class="o">&lt;/</code><code class="nx">select</code><code class="o">&gt;</code>
    <code class="o">&lt;/</code><code class="nx">form</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>

<p>Note that when working with multiselects—you <a data-type="indexterm" data-primary="event.target.selectedOptions" id="idm45779436824304"/><a data-type="indexterm" data-primary="event.target.value" id="idm45779436823696"/><a data-type="indexterm" data-primary="target.value" id="idm45779436707904"/>don’t get <code>event.target.value</code> in your change handlers. Instead, just as in HTML, you iterate over the <code>event.tar⁠get​.selectedOptions</code>. For example, a handler that logs the selected values to the console could look <a data-type="indexterm" data-startref="ch5_term27" id="idm45779436706272"/><a data-type="indexterm" data-startref="ch5_term28" id="idm45779436705600"/><a data-type="indexterm" data-startref="ch5_term29" id="idm45779436704928"/><a data-type="indexterm" data-startref="ch5_term32" id="idm45779436704256"/>like:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kd">function</code> <code class="nx">selectHandler</code><code class="p">({</code><code class="nx">target</code><code class="p">})</code> <code class="p">{</code>
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code>
    <code class="nb">Array</code><code class="p">.</code><code class="nx">from</code><code class="p">(</code><code class="nx">target</code><code class="p">.</code><code class="nx">selectedOptions</code><code class="p">).</code><code class="nx">map</code><code class="p">((</code><code class="nx">option</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="nx">option</code><code class="p">.</code><code class="nx">value</code><code class="p">),</code>
  <code class="p">);</code>
<code class="p">}</code></pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Controlled and Uncontrolled Components"><div class="sect2" id="idm45779436702064">
<h2>Controlled and Uncontrolled Components</h2>

<p>In the non-React world, the <a data-type="indexterm" data-primary="components" data-secondary="uncontrolled" id="ch5_term39"/><a data-type="indexterm" data-primary="uncontrolled components" id="ch5_term40"/>browser maintains the state of form elements such as the text in a text input. This state may even be restored if you navigate away from a page and then come back. React supports this behavior but also allows you to step in and take over the control of the form elements’ state.</p>

<p>When you leave the form elements to behave as the browser wishes, they are known as <em>uncontrolled components</em> because React does not control them. The opposite—when you take over with the help of React—results in <em>controlled</em> components.</p>

<p>How do you <a data-type="indexterm" data-primary="checkboxes" id="idm45779436675280"/><a data-type="indexterm" data-primary="components" data-secondary="controlled" id="idm45779436641920"/><a data-type="indexterm" data-primary="controlled components" id="idm45779436641072"/>create one versus the other? A component is <em>controlled</em> when you set the <code>value</code> property (of text inputs, <code>textarea</code>s, and selects) or the <code>checked</code> property (of radio inputs and checkboxes).</p>

<p>When you <a data-type="indexterm" data-primary="defaultChecked property" id="idm45779436638000"/><a data-type="indexterm" data-primary="inputs" data-secondary="prefilled text for" id="idm45779436637264"/><a data-type="indexterm" data-primary="prefilled text for inputs" id="idm45779436636320"/>don’t set these properties, the components are <em>uncontrolled</em>. You can still initialize (prefill) the form element with a default value by using the property <code>defaultValue</code> as you saw in several examples in this chapter. Or <code>defaultChecked</code> in case of radio elements and checkboxes.</p>

<p>Let’s clarify these concepts with a few examples.</p>










<section data-type="sect3" data-pdf-bookmark="Uncontrolled example"><div class="sect3" id="idm45779436633584">
<h3>Uncontrolled example</h3>

<p>Here’s an <a data-type="indexterm" data-primary="inputs" data-secondary="text fields for" id="ch5_term33"/><a data-type="indexterm" data-primary="text fields" id="ch5_term34"/>uncontrolled text input:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">const</code> <code class="nx">input</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">input</code> <code class="nx">type</code><code class="o">=</code><code class="s2">"text"</code> <code class="nx">name</code><code class="o">=</code><code class="s2">"firstname"</code> <code class="o">/&gt;;</code></pre>

<p>If you want to have prefilled text in the input, use <code>defaultValue</code>:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">const</code> <code class="nx">input</code> <code class="o">=</code> <code class="o">&lt;</code><code class="nx">input</code> <code class="nx">type</code><code class="o">=</code><code class="s2">"text"</code> <code class="nx">name</code><code class="o">=</code><code class="s2">"firstname"</code> <code class="nx">defaultValue</code><code class="o">=</code><code class="s2">"Jessie"</code> <code class="o">/&gt;;</code></pre>

<p>When you want to get the value the user has typed, you can have the <code>onChange</code> handler on the input or the whole form, as demonstrated in a previous example. Let’s consider a more <a data-type="indexterm" data-primary="profile editing form example" id="ch5_term43"/>complete example. Imagine you’re creating a profile editing form. Your data is:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kr">const</code> <code class="nx">profile</code> <code class="o">=</code> <code class="p">{</code>
  <code class="nx">firstname</code><code class="o">:</code> <code class="s1">'Jessie'</code><code class="p">,</code>
  <code class="nx">lastname</code><code class="o">:</code> <code class="s1">'Pinkman'</code><code class="p">,</code>
  <code class="nx">gender</code><code class="o">:</code> <code class="s1">'male'</code><code class="p">,</code>
  <code class="nx">acceptedTOC</code><code class="o">:</code> <code class="kc">false</code><code class="p">,</code>
<code class="p">};</code></pre>

<p>The form <a data-type="indexterm" data-primary="inputs" data-secondary="radio" id="ch5_term41"/><a data-type="indexterm" data-primary="radio inputs" id="ch5_term42"/>needs two text inputs, two radio inputs, and a checkbox:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">function</code> <code class="nx">UncontrolledForm</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="p">(</code>
    <code class="o">&lt;</code><code class="nx">form</code> <code class="nx">onChange</code><code class="o">=</code><code class="p">{</code><code class="nx">updateProfile</code><code class="p">}</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">label</code><code class="o">&gt;</code>
        <code class="nx">First</code> <code class="nx">name</code><code class="o">:</code><code class="p">{</code><code class="s1">' '</code><code class="p">}</code>
        <code class="o">&lt;</code><code class="nx">input</code> <code class="nx">type</code><code class="o">=</code><code class="s2">"text"</code> <code class="nx">name</code><code class="o">=</code><code class="s2">"firstname"</code> <code class="nx">defaultValue</code><code class="o">=</code><code class="p">{</code><code class="nx">profile</code><code class="p">.</code><code class="nx">firstname</code><code class="p">}</code> <code class="o">/&gt;</code>
      <code class="o">&lt;/</code><code class="nx">label</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">br</code> <code class="o">/&gt;</code>
      <code class="o">&lt;</code><code class="nx">label</code><code class="o">&gt;</code>
        <code class="nx">Last</code> <code class="nx">name</code><code class="o">:</code><code class="p">{</code><code class="s1">' '</code><code class="p">}</code>
        <code class="o">&lt;</code><code class="nx">input</code> <code class="nx">type</code><code class="o">=</code><code class="s2">"text"</code> <code class="nx">name</code><code class="o">=</code><code class="s2">"lastname"</code> <code class="nx">defaultValue</code><code class="o">=</code><code class="p">{</code><code class="nx">profile</code><code class="p">.</code><code class="nx">lastname</code><code class="p">}</code> <code class="o">/&gt;</code>
      <code class="o">&lt;/</code><code class="nx">label</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">br</code> <code class="o">/&gt;</code>
      <code class="nx">Gender</code><code class="o">:</code>
      <code class="o">&lt;</code><code class="nx">label</code><code class="o">&gt;</code>
        <code class="o">&lt;</code><code class="nx">input</code>
          <code class="nx">type</code><code class="o">=</code><code class="s2">"radio"</code>
          <code class="nx">name</code><code class="o">=</code><code class="s2">"gender"</code>
          <code class="nx">defaultChecked</code><code class="o">=</code><code class="p">{</code><code class="nx">profile</code><code class="p">.</code><code class="nx">gender</code> <code class="o">===</code> <code class="s1">'male'</code><code class="p">}</code>
          <code class="nx">value</code><code class="o">=</code><code class="s2">"male"</code>
        <code class="o">/&gt;</code>
        <code class="nx">Male</code>
      <code class="o">&lt;/</code><code class="nx">label</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">label</code><code class="o">&gt;</code>
        <code class="o">&lt;</code><code class="nx">input</code>
          <code class="nx">type</code><code class="o">=</code><code class="s2">"radio"</code>
          <code class="nx">name</code><code class="o">=</code><code class="s2">"gender"</code>
          <code class="nx">defaultChecked</code><code class="o">=</code><code class="p">{</code><code class="nx">profile</code><code class="p">.</code><code class="nx">gender</code> <code class="o">===</code> <code class="s1">'female'</code><code class="p">}</code>
          <code class="nx">value</code><code class="o">=</code><code class="s2">"female"</code>
        <code class="o">/&gt;</code>
        <code class="nx">Female</code>
      <code class="o">&lt;/</code><code class="nx">label</code><code class="o">&gt;</code>
      <code class="o">&lt;</code><code class="nx">br</code> <code class="o">/&gt;</code>
      <code class="o">&lt;</code><code class="nx">label</code><code class="o">&gt;</code>
        <code class="o">&lt;</code><code class="nx">input</code>
          <code class="nx">type</code><code class="o">=</code><code class="s2">"checkbox"</code>
          <code class="nx">name</code><code class="o">=</code><code class="s2">"acceptTOC"</code>
          <code class="nx">defaultChecked</code><code class="o">=</code><code class="p">{</code><code class="nx">profile</code><code class="p">.</code><code class="nx">acceptTOC</code> <code class="o">===</code> <code class="kc">true</code><code class="p">}</code>
        <code class="o">/&gt;</code>
        <code class="nx">I</code> <code class="nx">accept</code> <code class="nx">terms</code> <code class="nx">and</code> <code class="nx">things</code>
      <code class="o">&lt;/</code><code class="nx">label</code><code class="o">&gt;</code>
    <code class="o">&lt;/</code><code class="nx">form</code><code class="o">&gt;</code>
  <code class="p">);</code>
<code class="p">}</code></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The radio inputs do have <code>value</code> properties, but that does not make them controlled. Radio buttons (and checkboxes) become controlled when their <code>checked</code> property is <a data-type="indexterm" data-startref="ch5_term30" id="idm45779436530800"/>set.</p>
</div>

<p>The <code>updateProfile()</code> event <a data-type="indexterm" data-primary="updateProfile() event handler" id="ch5_term44"/><a data-type="indexterm" data-primary="target.checked" id="idm45779436261440"/><a data-type="indexterm" data-primary="target.value" id="idm45779436260768"/><a data-type="indexterm" data-primary="checkboxes" id="ch5_term45"/>handler should update the <code>profile</code> object. It can be fairly simple and generic. For checkboxes (<code>event.target.type === 'checkbox'</code>) you look for the <code>target.checked</code> property. In all other cases, you need the <span class="keep-together"><code>target.value</code></span>.</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kd">function</code> <code class="nx">updateProfile</code><code class="p">({</code><code class="nx">target</code><code class="p">})</code> <code class="p">{</code>
  <code class="nx">profile</code><code class="p">[</code><code class="nx">target</code><code class="p">.</code><code class="nx">name</code><code class="p">]</code> <code class="o">=</code>
    <code class="nx">target</code><code class="p">.</code><code class="nx">type</code> <code class="o">===</code> <code class="s1">'checkbox'</code> <code class="o">?</code> <code class="nx">target</code><code class="p">.</code><code class="nx">checked</code> <code class="o">===</code> <code class="kc">true</code> <code class="o">:</code> <code class="nx">target</code><code class="p">.</code><code class="nx">value</code><code class="p">;</code>
  <code class="nx">console</code><code class="p">.</code><code class="nx">log</code><code class="p">(</code><code class="nx">profile</code><code class="p">);</code>
<code class="p">}</code></pre>

<p><a data-type="xref" href="#FIG0508">Figure 5-8</a> shows how the profile is updated after you change the gender, accept the terms, and update the <a data-type="indexterm" data-startref="ch5_term33" id="idm45779436228272"/><a data-type="indexterm" data-startref="ch5_term34" id="idm45779436227664"/>first name (see <em>05.13.uncontrolled.html</em> in the repo).</p>

<p>Why is it important to treat checkboxes differently (look for <code>checked</code> property) but not radio inputs? The radio inputs are <a data-type="indexterm" data-primary="HTML" data-secondary="versus JSX" data-secondary-sortas="JSX" id="idm45779436188048"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="versus HTML" data-secondary-sortas="HTML" id="idm45779436186800"/>special in HTML given that you have several inputs with the same name and different values, and you get the value by referring to the name. You can still access <code>target.checked</code> on radio buttons if desired, but in this case it’s not necessary. And it’s always <code>true,</code> because the <code>onChange</code> callback is called when you click an element, and when you click a radio input, it’s always <a data-type="indexterm" data-startref="ch5_term41" id="idm45779436183920"/><a data-type="indexterm" data-startref="ch5_term42" id="idm45779436183216"/><a data-type="indexterm" data-startref="ch5_term43" id="idm45779436182544"/><a data-type="indexterm" data-startref="ch5_term44" id="idm45779436181872"/>checked.</p>

<figure><div id="FIG0508" class="figure">
<img src="Images/rur2_0508.png" alt="rur2 0508" width="600" height="272"/>
<h6><span class="label">Figure 5-8. </span>Uncontrolled component in action</h6>
</div></figure>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Uncontrolled example with an onSubmit handler"><div class="sect3" id="idm45779436632928">
<h3>Uncontrolled example with an onSubmit handler</h3>

<p>What if you don’t want to (over)react on every change? You want to let the users play with the form and you worry about the data only when they submit the form. In this <a data-type="indexterm" data-primary="DOM (Document Object Model)" data-secondary="form submission with" id="idm45779436177376"/>case you have two options:</p>

<ul>
<li>
<p>Use built-in DOM collections</p>
</li>
<li>
<p>Use React-created references</p>
</li>
</ul>

<p>Let’s see how to <a data-type="indexterm" data-primary="onSubmit event handler" id="idm45779436173696"/><a data-type="indexterm" data-primary="submit event" id="idm45779436172960"/>use the DOM collections (refer to <em>05.14.uncontrolled.onsubmit.html</em> in the repo). The form is essentially the same, except for the <code>onSubmit</code> event handler and a new submit button:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="o">&lt;</code><code class="nx">form</code> <code class="nx">onSubmit</code><code class="o">=</code><code class="p">{</code><code class="nx">updateProfile</code><code class="p">}</code><code class="o">&gt;</code>
  <code class="p">{</code><code class="cm">/* same thing as before ... */</code><code class="p">}</code>
  <code class="o">&lt;</code><code class="nx">input</code> <code class="nx">type</code><code class="o">=</code><code class="s2">"submit"</code> <code class="nx">value</code><code class="o">=</code><code class="s2">"Save"</code><code class="o">/&gt;</code>
<code class="o">&lt;/</code><code class="nx">form</code><code class="o">&gt;</code></pre>

<p>Here’s what the <a data-type="indexterm" data-primary="event.preventDefault()" id="idm45779436152448"/><a data-type="indexterm" data-primary="preventDefault()" id="idm45779436151840"/>newly updated <code>updateProfile()</code> could look like:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kd">function</code> <code class="nx">updateProfile</code><code class="p">(</code><code class="nx">ev</code><code class="p">)</code> <code class="p">{</code>
  <code class="nx">ev</code><code class="p">.</code><code class="nx">preventDefault</code><code class="p">();</code>
  <code class="kr">const</code> <code class="nx">form</code> <code class="o">=</code> <code class="nx">ev</code><code class="p">.</code><code class="nx">target</code><code class="p">;</code>
  <code class="nb">Object</code><code class="p">.</code><code class="nx">keys</code><code class="p">(</code><code class="nx">profile</code><code class="p">).</code><code class="nx">forEach</code><code class="p">((</code><code class="nx">name</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="p">{</code>
    <code class="kr">const</code> <code class="nx">element</code> <code class="o">=</code> <code class="nx">form</code><code class="p">[</code><code class="nx">name</code><code class="p">];</code>
    <code class="nx">profile</code><code class="p">[</code><code class="nx">name</code><code class="p">]</code> <code class="o">=</code>
      <code class="nx">element</code><code class="p">.</code><code class="nx">type</code> <code class="o">===</code> <code class="s1">'checkbox'</code> <code class="o">?</code> <code class="nx">element</code><code class="p">.</code><code class="nx">checked</code> <code class="o">:</code> <code class="nx">element</code><code class="p">.</code><code class="nx">value</code><code class="p">;</code>
  <code class="p">});</code>
<code class="p">}</code></pre>

<p>First, <code>preventDefault()</code> kills the propagation of the event and avoids the browser’s default behavior of reloading the page. Then it’s a question of looping over the profile’s fields and finding the corresponding form element with the same name.</p>

<p>The DOM provides access to the collection of form elements by various means, one of them being by name. For example:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="nx">form</code><code class="p">.</code><code class="nx">elements</code><code class="p">.</code><code class="nx">length</code><code class="p">;</code> <code class="c1">// 6</code>
<code class="nx">form</code><code class="p">.</code><code class="nx">elements</code><code class="p">[</code><code class="mi">0</code><code class="p">].</code><code class="nx">value</code><code class="p">;</code> <code class="c1">// "Jessie", access by index</code>
<code class="nx">form</code><code class="p">.</code><code class="nx">elements</code><code class="p">[</code><code class="s1">'firstname'</code><code class="p">].</code><code class="nx">value</code><code class="p">;</code> <code class="c1">// "Jessie", access by name</code>
<code class="nx">form</code><code class="p">.</code><code class="nx">firstname</code><code class="p">.</code><code class="nx">value</code><code class="p">;</code> <code class="c1">// "Jessie", even shorter</code></pre>

<p>It’s the last variant of this DOM form access that <code>updateProfile()</code> uses in its <a data-type="indexterm" data-startref="ch5_term39" id="idm45779436002464"/><a data-type="indexterm" data-startref="ch5_term40" id="idm45779436001968"/>loop.</p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Controlled example"><div class="sect3" id="idm45779436178640">
<h3>Controlled example</h3>

<p>Once you <a data-type="indexterm" data-primary="inputs" data-secondary="controlled component and" id="idm45779435999472"/><a data-type="indexterm" data-primary="components" data-secondary="controlled" id="ch5_term46"/><a data-type="indexterm" data-primary="controlled components" id="ch5_term47"/>assign a <code>value</code> property (to a <code>text</code> input, <code>textarea</code>, or <code>select</code>) or <code>checked</code> (to a <code>radio</code> input or <code>checkbox</code>), it’s your <a data-type="indexterm" data-startref="ch5_term45" id="idm45779435959472"/>responsibility to control the component. You need to maintain the state of the inputs as part of your component state. So now, the whole <a data-type="indexterm" data-primary="stateful components" id="idm45779435958448"/>form needs to be a <em>stateful</em> component. Let’s see how, using a class component:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="kd">class</code> <code class="nx">ControlledForm</code> <code class="kd">extends</code> <code class="nx">React</code><code class="p">.</code><code class="nx">Component</code> <code class="p">{</code>
  <code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
    <code class="c1">// ...</code>
  <code class="p">}</code>
  <code class="nx">updateForm</code><code class="p">({</code><code class="nx">target</code><code class="p">})</code> <code class="p">{</code>
    <code class="c1">// ...</code>
  <code class="p">}</code>
  <code class="nx">render</code><code class="p">()</code> <code class="p">{</code>
    <code class="k">return</code> <code class="p">(</code>
      <code class="o">&lt;</code><code class="nx">form</code><code class="o">&gt;</code>
        <code class="p">{</code><code class="cm">/* ... */</code><code class="p">}</code>
      <code class="o">&lt;/</code><code class="nx">form</code><code class="o">&gt;</code>
    <code class="p">);</code>
  <code class="p">}</code>
<code class="p">}</code></pre>

<p>Assuming there’s no other state to maintain but the form itself, you can clone the <code>profile</code> object as part of the initial state of the component inside the constructor. You <a data-type="indexterm" data-primary="updateForm() method" id="idm45779435955776"/>also need to bind the <code>updateForm()</code> method:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="nx">constructor</code><code class="p">()</code> <code class="p">{</code>
  <code class="kr">super</code><code class="p">();</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">state</code> <code class="o">=</code> <code class="p">{...</code><code class="nx">profile</code><code class="p">};</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">updateForm</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">updateForm</code><code class="p">.</code><code class="nx">bind</code><code class="p">(</code><code class="k">this</code><code class="p">);</code>
<code class="p">}</code></pre>

<p>The form <a data-type="indexterm" data-primary="defaultValue property" id="idm45779435868496"/><a data-type="indexterm" data-primary="onChange() event handler" id="idm45779435867888"/>elements now set <code>value</code> instead of <code>defaultValue</code> and all the values are maintained in <code>this.state</code>. Additionally, all inputs now need to have an <code>onChange</code> handler because they are now being <em>controlled</em>. For example, the first name input becomes:</p>

<pre data-type="programlisting" data-code-language="actionscript"><code class="o">&lt;</code><code class="nx">input</code>
  <code class="nx">type</code><code class="o">=</code><code class="s2">"text"</code>
  <code class="nx">name</code><code class="o">=</code><code class="s2">"firstname"</code>
  <code class="nx">value</code><code class="o">=</code><code class="p">{</code><code class="k">this</code><code class="p">.</code><code class="nx">state</code><code class="p">.</code><code class="nx">firstname</code><code class="p">}</code>
  <code class="nx">onChange</code><code class="o">=</code><code class="p">{</code><code class="k">this</code><code class="p">.</code><code class="nx">updateForm</code><code class="p">}</code>
<code class="o">/&gt;</code></pre>

<p>It will be a similar situation for the other elements except the submit button, as users don’t change its value.</p>

<p>Finally, the <code>updateForm()</code>. Using dynamic property names (the <code>target.name</code> in square brackets), it can be simple. All it needs to do is read the form element value and assign it to the state.</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="nx">updateForm</code><code class="p">({</code><code class="nx">target</code><code class="p">})</code> <code class="p">{</code>
  <code class="k">this</code><code class="p">.</code><code class="nx">setState</code><code class="p">({</code>
    <code class="p">[</code><code class="nx">target</code><code class="p">.</code><code class="nx">name</code><code class="p">]</code><code class="o">:</code>
      <code class="nx">target</code><code class="p">.</code><code class="nx">type</code> <code class="o">===</code> <code class="s1">'checkbox'</code> <code class="o">?</code> <code class="nx">target</code><code class="p">.</code><code class="nx">checked</code> <code class="o">:</code> <code class="nx">target</code><code class="p">.</code><code class="nx">value</code><code class="p">,</code>
  <code class="p">});</code>
<code class="p">}</code></pre>

<p>After <a data-type="indexterm" data-primary="setState()" id="idm45779435775264"/>the <code>setState()</code> call, the form is rerendered and the new form element values are read from the updated state (e.g., <code>value={this.state.firstname}</code>).</p>

<p>And this is it for the controlled component. As you can see, you need a bit of code just to get off the ground. This is the bad news. The good news is that now you can update the form values from your state, which is the single source of truth. You’re in control.</p>

<p>So which is <a data-type="indexterm" data-primary="components" data-secondary="uncontrolled" id="idm45779435755456"/><a data-type="indexterm" data-primary="uncontrolled components" id="idm45779435754448"/>better: controlled or uncontrolled? It depends on your use case. There isn’t really a “better” option. Also consider that at the time of writing, the official React documentation reads, “<em>In most cases</em>, we recommend using controlled components to implement forms.”</p>

<p>Can you mix and match controlled and uncontrolled components? Sure. In the last two examples, the “Save” button is always uncontrolled (<code>&lt;input type="submit" value="Save" /&gt;</code>) as there’s nothing <em>to</em> control; its <code>value</code> cannot be changed by the user. You can always opt for a mix: control the components you need to and leave the others to the <a data-type="indexterm" data-startref="ch5_term2" id="idm45779435717600"/><a data-type="indexterm" data-startref="ch5_term24" id="idm45779435716896"/><a data-type="indexterm" data-startref="ch5_term25" id="idm45779435716224"/><a data-type="indexterm" data-startref="ch5_term26" id="idm45779435715552"/><a data-type="indexterm" data-startref="ch5_term31" id="idm45779435714880"/><a data-type="indexterm" data-startref="ch5_term46" id="idm45779435714208"/><a data-type="indexterm" data-startref="ch5_term47" id="idm45779435713536"/>browser.</p>
</div></section>



</div></section>





</div></section>







</div></section></div></body>
</html>