<html><head></head><body><section data-pdf-bookmark="Chapter 4. Interactions Between Components" data-type="chapter" epub:type="chapter"><div class="chapter" id="unique_chapter_id_04">&#13;
<h1><span class="label">Chapter 4. </span>Interactions Between Components</h1>&#13;
&#13;
&#13;
<p>In <a data-type="xref" href="ch03.html#unique_chapter_id_03">Chapter 3</a>, we deep-dived into composing a component with lifecycle hooks, computed properties, watchers, methods, and other features. We also learned about the power of slots and how to receive external data from other components using props.</p>&#13;
&#13;
<p>Based on that foundation, this chapter guides you on how to build the interactions between components using custom events and provide/inject patterns. It also introduces Teleport API, which allows you to move elements around the DOM tree while keeping their order of appearance inside a Vue component.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Nested Components and Data Flow in Vue" data-type="sect1"><div class="sect1" id="ch04_nested_components">&#13;
<h1>Nested Components and Data Flow in Vue</h1>&#13;
&#13;
<p>Vue components can nest other Vue components inside them. This feature is handy in allowing users to organize their code into smaller, manageable, and reusable pieces in a complex UI project. We call nested elements child components and the component containing them their parent component<a data-primary="components" data-secondary="passing data with props" data-type="indexterm" id="ix-comp-inter1"/><a data-primary="props" data-secondary="declaring with types" data-type="indexterm" id="ix-comp-inter1a"/><a data-primary="props" data-secondary="passing data between components" data-type="indexterm" id="ix-comp-inter1b"/><a data-primary="types" data-secondary="declaring props with" data-type="indexterm" id="ix-comp-inter1c"/><a data-primary="components" data-secondary="nested components and data flow" data-type="indexterm" id="ix-comp-inter1d"/><a data-primary="data" data-secondary="data flow and nested components" data-type="indexterm" id="ix-comp-inter1e"/><a data-primary="nested components" data-secondary="data flow and" data-type="indexterm" id="ix-comp-inter1f"/>.</p>&#13;
&#13;
<p>Data flow in a Vue application is unidirectional by default, which means that the parent component can pass data to its child component but not the other way around. The parent can pass data to the child component using <code>props</code> (discussed briefly in <a data-type="xref" href="ch02.html#ch02_exploring_options">“Exploring the Options API”</a>), and the child component can emit events back to the parent component using custom events <code>emits</code>. <a data-type="xref" href="#figure_04_04">Figure 4-1</a> demonstrates the data flow between components<a data-primary="components" data-secondary="emitting data between" data-type="indexterm" id="id886"/><a data-primary="data" data-secondary="data flow diagram" data-type="indexterm" id="id887"/><a data-primary="data" data-secondary="emitting data between components" data-type="indexterm" id="id888"/><a data-primary="emits" data-secondary="passing data between components" data-type="indexterm" id="id889"/><a data-primary="emitters, event" data-secondary="passing data between components" data-type="indexterm" id="id890"/><a data-primary="events" data-secondary="emitting" data-type="indexterm" id="id891"/><a data-primary="props" data-secondary="emitting data between components" data-type="indexterm" id="id892"/>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_04">&#13;
<img alt="A diagram shows the one-way data flow between components" src="assets/lvue_0401.png"/>&#13;
<h6><span class="label">Figure 4-1. </span>One-way data flow in Vue components</h6>&#13;
</div></figure>&#13;
<div data-type="warning" epub:type="warning"><h1>Passing Functions as Props</h1>&#13;
<p>Unlike other frameworks, Vue does not allow you to pass a function as a prop to the child component. Instead, you can bind the function as a custom event emitter (see <a data-type="xref" href="#custom-event-emitters">“Communication Between Components with &#13;
<span class="keep-together">Custom Events</span>”</a>)<a data-primary="emitters, event" data-secondary="custom event emitters and functions" data-type="indexterm" id="id893"/><a data-primary="events" data-secondary="custom event emitters and functions" data-type="indexterm" id="id894"/><a data-primary="functions" data-secondary="passing as props" data-type="indexterm" id="id895"/><a data-primary="props" data-secondary="passing functions as" data-type="indexterm" id="id896"/>.</p>&#13;
</div>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using Props to Pass Data to Child Components" data-type="sect2"><div class="sect2" id="id55">&#13;
<h2>Using Props to Pass Data to Child Components</h2>&#13;
&#13;
<p>In the form of an object or array, the <code>props</code> field of a Vue component contains all the available data properties that the component can receive from its parent. Each property of <code>props</code> is a prop of the target component. To start receiving data from the parent, you need to declare the <code>props</code> field in the component’s options object, as shown in <a data-type="xref" href="#example_04_01">Example 4-1</a><a data-primary="props" data-secondary="defining" data-type="indexterm" id="id897"/>.</p>&#13;
<div data-type="example" id="example_04_01">&#13;
<h5><span class="label">Example 4-1. </span>Defining props in a component</h5>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">export</code> <code class="k">default</code> <code class="p">{</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'ChildComponent'</code><code class="p">,</code>&#13;
  <code class="nx">props</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">name</code><code class="o">:</code> <code class="nb">String</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>In <a data-type="xref" href="#example_04_01">Example 4-1</a>, the <code>ChildComponent</code> component accepts a <code>name</code> prop of type <code>String</code>. The parent component then can pass data to the child component using this <code>name</code> prop, as shown in <a data-type="xref" href="#example_04_02">Example 4-2</a><a data-primary="bindings" data-secondary="props" data-type="indexterm" id="ix-comp-inter2"/><a data-primary="bindings" data-secondary="with v-bind" data-secondary-sortas="v-bind" data-type="indexterm" id="ix-comp-inter2a"/><a data-primary="props" data-secondary="binding reactive data and passing props with v-bind" data-type="indexterm" id="ix-comp-inter2b"/><a data-primary="variables, passing and binding dynamic with v-bind" data-type="indexterm" id="ix-comp-inter2c"/><a data-primary="v-bind" data-secondary="binding reactive data and passing props" data-type="indexterm" id="ix-comp-inter2d"/>.</p>&#13;
<div data-type="example" id="example_04_02">&#13;
<h5><span class="label">Example 4-2. </span>Passing static data as props to a child component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">ChildComponent</code> <code class="na">name</code><code class="o">=</code><code class="s">"Red Sweater"</code> <code class="p">/&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="nx">ChildComponent</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'./ChildComponent.vue'</code><code class="w"/>&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'ParentComponent'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">components</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">ChildComponent</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="p">}</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>The <code>ChildComponent</code> receives a static “Red Sweater” as a <code>name</code> value in the previous example. If you want to pass and bind a dynamic data variable to <code>name</code>, such as the first element in the <code>children</code> list, you can use the <code>v-bind</code> attribute, denoted by <code>:</code>, as shown in <a data-type="xref" href="#example_04_03">Example 4-3</a>.</p>&#13;
<div data-type="example" id="example_04_03">&#13;
<h5><span class="label">Example 4-3. </span>Passing dynamic variables as props to a child component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">ChildComponent</code> <code class="na">:name</code><code class="o">=</code><code class="s">"children[0]"</code> <code class="p">/&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="nx">ChildComponent</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'./ChildComponent.vue'</code><code class="w"/>&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="c1">//...</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">children</code><code class="o">:</code><code class="w"> </code><code class="p">[</code><code class="s1">'Red Sweater'</code><code class="p">,</code><code class="w"> </code><code class="s1">'Blue T-Shirt'</code><code class="p">,</code><code class="w"> </code><code class="s1">'Green Hat'</code><code class="p">]</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">}</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">}</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>The output for the previous code is the same as passing a static string, <code>Red Sweater</code>, to the <code>name</code> prop.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>If the <code>name</code> prop is not of type <code>String</code>, you still need to use the &#13;
<span class="keep-together"><code>v-bind</code></span> attribute (or <code>:</code>) to pass static data to the child component, such as <code>:name="true"</code> for <code>Boolean</code>, or <code>:name="["hello", "world"]"</code> for <code>Array</code> type.</p>&#13;
</div>&#13;
&#13;
<p>In <a data-type="xref" href="#example_04_03">Example 4-3</a>, whenever the value of <code>children[0]</code> changes, Vue will also update the <code>name</code> prop in the <code>ChildComponent</code>, and the child component will re-render its content if needed.</p>&#13;
&#13;
<p>If you have more than one prop in the child component, you can follow the same approach and pass each data to the relevant prop. For instance, to pass <code>name</code> and <code>price</code> of a product to the <code>ProductComp</code> component, you can perform this (<a data-type="xref" href="#example_04_04">Example 4-4</a>)<a data-primary="props" data-secondary="passing data with multiple props" data-type="indexterm" id="id898"/>.</p>&#13;
<div data-type="example" id="example_04_04">&#13;
<h5><span class="label">Example 4-4. </span>Passing multiple props to a child component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting">/** components/ProductList.vue */&#13;
<code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">ProductComp</code> <code class="na">:name</code><code class="o">=</code><code class="s">"product.name"</code> <code class="na">:price</code><code class="o">=</code><code class="s">"product.price"</code> <code class="p">/&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="nx">ProductComp</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'./ProductComp.vue'</code><code class="w"/>&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'ProductList'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">components</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">ProductComp</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">product</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'Red Sweater'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">        </code><code class="nx">price</code><code class="o">:</code><code class="w"> </code><code class="mf">19.99</code><code class="w"/>&#13;
<code class="w">      </code><code class="p">}</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">}</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">}</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>And we can define the <code>ProductComp</code> component as in <a data-type="xref" href="#example_04_05">Example 4-5</a>.</p>&#13;
<div data-type="example" id="example_04_05">&#13;
<h5><span class="label">Example 4-5. </span>Defining multiple props in <code>ProductComp</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>Product: {{ name }}<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>Price: {{ price }}<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'ProductComp'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">props</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="nb">String</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">price</code><code class="o">:</code><code class="w"> </code><code class="nb">Number</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">}</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>The output will be as follows:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting">Product: Red Sweater&#13;
Price: 19.99</pre>&#13;
&#13;
<p>Alternatively, you can use <code>v-bind</code> (<em>not</em> <code>:</code>) to pass the entire object <code>user</code> and have its properties bound to the relevant child component’s props:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">ProductComp</code> <code class="na">v-bind</code><code class="o">=</code><code class="s">"product"</code> <code class="p">/&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre>&#13;
&#13;
<p>Note that only the child component will receive the relevant declared props. Hence, if you have another field, <code>product.description</code>, in the parent component, it will not be available for access in the child component.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Another approach to declare your component’s <code>props</code> is to use an array of strings, each representing the name of the prop it accepts, such as <code>props: ["name", "price"]</code>. This approach is practical when you want to prototype a component quickly. However, I strongly recommend you use the object form of <code>props</code> and declare all your props with types, as a good practice for code readability and bug prevention<a data-primary="props" data-secondary="declaring with strings" data-type="indexterm" id="id899"/><a data-primary="strings" data-secondary="declaring props with" data-type="indexterm" id="id900"/>.</p>&#13;
</div>&#13;
&#13;
<p>We have learned how to declare props with types, but how do we validate the data passed to the child’s props when needed? How can we set a fallback value for a prop when no value is passed? Let’s find out next.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Declaring Prop Types with Validation and Default Values" data-type="sect2"><div class="sect2" id="id56">&#13;
<h2>Declaring Prop Types with Validation and Default Values</h2>&#13;
&#13;
<p>Back in <a data-type="xref" href="#example_04_01">Example 4-1</a>, we declared the <code>name</code> prop as a <code>String</code> type. Vue will warn if the parent component passes a non-string value to the <code>name</code> prop during run-time. However, to be able to enjoy the benefit of Vue’s type validation, we should use the full declaration syntax<a data-primary="props" data-secondary="default values" data-type="indexterm" id="ix-comp-inter3"/><a data-primary="props" data-secondary="validating" data-type="indexterm" id="ix-comp-inter3a"/><a data-primary="type validation" data-secondary="props" data-type="indexterm" id="ix-comp-inter3b"/><a data-primary="values, default for props" data-type="indexterm" id="ix-comp-inter3c"/><a data-primary="type checking" data-secondary="props" data-type="indexterm" id="ix-comp-inter4"/><a data-primary="props" data-secondary="syntax" data-type="indexterm" id="id901"/>:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="p">{</code>&#13;
  <code class="nx">type</code><code class="o">:</code> <code class="nb">String</code> <code class="o">|</code> <code class="nb">Number</code> <code class="o">|</code> <code class="nb">Boolean</code> <code class="o">|</code> <code class="nb">Array</code> <code class="o">|</code> <code class="nb">Object</code> <code class="o">|</code> <code class="nb">Date</code> <code class="o">|</code> <code class="nb">Function</code> <code class="o">|</code> <code class="nx">Symbol</code><code class="p">,</code>&#13;
  <code class="k">default</code><code class="o">?:</code> <code class="nx">any</code><code class="p">,</code>&#13;
  <code class="nx">required</code><code class="o">?:</code> <code class="kr">boolean</code><code class="p">,</code>&#13;
  <code class="nx">validator</code><code class="o">?:</code> <code class="p">(</code><code class="nx">value</code><code class="o">:</code> <code class="nx">any</code><code class="p">)</code> <code class="o">=&gt;</code> <code class="kr">boolean</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>In which:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p><code>type</code> is the type of prop. It can be a constructor function (or custom class) or one of the built-in types<a data-primary="type, declaring props syntax" data-type="indexterm" id="id902"/>.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>default</code> is the prop’s default value if no value is passed. For types <code>Object</code>, &#13;
<span class="keep-together"><code>Function</code></span>, and <code>Array</code>, the default value must be a function that returns the initial value<a data-primary="default in props syntax" data-type="indexterm" id="id903"/>.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>required</code> is a boolean value indicating whether the prop is mandatory. If <code>required</code> is <code>true</code>, the parent component must pass a value to the prop. By default, all props are optional<a data-primary="required, props syntax" data-type="indexterm" id="id904"/><a data-primary="props" data-secondary="mandatory" data-type="indexterm" id="id905"/>.</p>&#13;
</li>&#13;
<li>&#13;
<p><code>validator</code> is a function that validates the value passed to the prop, mainly for development debugging.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>We can declare the <code>name</code> prop to be more specific, including a default value, as shown in <a data-type="xref" href="#example_06_04_01">Example 4-6</a>.</p>&#13;
<div data-type="example" id="example_06_04_01">&#13;
<h5><span class="label">Example 4-6. </span>Defining prop as a string with a default value</h5>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">export</code> <code class="k">default</code> <code class="p">{</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'ChildComponent'</code><code class="p">,</code>&#13;
  <code class="nx">props</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">name</code><code class="o">:</code> <code class="p">{</code>&#13;
      <code class="nx">type</code><code class="o">:</code> <code class="nb">String</code><code class="p">,</code>&#13;
      <code class="k">default</code><code class="o">:</code> <code class="s1">'Child component'</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>If the parent component does not pass a value, the child component will fall back to the default value <em>“Child component”</em> for the <code>name</code> prop.</p>&#13;
&#13;
<p>We can also set <code>name</code> as a mandatory prop for the child component and add a validator for its received data, as shown in <a data-type="xref" href="#example_ch04_05">Example 4-7</a>.</p>&#13;
<div data-type="example" id="example_ch04_05">&#13;
<h5><span class="label">Example 4-7. </span>Defining name as required with a prop validator</h5>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">export</code> <code class="k">default</code> <code class="p">{</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'ChildComponent'</code><code class="p">,</code>&#13;
  <code class="nx">props</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">name</code><code class="o">:</code> <code class="p">{</code>&#13;
      <code class="nx">type</code><code class="o">:</code> <code class="nb">String</code><code class="p">,</code>&#13;
      <code class="nx">required</code><code class="o">:</code> <code class="kc">true</code><code class="p">,</code>&#13;
      <code class="nx">validator</code><code class="o">:</code> <code class="nx">value</code> <code class="o">=&gt;</code> <code class="nx">value</code> <code class="o">!==</code> <code class="s2">"Child component"</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>In this scenario, if the parent component does not pass a value to the <code>name</code> prop, or the given value matches <em>Child component</em>, Vue will throw a warning in development mode (<a data-type="xref" href="#figure_ch04_warning">Figure 4-2</a>)<a data-primary="" data-startref="ix-comp-inter2" data-type="indexterm" id="id906"/><a data-primary="" data-startref="ix-comp-inter2a" data-type="indexterm" id="id907"/><a data-primary="" data-startref="ix-comp-inter2b" data-type="indexterm" id="id908"/><a data-primary="" data-startref="ix-comp-inter2c" data-type="indexterm" id="id909"/><a data-primary="" data-startref="ix-comp-inter2d" data-type="indexterm" id="id910"/>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_ch04_warning">&#13;
<img alt="Screenshot of console warning for failed name prop validation" src="assets/lvue_0402.png"/>&#13;
<h6><span class="label">Figure 4-2. </span>Console warning in development for failed prop validation</h6>&#13;
</div></figure>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>For the <code>default</code> field, the <code>Function</code> type is a function that returns the initial value of the prop. You can’t use it to pass data back to the parent component or to trigger data changes on the parent level.</p>&#13;
</div>&#13;
&#13;
<p>In addition to the built-in types and validation provided by Vue, you can combine a JavaScript <code>Class</code> or a function constructor and TypeScript to create your custom prop type. I’ll cover them in the next section<a data-primary="" data-startref="ix-comp-inter3" data-type="indexterm" id="id911"/><a data-primary="" data-startref="ix-comp-inter3a" data-type="indexterm" id="id912"/><a data-primary="" data-startref="ix-comp-inter3b" data-type="indexterm" id="id913"/><a data-primary="" data-startref="ix-comp-inter3c" data-type="indexterm" id="id914"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Declaring Props with Custom Type Checking" data-type="sect2"><div class="sect2" id="id57">&#13;
<h2>Declaring Props with Custom Type Checking</h2>&#13;
&#13;
<p>Using primitive types like <code>Array</code>, <code>String</code>, or <code>Object</code> suits the essential use case. However, as your application grows, primitive types can be too generic to keep your component’s type safe. Take a <code>PizzaComponent</code> with the following template code<a data-primary="props" data-secondary="custom props, declaring" data-type="indexterm" id="ix-comp-inter5"/><a data-primary="types" data-secondary="declaring props with custom type checking" data-type="indexterm" id="ix-comp-inter5a"/>:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">header</code><code class="p">&gt;</code>Title: {{ pizza.title }}<code class="p">&lt;/</code><code class="nt">header</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"pizza--details-wrapper"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">img</code> <code class="na">:src</code><code class="o">=</code><code class="s">"pizza.image"</code> <code class="na">:alt</code><code class="o">=</code><code class="s">"pizza.title"</code> <code class="na">width</code><code class="o">=</code><code class="s">"300"</code> <code class="p">/&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>Description: {{ pizza.description }}<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"pizza--inventory"</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"pizza--inventory-stock"</code><code class="p">&gt;</code>Quantity: {{pizza.quantity}}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"pizza--inventory-price"</code><code class="p">&gt;</code>Price: {{pizza.price}}<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre>&#13;
&#13;
<p>This component accepts a mandatory <code>pizza</code> prop, which is an <code>Object</code> containing some details about the <code>pizza</code>:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">export</code> <code class="k">default</code> <code class="p">{</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'PizzaComponent'</code><code class="p">,</code>&#13;
  <code class="nx">props</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">pizza</code><code class="o">:</code> <code class="p">{</code>&#13;
      <code class="nx">type</code><code class="o">:</code> <code class="nb">Object</code><code class="p">,</code>&#13;
      <code class="nx">required</code><code class="o">:</code> <code class="kc">true</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>Straightforward enough. However, by declaring <code>pizza</code> as an <code>Object</code> type, we assume the parent will always pass the suitable object with the appropriate fields (<code>title</code>, <code>image</code>, <code>description</code>, <code>quantity</code>, and <code>price</code>) required for a <code>pizza</code> to render.</p>&#13;
&#13;
<p>This assumption can lead to a problem. Since <code>pizza</code> accepts data of type <code>Object</code>, any component that uses <code>PizzaComponent</code> can pass any object data to the prop <code>pizza</code> without the actual fields needed for a <code>pizza</code>, as in <a data-type="xref" href="#example_06_04_02">Example 4-8</a>.</p>&#13;
<div data-type="example" id="example_06_04_02">&#13;
<h5><span class="label">Example 4-8. </span>Using Pizza component with wrong data</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code>Bad usage of Pizza component<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">pizza-component</code> <code class="na">:pizza</code><code class="o">=</code><code class="s">"{ name: 'Pinia', description: 'Hawaiian pizza' }"</code> <code class="p">/&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>The preceding  code results in a broken UI render of <code>PizzaComponent</code>, where only a <code>description</code> is available, and the rest of the fields are empty (with a broken image), as shown in <a data-type="xref" href="#figure_ch04_01_02">Figure 4-3</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_ch04_01_02">&#13;
<img alt="Screenshot of a pizza without title, price, quantity and image rendered" src="assets/lvue_0403.png"/>&#13;
<h6><span class="label">Figure 4-3. </span>Broken UI with no image link and missing fields for a pizza</h6>&#13;
</div></figure>&#13;
&#13;
<p>TypeScript won’t be able to detect the data type mismatch here either, as it performs the type checking according to the declared type of <code>pizza</code>: the generic <code>Object</code>. Another potential problem is that passing <code>pizza</code> in the wrong nest properties format can cause the app to crash. Therefore, to avoid such accidents, we use custom type declarations.</p>&#13;
&#13;
<p>We can define the <code>Pizza</code> class and declare the prop <code>pizza</code> of type <code>Pizza</code> as shown in <a data-type="xref" href="#example_ch04_07">Example 4-9</a>.</p>&#13;
<div data-type="example" id="example_ch04_07">&#13;
<h5><span class="label">Example 4-9. </span>Declaring a Pizza custom type</h5>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">class</code><code> </code><code class="nx">Pizza</code><code> </code><code class="p">{</code><code>&#13;
  </code><code class="nx">title</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">;</code><code>&#13;
  </code><code class="nx">description</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">;</code><code>&#13;
  </code><code class="nx">image</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">;</code><code>&#13;
  </code><code class="nx">quantity</code><code class="o">:</code><code> </code><code class="nx">number</code><code class="p">;</code><code>&#13;
  </code><code class="nx">price</code><code class="o">:</code><code> </code><code class="nx">number</code><code class="p">;</code><code>&#13;
&#13;
  </code><code class="nx">constructor</code><code class="p">(</code><code>&#13;
    </code><code class="nx">title</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">,</code><code>&#13;
    </code><code class="nx">description</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">,</code><code>&#13;
    </code><code class="nx">image</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">,</code><code>&#13;
    </code><code class="nx">quantity</code><code class="o">:</code><code> </code><code class="nx">number</code><code class="p">,</code><code>&#13;
    </code><code class="nx">price</code><code class="o">:</code><code> </code><code class="nx">number</code><code>&#13;
  </code><code class="p">)</code><code> </code><code class="p">{</code><code>&#13;
    </code><code class="k">this</code><code class="p">.</code><code class="nx">title</code><code> </code><code class="o">=</code><code> </code><code class="nx">title</code><code>&#13;
    </code><code class="k">this</code><code class="p">.</code><code class="nx">description</code><code> </code><code class="o">=</code><code> </code><code class="nx">description</code><code>&#13;
    </code><code class="k">this</code><code class="p">.</code><code class="nx">image</code><code> </code><code class="o">=</code><code> </code><code class="nx">image</code><code>&#13;
    </code><code class="k">this</code><code class="p">.</code><code class="nx">quantity</code><code> </code><code class="o">=</code><code> </code><code class="nx">quantity</code><code>&#13;
    </code><code class="k">this</code><code class="p">.</code><code class="nx">price</code><code> </code><code class="o">=</code><code> </code><code class="nx">price</code><code>&#13;
  </code><code class="p">}</code><code>&#13;
</code><code class="p">}</code><code>&#13;
&#13;
</code><code class="kr">export</code><code> </code><code class="k">default</code><code> </code><code class="p">{</code><code>&#13;
  </code><code class="nx">name</code><code class="o">:</code><code> </code><code class="s1">'PizzaComponent'</code><code class="p">,</code><code>&#13;
  </code><code class="nx">props</code><code class="o">:</code><code> </code><code class="p">{</code><code>&#13;
    </code><code class="nx">pizza</code><code class="o">:</code><code> </code><code class="p">{</code><code>&#13;
      </code><code class="nx">type</code><code class="o">:</code><code> </code><code class="nx">Pizza</code><code class="p">,</code><code> </code><a class="co" href="#callout_interactions_between_components_CO1-1" id="co_interactions_between_components_CO1-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
      </code><code class="nx">required</code><code class="o">:</code><code> </code><code class="kc">true</code><code>&#13;
    </code><code class="p">}</code><code>&#13;
  </code><code class="p">}</code><code>&#13;
</code><code class="p">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_interactions_between_components_CO1-1" id="callout_interactions_between_components_CO1-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Declare the type of <code>pizza</code> props as <code>Pizza</code> directly</p></dd>&#13;
</dl>&#13;
&#13;
<p>Alternatively, you can use TypeScript’s <code>interface</code> or <code>type</code> to define your custom type instead of <code>Class</code>. However, in such scenarios, you must use type <code>PropType</code> from the <code>vue</code> package, with the following syntax, to map the declared type to the target prop<a data-primary="interface, declaring custom types" data-type="indexterm" id="id915"/><a data-primary="PropType" data-type="indexterm" id="id916"/><a data-primary="type, declaring props syntax" data-type="indexterm" id="id917"/>:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="nx">type</code><code class="o">:</code> <code class="nb">Object</code> <code class="nx">as</code> <code class="nx">PropType</code><code class="o">&lt;</code><code class="nx">Your</code><code class="o">-</code><code class="nx">Custom</code><code class="o">-</code><code class="nx">Type</code><code class="o">&gt;</code></pre>&#13;
&#13;
<p>Let’s rewrite the <code>Pizza</code> class as an <code>interface</code> instead (<a data-type="xref" href="#example_04_08">Example 4-10</a>).</p>&#13;
<div data-type="example" id="example_04_08">&#13;
<h5><span class="label">Example 4-10. </span>Declaring a Pizza custom type using the TypeScript interface API</h5>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">import</code><code> </code><code class="nx">type</code><code> </code><code class="p">{</code><code> </code><code class="nx">PropType</code><code> </code><code class="p">}</code><code> </code><code class="nx">from</code><code> </code><code class="s1">'vue'</code><code>&#13;
&#13;
</code><code class="kr">interface</code><code> </code><code class="nx">Pizza</code><code> </code><code class="p">{</code><code>&#13;
  </code><code class="nx">title</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">;</code><code>&#13;
  </code><code class="nx">description</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">;</code><code>&#13;
  </code><code class="nx">image</code><code class="o">:</code><code> </code><code class="nx">string</code><code class="p">;</code><code>&#13;
  </code><code class="nx">quantity</code><code class="o">:</code><code> </code><code class="nx">number</code><code class="p">;</code><code>&#13;
  </code><code class="nx">price</code><code class="o">:</code><code> </code><code class="nx">number</code><code class="p">;</code><code>&#13;
</code><code class="p">}</code><code>&#13;
&#13;
</code><code class="kr">export</code><code> </code><code class="k">default</code><code> </code><code class="p">{</code><code>&#13;
  </code><code class="nx">name</code><code class="o">:</code><code> </code><code class="s1">'PizzaComponent'</code><code class="p">,</code><code>&#13;
  </code><code class="nx">props</code><code class="o">:</code><code> </code><code class="p">{</code><code>&#13;
    </code><code class="nx">pizza</code><code class="o">:</code><code> </code><code class="p">{</code><code>&#13;
      </code><code class="nx">type</code><code class="o">:</code><code> </code><code class="nb">Object</code><code> </code><code class="nx">as</code><code> </code><code class="nx">PropType</code><code class="o">&lt;</code><code class="nx">Pizza</code><code class="o">&gt;</code><code class="p">,</code><code> </code><a class="co" href="#callout_interactions_between_components_CO2-1" id="co_interactions_between_components_CO2-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
      </code><code class="nx">required</code><code class="o">:</code><code> </code><code class="kc">true</code><code>&#13;
    </code><code class="p">}</code><code>&#13;
  </code><code class="p">}</code><code>&#13;
</code><code class="p">}</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_interactions_between_components_CO2-1" id="callout_interactions_between_components_CO2-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>Declare the type of <code>pizza</code> props as <code>Pizza</code> interface with <code>PropType</code> help.</p></dd>&#13;
</dl>&#13;
&#13;
<p>When you use <code>PizzaComponent</code> with the wrong data format, TypeScript will detect and highlight the error appropriately<a data-primary="" data-startref="ix-comp-inter5" data-type="indexterm" id="id918"/><a data-primary="" data-startref="ix-comp-inter5a" data-type="indexterm" id="id919"/>.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Vue performs type validation during run-time, while TypeScript performs type checking during compile-time. Hence, it is a good practice to use both Vue’s type checking and TypeScript’s type checking to ensure your code is bug-free<a data-primary="compiling" data-secondary="type checking and type validation at compile time" data-type="indexterm" id="id920"/><a data-primary="type validation" data-secondary="compile-time with TypeScript" data-type="indexterm" id="id921"/><a data-primary="type validation" data-secondary="run-time with Vue" data-type="indexterm" id="id922"/><a data-primary="type validation" data-secondary="props" data-type="indexterm" id="id923"/><a data-primary="run-time" data-secondary="type validation" data-type="indexterm" id="id924"/><a data-primary="TypeScript" data-secondary="compile-time type checking and validation" data-type="indexterm" id="id925"/>.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Declaring Props Using defineProps() and withDefaults()" data-type="sect2"><div class="sect2" id="declaring-props-defineProps">&#13;
<h2>Declaring Props Using defineProps() and withDefaults()</h2>&#13;
&#13;
<p>As we learned in <a data-type="xref" href="ch03.html#setup_hook_03">“setup”</a>, starting with Vue 3.x, Vue offers <code>&lt;script setup&gt;</code> syntax for declaring a functional component without the classic Options API. Within this <code>&lt;script setup&gt;</code> block, you can use <code>defineProps()</code> to declare props, as shown in <a data-type="xref" href="#example_ch04_09">Example 4-11</a><a data-primary="defineProps()" data-type="indexterm" id="id926"/><a data-primary="props" data-secondary="declaring with defineProps() and withDefaults()" data-type="indexterm" id="id927"/><a data-primary="withDefaults()" data-type="indexterm" id="id928"/><a data-primary="setup hook" data-secondary="declaring props" data-type="indexterm" id="id929"/><a data-primary="TypeScript" data-secondary="defineProps() and" data-type="indexterm" id="id930"/>.</p>&#13;
<div data-type="example" id="example_ch04_09">&#13;
<h5><span class="label">Example 4-11. </span>Props declaration with <code>defineProps()</code> and <code>&lt;script setup&gt;</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code> <code class="na">setup</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineProps</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w"/>&#13;
&#13;
<code class="kd">const</code><code class="w"> </code><code class="nx">props</code><code class="w"> </code><code class="o">=</code><code class="w"> </code><code class="nx">defineProps</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">type</code><code class="o">:</code><code class="w"> </code><code class="nb">String</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">default</code><code class="o">:</code><code class="w"> </code><code class="s2">"Hello from the child component."</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">})</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>Thanks to TypeScript, we can also declare the accepted type for <code>defineProps()</code> per component with type validation on compile-time, as shown in <a data-type="xref" href="#example_ch04_10">Example 4-12</a>.</p>&#13;
<div data-type="example" id="example_ch04_10">&#13;
<h5><span class="label">Example 4-12. </span>Props declaration with <code>defineProps()</code> and <code>TypeScript type</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code> <code class="na">setup</code> <code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineProps</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w"/>&#13;
&#13;
<code class="nx">type</code><code class="w"> </code><code class="nx">ChildProps</code><code class="w"> </code><code class="o">=</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">?:</code><code class="w"> </code><code class="nx">string</code><code class="w"/>&#13;
<code class="p">}</code><code class="w"/>&#13;
&#13;
<code class="kd">const</code><code class="w"> </code><code class="nx">props</code><code class="w"> </code><code class="o">=</code><code class="w"> </code><code class="nx">defineProps</code><code class="p">&lt;</code><code class="nt">ChildProps</code><code class="p">&gt;()</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>In this case, to declare the default value of the <code>message</code> prop, we need to wrap the <code>defineProps()</code> call with <code>withDefaults()</code>, as in <a data-type="xref" href="#example_ch04_11">Example 4-13</a>.</p>&#13;
<div data-type="example" id="example_ch04_11">&#13;
<h5><span class="label">Example 4-13. </span>Props declaration with <code>defineProps()</code> and <code>withDefaults()</code></h5>&#13;
&#13;
<pre data-code-language="typescript" data-type="programlisting"><code class="kr">import</code> <code class="p">{</code> <code class="nx">defineProps</code><code class="p">,</code> <code class="nx">withDefaults</code> <code class="p">}</code> <code class="nx">from</code> <code class="s1">'vue'</code>&#13;
&#13;
<code class="kr">type</code> <code class="nx">ChildProps</code> <code class="o">=</code> <code class="p">{</code>&#13;
  <code class="nx">name</code><code class="o">?:</code> <code class="kt">string</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="kr">const</code> <code class="nx">props</code> <code class="o">=</code> <code class="nx">withDefaults</code><code class="p">(</code><code class="nx">defineProps</code><code class="o">&lt;</code><code class="nx">ChildProps</code><code class="o">&gt;</code><code class="p">(),</code> <code class="p">{</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'Hello from the child component.'</code>&#13;
<code class="p">})</code></pre></div>&#13;
<div data-type="warning" epub:type="warning"><h1>Using defineProps() with TypeScript Type Checking</h1>&#13;
<p>We can’t combine run-time and compile-time type checking when using <code>defineProps()</code>. I recommend using <code>defineProps()</code> in the approach in <a data-type="xref" href="#example_ch04_09">Example 4-11</a>, for better readability and a combination of both Vue and TypeScript type checking<a data-primary="run-time" data-secondary="type checking" data-type="indexterm" id="id931"/>.</p>&#13;
</div>&#13;
&#13;
<p>We have learned how to declare props for passing raw data in a Vue component, with type checking and validation. Next, we will explore how to pass functions as custom event emitters to a child component<a data-primary="" data-startref="ix-comp-inter1" data-type="indexterm" id="id932"/><a data-primary="" data-startref="ix-comp-inter1a" data-type="indexterm" id="id933"/><a data-primary="" data-startref="ix-comp-inter1b" data-type="indexterm" id="id934"/><a data-primary="" data-startref="ix-comp-inter1c" data-type="indexterm" id="id935"/><a data-primary="" data-startref="ix-comp-inter1d" data-type="indexterm" id="id936"/><a data-primary="" data-startref="ix-comp-inter1e" data-type="indexterm" id="id937"/><a data-primary="" data-startref="ix-comp-inter1f" data-type="indexterm" id="id938"/><a data-primary="" data-startref="ix-comp-inter4" data-type="indexterm" id="id939"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Communication Between Components with &#10;Custom Events" data-type="sect1"><div class="sect1" id="custom-event-emitters">&#13;
<h1>Communication Between Components with &#13;
<span class="keep-together">Custom Events</span></h1>&#13;
&#13;
<p>Vue treats data passed to a child component via props as read-only and raw data. One-way data flow ensures that the parent component is the only one that can update the data prop. We often want to update a specific data prop and sync it with the parent component. To do so, we use the <code>emits</code> field in the component’s options to declare custom events<a data-primary="components" data-secondary="emitting data between" data-type="indexterm" id="ix-comp-inter6"/><a data-primary="data" data-secondary="emitting data between components" data-type="indexterm" id="ix-comp-inter6a"/><a data-primary="emits" data-secondary="passing data between components" data-type="indexterm" id="ix-comp-inter6b"/><a data-primary="emitters, event" data-secondary="passing data between components" data-type="indexterm" id="ix-comp-inter6c"/><a data-primary="events" data-secondary="emitting" data-type="indexterm" id="ix-comp-inter6d"/><a data-primary="props" data-secondary="emitting data between components" data-type="indexterm" id="ix-comp-inter6e"/>.</p>&#13;
&#13;
<p>Take a to-do list, or <code>ToDoList</code> component, for instance. This <code>ToDoList</code> will use &#13;
<span class="keep-together"><code>ToDoItem</code></span> as its child component to render a list of tasks with the code in <a data-type="xref" href="#example_ch04_12">Example 4-14</a>.</p>&#13;
<div data-type="example" id="example_ch04_12">&#13;
<h5><span class="label">Example 4-14. </span><code>ToDoList</code> component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">ul</code> <code class="na">style</code><code class="o">=</code><code class="s">"list-style: none;"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">li</code> <code class="na">v-for</code><code class="o">=</code><code class="s">"task in tasks"</code> <code class="na">:key</code><code class="o">=</code><code class="s">"task.id"</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">ToDoItem</code> <code class="na">:task</code><code class="o">=</code><code class="s">"task"</code> <code class="p">/&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">li</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">ul</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="nx">ToDoItem</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'./ToDoItem.vue'</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="nx">type</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">Task</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'./ToDoItem'</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'ToDoList'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">components</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">ToDoItem</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">tasks</code><code class="o">:</code><code class="w"> </code><code class="p">[</code><code class="w"/>&#13;
<code class="w">        </code><code class="p">{</code><code class="w"> </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="mf">1</code><code class="p">,</code><code class="w"> </code><code class="nx">title</code><code class="o">:</code><code class="w"> </code><code class="s1">'Learn Vue'</code><code class="p">,</code><code class="w"> </code><code class="nx">completed</code><code class="o">:</code><code class="w"> </code><code class="kc">false</code><code class="w"> </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">        </code><code class="p">{</code><code class="w"> </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="mf">2</code><code class="p">,</code><code class="w"> </code><code class="nx">title</code><code class="o">:</code><code class="w"> </code><code class="s1">'Learn TypeScript'</code><code class="p">,</code><code class="w"> </code><code class="nx">completed</code><code class="o">:</code><code class="w"> </code><code class="kc">false</code><code class="w"> </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">        </code><code class="p">{</code><code class="w"> </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="mf">3</code><code class="p">,</code><code class="w"> </code><code class="nx">title</code><code class="o">:</code><code class="w"> </code><code class="s1">'Learn Vite'</code><code class="p">,</code><code class="w"> </code><code class="nx">completed</code><code class="o">:</code><code class="w"> </code><code class="kc">false</code><code class="w"> </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">      </code><code class="p">]</code><code class="w"> </code><code class="kr">as</code><code class="w"> </code><code class="nx">Task</code><code class="p">[]</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">}</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">})</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>And <code>ToDoItem</code> is a component that receives a <code>task</code> prop and renders an <code>input</code> as a checkbox for the user to mark the task as completed or not. This <code>input</code> element receives <code>task.completed</code> as its initial value for the <code>checked</code> attribute. Let’s look at <a data-type="xref" href="#example_ch04_09_01">Example 4-15</a><a data-primary="input element" data-secondary="toggling with event emitters" data-type="indexterm" id="ix-comp-inter7"/><a data-primary="toggling" data-secondary="with event emitters" data-secondary-sortas="event emitters" data-type="indexterm" id="ix-comp-inter7a"/>.</p>&#13;
<div data-type="example" id="example_ch04_09_01">&#13;
<h5><span class="label">Example 4-15. </span><code>ToDoItem</code> component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">input</code>&#13;
      <code class="na">type</code><code class="o">=</code><code class="s">"checkbox"</code>&#13;
      <code class="na">:checked</code><code class="o">=</code><code class="s">"task.completed"</code>&#13;
    <code class="p">/&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">span</code><code class="p">&gt;</code>{{ task.title }}<code class="p">&lt;/</code><code class="nt">span</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">,</code><code class="w"> </code><code class="nx">type</code><code class="w"> </code><code class="nx">PropType</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="kr">interface</code><code class="w"> </code><code class="nx">Task</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="nx">number</code><code class="p">;</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">title</code><code class="o">:</code><code class="w"> </code><code class="nx">string</code><code class="p">;</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">completed</code><code class="o">:</code><code class="w"> </code><code class="kr">boolean</code><code class="p">;</code><code class="w"/>&#13;
<code class="p">}</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'ToDoItem'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">props</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">task</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">type</code><code class="o">:</code><code class="w"> </code><code class="nb">Object</code><code class="w"> </code><code class="kr">as</code><code class="w"> </code><code class="nx">PropType</code><code class="p">&lt;</code><code class="nt">Task</code><code class="p">&gt;,</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">required</code><code class="o">:</code><code class="w"> </code><code class="kc">true</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">}</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="p">})</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p class="pagebreak-before">When a user toggles this <code>input</code> checkbox, we want to emit an event called <code>task-completed-toggle</code> to inform about the <code>task.completed</code> value of the specific task to the parent component. We can do so by first declaring the event in the <code>emits</code> field of the component’s options (<a data-type="xref" href="#example_ch04_09_todo_with_emits">Example 4-16</a>).</p>&#13;
<div data-type="example" id="example_ch04_09_todo_with_emits">&#13;
<h5><span class="label">Example 4-16. </span><code>ToDoItem</code> component with emits</h5>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="cm">/** ToDoItem.vue */</code>&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="c1">//...</code>&#13;
  <code class="nx">emits</code><code class="o">:</code> <code class="p">[</code><code class="s1">'task-completed-toggle'</code><code class="p">]</code>&#13;
<code class="p">})</code></pre></div>&#13;
&#13;
<p>Then, we create a new method <code>onTaskCompleted</code> to emit the <code>task-completed-toggle</code> event with the new value of <code>task.completed</code> from the checkbox and the <code>task.id</code> as the event’s payload (<a data-type="xref" href="#example_ch04_09_todo_with_emits2">Example 4-17</a>).</p>&#13;
<div data-type="example" id="example_ch04_09_todo_with_emits2">&#13;
<h5><span class="label">Example 4-17. </span><code>ToDoItem</code> component with a method to emit <code>task-completed-toggle</code> event</h5>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="cm">/** ToDoItem.vue */</code>&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="nx">defineComponent</code><code class="p">({</code>&#13;
  <code class="c1">//...</code>&#13;
  <code class="nx">methods</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">onTaskCompleted</code><code class="p">(</code><code class="nx">event</code><code class="o">:</code> <code class="nx">Event</code><code class="p">)</code> <code class="p">{</code>&#13;
      <code class="k">this</code><code class="p">.</code><code class="nx">$emit</code><code class="p">(</code><code class="s2">"task-completed-toggle"</code><code class="p">,</code> <code class="p">{</code>&#13;
        <code class="p">...</code><code class="k">this</code><code class="p">.</code><code class="nx">task</code><code class="p">,</code>&#13;
        <code class="nx">completed</code><code class="o">:</code> <code class="p">(</code><code class="nx">event</code><code class="p">.</code><code class="nx">target</code> <code class="nx">as</code> <code class="nx">HTMLInputElement</code><code class="p">)</code><code class="o">?</code><code class="p">.</code><code class="nx">checked</code><code class="p">,</code>&#13;
      <code class="p">});</code>&#13;
    <code class="p">},</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">})</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>We use <code>defineComponent</code> to wrap around the component’s options and create a TypeScript-friendly component. Using <code>define</code>&#13;
<span class="keep-together"><code>Component</code></span> is not required for simple components, but you need to use it to access other data properties of <code>this</code> inside components’ methods, hooks, or computed properties. Otherwise, TypeScript will throw an error<a data-primary="defineComponent()" data-type="indexterm" id="id940"/><a data-primary="this" data-secondary="wrapping components and TypeScript" data-type="indexterm" id="id941"/><a data-primary="TypeScript" data-secondary="wrapping components and" data-type="indexterm" id="id942"/>.</p>&#13;
</div>&#13;
&#13;
<p>Then we bind the <code>onTaskCompleted</code> method to the <code>input</code> element’s <code>change</code> event, as shown in <a data-type="xref" href="#example_ch04_09_todo_with_emits3">Example 4-18</a>.</p>&#13;
<div class="pagebreak-before" data-type="example" id="example_ch04_09_todo_with_emits3">&#13;
<h5><span class="label">Example 4-18. </span><code>ToDoItem</code> component’s updated template</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">input</code>&#13;
    <code class="na">type</code><code class="o">=</code><code class="s">"checkbox"</code>&#13;
    <code class="na">:checked</code><code class="o">=</code><code class="s">"task.completed"</code>&#13;
    <code class="err">@</code><code class="na">change</code><code class="o">=</code><code class="s">"onTaskCompleted"</code>&#13;
  <code class="p">/&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">span</code><code class="p">&gt;</code>{{ task.title }}<code class="p">&lt;/</code><code class="nt">span</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>Now in the parent component <code>&lt;ToDoList&gt;</code> of <code>ToDoItem</code>, we can bind the <code>task-completed-toggle</code> event to a method using <code>@</code> notation, with the template in <a data-type="xref" href="#example_ch04_09_todo_parent">Example 4-19</a>.</p>&#13;
<div data-type="example" id="example_ch04_09_todo_parent">&#13;
<h5><span class="label">Example 4-19. </span><code>ToDoList</code> component’s updated template</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">ul</code> <code class="na">style</code><code class="o">=</code><code class="s">"list-style: none;"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">li</code> <code class="na">v-for</code><code class="o">=</code><code class="s">"task in tasks"</code> <code class="na">:key</code><code class="o">=</code><code class="s">"task.id"</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">ToDoItem</code>&#13;
        <code class="na">:task</code><code class="o">=</code><code class="s">"task"</code>&#13;
        <code class="err">@</code><code class="na">task-completed-toggle</code><code class="o">=</code><code class="s">"onTaskCompleted"</code>&#13;
      <code class="p">/&gt;</code>&#13;
    <code class="p">&lt;/</code><code class="nt">li</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">ul</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>The <code>onTaskCompleted</code> method in the parent component <code>&lt;ToDoList&gt;</code> will receive the payload of the <code>task-completed-toggle</code> event, and update the <code>task.completed</code> value of the specific task in the <code>tasks</code> array, as in <a data-type="xref" href="#ch04_09_todo_parent_script">Example 4-20</a>.</p>&#13;
<div data-type="example" id="ch04_09_todo_parent_script">&#13;
<h5><span class="label">Example 4-20. </span><code>ToDoList</code> component’s script with a method to handle <code>task-completed-toggle</code> event</h5>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="c1">//...</code>&#13;
&#13;
<code class="kr">export</code> <code class="k">default</code> <code class="p">{</code>&#13;
  <code class="c1">//...</code>&#13;
  <code class="nx">methods</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">onTaskCompleted</code><code class="p">(</code><code class="nx">payload</code><code class="o">:</code> <code class="p">{</code> <code class="nx">id</code><code class="o">:</code> <code class="nx">number</code><code class="p">;</code> <code class="nx">completed</code><code class="o">:</code> <code class="kr">boolean</code> <code class="p">})</code> <code class="p">{</code>&#13;
      <code class="kr">const</code> <code class="nx">index</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">tasks</code><code class="p">.</code><code class="nx">findIndex</code><code class="p">(</code><code class="nx">t</code> <code class="o">=&gt;</code> <code class="nx">t</code><code class="p">.</code><code class="nx">id</code> <code class="o">===</code> <code class="nx">payload</code><code class="p">.</code><code class="nx">id</code><code class="p">)</code>&#13;
&#13;
      <code class="k">if</code> <code class="p">(</code><code class="nx">index</code> <code class="o">&lt;</code> <code class="mi">0</code><code class="p">)</code> <code class="k">return</code>&#13;
&#13;
      <code class="k">this</code><code class="p">.</code><code class="nx">tasks</code><code class="p">[</code><code class="nx">index</code><code class="p">].</code><code class="nx">completed</code> <code class="o">=</code> <code class="nx">payload</code><code class="p">.</code><code class="nx">completed</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>These code blocks will render the page shown in <a data-type="xref" href="#figure_04_02">Figure 4-4</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_02">&#13;
<img alt="Screenshot of a to-do list with three tasks, each with a checkbox and task's title" src="assets/lvue_0404.png"/>&#13;
<h6><span class="label">Figure 4-4. </span><code>ToDoList</code> component with three items</h6>&#13;
</div></figure>&#13;
&#13;
<p>Vue will update the related data in <code>ToDoList</code> and accordingly render the relevant <code>ToDoItem</code> component instance. You can toggle the checkbox to mark a to-do item as completed. <a data-type="xref" href="#figure_04_03">Figure 4-5</a> shows we can detect the component’s event using the Vue &#13;
<span class="keep-together">Devtools</span>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_03">&#13;
<img alt="A screenshot of the Vue Devtools showing the event emitted by the +ToDoItem+ component" src="assets/lvue_0405.png"/>&#13;
<h6><span class="label">Figure 4-5. </span>Mark a to-do item as completed and debug the event emitted using &#13;
<span class="keep-together">Vue Devtools</span></h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Defining Custom Events Using defineEmits()" data-type="sect1"><div class="sect1" id="declaring-emits-defineEmits">&#13;
<h1>Defining Custom Events Using defineEmits()</h1>&#13;
&#13;
<p>Similar to <a data-type="xref" href="#declaring-props-defineProps">“Declaring Props Using defineProps() and withDefaults()”</a>, within a <code>&lt;script setup&gt;</code> code block, you can use <code>defineEmits()</code> to define custom events. The <code>defineEmits()</code> function accepts the same input parameter type as <code>emits</code> accepts<a data-primary="defineEmits()" data-type="indexterm" id="id943"/><a data-primary="emits" data-secondary="custom events with defineEmits()" data-type="indexterm" id="id944"/><a data-primary="events" data-secondary="custom events with defineEmits()" data-type="indexterm" id="id945"/>:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">const</code> <code class="nx">emits</code> <code class="o">=</code> <code class="nx">defineEmits</code><code class="p">([</code><code class="s1">'component-event'</code><code class="p">])</code></pre>&#13;
&#13;
<p>It then returns a function instance that we can use to invoke a specific event from the component:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="nx">emits</code><code class="p">(</code><code class="s1">'component-event'</code><code class="p">,</code> <code class="p">[...</code><code class="nx">arguments</code><code class="p">])</code></pre>&#13;
&#13;
<p class="pagebreak-before">Thus we can write the script section of <code>ToDoItem</code> as in <a data-type="xref" href="#example_04_12">Example 4-21</a>.</p>&#13;
<div data-type="example" id="example_04_12">&#13;
<h5><span class="label">Example 4-21. </span><code>ToDoItem</code> component with the custom event using <code>defineEmits()</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code> <code class="na">setup</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="c1">//...</code><code class="w"/>&#13;
<code class="kd">const</code><code class="w"> </code><code class="nx">props</code><code class="w"> </code><code class="o">=</code><code class="w"> </code><code class="nx">defineProps</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">task</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">type</code><code class="o">:</code><code class="w"> </code><code class="nb">Object</code><code class="w"> </code><code class="kr">as</code><code class="w"> </code><code class="nx">PropType</code><code class="p">&lt;</code><code class="nt">Task</code><code class="p">&gt;,</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">required</code><code class="o">:</code><code class="w"> </code><code class="kc">true</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">}</code><code class="w"/>&#13;
<code class="p">});</code><code class="w"/>&#13;
&#13;
<code class="kd">const</code><code class="w"> </code><code class="nx">emits</code><code class="w"> </code><code class="o">=</code><code class="w"> </code><code class="nx">defineEmits</code><code class="p">([</code><code class="s1">'task-completed-toggle'</code><code class="p">])</code><code class="w"/>&#13;
&#13;
<code class="kd">const</code><code class="w"> </code><code class="nx">onTaskCompleted</code><code class="w"> </code><code class="o">=</code><code class="w"> </code><code class="p">(</code><code class="nx">event</code><code class="o">:</code><code class="w"> </code><code class="nx">Event</code><code class="p">)</code><code class="w"> </code><code class="p">=&gt;</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">emits</code><code class="p">(</code><code class="s2">"task-completed-toggle"</code><code class="p">,</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">id</code><code class="o">:</code><code class="w"> </code><code class="nx">props</code><code class="p">.</code><code class="nx">task</code><code class="p">.</code><code class="nx">id</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">completed</code><code class="o">:</code><code class="w"> </code><code class="p">(</code><code class="nx">event</code><code class="p">.</code><code class="nx">target</code><code class="w"> </code><code class="kr">as</code><code class="w"> </code><code class="nx">HTMLInputElement</code><code class="p">)</code><code class="o">?</code><code class="p">.</code><code class="nx">checked</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">});</code><code class="w"/>&#13;
<code class="p">}</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>Note here we don’t need to use <code>defineComponent</code> since there is no <code>this</code> instance available within the <code>&lt;script setup&gt;</code> code block.</p>&#13;
&#13;
<p>For better type checking, you can use type-only declaration for the <code>task-completed-toggle</code> event instead of a single string. Let’s improve the <code>emits</code> declaration in <a data-type="xref" href="#example_04_12">Example 4-21</a> to use type <code>EmitEvents</code> as shown in <a data-type="xref" href="#example_04_13">Example 4-22</a><a data-primary="type checking" data-secondary="custom events and" data-type="indexterm" id="id946"/>.</p>&#13;
<div data-type="example" id="example_04_13">&#13;
<h5><span class="label">Example 4-22. </span>Custom event using <code>defineEmits()</code> and type-only declaration</h5>&#13;
&#13;
<pre data-code-language="typescript" data-type="programlisting"><code class="c1">// Declare the emit type</code>&#13;
<code class="kr">type</code> <code class="nx">EmitEvents</code> <code class="o">=</code> <code class="p">{</code>&#13;
  <code class="p">(</code><code class="nx">e</code><code class="o">:</code> <code class="s1">'task-completed-toggle'</code><code class="p">,</code> <code class="nx">task</code><code class="o">:</code> <code class="nx">Task</code><code class="p">)</code><code class="o">:</code> <code class="k">void</code><code class="p">;</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="kr">const</code> <code class="nx">emits</code> <code class="o">=</code> <code class="nx">defineEmits</code><code class="o">&lt;</code><code class="nx">EmitEvents</code><code class="o">&gt;</code><code class="p">()</code></pre></div>&#13;
&#13;
<p>This approach helps ensure you bind the correct method to the declared event. As seen for the <code>task-complete-toggle</code> event, any event declaration should follow the same pattern:</p>&#13;
&#13;
<pre data-type="programlisting">(e: 'component-event', [...arguments]): void</pre>&#13;
&#13;
<p>In the previous syntax, <code>e</code> is the event’s name, and <code>arguments</code> are all the inputs passed to the event emitter. In the case of the <code>task-completed-toggle</code> event, its emitter’s argument is <code>task</code> of type <code>Task</code>.</p>&#13;
&#13;
<p class="pagebreak-before"><code>emits</code> is a powerful feature that allows you to enable two-way communication between a parent and a child component without breaking the data flow mechanism of Vue. However, <code>props</code> and <code>emits</code> are only beneficial when you want direct data communication.</p>&#13;
&#13;
<p>You must use a different approach to pass data from a component to its grandchild or descendant. In the next section, we will see how to use the <code>provide</code> and <code>inject</code> APIs to pass data from a parent component to its child or grandchild component<a data-primary="" data-startref="ix-comp-inter6" data-type="indexterm" id="id947"/><a data-primary="" data-startref="ix-comp-inter6a" data-type="indexterm" id="id948"/><a data-primary="" data-startref="ix-comp-inter6b" data-type="indexterm" id="id949"/><a data-primary="" data-startref="ix-comp-inter6c" data-type="indexterm" id="id950"/><a data-primary="" data-startref="ix-comp-inter6d" data-type="indexterm" id="id951"/><a data-primary="" data-startref="ix-comp-inter6e" data-type="indexterm" id="id952"/><a data-primary="" data-startref="ix-comp-inter7" data-type="indexterm" id="id953"/><a data-primary="" data-startref="ix-comp-inter7a" data-type="indexterm" id="id954"/>.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Communicate Between Components with &#10;provide/inject Pattern" data-type="sect1"><div class="sect1" id="provide_inject_pattern">&#13;
<h1>Communicate Between Components with &#13;
<span class="keep-together">provide/inject Pattern</span></h1>&#13;
&#13;
<p>To establish data communication between an ancestor component and its descendants, the <code>provide/inject</code> API is a reasonable option. The <code>provide</code> field passes data from the ancestor, while <code>inject</code> ensures that Vue injects the provided data into any target descendant<a data-primary="components" data-secondary="provide/inject pattern" data-type="indexterm" id="ix-comp-inter8"/><a data-primary="data" data-secondary="passing dynamic data with provide/inject pattern" data-type="indexterm" id="ix-comp-inter8a"/><a data-primary="inject/provide pattern" data-type="indexterm" id="ix-comp-inter8b"/><a data-primary="provide/inject pattern" data-type="indexterm" id="ix-comp-inter8c"/><a data-primary="this" data-secondary="passing dynamic data with provide/inject pattern" data-type="indexterm" id="ix-comp-inter8d"/>.</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using provide to Pass Data" data-type="sect2"><div class="sect2" id="id357">&#13;
<h2>Using provide to Pass Data</h2>&#13;
&#13;
<p>The component’s option field <code>provide</code> accepts two formats: a data object or a &#13;
<span class="keep-together">function</span>.</p>&#13;
&#13;
<p><code>provide</code> can be an object containing data to inject, with each property representing a (key, value) data type. In the following example, <code>ProductList</code> provides a data value, <code>selectedIds</code>, with the value <code>[1]</code> to all its descendants (<a data-type="xref" href="#example_04_provide">Example 4-23</a>).</p>&#13;
<div data-type="example" id="example_04_provide">&#13;
<h5><span class="label">Example 4-23. </span>Passing <code>selectedIds</code> using provide in <code>ProductList</code> component</h5>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">export</code> <code class="k">default</code> <code class="p">{</code>&#13;
  <code class="nx">name</code><code class="o">:</code> <code class="s1">'ProductList'</code><code class="p">,</code>&#13;
  <code class="c1">//...</code>&#13;
  <code class="nx">provide</code><code class="o">:</code> <code class="p">{</code>&#13;
    <code class="nx">selectedIds</code><code class="o">:</code> <code class="p">[</code><code class="mi">1</code><code class="p">]</code>&#13;
  <code class="p">},</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>Another format type for <code>provide</code> is a function that returns an object containing the data available to inject for descendants. A benefit of this format type is we can access the <code>this</code> instance and map dynamic data or a component method to the relevant fields of the return object. From <a data-type="xref" href="#example_04_provide">Example 4-23</a>, we can rewrite the <code>provide</code> field as a function as shown in <a data-type="xref" href="#example_04_provide_function">Example 4-24</a>.</p>&#13;
<div data-type="example" id="example_04_provide_function">&#13;
<h5><span class="label">Example 4-24. </span>Passing <code>selectedIds</code> using provide in <code>ProductList</code> component as a function</h5>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="kr">export</code> <code class="k">default</code> <code class="p">{</code>&#13;
<code class="c1">//...</code>&#13;
  <code class="nx">provide</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">return</code> <code class="p">{</code>&#13;
      <code class="nx">selectedIds</code><code class="o">:</code> <code class="p">[</code><code class="mi">1</code><code class="p">]</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">},</code>&#13;
<code class="c1">//...</code>&#13;
<code class="p">}</code>&#13;
<code class="o">&lt;</code><code class="err">/script&gt;</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>Unlike <code>props</code>, you can pass a function and have the target descendant trigger it using the <code>provide</code> field. Doing so enables sending data back up to the parent component. However, Vue considers this approach an anti-pattern, and you should use it cautiously.</p>&#13;
</div>&#13;
&#13;
<p>At this point, our <code>ProductList</code> passes some data values to its descendant using &#13;
<span class="keep-together"><code>provide</code></span>. Next, we must inject the provided values to operate within a descendant.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using inject to Receive Data" data-type="sect2"><div class="sect2" id="id62">&#13;
<h2>Using inject to Receive Data</h2>&#13;
&#13;
<p>Like <code>props</code>, the <code>inject</code> field can accept an array of strings, each representing the provided data key (<code>inject: [<em>selectedId</em>]</code>) or an object.</p>&#13;
&#13;
<p>When using <code>inject</code> as an object field, each of its properties is an object, with the key presenting the local data key used within the component and the following &#13;
<span class="keep-together">properties</span>:</p>&#13;
&#13;
<pre data-type="programlisting">{&#13;
  from?: string;&#13;
  default: any&#13;
}</pre>&#13;
&#13;
<p>Here, <code>from</code> is optional if the property key is the same as the provided key from the ancestor. Take <a data-type="xref" href="#example_04_provide">Example 4-23</a> with the <code>selectedIds</code> as the data provided by <code>ProductList</code> to its descendants, for instance. We can compute a <code>ProductComp</code> that receives the provided data, <code>selectedIds</code>, from <code>ProductList</code> and rename it to <code>current</code>&#13;
<span class="keep-together"><code>SelectedIds</code></span> to use locally, as shown in <a data-type="xref" href="#example_04_inject">Example 4-25</a><a data-primary="from, passing data with provide/inject pattern" data-type="indexterm" id="id955"/><a data-primary="key attribute" data-secondary="provide/inject pattern and" data-type="indexterm" id="id956"/>.</p>&#13;
<div data-type="example" id="example_04_inject">&#13;
<h5><span class="label">Example 4-25. </span>Injecting provided data in <code>ProductComp</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">'ts'</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">  </code><code class="c1">//...</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">inject</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">currentSelectedIds</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="kr">from</code><code class="o">:</code><code class="w"> </code><code class="s1">'selectedIds'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="k">default</code><code class="o">:</code><code class="w"> </code><code class="p">[]</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="p">}</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>In this code, Vue will take the value of injected <code>selectedIds</code> and assign it to a local data field, <code>currentSelectedIds</code>, or use its default value <code>[]</code> if there is no injected value.</p>&#13;
&#13;
<p>Within the Components section of the Vue tab in the browser’s Developer Tools, when selecting the <code>ProductComp</code> from the component tree (the left-side panel), you can debug the indication of the renaming for the injected data (the right-side panel), as shown in <a data-type="xref" href="#figure_04_05">Figure 4-6</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_05">&#13;
<img alt="A screenshot shows the Component tab of the Vue tab in the browser's Develop tools with information about a component's provided and injected data." src="assets/lvue_0406.png"/>&#13;
<h6><span class="label">Figure 4-6. </span>Debug the provided and injected data using Vue Devtools</h6>&#13;
</div></figure>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>The equivalent hooks in Composition API for <code>provide/inject</code> are <code>provide()</code> and <code>inject()</code>, respectively<a data-primary="hooks" data-secondary="provide/inject pattern" data-type="indexterm" id="id957"/><a data-primary="inject() hook" data-type="indexterm" id="id958"/><a data-primary="provide() hook" data-type="indexterm" id="id959"/>.</p>&#13;
</div>&#13;
&#13;
<p>Now we understand how to use <code>provide</code> and <code>inject</code> to pass data between components efficiently without props drilling. Let’s explore how we can render a specific content section of an element to another location in the DOM with the <code>&lt;Teleport&gt;</code> component<a data-primary="" data-startref="ix-comp-inter8" data-type="indexterm" id="id960"/><a data-primary="" data-startref="ix-comp-inter8a" data-type="indexterm" id="id961"/><a data-primary="" data-startref="ix-comp-inter8b" data-type="indexterm" id="id962"/><a data-primary="" data-startref="ix-comp-inter8c" data-type="indexterm" id="id963"/><a data-primary="" data-startref="ix-comp-inter8d" data-type="indexterm" id="id964"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Teleport API" data-type="sect1"><div class="sect1" id="id63">&#13;
<h1>Teleport API</h1>&#13;
&#13;
<p>Due to styling constraints, we often need to implement a component that contains elements that Vue should render in a different location in the actual DOM for full visual effect. In such cases, we usually need to “teleport” those elements to the desired place by developing a complex solution, resulting in lousy performance impact, time consumption, etc. To solve this “teleport” challenge, Vue offers the <code>&lt;Teleport&gt;</code> &#13;
<span class="keep-together">component</span><a data-primary="components" data-secondary="Teleport" data-type="indexterm" id="ix-comp-inter9"/><a data-primary="props" data-secondary="Teleport component" data-type="indexterm" id="ix-comp-inter9a"/><a data-primary="Teleport component" data-secondary="using" data-type="indexterm" id="ix-comp-inter9b"/><a data-primary="target" data-secondary="modals with Teleport component" data-type="indexterm" id="id965"/>.</p>&#13;
&#13;
<p>The <code>&lt;Teleport&gt;</code> component accepts a prop <code>to</code>, which indicates the target container, whether an element’s query selector or the desired HTML element. Suppose we have a <code>House</code> component that will have a section of <em>Sky and clouds</em> that needs the Vue engine to teleport it to a designated <code>#sky</code> DOM element, as in <a data-type="xref" href="#example_04_teleport">Example 4-26</a>.</p>&#13;
<div data-type="example" id="example_04_teleport">&#13;
<h5><span class="label">Example 4-26. </span>House component with <code>Teleport</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
    This is a house&#13;
  <code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">Teleport</code> <code class="na">to</code><code class="o">=</code><code class="s">"#sky"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">div</code><code class="p">&gt;</code>Sky and clouds<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">Teleport</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>In our <code>App.vue</code>, we add a <code>section</code> element with the target id <code>sky</code> above the <code>House</code> component, as in <a data-type="xref" href="#example_04_teleport_app">Example 4-27</a>.</p>&#13;
<div data-type="example" id="example_04_teleport_app">&#13;
<h5><span class="label">Example 4-27. </span>Template of <code>App.vue</code> with <code>House</code> component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">section</code> <code class="na">id</code><code class="o">=</code><code class="s">"sky"</code> <code class="p">/&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">section</code> <code class="na">class</code><code class="o">=</code><code class="s">"wrapper"</code><code class="p">&gt;</code>&#13;
      <code class="p">&lt;</code><code class="nt">House</code> <code class="p">/&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">section</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p><a data-type="xref" href="#figure_04_06">Figure 4-7</a> shows the code outputs.</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_06">&#13;
<img alt="Screenshot displaying two texts in the reverse order" src="assets/lvue_0407.png"/>&#13;
<h6><span class="label">Figure 4-7. </span>Actual display order when using the <code>Teleport</code> component</h6>&#13;
</div></figure>&#13;
&#13;
<p>When you inspect the DOM tree using the Elements tab of the browser’s Developer Tools, “Sky and clouds” appears as nested within <code>&lt;section id="sky"&gt;</code> instead (<a data-type="xref" href="#figure_04_07">Figure 4-8</a>)<a data-primary="disabled prop and Teleport" data-type="indexterm" id="id966"/><a data-primary="Teleport component" data-secondary="disabling" data-type="indexterm" id="id967"/>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_07">&#13;
<img alt="Screenshot displaying the DOM tree" src="assets/lvue_0408.png"/>&#13;
<h6><span class="label">Figure 4-8. </span>Actual DOM tree when using the Teleport component</h6>&#13;
</div></figure>&#13;
&#13;
<p>You can also temporarily disable moving the content inside a <code>&lt;Teleport&gt;</code> component instance with its Boolean prop <code>disabled</code>. This component is handy when you want to keep the DOM tree structure, and Vue should move only the desired content to the target location when needed. An everyday use case for <code>Teleport</code> is a modal, which we will implement next.</p>&#13;
<div data-type="warning" epub:type="warning"><h1>Wrapping Both Sections Under a Parent</h1>&#13;
<p>The destination component for teleporting must exist in the DOM before mounting <code>&lt;Teleport&gt;</code>. In <a data-type="xref" href="#example_04_teleport_app">Example 4-27</a>, if you wrap both instances of <code>section</code> under a <code>main</code> element, the <code>&lt;Teleport&gt;</code> component will not work as expected. See <a data-type="xref" href="#rendering-problem-using-teleport">“Rendering Problem Using Teleport”</a> for more details<a data-primary="components" data-secondary="wrapping components and Teleport" data-type="indexterm" id="id968"/>.</p>&#13;
</div>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Implementing a Modal with Teleport and the &lt;dialog&gt; Element" data-type="sect2"><div class="sect2" id="ch04_modal_teleport">&#13;
<h2>Implementing a Modal with Teleport and the &lt;dialog&gt; Element</h2>&#13;
&#13;
<p>A modal is a dialog window that appears on top of a screen and blocks the user’s interaction with the main page. The user must interact with the modal to dismiss it and then returns to the main page<a data-primary="dialog element modals with Teleport component" data-type="indexterm" id="ix-comp-inter10"/><a data-primary="modals" data-type="indexterm" id="ix-comp-inter10a"/><a data-primary="Teleport component" data-secondary="modals and" data-type="indexterm" id="ix-comp-inter10b"/>.</p>&#13;
&#13;
<p>A modal is very handy in displaying essential notifications that require the user’s full attention and should appear only once.</p>&#13;
&#13;
<p>Let’s design a basic modal. Similar to a dialog, a modal should contain the following elements (<a data-type="xref" href="#figure_04_08">Figure 4-9</a>):</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>A backdrop that covers the entire screen where the modal appears on top and blocks the user’s interactions with the current page.</p>&#13;
</li>&#13;
<li>&#13;
<p>A modal window that contains the modal’s content, including a <code>header</code> with a title and a close button, a <code>main</code> content section, and a <code>footer</code> section with a default close button. These three sections should be customizable using slots<a data-primary="footer, modals" data-type="indexterm" id="id969"/><a data-primary="header, modals" data-type="indexterm" id="id970"/><a data-primary="main section, modals" data-type="indexterm" id="id971"/><a data-primary="slots" data-secondary="modals and" data-type="indexterm" id="id972"/>.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<figure><div class="figure" id="figure_04_08">&#13;
<img alt="Screenshot displaying the design of a basic modal." src="assets/lvue_0409.png"/>&#13;
<h6><span class="label">Figure 4-9. </span>Design of a basic modal</h6>&#13;
</div></figure>&#13;
&#13;
<p>Based on the preceding design, we implement a <code>Modal</code> component template using the <code>&lt;dialog&gt;</code> HTML element in <a data-type="xref" href="#example_04_modal">Example 4-28</a>.</p>&#13;
<div data-type="example" id="example_04_modal">&#13;
<h5><span class="label">Example 4-28. </span><code>Modal</code> component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code><code>&#13;
  </code><code class="p">&lt;</code><code class="nt">dialog</code><code> </code><code class="na">:open</code><code class="o">=</code><code class="s">"open"</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="nt">header</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="nt">slot</code><code> </code><code class="na">name</code><code class="o">=</code><code class="s">"m-header"</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_interactions_between_components_CO3-1" id="co_interactions_between_components_CO3-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
        </code><code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code><code>{{ title }}</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">h2</code><code class="p">&gt;</code><code>&#13;
        </code><code class="p">&lt;</code><code class="nt">button</code><code class="p">&gt;</code><code>X</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">button</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">slot</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">header</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="nt">main</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="nt">slot</code><code> </code><code class="na">name</code><code class="o">=</code><code class="s">"m-main"</code><code> </code><code class="p">/</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_interactions_between_components_CO3-2" id="co_interactions_between_components_CO3-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
    </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">main</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="nt">footer</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="nt">slot</code><code> </code><code class="na">name</code><code class="o">=</code><code class="s">"m-footer"</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_interactions_between_components_CO3-3" id="co_interactions_between_components_CO3-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
        </code><code class="p">&lt;</code><code class="nt">button</code><code class="p">&gt;</code><code>Close</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">button</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">slot</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">footer</code><code class="p">&gt;</code><code>&#13;
  </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">dialog</code><code class="p">&gt;</code><code>&#13;
</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>In the preceding code, we use three slot sections to allow the user to customize:</p>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_interactions_between_components_CO3-1" id="callout_interactions_between_components_CO3-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p>The modal’s header (<code>m-header</code>)</p></dd>&#13;
<dt><a class="co" href="#co_interactions_between_components_CO3-2" id="callout_interactions_between_components_CO3-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p>The main content (<code>m-main</code>)</p></dd>&#13;
<dt><a class="co" href="#co_interactions_between_components_CO3-3" id="callout_interactions_between_components_CO3-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p>The modal’s footer (<code>m-footer</code>)</p></dd>&#13;
</dl>&#13;
&#13;
<p>We also bind the <code>&lt;dialog&gt;</code> element’s <code>open</code> attribute to a local data prop <code>open</code> for controlling the modal’s visibility (visible/hidden). In addition, we render the <code>title</code> prop as the modal’s default title<a data-primary="bindings" data-secondary="modal elements" data-type="indexterm" id="id973"/><a data-primary="open attribute, modals" data-type="indexterm" id="id974"/><a data-primary="title, modals" data-type="indexterm" id="id975"/><a data-primary="props" data-secondary="modals" data-type="indexterm" id="id976"/>. Now, let’s implement the <code>Modal</code> component’s options, which receive two props: <code>open</code> and <code>title</code> as in <a data-type="xref" href="#example_04_modal_props">Example 4-29</a>.</p>&#13;
<div data-type="example" id="example_04_modal_props">&#13;
<h5><span class="label">Example 4-29. </span>Adding props to <code>Modal</code> component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'Modal'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">props</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">open</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">type</code><code class="o">:</code><code class="w"> </code><code class="nb">Boolean</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="k">default</code><code class="o">:</code><code class="w"> </code><code class="kc">false</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">title</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">type</code><code class="o">:</code><code class="w"> </code><code class="nb">String</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">      </code><code class="k">default</code><code class="o">:</code><code class="w"> </code><code class="s1">'Dialog'</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="p">})</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>When a user clicks on the modal’s close button or the “X” button on the header, it should close itself. Since we control the visibility of the modal using the <code>open</code> prop, we need to emit a <code>closeDialog</code> event with the new value of <code>open</code> from the <code>Modal</code> component to the parent. Let’s declare <code>emits</code> and a <code>close</code> method that emits the target event as in <a data-type="xref" href="#example_04_modal_emits">Example 4-30</a><a data-primary="close(), modals" data-type="indexterm" id="id977"/><a data-primary="emits" data-secondary="modals" data-type="indexterm" id="id978"/><a data-primary="emitters, event" data-secondary="modals" data-type="indexterm" id="id979"/><a data-primary="events" data-secondary="modals" data-type="indexterm" id="id980"/>.</p>&#13;
<div data-type="example" id="example_04_modal_emits">&#13;
<h5><span class="label">Example 4-30. </span>Declaring the event <code>closeDialog</code> for <code>Modal</code> to emit</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">script</code><code> </code><code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w">&#13;
</code><code class="cm">/** Modal.vue */</code><code class="w">&#13;
</code><code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s1">'vue'</code><code class="w">&#13;
&#13;
</code><code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">(</code><code class="p">{</code><code class="w">&#13;
  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s1">'Modal'</code><code class="p">,</code><code class="w">&#13;
  </code><code class="c1">//...</code><code class="w">&#13;
  </code><code class="nx">emits</code><code class="o">:</code><code class="w"> </code><code class="p">[</code><code class="s2">"closeDialog"</code><code class="p">]</code><code class="p">,</code><code class="w"> </code><a class="co" href="#callout_interactions_between_components_CO4-1" id="co_interactions_between_components_CO4-1"><img alt="1" src="assets/1.png"/></a><code class="w">&#13;
  </code><code class="nx">methods</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w">&#13;
    </code><code class="nx">close</code><code class="p">(</code><code class="p">)</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><a class="co" href="#callout_interactions_between_components_CO4-2" id="co_interactions_between_components_CO4-2"><img alt="2" src="assets/2.png"/></a><code class="w">&#13;
      </code><code class="k">this</code><code class="p">.</code><code class="nx">$emit</code><code class="p">(</code><code class="s2">"closeDialog"</code><code class="p">,</code><code class="w"> </code><code class="kc">false</code><code class="p">)</code><code class="p">;</code><code class="w">&#13;
    </code><code class="p">}</code><code class="p">,</code><code class="w">&#13;
  </code><code class="p">}</code><code class="p">,</code><code class="w">&#13;
</code><code class="p">}</code><code class="p">)</code><code class="w">&#13;
</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_interactions_between_components_CO4-1" id="callout_interactions_between_components_CO4-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p><code>emits</code> with one event, <code>closeDialog</code></p></dd>&#13;
<dt><a class="co" href="#co_interactions_between_components_CO4-2" id="callout_interactions_between_components_CO4-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p><code>close</code> method that emits the <code>closeDialog</code> event with the new value of <code>open</code> as <code>false</code></p></dd>&#13;
</dl>&#13;
&#13;
<p>Then we bind it to the relevant action elements in the <code>&lt;dialog&gt;</code> element using <code>@</code> notation, as shown in <a data-type="xref" href="#example_04_modal_close">Example 4-31</a>.</p>&#13;
<div data-type="example" id="example_04_modal_close">&#13;
<h5><span class="label">Example 4-31. </span>Binding event listener on click events</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code><code>&#13;
  </code><code class="p">&lt;</code><code class="nt">dialog</code><code> </code><code class="na">:open</code><code class="o">=</code><code class="s">"open"</code><code> </code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="nt">header</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="nt">slot</code><code> </code><code class="na">name</code><code class="o">=</code><code class="s">"m-header"</code><code> </code><code class="p">&gt;</code><code>&#13;
        </code><code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code><code>{{ title }}</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">h2</code><code class="p">&gt;</code><code>&#13;
        </code><code class="p">&lt;</code><code class="nt">button</code><code> </code><code class="err">@</code><code class="na">click</code><code class="o">=</code><code class="s">"close"</code><code> </code><code class="p">&gt;</code><code>X</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">button</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_interactions_between_components_CO5-1" id="co_interactions_between_components_CO5-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
      </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">slot</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">header</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="nt">main</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="nt">slot</code><code> </code><code class="na">name</code><code class="o">=</code><code class="s">"m-main"</code><code> </code><code class="p">/</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">main</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="nt">footer</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="nt">slot</code><code> </code><code class="na">name</code><code class="o">=</code><code class="s">"m-footer"</code><code> </code><code class="p">&gt;</code><code>&#13;
        </code><code class="p">&lt;</code><code class="nt">button</code><code> </code><code class="err">@</code><code class="na">click</code><code class="o">=</code><code class="s">"close"</code><code> </code><code class="p">&gt;</code><code>Close</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">button</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_interactions_between_components_CO5-2" id="co_interactions_between_components_CO5-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
      </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">slot</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">footer</code><code class="p">&gt;</code><code>&#13;
  </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">dialog</code><code class="p">&gt;</code><code>&#13;
</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_interactions_between_components_CO5-1" id="callout_interactions_between_components_CO5-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p><code>@click</code> event handler for the “X” button on the header</p></dd>&#13;
<dt><a class="co" href="#co_interactions_between_components_CO5-2" id="callout_interactions_between_components_CO5-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p><code>@click</code> event handler for the default close button on the footer</p></dd>&#13;
</dl>&#13;
&#13;
<p>Next, we need to wrap the <code>dialog</code> element with a <code>&lt;Teleport&gt;</code> component to move it outside the parent component’s DOM tree. We also pass the <code>to</code> prop to the &#13;
<span class="keep-together"><code>&lt;Teleport&gt;</code></span> component to specify the target location: an HTML element with an id, <code>modal</code>. Finally, we bind the <code>disabled</code> prop to the component’s <code>open</code> value to ensure Vue moves only the modal component content to the desired location when visible (<a data-type="xref" href="#example_04_modal_teleport">Example 4-32</a>).</p>&#13;
<div data-type="example" id="example_04_modal_teleport">&#13;
<h5><span class="label">Example 4-32. </span>Using <code>&lt;Teleport&gt;</code> component</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code><code>&#13;
  </code><code class="p">&lt;</code><code class="nt">teleport</code><code> </code><a class="co" href="#callout_interactions_between_components_CO6-1" id="co_interactions_between_components_CO6-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
    </code><code class="na">to</code><code class="o">=</code><code class="s">"#modal"</code><code> </code><a class="co" href="#callout_interactions_between_components_CO6-2" id="co_interactions_between_components_CO6-2"><img alt="2" src="assets/2.png"/></a><code>&#13;
    </code><code class="na">:disabled</code><code class="o">=</code><code class="s">"!open"</code><code> </code><a class="co" href="#callout_interactions_between_components_CO6-3" id="co_interactions_between_components_CO6-3"><img alt="3" src="assets/3.png"/></a><code>&#13;
  </code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="nt">dialog</code><code> </code><code class="na">ref</code><code class="o">=</code><code class="s">"dialog"</code><code> </code><code class="na">:open</code><code class="o">=</code><code class="s">"open"</code><code> </code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="nt">header</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="nt">slot</code><code> </code><code class="na">name</code><code class="o">=</code><code class="s">"m-header"</code><code class="p">&gt;</code><code>&#13;
        </code><code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code><code>{{ title }}</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">h2</code><code class="p">&gt;</code><code>&#13;
        </code><code class="p">&lt;</code><code class="nt">button</code><code> </code><code class="err">@</code><code class="na">click</code><code class="o">=</code><code class="s">"close"</code><code> </code><code class="p">&gt;</code><code>X</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">button</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">slot</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">header</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="nt">main</code><code class="p">&gt;</code><code>&#13;
        </code><code class="p">&lt;</code><code class="nt">slot</code><code> </code><code class="na">name</code><code class="o">=</code><code class="s">"m-main"</code><code> </code><code class="p">/</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">main</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="nt">footer</code><code class="p">&gt;</code><code>&#13;
        </code><code class="p">&lt;</code><code class="nt">slot</code><code> </code><code class="na">name</code><code class="o">=</code><code class="s">"m-footer"</code><code class="p">&gt;</code><code>&#13;
          </code><code class="p">&lt;</code><code class="nt">button</code><code> </code><code class="err">@</code><code class="na">click</code><code class="o">=</code><code class="s">"close"</code><code> </code><code class="p">&gt;</code><code>Close</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">button</code><code class="p">&gt;</code><code>&#13;
        </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">slot</code><code class="p">&gt;</code><code>&#13;
      </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">footer</code><code class="p">&gt;</code><code>&#13;
    </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">dialog</code><code class="p">&gt;</code><code>&#13;
  </code><code class="p">&lt;</code><code class="p">/</code><code class="nt">teleport</code><code class="p">&gt;</code><code>&#13;
</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">template</code><code class="p">&gt;</code></pre></div>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_interactions_between_components_CO6-1" id="callout_interactions_between_components_CO6-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p><code>&lt;Teleport&gt;</code> component</p></dd>&#13;
<dt><a class="co" href="#co_interactions_between_components_CO6-2" id="callout_interactions_between_components_CO6-2"><img alt="2" src="assets/2.png"/></a></dt>&#13;
<dd><p><code>to</code> prop with the target location with id selector <code>modal</code></p></dd>&#13;
<dt><a class="co" href="#co_interactions_between_components_CO6-3" id="callout_interactions_between_components_CO6-3"><img alt="3" src="assets/3.png"/></a></dt>&#13;
<dd><p><code>disabled</code> prop with the condition when component’s <code>open</code> value is falsy</p></dd>&#13;
</dl>&#13;
&#13;
<p>Now let’s try out our <code>Modal</code> component in a <code>WithModalComponent</code> by adding the following code in <a data-type="xref" href="#with_modal_component_04">Example 4-33</a> to the <code>WithModalComponent</code>.</p>&#13;
<div data-type="example" id="with_modal_component_04">&#13;
<h5><span class="label">Example 4-33. </span>Using modal component in <code>WithModalComponent</code></h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code>With Modal component<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">button</code> <code class="err">@</code><code class="na">click</code><code class="o">=</code><code class="s">"openModal = true"</code><code class="p">&gt;</code>Open modal<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">Modal</code> <code class="na">:open</code><code class="o">=</code><code class="s">"openModal"</code> <code class="na">title</code><code class="o">=</code><code class="s">"Hello World"</code> <code class="err">@</code><code class="na">closeDialog</code><code class="o">=</code><code class="s">"toggleModal"</code><code class="p">/&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">script</code> <code class="na">lang</code><code class="o">=</code><code class="s">"ts"</code><code class="p">&gt;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="p">{</code><code class="w"> </code><code class="nx">defineComponent</code><code class="w"> </code><code class="p">}</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s2">"vue"</code><code class="p">;</code><code class="w"/>&#13;
<code class="k">import</code><code class="w"> </code><code class="nx">Modal</code><code class="w"> </code><code class="kr">from</code><code class="w"> </code><code class="s2">"./Modal.vue"</code><code class="p">;</code><code class="w"/>&#13;
&#13;
<code class="k">export</code><code class="w"> </code><code class="k">default</code><code class="w"> </code><code class="nx">defineComponent</code><code class="p">({</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">name</code><code class="o">:</code><code class="w"> </code><code class="s2">"WithModalComponent"</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">components</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">Modal</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">data</code><code class="p">()</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="k">return</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="nx">openModal</code><code class="o">:</code><code class="w"> </code><code class="kc">false</code><code class="p">,</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">};</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="nx">methods</code><code class="o">:</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">    </code><code class="nx">toggleModal</code><code class="p">(</code><code class="nx">newValue</code><code class="o">:</code><code class="w"> </code><code class="kr">boolean</code><code class="p">)</code><code class="w"> </code><code class="p">{</code><code class="w"/>&#13;
<code class="w">      </code><code class="k">this</code><code class="p">.</code><code class="nx">openModal</code><code class="w"> </code><code class="o">=</code><code class="w"> </code><code class="nx">newValue</code><code class="p">;</code><code class="w"/>&#13;
<code class="w">    </code><code class="p">},</code><code class="w"/>&#13;
<code class="w">  </code><code class="p">},</code><code class="w"/>&#13;
<code class="p">});</code><code class="w"/>&#13;
<code class="p">&lt;/</code><code class="nt">script</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>Finally, add a <code>&lt;div&gt;</code> element with id <code>modal</code> to the <code>body</code> element in the <code>index.html</code> file:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">body</code><code class="p">&gt;</code><code>&#13;
  </code><code class="p">&lt;</code><code class="nt">div</code><code> </code><code class="na">id</code><code class="o">=</code><code class="s">"app"</code><code class="p">&gt;</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">div</code><code class="p">&gt;</code><code>&#13;
  </code><code class="p">&lt;</code><code class="nt">div</code><code> </code><code class="na">id</code><code class="o">=</code><code class="s">"modal"</code><code class="p">&gt;</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">div</code><code class="p">&gt;</code><code> </code><a class="co" href="#callout_interactions_between_components_CO7-1" id="co_interactions_between_components_CO7-1"><img alt="1" src="assets/1.png"/></a><code>&#13;
  </code><code class="p">&lt;</code><code class="nt">script</code><code> </code><code class="na">type</code><code class="o">=</code><code class="s">"module"</code><code> </code><code class="na">src</code><code class="o">=</code><code class="s">"/src/main.ts"</code><code class="p">&gt;</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">script</code><code class="p">&gt;</code><code>&#13;
</code><code class="p">&lt;</code><code class="p">/</code><code class="nt">body</code><code class="p">&gt;</code></pre>&#13;
<dl class="calloutlist">&#13;
<dt><a class="co" href="#co_interactions_between_components_CO7-1" id="callout_interactions_between_components_CO7-1"><img alt="1" src="assets/1.png"/></a></dt>&#13;
<dd><p><code>div</code> element with id <code>modal</code></p></dd>&#13;
</dl>&#13;
&#13;
<p>By doing so, Vue renders the <code>Modal</code> component’s content to this <code>div</code> with id <code>modal</code> whenever the <code>open</code> prop is set to <code>true</code> (<a data-type="xref" href="#figure_04_09">Figure 4-10</a>)<a data-primary="rendering" data-secondary="modals" data-type="indexterm" id="id981"/>.</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_09">&#13;
<img alt="Modal component rendered to the +div+ with id +modal+ when visible" src="assets/lvue_0410.png"/>&#13;
<h6><span class="label">Figure 4-10. </span>Modal component rendered to the <code>div</code> with id <code>modal</code> when visible</h6>&#13;
</div></figure>&#13;
&#13;
<p><a data-type="xref" href="#figure_04_13">Figure 4-11</a> shows how it looks on screen:</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_13">&#13;
<img alt="Output of the +WithModalComponent+ when modal is visible" src="assets/lvue_0411.png"/>&#13;
<h6><span class="label">Figure 4-11. </span>Output of the <code>WithModalComponent</code> when modal is visible</h6>&#13;
</div></figure>&#13;
&#13;
<p>And when the <code>open</code> prop is <code>false</code>, the <code>div</code> with id <code>modal</code> is empty (<a data-type="xref" href="#figure_04_10">Figure 4-12</a>), and the modal is invisible on screen (<a data-type="xref" href="#figure_04_14">Figure 4-13</a>).</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_10">&#13;
<img alt="Modal component not rendered to the +div+ with id +modal+ when hidden" src="assets/lvue_0412.png"/>&#13;
<h6><span class="label">Figure 4-12. </span>Modal component not rendered to the <code>div</code> with id <code>modal</code> when hidden</h6>&#13;
</div></figure>&#13;
&#13;
<figure><div class="figure" id="figure_04_14">&#13;
<img alt="Modal component not visible when hidden" src="assets/lvue_0413.png"/>&#13;
<h6><span class="label">Figure 4-13. </span>Modal component not visible when hidden</h6>&#13;
</div></figure>&#13;
&#13;
<p>At this point, you have a working modal component. However, the visual appearance of the modal isn’t exactly as good as we wanted; there should be a dark overlay over the main page content when the modal is visible. Let’s fix this issue using CSS stylings for <code>::backdrop</code> selector in the <code>&lt;style&gt;</code> section of the modal element<a data-primary="::backdrop selector" data-primary-sortas="backdrop selector" data-type="indexterm" id="id982"/><a data-primary="style" data-secondary="modals" data-type="indexterm" id="id983"/>:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">style</code> <code class="na">scoped</code><code class="p">&gt;</code>&#13;
  <code class="nt">dialog</code><code class="nd">::backdrop</code> <code class="p">{</code>&#13;
    <code class="k">background-color</code><code class="o">:</code> <code class="n">rgba</code><code class="p">(</code><code class="m">0</code><code class="o">,</code> <code class="m">0</code><code class="o">,</code> <code class="m">0</code><code class="o">,</code> <code class="m">0</code><code class="o">.</code><code class="m">5</code><code class="p">);</code>&#13;
  <code class="p">}</code>&#13;
<code class="nt">&lt;/style&gt;</code></pre>&#13;
&#13;
<p>However, this won’t change the appearance of the modal’s backdrop. This behavior is because the browser applies the <code>::backdrop</code> CSS selector rules to the dialog only when we open the dialog using <code>dialog.showModal()</code> method, and not by changing the <code>open</code> attribute. To fix this issue, we need to perform the following modifications in our <code>Modal</code> component<a data-primary="showModal()" data-type="indexterm" id="id984"/>:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Add a direct reference to the <code>&lt;dialog&gt;</code> element by assigning a “dialog” value to the <code>ref</code> attribute:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">dialog</code> <code class="na">:open</code><code class="o">=</code><code class="s">"open"</code> <code class="na">ref</code><code class="o">=</code><code class="s">"dialog"</code><code class="p">&gt;</code>&#13;
  <code class="cm">&lt;!--...--&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">dialog</code><code class="p">&gt;</code></pre>&#13;
</li>&#13;
<li>&#13;
<p>Trigger <code>$refs.dialog.showModal()</code> or <code>$refs.dialog.close()</code> on the <code>dialog</code> element whenever the <code>open</code> prop changes respectively with <code>watch</code>:</p>&#13;
&#13;
<pre data-code-language="js" data-type="programlisting"><code class="nx">watch</code><code class="o">:</code> <code class="p">{</code>&#13;
  <code class="nx">open</code><code class="p">(</code><code class="nx">newValue</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="kr">const</code> <code class="nx">element</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">$refs</code><code class="p">.</code><code class="nx">dialog</code> <code class="nx">as</code> <code class="nx">HTMLDialogElement</code><code class="p">;</code>&#13;
    <code class="k">if</code> <code class="p">(</code><code class="nx">newValue</code><code class="p">)</code> <code class="p">{</code>&#13;
      <code class="nx">element</code><code class="p">.</code><code class="nx">showModal</code><code class="p">();</code>&#13;
    <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>&#13;
      <code class="nx">element</code><code class="p">.</code><code class="nx">close</code><code class="p">();</code>&#13;
    <code class="p">}</code>&#13;
  <code class="p">},</code>&#13;
<code class="p">},</code></pre>&#13;
</li>&#13;
<li>&#13;
<p>Remove the original binding for the <code>open</code> attribute of the <code>&lt;dialog&gt;</code> element:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">dialog</code> <code class="na">ref</code><code class="o">=</code><code class="s">"dialog"</code><code class="p">&gt;</code>&#13;
  <code class="cm">&lt;!--...--&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">dialog</code><code class="p">&gt;</code></pre>&#13;
</li>&#13;
<li>&#13;
<p>Remove the use of the <code>disabled</code> attribute in the <code>&lt;teleport&gt;</code> component:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">teleport</code> <code class="na">to</code><code class="o">=</code><code class="s">"#modal"</code><code class="p">&gt;</code>&#13;
  <code class="cm">&lt;!--...--&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">teleport</code><code class="p">&gt;</code></pre>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>When opening the modal using the built-in <code>showModal()</code> method, the browser will add a <code>::backdrop</code> pseudo-element to the actual <code>&lt;dialog&gt;</code> element in the DOM, and dynamically moving the element content to the target location will disable this functionality, leaving the modal without the desired backdrop.</p>&#13;
&#13;
<p>We also reposition the modal to the center of the page and on top of other elements by adding the following CSS rules to the <code>dialog</code> selector:</p>&#13;
&#13;
<pre data-code-language="css" data-type="programlisting"><code class="nt">dialog</code> <code class="p">{</code>&#13;
  <code class="k">position</code><code class="o">:</code> <code class="nb">fixed</code><code class="p">;</code>&#13;
  <code class="k">z-index</code><code class="o">:</code> <code class="m">999</code><code class="p">;</code>&#13;
  <code class="nb">inset</code><code class="o">-</code><code class="nb">block</code><code class="o">-</code><code class="n">start</code><code class="o">:</code> <code class="m">30%</code><code class="p">;</code>&#13;
  <code class="nb">inset</code><code class="o">-</code><code class="nb">inline</code><code class="o">-</code><code class="n">start</code><code class="o">:</code> <code class="m">50%</code><code class="p">;</code>&#13;
  <code class="k">width</code><code class="o">:</code> <code class="m">300px</code><code class="p">;</code>&#13;
  <code class="n">margin</code><code class="o">-</code><code class="nb">inline</code><code class="o">-</code><code class="n">start</code><code class="o">:</code> <code class="m">-150px</code><code class="p">;</code>&#13;
<code class="p">}</code></pre>&#13;
&#13;
<p>The output will be as shown in <a data-type="xref" href="#figure_04_11">Figure 4-14</a> when the modal is visible.</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_11">&#13;
<img alt="Modal component with backdrop and stylings" src="assets/lvue_0414.png"/>&#13;
<h6><span class="label">Figure 4-14. </span>Modal component with backdrop and stylings</h6>&#13;
</div></figure>&#13;
&#13;
<p>We have learned how to implement a reusable <code>Modal</code> component using <code>Teleport</code> and explored different use cases with each of the built-in <code>&lt;dialog&gt;</code> element features. We also learned how to use the <code>::backdrop</code> CSS selector to style the modal’s backdrop<a data-primary="target" data-secondary="modals with Teleport component" data-type="indexterm" id="ix-comp-inter11"/>.</p>&#13;
&#13;
<p>As you have noticed, we set the target location <code>div</code> for the modal to be a direct child of <code>body</code>, outside of the Vue app entry element <code>&lt;div id="app"&gt;</code>. What happens if we want to move the modal’s target <code>div</code> to within the entry component <code>App.vue</code> of the Vue application? Let’s find out in the next section.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Rendering Problem Using Teleport" data-type="sect2"><div class="sect2" id="rendering-problem-using-teleport">&#13;
<h2>Rendering Problem Using Teleport</h2>&#13;
&#13;
<p>To understand the problem with using <code>Teleport</code> to render the modal inside a child component of the <code>App.vue</code> component, let’s first move the <code>&lt;div id="modal"&gt;&lt;/div&gt;</code> from <code>index.html</code> to <code>App.vue</code>, after the <code>WithModalComponent</code> instance<a data-primary="rendering" data-secondary="modals" data-type="indexterm" id="id985"/><a data-primary="rendering" data-secondary="Teleport component and" data-type="indexterm" id="id986"/><a data-primary="Teleport component" data-secondary="rendering issues" data-type="indexterm" id="id987"/>:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">section</code> <code class="na">class</code><code class="o">=</code><code class="s">"wrapper"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">WithModalComponent</code> <code class="p">/&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">section</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"modal"</code><code class="p">&gt;&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre>&#13;
&#13;
<p>After running your application, you can see that the browser doesn’t render the modal despite how often you click on the <code>Open modal</code> button. And the console shows the following error:</p>&#13;
&#13;
<figure><div class="figure" id="figure_04_15">&#13;
<img alt="Error message when rendering modal inside App.vue" src="assets/lvue_0415.png"/>&#13;
<h6><span class="label">Figure 4-15. </span>Console error message when rendering modal inside <code>App.vue</code></h6>&#13;
</div></figure>&#13;
&#13;
<p>Due to the Vue rendering order mechanism, the parent waits for the children to render before rendering itself. The children render in the order of appearance in the parent’s <code>template</code> section. In this scenario, the <code>WithModalComponent</code> renders first. Thus Vue renders the <code>&lt;dialog&gt;</code> element and starts moving the component’s content to the target location before rendering the <code>ParentComponent</code>. However, since the <code>ParentComponent</code> is still waiting for <code>WithModalComponent</code> to finish its rendering, the <code>&lt;div id="modal"&gt;</code> element doesn’t yet exist on the DOM. As a result, Vue can’t locate the target location and perform the right move, and it can’t render the <code>&lt;dialog&gt;</code> element inside the <code>&lt;div id="modal"&gt;</code> element, hence the error<a data-primary="order" data-secondary="rendering and Teleport component" data-type="indexterm" id="id988"/>.</p>&#13;
&#13;
<p>A workaround to bypass this limitation is to put the target element &#13;
<span class="keep-together"><code>&lt;div id="modal"&gt;</code></span> to appear before <code>WithModalComponent</code>:</p>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">template</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"modal"</code><code class="p">&gt;&lt;/</code><code class="nt">div</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">section</code> <code class="na">class</code><code class="o">=</code><code class="s">"wrapper"</code><code class="p">&gt;</code>&#13;
    <code class="p">&lt;</code><code class="nt">WithModalComponent</code> <code class="p">/&gt;</code>&#13;
  <code class="p">&lt;/</code><code class="nt">section</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">template</code><code class="p">&gt;</code></pre>&#13;
&#13;
<p>This solution ensures the target <code>div</code> is available before Vue renders the <code>Modal</code> element and moves the content. Another approach is to use the <code>disabled</code> attribute to postpone the content moving process for <code>Modal</code> during rendering until the user clicks on the <code>Open modal</code> button. Both options have pros and cons, and you should choose the one that best suits your needs<a data-primary="disabled prop and Teleport" data-type="indexterm" id="id989"/>.</p>&#13;
&#13;
<p>The most common solution is to insert the target element as a direct child of the <code>body</code> element and isolate it from the Vue rendering context.</p>&#13;
&#13;
<p>A significant benefit of using <code>&lt;Teleport&gt;</code> is achieving the maximum visual display effect (such as fullscreen mode, modal, sidebar, etc.) while maintaining the code hierarchy structure, component isolation, and readability<a data-primary="" data-startref="ix-comp-inter9" data-type="indexterm" id="id990"/><a data-primary="" data-startref="ix-comp-inter9" data-type="indexterm" id="id991"/><a data-primary="" data-startref="ix-comp-inter9a" data-type="indexterm" id="id992"/><a data-primary="" data-startref="ix-comp-inter9b" data-type="indexterm" id="id993"/><a data-primary="" data-startref="ix-comp-inter10" data-type="indexterm" id="id994"/><a data-primary="" data-startref="ix-comp-inter10a" data-type="indexterm" id="id995"/><a data-primary="" data-startref="ix-comp-inter10b" data-type="indexterm" id="id996"/><a data-primary="" data-startref="ix-comp-inter11" data-type="indexterm" id="id997"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Summary" data-type="sect1"><div class="sect1" id="id358">&#13;
<h1>Summary</h1>&#13;
&#13;
<p>This chapter explored the concept of different approaches in components’ communication using the built-in Vue features such as <code>props</code>, <code>emits</code>, and <code>provide/inject</code>. We learned how to use these features to pass data and events between components while keeping Vue’s data flow mechanism intact. We also learned how to use Teleport API to render an element outside the parent component’s DOM tree while keeping its appearance order in the parent component’s <code>&lt;template&gt;</code>. <code>&lt;Teleport&gt;</code> is beneficial for building components that require displaying with alignment to the main page element, such as popups, dialogs, modals, etc.</p>&#13;
&#13;
<p>In the next chapter, we will explore more on Composition API and how to use it to compose Vue components together.</p>&#13;
</div></section>&#13;
</div></section></body></html>