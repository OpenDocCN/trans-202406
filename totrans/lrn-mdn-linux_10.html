<html><head></head><body><div id="sbo-rt-content"><section data-type="appendix" epub:type="appendix" data-pdf-bookmark="Appendix A. Helpful Recipes"><div class="appendix" id="appendix-howto">
<h1><span class="label">Appendix A. </span>Helpful Recipes</h1>


<p>In this appendix, I’ve compiled a list of recipes for common tasks. This is
just a selection of recipes that I’ve gathered over time, tasks that I often
carry out and like to have handy as a reference. By no means is this a complete
or deep coverage of Linux usage and admin tasks. For a comprehensive
collection of recipes, I strongly recommend you check out Carla Schroder’s
<a class="orm:hideurl" href="https://oreil.ly/53Pk9"><em>Linux Cookbook</em></a> (O’Reilly), covering a range of recipes in great detail.</p>






<section data-type="sect1" data-pdf-bookmark="Gathering System Information"><div class="sect1" id="idm45805425173232">
<h1>Gathering System Information</h1>

<p><a data-type="indexterm" data-primary="system information, gathering" id="idm45805425171680"/>To learn about the Linux version, kernel, and other related information, use
any of the following commands:</p>

<pre data-type="programlisting" data-code-language="shell">cat /etc/*-release
cat /proc/version
uname -a</pre>

<p>To learn about basic hardware equipment (CPU, RAM, disks), do:</p>

<pre data-type="programlisting" data-code-language="shell">cat /proc/cpuinfo
cat /proc/meminfo
cat /proc/diskstats</pre>

<p>To learn more about the hardware of your system, such as about the BIOS, use:</p>

<pre data-type="programlisting" data-code-language="shell">sudo dmidecode -t bios</pre>

<p>Note for the previous command: other interesting options for <code>-t</code> include
<code>system</code> and <code>memory</code>.</p>

<p>To query overall main memory and swap usage, do:</p>

<pre data-type="programlisting" data-code-language="shell">free -ht</pre>

<p>To query how many file descriptors a process can have, use:</p>

<pre data-type="programlisting" data-code-language="shell"><code class="nb">ulimit</code> -n</pre>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Working with Users and Processes"><div class="sect1" id="idm45805425172560">
<h1>Working with Users and Processes</h1>

<p><a data-type="indexterm" data-primary="users" data-secondary="listing" id="idm45805425107680"/>You can list logged-in users with either <code>who</code> or <code>w</code> (more detailed output).</p>

<p>To show system metrics (CPU, memory, etc.) on a per-process basis for a specific
user, <code>SOMEUSER</code>, use the following command:</p>

<pre data-type="programlisting" data-code-language="shell">top -U SOMEUSER</pre>

<p><a data-type="indexterm" data-primary="process" data-secondary="listing" id="idm45805425094336"/>List all processes (for all users) in tree format with details by using:</p>

<pre data-type="programlisting" data-code-language="shell">ps faux</pre>

<p>Find a specific process (<code>python</code> here):</p>

<pre data-type="programlisting" data-code-language="shell">ps -e <code class="p">|</code> grep python</pre>

<p>To terminate a process, use its PID if you know it (and add <code>-9</code> as a
parameter if the process ignores this signal):</p>

<pre data-type="programlisting" data-code-language="shell"><code class="nb">kill</code><code> </code><em><code>PID</code></em></pre>

<p>Alternatively, you can terminate a process by name using <code>killall</code>.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Gathering File Information"><div class="sect1" id="idm45805425108528">
<h1>Gathering File Information</h1>

<p><a data-type="indexterm" data-primary="file information, gathering" id="idm45805425011216"/>To query file details (including filesystem information such as inodes):</p>

<pre data-type="programlisting" data-code-language="shell"><code>stat</code><code> </code><em><code>somefile</code></em></pre>

<p>To learn about a command, how the shell interprets it, and where the
executable file is located, use:</p>

<pre data-type="programlisting" data-code-language="shell"><code class="nb">type</code><code> </code><em><code>somecommand</code></em><code>
</code><code>which</code><code> </code><em><code>somebinary</code></em></pre>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Working with Files and Directories"><div class="sect1" id="idm45805424951024">
<h1>Working with Files and Directories</h1>

<p><a data-type="indexterm" data-primary="files, working with" id="idm45805424949712"/>To display the content of a text file called <code>afile</code>:</p>

<pre data-type="programlisting" data-code-language="shell">cat afile</pre>

<p><a data-type="indexterm" data-primary="directories, working with" id="idm45805424948016"/>To list the contents of a directory, use <code>ls</code>, and you may wish to further
use the output. For example, to count the number of files in a directory, use:</p>

<pre data-type="programlisting" data-code-language="shell">ls -l /etc <code class="p">|</code>  wc -l</pre>

<p class="pagebreak-before">Finding files and file content:</p>

<pre data-type="programlisting" data-code-language="shell"><code>find</code><code> </code><code>/etc</code><code> </code><code>-name</code><code> </code><code class="s2">"*.conf"</code><code> </code><a class="co" id="co_helpful_recipes_CO1-1" href="#callout_helpful_recipes_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code>find</code><code> </code><code>.</code><code> </code><code>-type</code><code> </code><code>f</code><code> </code><code>-exec</code><code> </code><code>grep</code><code> </code><code>-H</code><code> </code><code>FINDME</code><code> </code><code class="o">{</code><code class="o">}</code><code> </code><code class="se">\;</code><code> </code><a class="co" id="co_helpful_recipes_CO1-2" href="#callout_helpful_recipes_CO1-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_helpful_recipes_CO1-1" href="#co_helpful_recipes_CO1-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Find files ending in <em>.conf</em> in directory <em>/etc</em>.</p></dd>
<dt><a class="co" id="callout_helpful_recipes_CO1-2" href="#co_helpful_recipes_CO1-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Find “FINDME” in current directory by executing <code>grep</code>.</p></dd>
</dl>

<p>To show the differences in files, use:</p>

<pre data-type="programlisting" data-code-language="shell"><code>diff</code><code> </code><code>-u</code><code> </code><em><code>somefile</code></em><code> </code><em><code>anotherfile</code></em></pre>

<p>To replace characters, use <code>tr</code> like so:</p>

<pre data-type="programlisting" data-code-language="shell"><code class="nb">echo</code> <code class="s1">'Com_Acme_Library'</code> <code class="p">|</code> tr <code class="s1">'_A-Z'</code> <code class="s1">'.a-z'</code></pre>

<p>Another way to replace parts of a string is with <code>sed</code> (note that the delimiter
doesn’t have to be <code>/</code>, which is handy for cases where you replace content in a
path or URL):</p>

<pre data-type="programlisting" data-code-language="shell">cat <code class="s1">'foo bar baz'</code> <code class="p">|</code> sed -e <code class="s1">'s/foo/quux/'</code></pre>

<p>To create a file of a specific size (for testing), you can use the <code>dd</code> command,
as shown here:</p>

<pre data-type="programlisting" data-code-language="shell"><code>dd</code><code> </code><code class="k">if</code><code class="o">=</code><code>/dev/zero</code><code> </code><code class="nv">of</code><code class="o">=</code><code>output.dat</code><code> </code><code class="nv">bs</code><code class="o">=</code><code class="m">1024</code><code> </code><code class="nv">count</code><code class="o">=</code><code class="m">1000</code><code> </code><a class="co" id="co_helpful_recipes_CO2-1" href="#callout_helpful_recipes_CO2-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" id="callout_helpful_recipes_CO2-1" href="#co_helpful_recipes_CO2-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>This creates a 1 MB file (1,000 times 1 KB blocks) called <em>output.dat</em>
that is filled with zeros.</p></dd>
</dl>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Working with Redirection and Pipes"><div class="sect1" id="idm45805424950432">
<h1>Working with Redirection and Pipes</h1>

<p><a data-type="indexterm" data-primary="redirection" id="idm45805424747216"/>In <a data-type="xref" href="ch03.xhtml#shell-streams">“Streams”</a>, we discussed file descriptors and streams. Here are
a few recipes around this topic.</p>

<p>File I/O redirection:</p>
<pre data-type="programlisting" data-code-language="shell"><code class="nb"><em>command</em></code><code> </code><code class="m">1</code><code>&gt;</code><code> </code><code><em>file</em></code><code> </code><a class="co" id="custom_co_helpful_recipes_CO3-1" href="#custom_callout_helpful_recipes_CO3-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a><code>
</code><code class="nb"><em>command</em></code><code> </code><code class="m">2</code><code>&gt;</code><code> </code><code><em>file</em></code><code> </code><a class="co" id="custom_co_helpful_recipes_CO3-2" href="#custom_callout_helpful_recipes_CO3-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a><code>
</code><code class="nb"><em>command</em></code><code> </code><code class="p">&amp;</code><code>&gt;</code><code> </code><code><em>file</em></code><code> </code><a class="co" id="custom_co_helpful_recipes_CO3-3" href="#custom_callout_helpful_recipes_CO3-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a><code>
</code><code class="nb"><em>command</em></code><code> </code><code>&gt;<em>file</em></code><code> </code><code class="m">2</code><code>&gt;</code><code class="p">&amp;</code><code class="m">1</code><code> </code><a class="co" id="custom_co_helpful_recipes_CO3-4" href="#custom_callout_helpful_recipes_CO3-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a><code>
</code><code class="nb"><em>command</em></code><code> </code><code>&gt;</code><code> </code><code>/dev/null</code><code> </code><a class="co" id="custom_co_helpful_recipes_CO3-5" href="#custom_callout_helpful_recipes_CO3-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a><code>
</code><code class="nb"><em>command</em></code><code> </code><code>&lt;</code><code> </code><code><em>file</em></code><code> </code><a class="co" id="custom_co_helpful_recipes_CO3-6" href="#custom_callout_helpful_recipes_CO3-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a></pre>
<dl class="calloutlist">
<dt><a class="co" id="custom_callout_helpful_recipes_CO3-1" href="#custom_co_helpful_recipes_CO3-1"><img src="Images/1.png" alt="1" width="12" height="12"/></a></dt>
<dd><p>Redirect <code>stdout</code> of <code><em>command</em></code> into <code><em>file</em></code>.</p></dd>
<dt><a class="co" id="custom_callout_helpful_recipes_CO3-2" href="#custom_co_helpful_recipes_CO3-2"><img src="Images/2.png" alt="2" width="12" height="12"/></a></dt>
<dd><p>Redirect <code>stderr</code> of <code><em>command</em></code> into <code><em>file</em></code>.</p></dd>
<dt><a class="co" id="custom_callout_helpful_recipes_CO3-3" href="#custom_co_helpful_recipes_CO3-3"><img src="Images/3.png" alt="3" width="12" height="12"/></a></dt>
<dd><p>Redirect both <code>stdout</code> and <code>stderr</code> of <code><em>command</em></code> into <code><em>file</em></code>.</p></dd>
<dt><a class="co" id="custom_callout_helpful_recipes_CO3-4" href="#custom_co_helpful_recipes_CO3-4"><img src="Images/4.png" alt="4" width="12" height="12"/></a></dt>
<dd><p>An alternative way to redirect <code>stdout</code> and <code>stderr</code> of <code><em>command</em></code> into <code><em>file</em></code>.</p></dd>
<dt><a class="co" id="custom_callout_helpful_recipes_CO3-5" href="#custom_co_helpful_recipes_CO3-5"><img src="Images/5.png" alt="5" width="12" height="12"/></a></dt>
<dd><p>Discard output of <code><em>command</em></code> (by redirecting it to <em>/dev/null</em>).</p></dd>
<dt><a class="co" id="custom_callout_helpful_recipes_CO3-6" href="#custom_co_helpful_recipes_CO3-6"><img src="Images/6.png" alt="6" width="12" height="12"/></a></dt>
<dd><p>Redirect <code>stdin</code> (inputs <code><em>file</em></code> to <code><em>command</em></code>).</p></dd>
</dl>

<p><a data-type="indexterm" data-primary="pipes (|)" id="idm45805424669168"/>To connect <code>stdout</code> of one process to <code>stdin</code> of another process, use a
pipe (<code>|</code>):</p>

<pre data-type="programlisting" data-code-language="shell"><em><code>cmd1</code></em><code> </code><code class="p">|</code><code> </code><em><code>cmd2</code></em><code> </code><code class="p">|</code><code> </code><em><code>cmd3</code></em></pre>

<p>To show the exit codes of each command in a pipe:</p>

<pre data-type="programlisting" data-code-language="shell"><code class="nb">echo</code> <code class="si">${</code><code class="nv">PIPESTATUS</code><code class="p">[@]</code><code class="si">}</code></pre>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Working with Time and Dates"><div class="sect1" id="idm45805424656720">
<h1>Working with Time and Dates</h1>

<p><a data-type="indexterm" data-primary="time/date handling" id="idm45805424655280"/>To query time-related information, such as local and UTC time as well as synchronization
status, use:</p>

<pre data-type="programlisting" data-code-language="shell">timedatectl status</pre>

<p>Working with dates, you usually want to either get a date or timestamp for the
current time or convert existing timestamps from one format to another.</p>

<p>To get the date in the format <code>YYYY-MM-DD</code>—for example, <code>2021-10-09</code>—use the 
<span class="keep-together">following:</span></p>

<pre data-type="programlisting" data-code-language="shell">date +<code class="s2">"%Y-%m-%d"</code></pre>

<p>To generate a Unix epoch timestamp (such as <code>1633787676</code>), do:</p>

<pre data-type="programlisting" data-code-language="shell">date +%s</pre>

<p>To create an ISO 8601 timestamp for UTC (something like <code>2021-10-09T13:55:47Z</code>),
you can use:</p>

<pre data-type="programlisting" data-code-language="shell">date -u +<code class="s2">"%Y-%m-%dT%H:%M:%SZ"</code></pre>

<p>Same ISO 8601 timestamp format but for local time:</p>

<pre data-type="programlisting" data-code-language="shell">date +%FT%TZ</pre>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Working with Git"><div class="sect1" id="idm45805424656128">
<h1>Working with Git</h1>

<p><a data-type="indexterm" data-primary="Git, working with" id="idm45805424551712"/>To clone a Git repo—that is, to make a local copy on your Linux system—use the 
<span class="keep-together">following:</span></p>

<pre data-type="programlisting" data-code-language="shell"><code>git</code><code> </code><code>clone</code><code> </code><code>https://github.com/</code><em><code>exampleorg</code></em><code>/</code><em><code>examplerepo</code></em><code>.git</code></pre>

<p>After the previous <code>git clone</code> command is completed, the Git repo will be in the
directory <em>examplerepo</em>, and you should execute the rest of the following
commands in this directory.</p>

<p>To view local changes in color and show where lines have been added and removed
side by side, use:</p>

<pre data-type="programlisting" data-code-language="shell">git diff --color-moved</pre>

<p>To see what has changed locally (files edited, new files, removed files), do:</p>

<pre data-type="programlisting" data-code-language="shell">git status</pre>

<p>To add all local changes and commit them:</p>

<pre data-type="programlisting" data-code-language="shell">git add --all <code class="o">&amp;&amp;</code> git commit -m <code class="s2">"adds a super cool feature"</code></pre>

<p>To find out the commit ID of the current commit, use:</p>

<pre data-type="programlisting" data-code-language="shell">git rev-parse HEAD</pre>

<p>To tag a commit with ID <code>HASH</code> using the tag <code>ATAG</code>, do:</p>

<pre data-type="programlisting" data-code-language="shell">git tag ATAG HASH</pre>

<p>To push the local changes to a remote (upstream) repo with a tag <code>ATAG</code>:</p>

<pre data-type="programlisting" data-code-language="shell">git push origin ATAG</pre>

<p>To see the commit history use <code>git log</code>; specifically, to get a summary, do:</p>

<pre data-type="programlisting" data-code-language="shell">git log <code class="o">(</code>git describe --tags --abbrev<code class="o">=</code><code class="m">0</code><code class="o">)</code>..HEAD --oneline</pre>
</div></section>













<section data-type="sect1" data-pdf-bookmark="System Performance"><div class="sect1" id="idm45805424552560">
<h1>System Performance</h1>

<p><a data-type="indexterm" data-primary="system performance, testing" id="idm45805424409072"/>Sometimes you need to see how fast a device is or how your Linux system
performs under load. Here some ways to generate system load.</p>

<p>Simulate memory load (and also burn some CPU cycles) with the following 
<span class="keep-together">command:</span></p>

<pre data-type="programlisting" data-code-language="shell">yes <code class="p">|</code> tr <code class="se">\\</code>n x <code class="p">|</code> head -c 450m <code class="p">|</code> grep z</pre>

<p>In the preceding pipe, <code>yes</code> generates an endless supply of <code>y</code>
    characters, each on its own line, and then the <code>tr</code> command converts it
    into a continuous stream of <code>yx</code> that the <code>head</code> command chops off at 450
    million bytes (ca. 450 MB). Last but not least, we let <code>grep</code> consume
    the resulting <code>yx</code> block for something that doesn’t exist (<code>z</code>), and hence
    we see no output, but it is still generating load.</p>

<p>More detailed disk usage for a directory:</p>

<pre data-type="programlisting" data-code-language="shell">du -h /home</pre>

<p>Listing free disk space (globally, in this case):</p>

<pre data-type="programlisting" data-code-language="shell">df -h</pre>

<p>Load test a disk and measure I/O throughput with:</p>

<pre data-type="programlisting" data-code-language="shell">dd <code class="k">if</code><code class="o">=</code>/dev/zero <code class="nv">of</code><code class="o">=</code>/home/some/file <code class="nv">bs</code><code class="o">=</code>1G <code class="nv">count</code><code class="o">=</code><code class="m">1</code> <code class="nv">oflag</code><code class="o">=</code>direct</pre>
</div></section>







</div></section></div></body></html>