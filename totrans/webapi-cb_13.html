<html><head></head><body><section data-pdf-bookmark="Chapter 13. UI Elements" data-type="chapter" epub:type="chapter"><div class="chapter" id="ch_uiElements">&#13;
<h1><span class="label">Chapter 13. </span>UI Elements</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Introduction" data-type="sect1"><div class="sect1" id="id182">&#13;
<h1>Introduction</h1>&#13;
&#13;
<p><a data-primary="UI elements" data-type="indexterm" id="ix_13-ui-elements-asciidoc0"/>Modern  <a data-primary="UI elements" data-secondary="basics" data-type="indexterm" id="ix_13-ui-elements-asciidoc1"/>browsers have a few powerful built-in UI elements that you can use in your app. These UI components previously required third-party libraries (or you could build your own).</p>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Dialogs" data-type="sect2"><div class="sect2" id="id183">&#13;
<h2>Dialogs</h2>&#13;
&#13;
<p><a data-primary="&lt;dialog&gt; element" data-primary-sortas="dialog" data-type="indexterm" id="id1110"/><a data-primary="pop-up dialogs" data-type="indexterm" id="id1111"/><a data-primary="UI elements" data-secondary="dialogs" data-type="indexterm" id="id1112"/>Pop-up dialogs are a mainstay of many apps, providing feedback and prompting for input. There are countless dialog libraries out there, and it’s possible to build your own. Modern browsers have already done this for you with the <code>&lt;dialog&gt;</code> element. This is a pop-up dialog and includes a backdrop that covers the rest of the page. You can apply styles to both the backdrop and the dialog with a little CSS. By default, the dialog is just a box that pops up with the backdrop behind it. It’s up to you to add a title, buttons, and other content.</p>&#13;
&#13;
<p>Some dialogs contain multiple buttons, and you want to run different code depending on which option they chose. For example, a confirmation modal might have Confirm and Cancel buttons. You’ll need to handle this yourself as well, adding click event listeners to the buttons. In each event listener, you can close the dialog by calling <code>close</code> on it. The <code>close</code> method is a built-in method on the dialog that takes an optional argument that lets you specify a “return value.” This can be checked later from the dialog’s <code>returnValue</code> property. This lets you pass data from the dialog back to the page that opened it.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Details" data-type="sect2"><div class="sect2" id="id304">&#13;
<h2>Details</h2>&#13;
&#13;
<p><a data-primary="&lt;details&gt; element" data-primary-sortas="details" data-secondary="basics" data-type="indexterm" id="id1113"/><a data-primary="UI elements" data-secondary="details" data-type="indexterm" id="id1114"/>A <code>&lt;details&gt;</code> element is a component whose content is collapsible. It has some summary content that is displayed in an interactive element. By clicking this element, you can show or hide the detailed content. Like with dialogs, you can style the component with CSS and toggle its visibility with JavaScript.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Popovers" data-type="sect2"><div class="sect2" id="id184">&#13;
<h2>Popovers</h2>&#13;
&#13;
<p><a data-primary="popovers" data-type="indexterm" id="id1115"/><a data-primary="UI elements" data-secondary="popovers" data-type="indexterm" id="id1116"/>A popover is similar to a dialog. This is another type of pop-up element. There are a few differences between a popover and a dialog:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>Clicking outside of the popover will close it.</p>&#13;
</li>&#13;
<li>&#13;
<p>You can still interact with the rest of the page while a popover is visible.</p>&#13;
</li>&#13;
<li>&#13;
<p>You can turn any HTML element into a popover.</p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Notifications" data-type="sect2"><div class="sect2" id="id185">&#13;
<h2>Notifications</h2>&#13;
&#13;
<p><a data-primary="notifications" data-secondary="basics" data-type="indexterm" id="id1117"/><a data-primary="UI elements" data-secondary="notifications" data-type="indexterm" id="id1118"/>Smartphones use notifications extensively, and newer operating systems also support notifications. Modern browsers have an API for showing native operating system notifications, triggered from JavaScript. The user must grant permission before these notifications can be sent. These notifications are created in your JavaScript code, on demand, while the app is running<a data-startref="ix_13-ui-elements-asciidoc1" data-type="indexterm" id="id1119"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Creating an Alert Dialog" data-type="sect1"><div class="sect1" id="id569">&#13;
<h1>Creating an Alert Dialog</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id186">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="&lt;dialog&gt; element" data-primary-sortas="dialog" data-secondary="for alert dialogs" data-type="indexterm" id="ix_13-ui-elements-asciidoc2"/><a data-primary="alert dialogs" data-type="indexterm" id="ix_13-ui-elements-asciidoc3"/><a data-primary="UI elements" data-secondary="alert dialog" data-type="indexterm" id="ix_13-ui-elements-asciidoc4"/>You want to show a dialog with a simple message, with an OK button to close it.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id570">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a <code>&lt;dialog&gt;</code> element with an OK button.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by older browsers. See <a href="https://oreil.ly/tk52g">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
&#13;
<p>First, define the HTML for your dialog, as shown in <a data-type="xref" href="#example13-1">Example 13-1</a>.</p>&#13;
<div data-type="example" id="example13-1">&#13;
<h5><span class="label">Example 13-1. </span>The dialog markup</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">dialog</code> <code class="na">id</code><code class="o">=</code><code class="s">"alert"</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code>Alert<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>This is an alert dialog.<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
&#13;
  <code class="p">&lt;</code><code class="nt">button</code> <code class="na">type</code><code class="o">=</code><code class="s">"button"</code> <code class="na">id</code><code class="o">=</code><code class="s">"ok-button"</code><code class="p">&gt;</code>OK<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">dialog</code><code class="p">&gt;</code>&#13;
&#13;
<code class="p">&lt;</code><code class="nt">button</code> <code class="na">type</code><code class="o">=</code><code class="s">"button"</code> <code class="na">id</code><code class="o">=</code><code class="s">"show-dialog"</code><code class="p">&gt;</code>Show Dialog<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>You need two snippets of JavaScript. First, you’ll need a function to trigger the dialog to be displayed, and then you’ll need an event listener for the OK button to close the dialog (see <a data-type="xref" href="#example13-2">Example 13-2</a>).</p>&#13;
<div data-type="example" id="example13-2">&#13;
<h5><span class="label">Example 13-2. </span>JavaScript for the dialog</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// Select the dialog, its OK button, and the trigger button elements.</code>&#13;
<code class="kr">const</code> <code class="nx">dialog</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#alert'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">okButton</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#ok-button'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">trigger</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#show-dialog'</code><code class="p">);</code>&#13;
&#13;
<code class="c1">// Close the dialog when the OK button is clicked.</code>&#13;
<code class="nx">okButton</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">dialog</code><code class="p">.</code><code class="nx">close</code><code class="p">();</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="c1">// Show the dialog when the trigger button is clicked.</code>&#13;
<code class="nx">trigger</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">dialog</code><code class="p">.</code><code class="nx">showModal</code><code class="p">();</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>This results in the dialog shown in <a data-type="xref" href="#img_alertScreenshot">Figure 13-1</a>.</p>&#13;
&#13;
<figure class="width-30"><div class="figure" id="img_alertScreenshot">&#13;
<img alt="The alert dialog" src="assets/wacb_1301.png"/>&#13;
<h6><span class="label">Figure 13-1. </span>The alert dialog</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section class="less_space pagebreak-before" data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id187">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p><a data-primary="modal dialog" data-type="indexterm" id="id1120"/>The dialog’s <code>showModal</code> method shows a <em>modal</em> dialog. A modal dialog blocks the rest of the page until it is closed. This means if you open a modal dialog, clicking on other elements on the page will have no effect. With a modal dialog, the focus is “trapped” inside the dialog. Using the Tab key will cycle focus through the focusable elements in the dialog only. If this isn’t what you want, you can also call the <code>show</code> method. This will show a <a data-primary="modeless dialog" data-type="indexterm" id="id1121"/><em>modeless</em> dialog, which still allows you to interact with the rest of the page while the dialog is open.</p>&#13;
&#13;
<p>Clicking the OK button will close the dialog due to the click listener calling <code>dialog.close</code>, but you can also close the modal by pressing the Escape key. To capture this, you can listen for the dialog’s <code>cancel</code> event. Canceling the dialog with the Escape key will also trigger the dialog’s <code>close</code> event. Finally, closing the dialog manually by calling <code>close</code> on it will trigger the <code>close</code> event as well.</p>&#13;
&#13;
<p>The <code>dialog</code> element also has some nice keyboard accessibility features. When you click the Show Dialog button and the dialog opens, the first focusable element button automatically receives focus. In this case, it’s the OK button. You can change this behavior by adding the <code>autofocus</code> attribute to the element that you want to receive the initial focus when the dialog is opened.</p>&#13;
&#13;
<p>When you close the dialog, either by pressing the Escape key or clicking the OK button, the keyboard focus will return to the Show Dialog button.</p>&#13;
&#13;
<p>You can style both the dialog itself and its semitransparent backdrop with CSS. For the dialog, you can add a CSS rule targeting the <code>&lt;dialog&gt;</code> element itself. To style the backdrop—for example, you might want it to be a more opaque black—you can use the <code>::backdrop</code> pseudo-element (see <a data-type="xref" href="#example13-3">Example 13-3</a>)<a data-startref="ix_13-ui-elements-asciidoc4" data-type="indexterm" id="id1122"/><a data-startref="ix_13-ui-elements-asciidoc3" data-type="indexterm" id="id1123"/><a data-startref="ix_13-ui-elements-asciidoc2" data-type="indexterm" id="id1124"/>.</p>&#13;
<div data-type="example" id="example13-3">&#13;
<h5><span class="label">Example 13-3. </span>Styling the backdrop</h5>&#13;
&#13;
<pre data-code-language="css" data-type="programlisting"><code class="nf">#alert</code><code class="nd">::backdrop</code> <code class="p">{</code>&#13;
  <code class="k">background</code><code class="o">:</code> <code class="n">rgba</code><code class="p">(</code><code class="m">0</code><code class="o">,</code> <code class="m">0</code><code class="o">,</code> <code class="m">0</code><code class="o">,</code> <code class="m">0</code><code class="o">.</code><code class="m">75</code><code class="p">);</code>&#13;
<code class="p">}</code></pre></div>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Creating a Confirmation Dialog" data-type="sect1"><div class="sect1" id="id571">&#13;
<h1>Creating a Confirmation Dialog</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id305">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="&lt;dialog&gt; element" data-primary-sortas="dialog" data-secondary="for user prompt with Confirm/Cancel buttons" data-type="indexterm" id="ix_13-ui-elements-asciidoc5"/><a data-primary="confirmation dialogs" data-secondary="creating user prompt with Confirm/Cancel buttons" data-type="indexterm" id="ix_13-ui-elements-asciidoc6"/><a data-primary="UI elements" data-secondary="user prompt with Confirm/Cancel buttons" data-type="indexterm" id="ix_13-ui-elements-asciidoc7"/>You want to prompt the user to confirm an operation. The prompt should show a question and have Confirm and Cancel buttons.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id572">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>This is another great use case for a <code>&lt;dialog&gt;</code>. First, create your dialog content with the prompt and buttons, as shown in <a data-type="xref" href="#example13-4">Example 13-4</a>.</p>&#13;
<div data-type="example" id="example13-4">&#13;
<h5><span class="label">Example 13-4. </span>The confirmation dialog markup</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">dialog</code> <code class="na">id</code><code class="o">=</code><code class="s">"confirm"</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">h2</code><code class="p">&gt;</code>Confirm<code class="p">&lt;/</code><code class="nt">h2</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">p</code><code class="p">&gt;</code>Are you sure you want to do that?<code class="p">&lt;/</code><code class="nt">p</code><code class="p">&gt;</code>&#13;
&#13;
  <code class="p">&lt;</code><code class="nt">button</code> <code class="na">type</code><code class="o">=</code><code class="s">"button"</code> <code class="na">class</code><code class="o">=</code><code class="s">"confirm-button"</code><code class="p">&gt;</code>Confirm<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">button</code> <code class="na">type</code><code class="o">=</code><code class="s">"button"</code> <code class="na">class</code><code class="o">=</code><code class="s">"cancel-button"</code><code class="p">&gt;</code>Cancel<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;/</code><code class="nt">dialog</code><code class="p">&gt;</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/tk52g">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
&#13;
<p>You want both buttons to close the dialog, but to take different actions. To do this, you can pass a string argument to <code>dialog.close</code>. This will set the <code>returnValue</code> property on the dialog itself, which you can examine when you receive the <code>close</code> event (see <a data-type="xref" href="#example13-3">Example 13-3</a>).</p>&#13;
<div data-type="example" id="example13-5">&#13;
<h5><span class="label">Example 13-5. </span>Event listeners for the confirmation dialog</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">dialog</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#confirm'</code><code class="p">);</code>&#13;
&#13;
<code class="nx">confirmButton</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="c1">// Close the dialog with a return value of 'confirm'</code>&#13;
  <code class="nx">dialog</code><code class="p">.</code><code class="nx">close</code><code class="p">(</code><code class="s1">'confirm'</code><code class="p">);</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="nx">cancelButton</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="c1">// Close the dialog with a return value of 'cancel'</code>&#13;
  <code class="nx">dialog</code><code class="p">.</code><code class="nx">close</code><code class="p">(</code><code class="s1">'cancel'</code><code class="p">);</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="nx">dialog</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'cancel'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="c1">// Canceling with the Escape key doesn't set a return value.</code>&#13;
  <code class="c1">// Set it to 'cancel' here so the close event handler will get</code>&#13;
  <code class="c1">// the proper value.</code>&#13;
  <code class="nx">dialog</code><code class="p">.</code><code class="nx">returnValue</code> <code class="o">=</code> <code class="s1">'cancel'</code><code class="p">;</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="nx">dialog</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'close'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="k">if</code> <code class="p">(</code><code class="nx">dialog</code><code class="p">.</code><code class="nx">returnValue</code> <code class="o">===</code> <code class="s1">'confirm'</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="c1">// The user clicked the Confirm button.</code>&#13;
    <code class="c1">// Perform the action, such as creating or deleting data.</code>&#13;
  <code class="p">}</code> <code class="k">else</code> <code class="p">{</code>&#13;
    <code class="c1">// The user clicked the Cancel button or pressed the Escape key.</code>&#13;
    <code class="c1">// Don't perform the action.</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">});</code></pre></div>&#13;
&#13;
<p>The resulting confirmation dialog looks like <a data-type="xref" href="#img_screenshotConfirm">Figure 13-2</a>.</p>&#13;
&#13;
<figure class="width-40"><div class="figure" id="img_screenshotConfirm">&#13;
<img alt="The confirmation dialog" src="assets/wacb_1302.png"/>&#13;
<h6><span class="label">Figure 13-2. </span>The confirmation dialog</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id188">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>If the user clicks one of the buttons, the dialog is closed with a return value that depends on which button was clicked. After the dialog closes, it will emit the <code>close</code> event where you can check the <code>returnValue</code> property. If the <code>returnValue</code> is <code>confirm</code>, you know the user clicked the Confirm button. Otherwise, the <code>returnValue</code> is <code>cancel</code> and you can cancel the operation.</p>&#13;
&#13;
<p>This example also listens for the <code>cancel</code> event. This event is triggered if the dialog is closed by pressing the Escape key. When the dialog is closed in this way, the dialog’s <code>returnValue</code> is not updated and will retain whatever previous value it had. To make sure the <code>returnValue</code> is correct, the <code>cancel</code> event handler sets it. This works because the <code>close</code> event is triggered <em>after</em> the <code>cancel</code> event. Because the Escape key triggers this event, you don’t need to actually listen for the Escape key to be pressed.</p>&#13;
&#13;
<p>Why do you need to handle this case? Well, if you close the dialog, it is not destroyed. It still exists in the DOM, just hidden, and still has the same <code>returnValue</code> set. Suppose you opened the dialog previously, and you clicked Confirm. The return value is now set to <code>confirm</code>. If you open the confirmation dialog again and cancel by pressing Escape, the return value will still be <code>confirm</code> when the <code>close</code> event is handled. To avoid this potential bug, you can use the <code>cancel</code> event handler to explicitly set the <code>returnValue</code> to <code>cancel</code><a data-startref="ix_13-ui-elements-asciidoc7" data-type="indexterm" id="id1125"/><a data-startref="ix_13-ui-elements-asciidoc6" data-type="indexterm" id="id1126"/><a data-startref="ix_13-ui-elements-asciidoc5" data-type="indexterm" id="id1127"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Creating a Confirmation Dialog Web Component" data-type="sect1"><div class="sect1" id="id573">&#13;
<h1>Creating a Confirmation Dialog Web Component</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id306">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="&lt;dialog&gt; element" data-primary-sortas="dialog" data-secondary="for customizable confirmation dialogs" data-type="indexterm" id="ix_13-ui-elements-asciidoc8"/><a data-primary="&lt;slot&gt; element" data-primary-sortas="slot" data-secondary="for customizable confirmation dialogs" data-type="indexterm" id="ix_13-ui-elements-asciidoc9"/><a data-primary="confirmation dialogs" data-secondary="creating customizable web component" data-type="indexterm" id="ix_13-ui-elements-asciidoc10"/><a data-primary="UI elements" data-secondary="customizable confirmation dialog web component" data-type="indexterm" id="ix_13-ui-elements-asciidoc11"/>You want to create a customizable confirmation dialog. When you show the dialog, you want to get a <code>Promise</code> that resolves to the return value rather than having to listen for multiple events.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id574">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Wrap the dialog in a web component, using a slot for the confirmation message. The component exposes a <code>showConfirmation</code> method that uses a <code>Promise</code>.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/tk52g">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
&#13;
<p>As with most web components, start by defining the template, as shown in <a data-type="xref" href="#example13-6">Example 13-6</a>.</p>&#13;
<div data-type="example" id="example13-6">&#13;
<h5><span class="label">Example 13-6. </span>The template for the confirmation dialog component</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">template</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">createElement</code><code class="p">(</code><code class="s1">'template'</code><code class="p">);</code>&#13;
<code class="nx">template</code><code class="p">.</code><code class="nx">innerHTML</code> <code class="o">=</code> <code class="sb">`</code>&#13;
<code class="sb">  &lt;dialog id="confirm"&gt;</code>&#13;
<code class="sb">    &lt;h2&gt;Confirm&lt;/h2&gt;</code>&#13;
<code class="sb">    &lt;p&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/p&gt;</code>&#13;
&#13;
<code class="sb">    &lt;button type="button" class="confirm-button"&gt;Confirm&lt;/button&gt;</code>&#13;
<code class="sb">    &lt;button type="button" class="cancel-button"&gt;Cancel&lt;/button&gt;</code>&#13;
<code class="sb">  &lt;/dialog&gt;</code>&#13;
<code class="sb">`</code><code class="p">;</code></pre></div>&#13;
&#13;
<p>The template contains a slot that will receive the component’s child content. Next, <a data-type="xref" href="#example13-7">Example 13-7</a> show the component implementation.</p>&#13;
<div data-type="example" id="example13-7">&#13;
<h5><span class="label">Example 13-7. </span>The confirmation component implementation</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">class</code> <code class="nx">ConfirmDialog</code> <code class="kr">extends</code> <code class="nx">HTMLElement</code> <code class="p">{</code>&#13;
  <code class="nx">connectedCallback</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="kr">const</code> <code class="nx">shadowRoot</code> <code class="o">=</code> <code class="k">this</code><code class="p">.</code><code class="nx">attachShadow</code><code class="p">({</code> <code class="nx">mode</code><code class="o">:</code> <code class="s1">'open'</code> <code class="p">});</code>&#13;
    <code class="nx">shadowRoot</code><code class="p">.</code><code class="nx">appendChild</code><code class="p">(</code><code class="nx">template</code><code class="p">.</code><code class="nx">content</code><code class="p">.</code><code class="nx">cloneNode</code><code class="p">(</code><code class="kc">true</code><code class="p">));</code>&#13;
&#13;
    <code class="k">this</code><code class="p">.</code><code class="nx">dialog</code> <code class="o">=</code> <code class="nx">shadowRoot</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'dialog'</code><code class="p">);</code>&#13;
    <code class="k">this</code><code class="p">.</code><code class="nx">dialog</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'cancel'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
      <code class="k">this</code><code class="p">.</code><code class="nx">dialog</code><code class="p">.</code><code class="nx">returnValue</code> <code class="o">=</code> <code class="s1">'cancel'</code><code class="p">;</code>&#13;
    <code class="p">});</code>&#13;
&#13;
    <code class="nx">shadowRoot</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'.confirm-button'</code><code class="p">)</code>&#13;
      <code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
        <code class="k">this</code><code class="p">.</code><code class="nx">dialog</code><code class="p">.</code><code class="nx">close</code><code class="p">(</code><code class="s1">'confirm'</code><code class="p">);</code>&#13;
      <code class="p">});</code>&#13;
&#13;
    <code class="nx">shadowRoot</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'.cancel-button'</code><code class="p">)</code>&#13;
      <code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
        <code class="k">this</code><code class="p">.</code><code class="nx">dialog</code><code class="p">.</code><code class="nx">close</code><code class="p">(</code><code class="s1">'cancel'</code><code class="p">);</code>&#13;
      <code class="p">});</code>&#13;
  <code class="p">}</code>&#13;
&#13;
  <code class="nx">showConfirmation</code><code class="p">()</code> <code class="p">{</code>&#13;
    <code class="k">this</code><code class="p">.</code><code class="nx">dialog</code><code class="p">.</code><code class="nx">showModal</code><code class="p">();</code>&#13;
&#13;
    <code class="k">return</code> <code class="k">new</code> <code class="nb">Promise</code><code class="p">(</code><code class="nx">resolve</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
      <code class="c1">// Listen for the next close event and resolve the Promise.</code>&#13;
      <code class="c1">// Resolve the Promise with a boolean indicating whether or not the</code>&#13;
      <code class="c1">// user confirmed.</code>&#13;
      <code class="k">this</code><code class="p">.</code><code class="nx">dialog</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'close'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
        <code class="nx">resolve</code><code class="p">(</code><code class="k">this</code><code class="p">.</code><code class="nx">dialog</code><code class="p">.</code><code class="nx">returnValue</code> <code class="o">===</code> <code class="s1">'confirm'</code><code class="p">);</code>&#13;
      <code class="p">},</code> <code class="p">{</code>&#13;
        <code class="c1">// Only listen for the event once, then remove the listener.</code>&#13;
        <code class="nx">once</code><code class="o">:</code> <code class="kc">true</code>&#13;
      <code class="p">});</code>&#13;
    <code class="p">});</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="nx">customElements</code><code class="p">.</code><code class="nx">define</code><code class="p">(</code><code class="s1">'confirm-dialog'</code><code class="p">,</code> <code class="nx">ConfirmDialog</code><code class="p">);</code></pre></div>&#13;
&#13;
<p>Suppose you want to use this component to confirm a delete operation. You can add the element to your page with the confirmation prompt as the child content (see <a data-type="xref" href="#example13-8">Example 13-8</a>).</p>&#13;
<div data-type="example" id="example13-8">&#13;
<h5><span class="label">Example 13-8. </span>The component markup</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">confirm-dialog</code> <code class="na">id</code><code class="o">=</code><code class="s">"confirm-delete"</code><code class="p">&gt;</code>&#13;
  Are you sure you want to delete this item?&#13;
<code class="p">&lt;/</code><code class="nt">confirm-dialog</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>To show the dialog, select the DOM element and call its <code>showConfirmation</code> method. Await the returned <code>Promise</code> to get the return value (see <a data-type="xref" href="#example13-9">Example 13-9</a>).</p>&#13;
<div data-type="example" id="example13-9">&#13;
<h5><span class="label">Example 13-9. </span>Using the confirmation dialog component</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">confirmDialog</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#confirm-delete'</code><code class="p">);</code>&#13;
<code class="k">if</code> <code class="p">(</code><code class="nx">await</code> <code class="nx">confirmDialog</code><code class="p">.</code><code class="nx">showConfirmation</code><code class="p">())</code> <code class="p">{</code>&#13;
  <code class="c1">// perform the delete operation</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>As with <a data-type="xref" href="ch12.html#recipe_disclosure">“Creating a Disclosure Component”</a> from <a data-type="xref" href="ch12.html#ch_webComponents">Chapter 12</a>, you need to add some CSS to hide the child content until it is placed within the slots to prevent a flicker of the dialog content (see <a data-type="xref" href="#example13-10">Example 13-10</a>).</p>&#13;
<div data-type="example" id="example13-10">&#13;
<h5><span class="label">Example 13-10. </span>Fixing the flicker issue</h5>&#13;
&#13;
<pre data-code-language="css" data-type="programlisting"><code class="nt">confirm-dialog</code><code class="nd">:not</code><code class="o">(</code><code class="nd">:defined</code><code class="o">)</code> <code class="p">{</code>&#13;
  <code class="k">display</code><code class="o">:</code> <code class="nb">none</code><code class="p">;</code>&#13;
<code class="p">}</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id189">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>This is a good example of the usefulness of web components to encapsulate custom behavior. In this case, you also added a custom method to be called from the outside. This method shows the dialog and abstracts away having to listen for multiple events. You just show the dialog and wait for the result<a data-startref="ix_13-ui-elements-asciidoc11" data-type="indexterm" id="id1128"/><a data-startref="ix_13-ui-elements-asciidoc10" data-type="indexterm" id="id1129"/><a data-startref="ix_13-ui-elements-asciidoc9" data-type="indexterm" id="id1130"/><a data-startref="ix_13-ui-elements-asciidoc8" data-type="indexterm" id="id1131"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Using a Disclosure Element" data-type="sect1"><div class="sect1" id="id575">&#13;
<h1>Using a Disclosure Element</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id190">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="&lt;details&gt; element" data-primary-sortas="details" data-secondary="for disclosure elements" data-type="indexterm" id="ix_13-ui-elements-asciidoc12"/><a data-primary="disclosure elements" data-type="indexterm" id="ix_13-ui-elements-asciidoc13"/><a data-primary="UI elements" data-secondary="using a disclosure element" data-type="indexterm" id="ix_13-ui-elements-asciidoc14"/>You have some content you want to show or hide using a toggle button.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id576">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use the built-in <code>&lt;details&gt;</code> element (see <a data-type="xref" href="#example13-10">Example 13-10</a>).</p>&#13;
<div data-type="example" id="example13-11">&#13;
<h5><span class="label">Example 13-11. </span>Using the <code>details</code> element</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">details</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">summary</code><code class="p">&gt;</code>More Info<code class="p">&lt;/</code><code class="nt">summary</code><code class="p">&gt;</code>&#13;
  Here are some extra details that you can toggle.&#13;
<code class="p">&lt;/</code><code class="nt">details</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>When the details are collapsed, you’ll just see the More Info trigger button, as shown in <a data-type="xref" href="#figure13-3">Figure 13-3</a>.</p>&#13;
&#13;
<figure><div class="figure" id="figure13-3">&#13;
<img alt="The collapsed details element" src="assets/wacb_1303.png"/>&#13;
<h6><span class="label">Figure 13-3. </span>The collapsed details element</h6>&#13;
</div></figure>&#13;
&#13;
<p>When you click the summary, the details open and the arrow changes to indicate that the content is expanded, as shown in <a data-type="xref" href="#figure13-4">Figure 13-4</a>.</p>&#13;
&#13;
<figure class="width-60"><div class="figure" id="figure13-4">&#13;
<img alt="The expanded details element" src="assets/wacb_1304.png"/>&#13;
<h6><span class="label">Figure 13-4. </span>The expanded details element</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id191">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>By default, the inner content is hidden, and you’ll just see a disclosure element with the contents of the <code>&lt;summary&gt;</code> element. In this case, the button will read More Info. When you click the More Info button, the hidden content will appear. If you click it again, the content again becomes hidden.</p>&#13;
&#13;
<p>You can change this default behavior with the <code>open</code> attribute. If you add this attribute, the content will start out visible (see <a data-type="xref" href="#example13-12">Example 13-12</a>).</p>&#13;
<div data-type="example" id="example13-12">&#13;
<h5><span class="label">Example 13-12. </span>Controlling the default state with the <code>open</code> attribute</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">details</code> <code class="na">open</code><code class="p">&gt;</code>&#13;
  <code class="p">&lt;</code><code class="nt">summary</code><code class="p">&gt;</code>More Info<code class="p">&lt;/</code><code class="nt">summary</code><code class="p">&gt;</code>&#13;
  This content is visible by default.&#13;
<code class="p">&lt;/</code><code class="nt">details</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>Finally, you can also toggle the content with JavaScript. You can change the value of the element’s <code>open</code> attribute directly, as shown in <a data-type="xref" href="#example13-13">Example 13-13</a>.</p>&#13;
<div data-type="example" id="example13-13">&#13;
<h5><span class="label">Example 13-13. </span>Toggling the visibility with JavaScript</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="c1">// Show the content</code>&#13;
<code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'details'</code><code class="p">).</code><code class="nx">open</code> <code class="o">=</code> <code class="kc">true</code><code class="p">;</code></pre></div>&#13;
&#13;
<p>Most browsers have good accessibility support for this element, identifying the trigger element to screen readers and indicating its expanded or collapsed state<a data-startref="ix_13-ui-elements-asciidoc14" data-type="indexterm" id="id1132"/><a data-startref="ix_13-ui-elements-asciidoc13" data-type="indexterm" id="id1133"/><a data-startref="ix_13-ui-elements-asciidoc12" data-type="indexterm" id="id1134"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Showing a Popover" data-type="sect1"><div class="sect1" id="id577">&#13;
<h1>Showing a Popover</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id307">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="popovers" data-secondary="showing" data-type="indexterm" id="ix_13-ui-elements-asciidoc15"/><a data-primary="UI elements" data-secondary="showing a popover" data-type="indexterm" id="ix_13-ui-elements-asciidoc16"/>You want to show pop-up content by clicking a button, but still allow the user to interact with the rest of the page.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id578">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Give the element a <code>popover</code> attribute, and add the <code>popovertarget</code> attribute to the trigger button (see <a data-type="xref" href="#example13-14">Example 13-14</a>).</p>&#13;
<div data-type="example" id="example13-14">&#13;
<h5><span class="label">Example 13-14. </span>Automatically wiring a popover</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">button</code> <code class="na">type</code><code class="o">=</code><code class="s">"button"</code> <code class="na">popovertarget</code><code class="o">=</code><code class="s">"greeting"</code><code class="p">&gt;</code>Open Popover<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">popover</code> <code class="na">id</code><code class="o">=</code><code class="s">"greeting"</code><code class="p">&gt;</code>Hello world!<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/YFjQX">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id192">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>A popover differs from a dialog in a few ways:</p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>You can open it without any JavaScript.</p>&#13;
</li>&#13;
<li>&#13;
<p>There is no backdrop like there is with a dialog.</p>&#13;
</li>&#13;
<li>&#13;
<p>Unlike a dialog, you aren’t blocked from interacting with the underlying page while the popover is displayed.</p>&#13;
</li>&#13;
<li>&#13;
<p>When you click outside of a popover, it will close.</p>&#13;
</li>&#13;
</ul>&#13;
&#13;
<p>To make an element into a popover, you give it the <code>popover</code> attribute. The popover element also needs an <code>id</code> attribute. To link a trigger button to the popover, the button is given a <code>popovertarget</code> attribute. The value of this attribute should correspond to the <code>id</code> of the popover.</p>&#13;
&#13;
<p class="pagebreak-before">One drawback of the popover API in its current state is that there is no mechanism to position the popover relative to its trigger. By default, the popover always appears centered on screen. If you want to change its position, you’ll need to manually do that with CSS.</p>&#13;
&#13;
<p>In the future, you will be able to use CSS anchor positioning to position the popover relative to its trigger. In the meantime, there are third-party libraries such as Floating UI that you can use to augment this solution in order to position the element<a data-startref="ix_13-ui-elements-asciidoc16" data-type="indexterm" id="id1135"/><a data-startref="ix_13-ui-elements-asciidoc15" data-type="indexterm" id="id1136"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Manually Controlling a Popover" data-type="sect1"><div class="sect1" id="recipe_manualPopover">&#13;
<h1>Manually Controlling a Popover</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id308">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="popovers" data-secondary="manually controlling" data-type="indexterm" id="ix_13-ui-elements-asciidoc17"/><a data-primary="UI elements" data-secondary="manually controlling a popover" data-type="indexterm" id="ix_13-ui-elements-asciidoc18"/>You want to use the <code>popover</code> attribute but programmatically use JavaScript to have control over when the popover is shown and hidden.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id580">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Set the <code>popover</code> attribute to <code>manual</code> and call its <code>showPopover</code>, <code>hidePopover</code>, or &#13;
<span class="keep-together"><code>togglePopover</code></span> methods (see <a data-type="xref" href="#example13-15">Example 13-15</a>).</p>&#13;
<div data-type="example" id="example13-15">&#13;
<h5><span class="label">Example 13-15. </span>The popover and trigger markup</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">button</code> <code class="na">type</code><code class="o">=</code><code class="s">"button"</code> <code class="na">id</code><code class="o">=</code><code class="s">"trigger"</code><code class="p">&gt;</code>Show Popover<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"greeting"</code> <code class="na">popover</code><code class="o">=</code><code class="s">"manual"</code><code class="p">&gt;</code>Hello World!<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/YFjQX">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
&#13;
<p>The <code>popover="manual"</code> attribute tells the browser that the popover will be manually controlled (see <a data-type="xref" href="#example13-16">Example 13-16</a>). To show the popover, select the popover element and call its <code>togglePopover</code> method. This will show the popover when it is hidden and hide the popover when it is shown.</p>&#13;
<div data-type="example" id="example13-16">&#13;
<h5><span class="label">Example 13-16. </span>The toggle button code</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">trigger</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#trigger'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">popover</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#greeting'</code><code class="p">);</code>&#13;
<code class="nx">trigger</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'click'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">popover</code><code class="p">.</code><code class="nx">togglePopover</code><code class="p">();</code>&#13;
<code class="p">});</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id193">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>If you want to manually control the popover’s visibility, make sure that you set the <code>popover</code> attribute to <code>manual</code>. When the popover element is set to manual control, clicking outside of the popover will <em>not</em> close it. To close the popover, you’ll need to call either its <code>hidePopover</code> or <code>togglePopover</code> methods<a data-startref="ix_13-ui-elements-asciidoc18" data-type="indexterm" id="id1137"/><a data-startref="ix_13-ui-elements-asciidoc17" data-type="indexterm" id="id1138"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Positioning a Popover Relative to an Element" data-type="sect1"><div class="sect1" id="recipe_positioning">&#13;
<h1>Positioning a Popover Relative to an Element</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id309">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="popovers" data-secondary="positioning relative to an element" data-type="indexterm" id="ix_13-ui-elements-asciidoc19"/><a data-primary="UI elements" data-secondary="positioning a popover relative to an element" data-type="indexterm" id="ix_13-ui-elements-asciidoc20"/>You want to show a popover, but you don’t want it in the middle of the screen. You want to position it relative to another element, such as the button that triggered it.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id582">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Calculate the bounding rectangle of the element, then adjust the popover’s position accordingly. This example will cover positioning the tooltip just below the element.</p>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/YFjQX">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
&#13;
<p>First, you’ll need to apply some styles to the popover element, as shown in <a data-type="xref" href="#example13-17">Example 13-17</a>.</p>&#13;
<div data-type="example" id="example13-17">&#13;
<h5><span class="label">Example 13-17. </span>The popover styles</h5>&#13;
&#13;
<pre data-code-language="css" data-type="programlisting"><code class="nc">.popover</code> <code class="p">{</code>&#13;
  <code class="k">margin</code><code class="o">:</code> <code class="m">0</code><code class="p">;</code>&#13;
  <code class="k">margin-top</code><code class="o">:</code> <code class="m">1em</code><code class="p">;</code>&#13;
  <code class="k">position</code><code class="o">:</code> <code class="nb">absolute</code><code class="p">;</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>By default, the browser uses margin to center the popover within the viewport. To position the popover relative to another element, you need to remove this margin. Since you are positioning the tooltip below the other element, you can set a <code>margin-top</code> so that there’s a small amount of space between the element and the popover. Finally, to make the popover scroll along with the element, you need to set <code>position: fixed</code>.</p>&#13;
&#13;
<p>Next, you can use the <code>popovertarget</code> attribute on the trigger to automatically show the popover on click (see <a data-type="xref" href="#example13-18">Example 13-18</a>).</p>&#13;
<div data-type="example" id="example13-18">&#13;
<h5><span class="label">Example 13-18. </span>The popover and trigger markup</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">button</code> <code class="na">type</code><code class="o">=</code><code class="s">"button"</code> <code class="na">class</code><code class="o">=</code><code class="s">"trigger"</code> <code class="na">popovertarget</code><code class="o">=</code><code class="s">"popover"</code><code class="p">&gt;</code>Show Popover<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">class</code><code class="o">=</code><code class="s">"popover"</code> <code class="na">popover</code><code class="p">&gt;</code>&#13;
  This is popover content anchored to the trigger button.&#13;
<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>The last step is to update the popover’s position whenever it is shown. You can listen for the popover element’s <code>toggle</code> event, which is triggered when the popover is either shown or hidden. When handling this event, you can calculate the trigger element’s position and use it to update the popover’s position (see <a data-type="xref" href="#example13-19">Example 13-19</a>).</p>&#13;
<div data-type="example" id="example13-19">&#13;
<h5><span class="label">Example 13-19. </span>Setting the popover’s position</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">popover</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'.popover'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">trigger</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'.trigger'</code><code class="p">);</code>&#13;
&#13;
<code class="nx">popover</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'toggle'</code><code class="p">,</code> <code class="nx">event</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="c1">// Update the position if the popover is being opened.</code>&#13;
  <code class="k">if</code> <code class="p">(</code><code class="nx">event</code><code class="p">.</code><code class="nx">newState</code> <code class="o">===</code> <code class="s1">'open'</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="c1">// Find the position of the trigger element.</code>&#13;
    <code class="kr">const</code> <code class="nx">triggerRect</code> <code class="o">=</code> <code class="nx">trigger</code><code class="p">.</code><code class="nx">getBoundingClientRect</code><code class="p">();</code>&#13;
&#13;
    <code class="c1">// Since the popover is positioned relative to the viewport,</code>&#13;
    <code class="c1">// you need to account for the scroll offset.</code>&#13;
    <code class="nx">popover</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">top</code> <code class="o">=</code> <code class="sb">`</code><code class="si">${</code><code class="nx">triggerRect</code><code class="p">.</code><code class="nx">bottom</code> <code class="o">+</code> <code class="nb">window</code><code class="p">.</code><code class="nx">scrollY</code><code class="si">}</code><code class="sb">px`</code><code class="p">;</code>&#13;
    <code class="nx">popover</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">left</code> <code class="o">=</code> <code class="sb">`</code><code class="si">${</code><code class="nx">triggerRect</code><code class="p">.</code><code class="nx">left</code><code class="si">}</code><code class="sb">px`</code><code class="p">;</code>&#13;
  <code class="p">}</code>&#13;
<code class="p">});</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id194">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>If you are familiar with CSS positioning, you might be a little confused about the behavior of <code>position: absolute</code> here. Normally, <code>position: absolute</code> will position the element relative to its closest positioned ancestor element. In this case, though, the popover will always be positioned relative to the viewport.</p>&#13;
&#13;
<p>This is because popovers are positioned inside the browser’s <em>top layer</em>. This is a special layer that is on top of all other layers in the document. Regardless of where in the DOM your popover element exists, the popover content is placed in the top layer. Since it’s in this special top layer, <code>position: absolute</code> will position the element relative to the viewport.</p>&#13;
&#13;
<p>The position of the popover is calculated by calling <code>getBoundingClientRect</code> on the trigger element. As you scroll the page, the top and bottom positions of this rectangle will change. To make sure the popover is positioned correctly underneath the trigger, you also need to include <code>window.scrollY</code> in the calculation.</p>&#13;
&#13;
<p>There are a few limitations to note of this implementation. First, if the trigger element is at the bottom of the document, there may not be enough room underneath the element to show the popover. You may want to check for this and, when there isn’t enough room, position the popover <em>above</em> the trigger instead.</p>&#13;
&#13;
<p>Another thing you might want to handle is if the window is resized while the popover is visible, the position may not be updated correctly. You could use a <code>ResizeObserver</code> or the window’s <code>resize</code> event to handle this case<a data-startref="ix_13-ui-elements-asciidoc20" data-type="indexterm" id="id1139"/><a data-startref="ix_13-ui-elements-asciidoc19" data-type="indexterm" id="id1140"/>.</p>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Showing a Tooltip" data-type="sect1"><div class="sect1" id="id583">&#13;
<h1>Showing a Tooltip</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id195">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="popovers" data-secondary="showing tooltips" data-type="indexterm" id="ix_13-ui-elements-asciidoc21"/><a data-primary="tooltips" data-type="indexterm" id="ix_13-ui-elements-asciidoc22"/><a data-primary="UI elements" data-secondary="showing a tooltip" data-type="indexterm" id="ix_13-ui-elements-asciidoc23"/>You want to show a tooltip when hovering over, or focusing, an element.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id584">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a manually controlled popover, showing and hiding it with the corresponding mouse events. This will use the same positioning approach as in <a data-type="xref" href="#recipe_positioning">“Positioning a Popover Relative to an Element”</a>, so first you’ll need to define the custom styles for the popover (see <a data-type="xref" href="#example13-20">Example 13-20</a>).</p>&#13;
<div data-type="example" id="example13-20">&#13;
<h5><span class="label">Example 13-20. </span>The tooltip styles</h5>&#13;
&#13;
<pre data-code-language="css" data-type="programlisting"><code class="nf">#tooltip</code> <code class="p">{</code>&#13;
  <code class="k">margin</code><code class="o">:</code> <code class="m">0</code><code class="p">;</code>&#13;
  <code class="k">margin-top</code><code class="o">:</code> <code class="m">1em</code><code class="p">;</code>&#13;
  <code class="k">position</code><code class="o">:</code> <code class="nb">absolute</code><code class="p">;</code>&#13;
<code class="p">}</code></pre></div>&#13;
<div data-type="note" epub:type="note"><h6>Note</h6>&#13;
<p>This API may not be supported by all browsers yet. See <a href="https://oreil.ly/YFjQX">CanIUse</a> for the latest compatibility data.</p>&#13;
</div>&#13;
&#13;
<p>Implement the tooltip as a popover with the <code>popover</code> attribute set to <code>manual</code>, as shown in <a data-type="xref" href="#example13-21">Example 13-21</a>.</p>&#13;
<div data-type="example" id="example13-21">&#13;
<h5><span class="label">Example 13-21. </span>The tooltip markup</h5>&#13;
&#13;
<pre data-code-language="html" data-type="programlisting"><code class="p">&lt;</code><code class="nt">button</code> <code class="na">type</code><code class="o">=</code><code class="s">"button"</code> <code class="na">id</code><code class="o">=</code><code class="s">"trigger"</code><code class="p">&gt;</code>Hover Me<code class="p">&lt;/</code><code class="nt">button</code><code class="p">&gt;</code>&#13;
<code class="p">&lt;</code><code class="nt">div</code> <code class="na">id</code><code class="o">=</code><code class="s">"tooltip"</code> <code class="na">popover</code><code class="o">=</code><code class="s">"manual"</code> <code class="na">role</code><code class="o">=</code><code class="s">"tooltip"</code><code class="p">&gt;</code>Here is some tooltip content<code class="p">&lt;/</code><code class="nt">div</code><code class="p">&gt;</code></pre></div>&#13;
&#13;
<p>When the mouse hovers over the trigger, calculate the position and show the popover element on the <code>mouseover</code> event. On the <code>mouseout</code> event, hide the popover element (see <a data-type="xref" href="#example13-22">Example 13-22</a>).</p>&#13;
<div data-type="example" id="example13-22">&#13;
<h5><span class="label">Example 13-22. </span>Showing and hiding the tooltip</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="kr">const</code> <code class="nx">button</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#trigger'</code><code class="p">);</code>&#13;
<code class="kr">const</code> <code class="nx">tooltip</code> <code class="o">=</code> <code class="nb">document</code><code class="p">.</code><code class="nx">querySelector</code><code class="p">(</code><code class="s1">'#tooltip'</code><code class="p">);</code>&#13;
&#13;
<code class="kd">function</code> <code class="nx">showTooltip</code><code class="p">()</code> <code class="p">{</code>&#13;
  <code class="c1">// Find the position of the trigger element.</code>&#13;
  <code class="kr">const</code> <code class="nx">triggerRect</code> <code class="o">=</code> <code class="nx">trigger</code><code class="p">.</code><code class="nx">getBoundingClientRect</code><code class="p">();</code>&#13;
&#13;
  <code class="c1">// Since the popover is positioned relative to the viewport,</code>&#13;
  <code class="c1">// you need to account for the scroll offset.</code>&#13;
  <code class="nx">tooltip</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">top</code> <code class="o">=</code> <code class="sb">`</code><code class="si">${</code><code class="nx">triggerRect</code><code class="p">.</code><code class="nx">bottom</code> <code class="o">+</code> <code class="nb">window</code><code class="p">.</code><code class="nx">scrollY</code><code class="si">}</code><code class="sb">px`</code><code class="p">;</code>&#13;
  <code class="nx">tooltip</code><code class="p">.</code><code class="nx">style</code><code class="p">.</code><code class="nx">left</code> <code class="o">=</code> <code class="sb">`</code><code class="si">${</code><code class="nx">triggerRect</code><code class="p">.</code><code class="nx">left</code><code class="si">}</code><code class="sb">px`</code><code class="p">;</code>&#13;
&#13;
  <code class="nx">tooltip</code><code class="p">.</code><code class="nx">showPopover</code><code class="p">();</code>&#13;
<code class="p">}</code>&#13;
&#13;
<code class="c1">// Show and hide the tooltip in response to mouse events.</code>&#13;
<code class="nx">button</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'mouseover'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">showTooltip</code><code class="p">();</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="nx">button</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'mouseout'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">tooltip</code><code class="p">.</code><code class="nx">hidePopover</code><code class="p">();</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="c1">// For keyboard accessibility, also show and hide the tooltip</code>&#13;
<code class="c1">// in response to focus events.</code>&#13;
<code class="nx">button</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'focus'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">showTooltip</code><code class="p">();</code>&#13;
<code class="p">});</code>&#13;
&#13;
<code class="nx">button</code><code class="p">.</code><code class="nx">addEventListener</code><code class="p">(</code><code class="s1">'blur'</code><code class="p">,</code> <code class="p">()</code> <code class="o">=&gt;</code> <code class="p">{</code>&#13;
  <code class="nx">tooltip</code><code class="p">.</code><code class="nx">hidePopover</code><code class="p">();</code>&#13;
<code class="p">});</code></pre></div>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id196">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Since this uses the same positioning technique as <a data-type="xref" href="#recipe_positioning">“Positioning a Popover Relative to an Element”</a>, it has the same &#13;
<span class="keep-together">limitations:</span></p>&#13;
&#13;
<ul>&#13;
<li>&#13;
<p>It doesn’t account for the case where there’s not enough room to show the tooltip below it.</p>&#13;
</li>&#13;
<li>&#13;
<p>It doesn’t account for resizing the window<a data-startref="ix_13-ui-elements-asciidoc23" data-type="indexterm" id="id1141"/><a data-startref="ix_13-ui-elements-asciidoc22" data-type="indexterm" id="id1142"/><a data-startref="ix_13-ui-elements-asciidoc21" data-type="indexterm" id="id1143"/>.</p>&#13;
</li>&#13;
</ul>&#13;
</div></section>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Showing a Notification" data-type="sect1"><div class="sect1" id="id585">&#13;
<h1>Showing a Notification</h1>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Problem" data-type="sect2"><div class="sect2" id="id310">&#13;
<h2>Problem</h2>&#13;
&#13;
<p><a data-primary="notifications" data-secondary="showing" data-type="indexterm" id="ix_13-ui-elements-asciidoc24"/><a data-primary="UI elements" data-secondary="showing a notification" data-type="indexterm" id="ix_13-ui-elements-asciidoc25"/>You want to notify the user when something occurs in your app.</p>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Solution" data-type="sect2"><div class="sect2" id="id197">&#13;
<h2>Solution</h2>&#13;
&#13;
<p>Use a <code>Notification</code> object to show a native operating system notification.</p>&#13;
&#13;
<p>In order to show notifications, you must first ask the user for permission. This is done with the <code>Notification.requestPermission</code> method. To check if the user has already given permission, you can check the <code>Notification.permission</code> property.</p>&#13;
<aside data-type="sidebar" epub:type="sidebar"><div class="sidebar" id="id1144">&#13;
<h1>Notifications Versus Push Notifications</h1>&#13;
<p><a data-primary="notifications" data-secondary="push notifications versus" data-type="indexterm" id="id1145"/><a data-primary="push notifications" data-type="indexterm" id="id1146"/>The notifications described in this recipe are only triggered when a user is on the page. This is different than push notifications, which can be delivered even when the page is not active. This is more involved, and it typically requires the use of a third-party service.</p>&#13;
</div></aside>&#13;
&#13;
<p><a data-type="xref" href="#example13-23">Example 13-23</a> shows a helper function that checks the permission, asks the user for permission if necessary, and returns a boolean indicating whether or not notifications can be shown.</p>&#13;
<div data-type="example" id="example13-23">&#13;
<h5><span class="label">Example 13-23. </span>Checking notification permissions</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="nx">async</code> <code class="kd">function</code> <code class="nx">getPermission</code><code class="p">()</code> <code class="p">{</code>&#13;
  <code class="c1">// If the user has already explicitly denied permission, don't ask again.</code>&#13;
  <code class="k">if</code> <code class="p">(</code><code class="nx">Notification</code><code class="p">.</code><code class="nx">permission</code> <code class="o">!==</code> <code class="s1">'denied'</code><code class="p">)</code> <code class="p">{</code>&#13;
    <code class="c1">// The result of this permission request will update the Notification.permission</code>&#13;
    <code class="c1">// property.</code>&#13;
    <code class="c1">// The permission request returns a Promise.</code>&#13;
    <code class="nx">await</code> <code class="nx">Notification</code><code class="p">.</code><code class="nx">requestPermission</code><code class="p">();</code>&#13;
  <code class="p">}</code>&#13;
&#13;
  <code class="c1">// Only show a notification if Notification.permission is 'granted'.</code>&#13;
  <code class="k">return</code> <code class="nx">Notification</code><code class="p">.</code><code class="nx">permission</code> <code class="o">===</code> <code class="s1">'granted'</code><code class="p">;</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>Once you have checked for permission, you can send a new notification by creating a new <code>Notification</code> instance. Use the <code>getPermission</code> helper to determine if a notification should be shown (see <a data-type="xref" href="#example13-24">Example 13-24</a>).</p>&#13;
<div data-type="example" id="example13-24">&#13;
<h5><span class="label">Example 13-24. </span>Showing a notification</h5>&#13;
&#13;
<pre data-code-language="javascript" data-type="programlisting"><code class="k">if</code> <code class="p">(</code><code class="nx">await</code> <code class="nx">getPermission</code><code class="p">())</code> <code class="p">{</code>&#13;
  <code class="k">new</code> <code class="nx">Notification</code><code class="p">(</code><code class="s1">'Hello!'</code><code class="p">,</code> <code class="p">{</code>&#13;
    <code class="nx">body</code><code class="o">:</code> <code class="s1">'This is a test notification'</code>&#13;
  <code class="p">});</code>&#13;
<code class="p">}</code></pre></div>&#13;
&#13;
<p>If you try to show a notification when permission hasn’t been granted, the <code>Notification</code> object will trigger an <code>error</code> event.</p>&#13;
&#13;
<p><a data-type="xref" href="#figure_notification">Figure 13-5</a> shows what this notification might look like on a desktop computer.</p>&#13;
&#13;
<figure><div class="figure" id="figure_notification">&#13;
<img alt="A screenshot of a notification rendered on macOS 14" src="assets/wacb_1305.png"/>&#13;
<h6><span class="label">Figure 13-5. </span>A notification rendered on macOS 14</h6>&#13;
</div></figure>&#13;
</div></section>&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
&#13;
<section data-pdf-bookmark="Discussion" data-type="sect2"><div class="sect2" id="id198">&#13;
<h2>Discussion</h2>&#13;
&#13;
<p>Notifications can only be shown from apps running in a <em>secure context</em>. Typically, this means it must be served with HTTPS or from a <code>localhost</code> URL.</p>&#13;
&#13;
<p>The <code>Notification.permission</code> property has one of three values:</p>&#13;
<dl>&#13;
<dt><code>granted</code></dt>&#13;
<dd>&#13;
<p>The user has expressly granted permissions to show notifications.</p>&#13;
</dd>&#13;
<dt><code>denied</code></dt>&#13;
<dd>&#13;
<p>The user has expressly denied permission to show notifications when prompted.</p>&#13;
</dd>&#13;
<dt><code>default</code></dt>&#13;
<dd>&#13;
<p>The user hasn’t responded to a notification permission request. Browsers will treat this the same as the <code>denied</code> case.</p>&#13;
</dd>&#13;
</dl>&#13;
&#13;
<p>A <code>Notification</code> can trigger some other events as well:</p>&#13;
<dl>&#13;
<dt><code>show</code></dt>&#13;
<dd>&#13;
<p>Triggered when the notification is shown</p>&#13;
</dd>&#13;
<dt><code>close</code></dt>&#13;
<dd>&#13;
<p>Triggered when the notification closes</p>&#13;
</dd>&#13;
<dt><code>click</code></dt>&#13;
<dd>&#13;
<p>Triggered when the notification is <a data-startref="ix_13-ui-elements-asciidoc25" data-type="indexterm" id="id1147"/><a data-startref="ix_13-ui-elements-asciidoc24" data-type="indexterm" id="id1148"/>clicked<a data-startref="ix_13-ui-elements-asciidoc0" data-type="indexterm" id="id1149"/></p>&#13;
</dd>&#13;
</dl>&#13;
</div></section>&#13;
</div></section>&#13;
</div></section></body></html>