<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:epub="http://www.idpf.org/2007/ops" lang="en" xml:lang="en" xsi:schemaLocation="http://www.w3.org/2002/06/xhtml2/ http://www.w3.org/MarkUp/SCHEMA/xhtml2.xsd">
  <head>
    <title>Unknown</title>
    <link rel="stylesheet" type="text/css" href="../stylesheet.css"/>
    <link rel="stylesheet" type="text/css" href="../page_styles.css"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  </head>
  <body class="calibre"><div id="sbo-rt-content" class="calibre1"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 16. CustomResourceDefinitions (CRDs)" class="praise"><div class="dedication" id="crds">
<h1 class="calibre14"><span class="keep-together">Chapter 16. </span>CustomResourceDefinitions (CRDs)</h1>


<p class="author1">Kubernetes provides primitives that support the most common use cases required by operators of an application stack. For custom use cases, Kubernetes allows for implementing and installing extensions to the platform.</p>

<p class="author1">A CustomResourceDefinition (CRD) is a Kubernetes extension mechanism for introducing custom API primitives to fulfill requirements not covered by built-in primitives. This chapter will primarily focus on the implementation of and interaction with CRDs.</p>
<aside data-type="sidebar" epub:type="sidebar" class="calibre48"><div class="sidebar" id="id485">
<h1 class="calibre49">Coverage of Curriculum Objectives</h1>
<p class="author1">This chapter addresses the following curriculum objective:</p>

<ul class="printings">
<li class="calibre13">
<p class="author1">Discover and use resources that extend Kubernetes (CRD)</p>
</li>
</ul>
</div></aside>






<section data-type="sect1" data-pdf-bookmark="Working with CRDs" class="praise"><div class="dedication" id="id324">
<h1 class="calibre17">Working with CRDs</h1>

<p class="author1">CRDs can be understood as the schema that defines the blueprint for a custom object, and then the instantiation of those objects with the newly introduced type. For a CRD to be useful, it has to be backed by a <em class="calibre3">controller</em>. Controllers interact with the Kubernetes API and implement the reconciliation logic that interacts with CRD objects. The combination of CRDs and controllers is commonly referred to as the <em class="calibre3">operator pattern</em>. The exam does not require you to have an understanding of controllers; therefore, their implementation won’t be covered in this chapter. <a data-type="xref" href="#operator_pattern" class="calibre10">Figure 16-1</a> shows the operator patterns with all its moving parts.</p>

<figure class="calibre35"><div id="operator_pattern" class="figure">
<img src="Images/ckd2_1601.png" alt="ckd2 1601" class="calibre98"/>
<h6 class="calibre32"><span class="keep-together">Figure 16-1. </span>The Kubernetes operator pattern</h6>
</div></figure>

<p class="author1">The Kubernetes community has implemented many useful operators discoverable on <a href="https://operatorhub.io/" class="calibre10">OperatorHub.io</a>. You can install many of those operators with a single <code class="calibre15">kubectl</code>. A prominent operator is the <a href="https://external-secrets.io/" class="calibre10">External Secrets Operator</a> that helps with integrating external Secret managers, like AWS Secrets Manager and HashiCorp Vault, with Kubernetes. For the exam, you will need to understand how to discover CRD schemas provided by external operators and how to interact with objects that follow the CRD schema. We’ll go a little further in this chapter and talk about creating your own CRD schemas.</p>








<section data-type="sect2" data-pdf-bookmark="Example CRD" class="praise"><div class="dedication" id="id325">
<h2 class="calibre33">Example CRD</h2>

<p class="author1">The implementation of and interaction with a CRD is best explained by example. We will implement and instantiate a CRD that represents a smoke test for a Service object to be executed after an application stack has been deployed to Kubernetes.</p>
<dl class="calibre18">
<dt class="calibre19">Technical baseline</dt>
<dd class="calibre20">
<p class="calibre21">Assume you are in charge of managing a web-based application. The Kubernetes objects needed to manage the application consist of a Deployment for running an application in Pods and the Service object that routes the network traffic to the replicas.</p>
</dd>
<dt class="calibre19">Desired functionality</dt>
<dd class="calibre20">
<p class="calibre21">A smoke test should be triggered automatically after deploying the Kubernetes objects responsible for operating the application. At runtime, the smoke test executes HTTPS calls to an endpoint of the application by targeting the Service’s DNS name. The result of the smoke test (in the case of success or failure) will be sent to an external service so it can be rendered as charts and graphs in a 
<span class="keep-together">dashboard.</span></p>
</dd>
<dt class="calibre19">Goal</dt>
<dd class="calibre20">
<p class="calibre21">To implement this functionality, you could decide to write a CRD and controller. In this chapter, we are only going to cover the CRD for a smoke test, not the controller that would do the heavy lifting of executing the smoke test.</p>
</dd>
</dl>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Implementing a CRD Schema" class="praise"><div class="dedication" id="id326">
<h2 class="calibre33">Implementing a CRD Schema</h2>

<p class="author1">To make a CRD operational, you have to create two objects: the custom resource schema and the custom resource object. The custom resource schema specifies the CRD blueprint in the form of an OpenAPI v3 specification. The custom resource object follows the specification of the CRD schema and assigns values to properties available to the schema.</p>
<div data-type="tip" class="calibre26"><h1 class="calibre34">Using Kubebuilder to generate CRDs</h1>
<p class="author1">A CRD schema specification can become quite extensive. To avoid writing those specification by hand, take a look at the <a href="https://github.com/kubernetes-sigs/kubebuilder" class="calibre10">Kubebuilder</a> project. One Kubebuilder functionality is the ability to generate CRD schemas with minimal input provided by the user. Using the tool can help save time getting a Kubernetes operator project started.</p>
</div>

<p class="author1">First, let’s look at the custom resource schema of the smoke test. The schema uses the kind CustomResourceDefinition, as shown in <a data-type="xref" href="#custom_resource_schema" class="calibre10">Example 16-1</a>.</p>

<p class="author1">While I can’t explain the meaning of every attribute of a CustomResourceDefinition here, I want to point out some important aspects. The CustomResourceDefinition specifies the group, version, and names of the custom primitive. It also spells out all configurable attributes, including their data types. For a more detailed description of the CustomResourceDefinition see the <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/" class="calibre10">Kubernetes documentation</a>.</p>
<div id="custom_resource_schema" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 16-1. </span>A custom resource schema to represent a smoke test</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">apiextensions.k8s.io/v1</code><code class="w">
</code><code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">CustomResourceDefinition</code><code class="w">
</code><code class="nt">metadata</code><code class="p">:</code><code class="w">
</code><code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">smoketests.stable.bmuschko.com</code><code class="w">   </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO1-1" href="#callout_customresourcedefinitions__crds__CO1-1"><img src="Images/1.png" alt="1" class="calibre51"/></a><code class="w">
</code><code class="nt">spec</code><code class="p">:</code><code class="w">
</code><code class="w">  </code><code class="nt">group</code><code class="p">:</code><code class="w"> </code><code class="calibre15">stable.bmuschko.com</code><code class="w">             </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO1-2" href="#callout_customresourcedefinitions__crds__CO1-2"><img src="Images/2.png" alt="2" class="calibre51"/></a><code class="w">
</code><code class="w">  </code><code class="nt">versions</code><code class="p">:</code><code class="w">
</code><code class="w">    </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">v1</code><code class="w">                           </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO1-3" href="#callout_customresourcedefinitions__crds__CO1-3"><img src="Images/3.png" alt="3" class="calibre51"/></a><code class="w">
</code><code class="w">      </code><code class="nt">served</code><code class="p">:</code><code class="w"> </code><code class="calibre15">true</code><code class="w">
</code><code class="w">      </code><code class="nt">storage</code><code class="p">:</code><code class="w"> </code><code class="calibre15">true</code><code class="w">
</code><code class="w">      </code><code class="nt">schema</code><code class="p">:</code><code class="w">
</code><code class="w">        </code><code class="nt">openAPIV3Schema</code><code class="p">:</code><code class="w">
</code><code class="w">          </code><code class="nt">type</code><code class="p">:</code><code class="w"> </code><code class="calibre15">object</code><code class="w">
</code><code class="w">          </code><code class="nt">properties</code><code class="p">:</code><code class="w">                    </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO1-4" href="#callout_customresourcedefinitions__crds__CO1-4"><img src="Images/4.png" alt="4" class="calibre51"/></a><code class="w">
</code><code class="w">            </code><code class="nt">spec</code><code class="p">:</code><code class="w">
</code><code class="w">              </code><code class="nt">type</code><code class="p">:</code><code class="w"> </code><code class="calibre15">object</code><code class="w">
</code><code class="w">              </code><code class="nt">properties</code><code class="p">:</code><code class="w">
</code><code class="w">                </code><code class="nt">service</code><code class="p">:</code><code class="w">
</code><code class="w">                  </code><code class="nt">type</code><code class="p">:</code><code class="w"> </code><code class="calibre15">string</code><code class="w">
</code><code class="w">                </code><code class="nt">path</code><code class="p">:</code><code class="w">
</code><code class="w">                  </code><code class="nt">type</code><code class="p">:</code><code class="w"> </code><code class="calibre15">string</code><code class="w">
</code><code class="w">                </code><code class="nt">timeout</code><code class="p">:</code><code class="w">
</code><code class="w">                  </code><code class="nt">type</code><code class="p">:</code><code class="w"> </code><code class="calibre15">integer</code><code class="w">
</code><code class="w">                </code><code class="nt">retries</code><code class="p">:</code><code class="w">
</code><code class="w">                  </code><code class="nt">type</code><code class="p">:</code><code class="w"> </code><code class="calibre15">integer</code><code class="w">
</code><code class="w">  </code><code class="nt">scope</code><code class="p">:</code><code class="w"> </code><code class="calibre15">Namespaced</code><code class="w">
</code><code class="w">  </code><code class="nt">names</code><code class="p">:</code><code class="w">                                 </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO1-5" href="#callout_customresourcedefinitions__crds__CO1-5"><img src="Images/5.png" alt="5" class="calibre51"/></a><code class="w">
</code><code class="w">    </code><code class="nt">plural</code><code class="p">:</code><code class="w"> </code><code class="calibre15">smoketests</code><code class="w">
</code><code class="w">    </code><code class="nt">singular</code><code class="p">:</code><code class="w"> </code><code class="calibre15">smoketest</code><code class="w">
</code><code class="w">    </code><code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">SmokeTest</code><code class="w">
</code><code class="w">    </code><code class="nt">shortNames</code><code class="p">:</code><code class="w">
</code><code class="w">    </code><code class="calibre15">-</code><code class="w"> </code><code class="calibre15">st</code></pre></div>
<dl class="calibre18">
<dt class="calibre52"><a class="calibre10" id="callout_customresourcedefinitions__crds__CO1-1" href="#co_customresourcedefinitions__crds__CO1-1"><img src="Images/1.png" alt="1" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">The combination of the identifiers <code class="calibre15">&lt;plural&gt;</code>.<code class="calibre15">&lt;group&gt;</code>.</p></dd>
<dt class="calibre52"><a class="calibre10" id="callout_customresourcedefinitions__crds__CO1-2" href="#co_customresourcedefinitions__crds__CO1-2"><img src="Images/2.png" alt="2" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">The API group to be used by CRD.</p></dd>
<dt class="calibre52"><a class="calibre10" id="callout_customresourcedefinitions__crds__CO1-3" href="#co_customresourcedefinitions__crds__CO1-3"><img src="Images/3.png" alt="3" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">The versions supported by the CRD. A version can define 0..n attributes.</p></dd>
<dt class="calibre52"><a class="calibre10" id="callout_customresourcedefinitions__crds__CO1-4" href="#co_customresourcedefinitions__crds__CO1-4"><img src="Images/4.png" alt="4" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">The attributes to be set by the custom type.</p></dd>
<dt class="calibre52"><a class="calibre10" id="callout_customresourcedefinitions__crds__CO1-5" href="#co_customresourcedefinitions__crds__CO1-5"><img src="Images/5.png" alt="5" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">The identifiers for the custom type, e.g., the kind and the singular/plural/short names.</p></dd>
</dl>

<p class="author1">The file <em class="calibre3">smoketest-resource.yaml</em> contains the YAML content shown in the previous example. You can now create the object for the schema with the typical <code class="calibre15">kubectl</code> 
<span class="keep-together">commands:</span></p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl apply -f smoketest-resource.yaml</strong>
customresourcedefinition.apiextensions.k8s.io/smoketests.stable.bmuschko.com \
created
</pre>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Instantiating an Object for the CRD" class="praise"><div class="dedication" id="id327">
<h2 class="calibre33">Instantiating an Object for the CRD</h2>

<p class="author1">Once the schema object has been created, you can create objects for the new custom type. The YAML manifest in <a data-type="xref" href="#custom_resource_object" class="calibre10">Example 16-2</a> defines a primitive of type SmokeTest named <code class="calibre15">backend-smoke-test</code> for the Service named <code class="calibre15">backend</code>. As you can see in the manifest, additional attributes can be specified to fine-tune its runtime behavior.</p>
<div id="custom_resource_object" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 16-2. </span>Instantiation of CRD kind SmokeTest</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">stable.bmuschko.com/v1</code><code class="w">   </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO2-1" href="#callout_customresourcedefinitions__crds__CO2-1"><img src="Images/1.png" alt="1" class="calibre51"/></a><code class="w">
</code><code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">SmokeTest</code><code class="w">                      </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO2-2" href="#callout_customresourcedefinitions__crds__CO2-2"><img src="Images/2.png" alt="2" class="calibre51"/></a><code class="w">
</code><code class="nt">metadata</code><code class="p">:</code><code class="w">
</code><code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">backend-smoke-test</code><code class="w">
</code><code class="nt">spec</code><code class="p">:</code><code class="w">
</code><code class="w">  </code><code class="nt">service</code><code class="p">:</code><code class="w"> </code><code class="calibre15">backend</code><code class="w">                   </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO2-3" href="#callout_customresourcedefinitions__crds__CO2-3"><img src="Images/3.png" alt="3" class="calibre51"/></a><code class="w">
</code><code class="w">  </code><code class="nt">path</code><code class="p">:</code><code class="w"> </code><code class="calibre15">/health</code><code class="w">                      </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO2-4" href="#callout_customresourcedefinitions__crds__CO2-3"><img src="Images/3.png" alt="3" class="calibre51"/></a><code class="w">
</code><code class="w">  </code><code class="nt">timeout</code><code class="p">:</code><code class="w"> </code><code class="calibre15">600</code><code class="w">                       </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO2-5" href="#callout_customresourcedefinitions__crds__CO2-3"><img src="Images/3.png" alt="3" class="calibre51"/></a><code class="w">
</code><code class="w">  </code><code class="nt">retries</code><code class="p">:</code><code class="w"> </code><code class="calibre15">3</code><code class="w">                         </code><a class="calibre10" id="co_customresourcedefinitions__crds__CO2-6" href="#callout_customresourcedefinitions__crds__CO2-3"><img src="Images/3.png" alt="3" class="calibre51"/></a></pre></div>
<dl class="calibre18">
<dt class="calibre52"><a class="calibre10" id="callout_customresourcedefinitions__crds__CO2-1" href="#co_customresourcedefinitions__crds__CO2-1"><img src="Images/1.png" alt="1" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">The group and Version of the custom kind.</p></dd>
<dt class="calibre52"><a class="calibre10" id="callout_customresourcedefinitions__crds__CO2-2" href="#co_customresourcedefinitions__crds__CO2-2"><img src="Images/2.png" alt="2" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">The kind defined by CRD.</p></dd>
<dt class="calibre52"><a class="calibre10" id="callout_customresourcedefinitions__crds__CO2-3" href="#co_customresourcedefinitions__crds__CO2-3"><img src="Images/3.png" alt="3" class="calibre51"/></a></dt>
<dd class="calibre20"><p class="calibre53">The attributes and their values that make the custom kind configurable.</p></dd>
</dl>

<p class="author1">Go ahead and create the SmokeTest object from the file <em class="calibre3">smoketest.yaml</em>:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl apply -f smoketest.yaml</strong>
smoketest.stable.bmuschko.com/backend-smoke-test created
</pre>

<p class="author1">You can interact with the <code class="calibre15">backend-smoke-test</code> like any other object in Kubernetes. For example, to list the object use the <code class="calibre15">get</code> command. To delete the object, use the <code class="calibre15">delete</code> command. The following commands show those operations in action:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl get smoketest backend-smoke-test</strong>
NAME                 AGE
backend-smoke-test   12s
<strong class="calibre38">$ kubectl delete smoketest backend-smoke-test</strong>
smoketest.stable.bmuschko.com "backend-smoke-test" deleted
</pre>

<p class="author1">You can create more objects of this type as needed to execute smoke tests against other Services, although each of the objects needs a unique name. We now have the CRD schema object in place. In the next section, we’ll interact with it.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Discovering CRDs" class="praise"><div class="dedication" id="id328">
<h2 class="calibre33">Discovering CRDs</h2>

<p class="author1">A CRD schema registers a new API resource. Every API resource can be discovered. You can list custom 
<span class="keep-together">API resources</span> in the same way as you would for built-in API resources. The following command lists API resources by the API group 
<span class="keep-together"><code class="calibre15">stable.bmuschko.com</code>:</span></p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl api-resources --api-group=stable.bmuschko.com</strong>
NAME         SHORTNAMES   APIVERSION               NAMESPACED   KIND
smoketests   st           stable.bmuschko.com/v1   true         SmokeTest
</pre>

<p class="author1">CRD objects can be interacted with like any other object using <code class="calibre15">kubectl</code>. You can create, read, update, and delete them. The following command lists all CRDs installed in the cluster:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl get crds</strong>
NAME                             CREATED AT
smoketests.stable.bmuschko.com   2023-05-04T14:49:40Z
</pre>

<p class="author1">The CRD you see in the output is the one representing a smoke test. If you see other CRDs in the output then they may have been provided by the external operator installed in your cluster.</p>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Implementing a Controller" class="praise"><div class="dedication" id="id329">
<h2 class="calibre33">Implementing a Controller</h2>

<p class="author1">The smoke test object just represents data and won’t be useful by itself. You need to add a controller implementation that does something with those objects. In a nutshell, a controller acts as a reconciliation process by inspecting the state of CRD objects via calls to the Kubernetes API.</p>

<p class="author1">At runtime, a controller implementation needs to poll for new SmokeTest objects and perform the HTTPS requests to the configured Service endpoint. Finally, the controller inspects the response from the request, evaluates the result, and sends it to an external service to be recorded in a database. A dashboard can then tap into historical results and render them as needed, e.g., as charts and graphs.</p>

<p class="author1">Controllers can use one of the Kubernetes <a href="https://kubernetes.io/docs/reference/using-api/client-libraries/" class="calibre10">client libraries</a>, written in Go or Python, to access custom resources. Visit the relevant documentation for more information and examples on how to implement a controller.</p>
</div></section>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Summary" class="praise"><div class="dedication" id="id330">
<h1 class="calibre17">Summary</h1>

<p class="author1">A CRD schema defines the structure of a custom resource. The schema includes the group, name, version, and its configurable attributes. New objects of this kind can be created after registering the schema. You can interact with a custom object using <code class="calibre15">kubectl</code> with the same CRUD commands used by any other primitive.</p>

<p class="author1">CRDs realize their full potential when combined with a controller implementation. The controller implementation inspects the state of specific custom objects and reacts based on their discovered state. Kubernetes refers to the CRD and the corresponding controller as the operator pattern. The Kubernetes community has implemented many operators to fulfill custom requirements. You can install them into your cluster to reuse the functionality.</p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Exam Essentials" class="praise"><div class="dedication" id="id331">
<h1 class="calibre17">Exam Essentials</h1>
<dl class="calibre18">
<dt class="calibre19">Acquire a high-level understanding of configurable options for a CRD schema</dt>
<dd class="calibre20">
<p class="calibre21">You are not expected to implement a CRD schema. All you need to know is how to discover and use them with <code class="calibre15">kubectl</code>. Controller implementations are definitely outside the scope of the exam.</p>
</dd>
<dt class="calibre19">Practice the commands for installing and discovering CRDs</dt>
<dd class="calibre20">
<p class="calibre21">Learn how to use the <code class="calibre15">kubectl get crds</code> command to discover installed CRDs, and how to create objects from a CRD schema. If you want to explore further, install an open source CRD, such as the <a href="https://github.com/prometheus-operator/prometheus-operator" class="calibre10">Prometheus operator</a> or the <a href="https://github.com/jaegertracing/jaeger-operator" class="calibre10">Jaeger operator</a>, and inspect its schema.</p>
</dd>
</dl>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Sample Exercises" class="praise"><div class="dedication" id="id332">
<h1 class="calibre17">Sample Exercises</h1>

<p class="author1">Solutions to these exercises are available in <a href="app01_split_012.xhtml#appendix_a_crds" class="calibre10">Appendix A</a>.</p>
<ol class="calibre55">
<li class="calibre56">
<p class="author1">You decide to manage a <a href="https://www.mongodb.com/" class="calibre10">MongoDB</a> installation in Kubernetes with the help of the <a href="https://github.com/mongodb/mongodb-kubernetes-operator" class="calibre10">official community operator</a>. This operator provides a CRD. After installing the operator, you will interact with the CRD.</p>

<p class="author1">Navigate to the directory <em class="calibre3">app-a/ch16/mongodb-operator</em> of the checked-out GitHub repository <a href="https://github.com/bmuschko/ckad-study-guide" class="calibre10"><em class="calibre3">bmuschko/ckad-study-guide</em></a>. Install the operator using the following command: <code class="calibre15">kubectl apply -f</code> <code class="calibre15">mongodbcommunity.mongodb.com_mongodbcommunity.yaml</code>.</p>

<p class="author1">List all CRDs using the appropriate <code class="calibre15">kubectl</code> command. Can you identify the CRD that was installed by the installation procedure?</p>

<p class="author1">Inspect the schema of the CRD. What are the type and property names of this CRD?</p>
</li>
<li class="calibre56">
<p class="author1">As an application developer, you may want to install Kubernetes functionality that extends the platform using the Kubernetes operator pattern. The objective of this exercise is to familiarize yourself with creating and managing CRDs. You will not need to write a controller.</p>

<p class="author1">Create a CRD resource named <code class="calibre15">backup.example.com</code> with the following 
<span class="keep-together">specifications:</span></p>
<ul class="printings">
<li class="calibre13">
<p class="author1">Group: <code class="calibre15">example.com</code></p>
</li>
<li class="calibre13">
<p class="author1">Version: <code class="calibre15">v1</code></p>
</li>
<li class="calibre13">
<p class="author1">Kind: <code class="calibre15">Backup</code></p>
</li>
<li class="calibre13">
<p class="author1">Singular: <code class="calibre15">backup</code></p>
</li>
</ul>

<ul class="printings">
<li class="calibre13">
<p class="author1">Plural: <code class="calibre15">backups</code></p>
</li>
<li class="calibre13">
<p class="author1">Properties of type <code class="calibre15">string</code>: <code class="calibre15">cronExpression</code>, <code class="calibre15">podName</code>, <code class="calibre15">path</code></p>
</li>
</ul>

<p class="author1">Retrieve the details for the <code class="calibre15">Backup</code> custom resource created in the previous step.</p>

<p class="author1">Create a custom object named <code class="calibre15">nginx-backup</code> for the CRD. Provide the following property values:</p>
<ul class="printings">
<li class="calibre13">
<p class="author1"><code class="calibre15">cronExpression</code>: <code class="calibre15">0 0 * * *</code></p>
</li>
<li class="calibre13">
<p class="author1"><code class="calibre15">podName</code>: <code class="calibre15">nginx</code></p>
</li>
<li class="calibre13">
<p class="author1"><code class="calibre15">path</code>: <code class="calibre15">/usr/local/nginx</code></p>
</li>
</ul>

<p class="author1">Retrieve the details for the <code class="calibre15">nginx-backup</code> object created in the previous step.</p>
</li>

</ol>
</div></section>
</div></section></div></body>
</html>