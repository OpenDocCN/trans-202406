<html><head></head><body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 4. Working with Database Structures"><div class="chapter" id="CH4_MODIFY">
<h1><span class="label">Chapter 4. </span>Working with Database Structures</h1>


<p>This chapter shows you how to create your own databases, add and remove structures such as tables and indexes, and make choices about column types in your tables. It focuses on the syntax and features of SQL, and not the semantics of conceiving, specifying, and refining a database design; you’ll find an introductory description of database design techniques in <a data-type="xref" href="ch02.xhtml#CH2_DESIGN">Chapter 2</a>. To work through this chapter, you need to understand how to work with an existing database and its tables, as discussed in <a data-type="xref" href="ch03.xhtml#CH3_BASICS">Chapter 3</a>.</p>

<p>This chapter lists the structures in the sample <code>sakila</code> database. If you followed the instructions for loading the database in <a data-type="xref" href="ch02.xhtml#BAS-SEC-MODELING-EXAMPLES">“Entity Relationship Modeling Examples”</a>, you’ll already have the database available and know how to restore it after you’ve modified its structures.</p>

<p>When you finish this chapter, you’ll have all the basics required to create, modify, and delete database structures. Together with the techniques you learned in <a data-type="xref" href="ch03.xhtml#CH3_BASICS">Chapter 3</a>, you’ll have the skills to carry out a wide range of basic operations. Chapters <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch05.xhtml#CH5_ADV1">5</a> and <a data-type="xref" data-xrefstyle="select:labelnumber" href="ch07.xhtml#CH7_DOING_MORE">7</a> cover skills that allow you to do more advanced operations with MySQL.</p>






<section data-type="sect1" data-pdf-bookmark="Creating and Using Databases"><div class="sect1" id="MOD-SEC-CREATEDB">
<h1>Creating and Using Databases</h1>

<p>When you’ve finished designing a database, the first practical<a data-type="indexterm" data-primary="CREATE DATABASE" id="ch04-cre"/><a data-type="indexterm" data-primary="database structures" data-secondary="creating databases" data-see="CREATE DATABASE" id="idm46177494722456"/> step to take with MySQL is to create it. You do this with the <code>CREATE DATABASE</code> statement. Suppose you want to create a database with the name <code>lucy</code>. Here’s the statement you’d type:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">DATABASE</code><code> </code><code class="n">lucy</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.10 sec)</pre>

<p>We assume here that you know how to connect using the MySQL client, as described in <a data-type="xref" href="ch01.xhtml#CH1_INSTALL">Chapter 1</a>. We also assume that you’re able to connect as the root user or as another user who can create, delete, and modify structures (you’ll find a detailed discussion on user privileges in <a data-type="xref" href="ch08.xhtml#CH8_USER_MANAGEMENT">Chapter 8</a>). Note that when you create the database, MySQL says that one row was affected. This isn’t in fact a normal row in any specific database, but a new entry added to the list that you <a data-type="indexterm" data-primary="USE database" data-secondary="SHOW DATABASES" id="idm46177494709144"/><a data-type="indexterm" data-primary="SHOW" data-secondary="DATABASES" data-tertiary="after creating" id="idm46177494708200"/>see with the <code>SHOW DATABASES</code> command.</p>

<p>Once you’ve created the database, the next step is to use<a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="USE database" id="ch04-usr"/><a data-type="indexterm" data-primary="USE database" data-secondary="after creating" id="ch04-usr2"/><a data-type="indexterm" data-primary="database structures" data-secondary="using databases" data-see="USE database" id="idm46177494684664"/> it—that is, choose it as the database you’re working with. You do this with the MySQL <code>USE</code> command:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">USE</code><code> </code><code class="n">lucy</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Database changed</pre>

<p>This command must be entered on one line and need not be terminated with a semicolon, though we usually do so automatically through habit. Once you’ve used (selected) the database, you can start creating tables, indexes, and other structures using the steps discussed in the next section.</p>

<p>Before we move on to creating other structures, let’s discuss a few features and limitations of creating databases. First, let’s see what happens if you try to create a database that already exists:<a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="IF NOT EXISTS" id="idm46177494674056"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">DATABASE</code><code> </code><code class="n">lucy</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1007 (HY000): Can't create database 'lucy'; database exists</pre>

<p>You can avoid this error by adding the <code>IF NOT EXISTS</code> keyword phrase to the 
<span class="keep-together">statement:</span></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">DATABASE</code><code> </code><code class="k">IF</code><code> </code><code class="k">NOT</code><code> </code><code class="k">EXISTS</code><code> </code><code class="n">lucy</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.00 sec)</pre>

<p>You can see that MySQL didn’t complain, but it didn’t do anything either: the <code>0 rows affected</code> message indicates that no data was changed. This addition is useful when you’re adding SQL statements to a script: it prevents the script from aborting on error.</p>

<p>Let’s look at how to choose database names<a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="name of database" id="idm46177494611048"/><a data-type="indexterm" data-primary="names" data-secondary="tables" id="idm46177494610072"/><a data-type="indexterm" data-primary="tables" data-secondary="names" id="idm46177494609128"/><a data-type="indexterm" data-primary="database design" data-secondary="names of databases" id="idm46177494608184"/><a data-type="indexterm" data-primary="names" data-secondary="databases" id="idm46177494607240"/> and use character case. Database names define physical directory (or folder) names on disk. <a data-type="indexterm" data-primary="names" data-secondary="case sensitivity" data-seealso="case sensitivity" id="idm46177494606056"/><a data-type="indexterm" data-primary="case sensitivity" data-secondary="database names" id="idm46177494585736"/><a data-type="indexterm" data-primary="Linux" data-secondary="name case sensitivity" id="idm46177494584792"/><a data-type="indexterm" data-primary="macOS" data-secondary="name case sensitivity" id="idm46177494583848"/><a data-type="indexterm" data-primary="Windows 10" data-secondary="name case sensitivity" id="idm46177494582904"/><a data-type="indexterm" data-primary="PC" data-see="Windows 10" id="idm46177494581960"/>On some operating systems, directory names are case-sensitive; on others, case doesn’t matter. For example, Unix-like systems such as Linux and macOS are typically case-sensitive, whereas Windows isn’t. The result is that database names have the same restrictions: when case matters to the operating system, it matters to MySQL. For example, on a Linux machine, <code>LUCY</code>, <code>lucy</code>, and <code>Lucy</code> are different database names; on Windows, they refer to just one database. Using incorrect capitalization under Linux or macOS will cause MySQL to complain:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="n">SaKilA</code><code class="p">.</code><code class="n">AcTor_id</code><code> </code><code class="k">FROM</code><code> </code><code class="n">ACTor</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1146 (42S02): Table 'sakila.ACTor' doesn't exist</pre>

<p>But under Windows, this will normally work.</p>
<div data-type="tip"><h6>Tip</h6>
<p>To make your SQL machine-independent, we recommend<a data-type="indexterm" data-primary="case sensitivity" data-secondary="machine independence via lowercase" id="idm46177494566008"/><a data-type="indexterm" data-primary="names" data-secondary="case sensitivity" data-tertiary="machine independence via lowercase" id="idm46177494565064"/><a data-type="indexterm" data-primary="portability" data-secondary="names in lowercase" id="idm46177494563880"/> that you consistently use lowercase names for databases (and for tables, columns, aliases, and indexes). That’s not a requirement, though, and as earlier examples in this book have demonstrated, you’re welcome to use whatever naming convention you are comfortable with. Just be consistent and remember how MySQL behaves on different OSs.</p>
</div>

<p>This behavior is controlled by the <code>lower_case_table_names</code> parameter.<a data-type="indexterm" data-primary="lower_case_table_names parameter" id="idm46177494561304"/> If it’s set to <code>0</code>, table names are stored as specified, and comparisons are case-sensitive. If it’s set to <code>1</code>, table names are stored in lowercase on disk, and comparisons are not case-sensitive. If this parameter is set to <code>2</code>, table names are stored as given but compared in lowercase. On Windows, the default value is <code>1</code>. On macOS, the default is <code>2</code>. On Linux, a value of <code>2</code> is not supported; the server forces the value to <code>0</code> instead.</p>

<p>There are other restrictions on database names. They can be at most 64 characters in length. <a data-type="indexterm" data-primary="names" data-secondary="length maximum" id="idm46177494537240"/><a data-type="indexterm" data-primary="reserved words" id="idm46177494536264"/>You also shouldn’t use MySQL reserved words, such as <code>SELECT</code>, <code>FROM</code>, and <code>USE</code>, as names for structures; these can confuse the MySQL parser, making it impossible to interpret the meaning of your statements. <a data-type="indexterm" data-primary="` (backtick)" data-primary-sortas="#backtick" id="idm46177494533976"/><a data-type="indexterm" data-primary="backtick (`)" id="idm46177494533000"/>You can get around this restriction by enclosing the reserved word in backticks (<code>`</code>), but it’s more trouble remembering to do so than it’s worth. In addition, you can’t use certain characters in the names—specifically, the forward slash, backward slash, semicolon, and period characters—and a database name can’t end in whitespace. Again, the use of these characters confuses the MySQL parser and can result in unpredictable behavior. <a data-type="indexterm" data-primary="semicolon (;)" id="idm46177494531432"/>For example, here’s what happens when you insert a semicolon into a database name:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">DATABASE</code><code> </code><code class="k">IF</code><code> </code><code class="k">NOT</code><code> </code><code class="k">EXISTS</code><code> </code><code class="n">lu</code><code class="p">;</code><code class="n">cy</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual
that corresponds to your MySQL server version for the right syntax to use
near 'cy' at line 1</pre>

<p>Since more than one SQL statement can be on a single line, the result is that a database <code>lu</code> is created, and then an error is generated by the very short, unexpected SQL statement <code>cy;</code>. If you really want to create a database with a semicolon in its name, you can do that with backticks:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">DATABASE</code><code> </code><code class="k">IF</code><code> </code><code class="k">NOT</code><code> </code><code class="k">EXISTS</code><code> </code><code class="ss">`lu;cy`</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.01 sec)</pre>

<p>And you can see that you now have two new databases:<a data-type="indexterm" data-startref="ch04-cre" id="idm46177494480856"/><a data-type="indexterm" data-startref="ch04-usr" id="idm46177494480184"/><a data-type="indexterm" data-startref="ch04-usr2" id="idm46177494479512"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="k">DATABASES</code><code> </code><code class="k">LIKE</code><code> </code><code class="ss">`lu%`</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+----------------+
| Database (lu%) |
+----------------+
| lu             |
| lu;cy          |
+----------------+
2 rows in set (0.01 sec)</pre>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Creating Tables"><div class="sect1" id="MOD-SEC-CREATETABLE">
<h1>Creating Tables</h1>

<p>This section covers topics on table structures. We show you how to:<a data-type="indexterm" data-primary="database structures" data-secondary="tables" data-see="tables" id="idm46177494447960"/></p>

<ul>
<li>
<p>Create tables, through introductory examples.</p>
</li>
<li>
<p>Choose names for tables and table-related structures.</p>
</li>
<li>
<p>Understand and choose column types.</p>
</li>
<li>
<p>Understand and choose keys and indexes.</p>
</li>
<li>
<p>Use the proprietary MySQL <code>AUTO_INCREMENT</code> feature.</p>
</li>
</ul>

<p>When you finish this section, you’ll have completed all of the basic material on creating database structures; the remainder of this chapter covers the sample <code>sakila</code> database and how to alter and remove existing structures.</p>








<section data-type="sect2" data-pdf-bookmark="Basics"><div class="sect2" id="idm46177494421048">
<h2>Basics</h2>

<p>For the examples in this section, we’ll assume that the<a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="creating tables" data-tertiary="basics" id="ch04-ate"/><a data-type="indexterm" data-primary="tables" data-secondary="creating tables" data-tertiary="basics" id="ch04-ate2"/><a data-type="indexterm" data-primary="sakila example database" data-secondary="creating from scratch" id="ch04-ate3"/><a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="sakila created from scratch" id="ch04-ate4"/> database <code>sakila</code> hasn’t yet been created. If you want to follow along with the examples and you have already loaded the database, you can drop it for this section and reload it later; dropping it removes the database, its tables, and all of the data, but the original is easy to restore by following the steps in <a data-type="xref" href="ch02.xhtml#BAS-SEC-MODELING-EXAMPLES">“Entity Relationship Modeling Examples”</a>. Here’s how you drop it temporarily:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">DROP</code><code> </code><code class="k">DATABASE</code><code> </code><code class="n">sakila</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 23 rows affected (0.06 sec)</pre>

<p>The <code>DROP</code> statement is discussed further at the end of this chapter in <a data-type="xref" href="#MOD-SEC-DELETE">“Deleting Structures”</a>.</p>

<p>To begin, create the database <code>sakila</code> using the statement:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">DATABASE</code><code> </code><code class="n">sakila</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<p>Then select the database with:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">USE</code><code> </code><code class="n">sakila</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Database changed</pre>

<p>We’re now ready to begin creating the tables that will hold our<a data-type="indexterm" data-primary="tables" data-secondary="creating tables" data-tertiary="sakila database re-created" id="ch04-crt2"/><a data-type="indexterm" data-primary="CREATE TABLE" data-secondary="basics" id="ch04-crt4"/><a data-type="indexterm" data-primary="CREATE TABLE" data-secondary="sakila database re-created" id="ch04-crt3"/> data. Let’s create a table to hold actor details. For now, we’re going to have a simplified structure, and we’ll add more complexity later. Here’s the statement we use:<a data-type="indexterm" data-primary="columns" data-secondary="NOT NULL declaration" id="idm46177494341640"/><a data-type="indexterm" data-primary="NULL" data-secondary="NOT NULL columns" data-tertiary="example table" id="idm46177494340696"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">actor</code><code> </code><code class="p">(</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">actor_id</code><code> </code><code class="kt">SMALLINT</code><code> </code><code class="k">UNSIGNED</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code> </code><code class="k">DEFAULT</code><code> </code><code class="mi">0</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">first_name</code><code> </code><code class="kt">VARCHAR</code><code class="p">(</code><code class="mi">45</code><code class="p">)</code><code> </code><code class="k">DEFAULT</code><code> </code><code class="no">NULL</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">last_name</code><code> </code><code class="kt">VARCHAR</code><code class="p">(</code><code class="mi">45</code><code class="p">)</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">last_update</code><code> </code><code class="kt">TIMESTAMP</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">PRIMARY</code><code> </code><code class="k">KEY</code><code> </code><code class="p">(</code><code class="n">actor_id</code><code class="p">)</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.01 sec)</pre>

<p>Don’t panic—even though MySQL reports that zero rows were affected, it created the table:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="kp">tables</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------------------+
| Tables_in_sakila |
+------------------+
| actor            |
+------------------+
1 row in set (0.01 sec)</pre>

<p>Let’s consider all this in detail. The <code>CREATE TABLE</code> command has three major sections:</p>
<ol>
<li>
<p>The <code>CREATE TABLE</code> statement, which is followed by the table name to create. In this example, it’s <code>actor</code>.</p>
</li>
<li>
<p>A list of one or more columns to be added to the table. In this example, we’ve added quite a few: <code>actor_id SMALLINT UNSIGNED NOT NULL DEFAULT 0</code>, <code>first_name VARCHAR(45) DEFAULT NULL</code>, <code>last_name VARCHAR(45)</code>, and <code>last_update TIMESTAMP</code>. We’ll discuss these in a moment.</p>
</li>
<li>
<p>Optional key definitions. In this example, we’ve defined a single key: <code>PRIMARY KEY (actor_id)</code>. We’ll discuss keys and indexes in detail later in this chapter.</p>
</li>

</ol>

<p>Notice that the <code>CREATE TABLE</code> component is followed by an opening parenthesis that’s matched by a closing parenthesis at the end of the statement. Notice also that the other components are separated by commas. There are other elements that you can add to a <code>CREATE TABLE</code> statement, and we’ll discuss some in a moment.</p>

<p>Let’s discuss the column specifications. The basic syntax<a data-type="indexterm" data-primary="columns" data-secondary="CREATE TABLE" id="idm46177494192872"/><a data-type="indexterm" data-primary="columns" data-secondary="CREATE TABLE" data-tertiary="names of columns" id="idm46177494191896"/><a data-type="indexterm" data-primary="names" data-secondary="tables" data-tertiary="columns" id="idm46177494190680"/><a data-type="indexterm" data-primary="tables" data-secondary="names" data-tertiary="columns" id="idm46177494189464"/> is as follows: <code><em>name</em> <em>type</em> [NOT NULL | NULL] [DEFAULT <em>value</em>]</code>. The <code><em>name</em></code> field is the column name, and it has the same limitations as database names, as discussed in the previous section. It can be at most 64 characters in length, backward and forward slashes aren’t allowed, periods aren’t allowed, it can’t end in whitespace, and case sensitivity is dependent on the underlying operating system. The <code><em>type</em></code> field defines how and what is stored in the column; for example, we’ve seen that it can be set to <code>VARCHAR</code> for strings, <code>SMALLINT</code> for numbers, or <code>TIMESTAMP</code> for a date and time.</p>

<p>If you specify <code>NOT NULL</code>, a row isn’t valid without a value for<a data-type="indexterm" data-primary="NULL" data-secondary="NOT NULL columns" id="idm46177494182504"/> the column; if you specify <code>NULL</code> or omit this clause, a row can exist without a value for the column. <a data-type="indexterm" data-primary="defaults" data-secondary="DEFAULT value" data-tertiary="CREATE TABLE" id="idm46177494181016"/>If you specify a <code><em>value</em></code> with the <code>DEFAULT</code> clause, it’ll be used to populate the column when you don’t otherwise provide data; this is particularly useful when you frequently reuse a default value such as a country name. The <code><em>value</em></code> must be a constant (such as <code>0</code>, <code>"cat"</code>, or <code>20060812045623</code>), except if the column is of the type <code>TIMESTAMP</code>. Types are discussed in detail in <a data-type="xref" href="#SEC-COLUMN-TYPES">“Column Types”</a>.</p>

<p>The <code>NOT NULL</code> and <code>DEFAULT</code> features can be used together. If you specify <code>NOT NULL</code> and add a <code>DEFAULT</code> value, the default is used when you don’t provide a value for the column. Sometimes, this works fine:<a data-type="indexterm" data-primary="INSERT" data-secondary="primary key" id="idm46177494173096"/><a data-type="indexterm" data-primary="primary key" data-secondary="INSERT detecting duplicates" id="idm46177494172120"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="nf">actor</code><code class="p">(</code><code class="n">first_name</code><code class="p">)</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'John'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.01 sec)</pre>

<p>And sometimes it doesn’t:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="nf">actor</code><code class="p">(</code><code class="n">first_name</code><code class="p">)</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'Elisabeth'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1062 (23000): Duplicate entry '0' for key 'actor.PRIMARY'</pre>

<p>Whether it works or not is dependent on the underlying constraints and conditions of the database: in this example, <code>actor_id</code> has a default value of <code>0</code>, but it’s also the primary key. Having two rows with the same primary key value isn’t permitted, and so the second attempt to insert a row with no values (and a resulting primary key value of <code>0</code>) fails. We discuss primary keys in detail in <a data-type="xref" href="#SEC-KEYS_AND_INDEXES">“Keys and Indexes”</a>.</p>

<p>Column names have fewer restrictions than database and table<a data-type="indexterm" data-primary="names" data-secondary="tables" data-tertiary="columns" id="idm46177494115992"/><a data-type="indexterm" data-primary="columns" data-secondary="CREATE TABLE" data-tertiary="names of columns" id="idm46177494114744"/><a data-type="indexterm" data-primary="case sensitivity" data-secondary="column names" id="idm46177494113528"/><a data-type="indexterm" data-primary="portability" data-secondary="column names" id="idm46177494112584"/><a data-type="indexterm" data-primary="machine independence" data-see="portability" id="idm46177494111640"/> names. What’s more, the names are case-insensitive and portable across all platforms. All characters are allowed in column names, <a data-type="indexterm" data-primary="backtick (`)" id="idm46177494090088"/><a data-type="indexterm" data-primary="` (backtick)" data-primary-sortas="#backtick" id="idm46177494089416"/>though if you want terminate them with whitespace or include periods or other special characters, such as a semicolon or dash, you’ll need to enclose the name in backticks (<code>`</code>). Again, we recommend that you consistently choose lowercase names for developer-driven choices (such as database, alias, and table names) and avoid characters that require you to remember to use backticks.</p>

<p>Naming columns and other database objects is something<a data-type="indexterm" data-primary="names" data-secondary="databases" id="idm46177494087256"/><a data-type="indexterm" data-primary="database design" data-secondary="names of databases" id="idm46177494085896"/> of a personal preference when starting anew (you can get some inspiration by looking at the example databases) or a matter of following standards when working on an existing codebase. In general, aim to avoid repetition: in a table named <code>actor</code>, use the column name <code>first_name</code> rather than <code>actor_first_name</code>, which would look redundant when preceded by the table name in a complex query (<code>actor.actor_first_name</code> versus <code>actor.first_name</code>). An exception to this is when using the ubiquitous <code>id</code> column name; either avoid using this or prepend the table name for clarity (e.g., <code>actor_id</code>). <a data-type="indexterm" data-primary="_ (underscore for names)" data-primary-sortas="#underscore" id="idm46177494081592"/><a data-type="indexterm" data-primary="names" data-secondary="case sensitivity" data-tertiary="CamelCase difficult to read" id="idm46177494080616"/><a data-type="indexterm" data-primary="case sensitivity" data-secondary="CamelCase difficult to read" id="idm46177494079432"/><a data-type="indexterm" data-primary="CamelCase difficult to read" id="idm46177494078520"/><a data-type="indexterm" data-primary="underscore for names (_)" id="idm46177494077880"/>It’s good practice to use the underscore character to separate words. You could use another character, like a dash or slash, but you’d have to remember to enclose the names with backticks (e.g., <code><code>actor-id</code></code>). You can also omit the word-separating formatting altogether, but “CamelCase” is arguably harder to read. <a data-type="indexterm" data-primary="names" data-secondary="length maximum" id="idm46177494076184"/>As with database and table names, the longest permitted length for a column name is 64 characters.<a data-type="indexterm" data-startref="ch04-ate" id="idm46177494075000"/><a data-type="indexterm" data-startref="ch04-ate2" id="idm46177494074328"/><a data-type="indexterm" data-startref="ch04-ate3" id="idm46177494073656"/><a data-type="indexterm" data-startref="ch04-ate4" id="idm46177494072984"/><a data-type="indexterm" data-startref="ch04-crt2" id="idm46177494072312"/><a data-type="indexterm" data-startref="ch04-crt3" id="idm46177494071640"/><a data-type="indexterm" data-startref="ch04-crt4" id="idm46177494070968"/></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Collation and Character Sets"><div class="sect2" id="SEC-COLLATIONS">
<h2>Collation and Character Sets</h2>

<p>When you’re comparing or sorting strings, how MySQL evaluates the result depends on the <a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="character set and collation order" id="ch04-coch"/><a data-type="indexterm" data-primary="strings" data-secondary="collation and character sets" data-tertiary="about" id="idm46177494067304"/><a data-type="indexterm" data-primary="collation of character sets" data-secondary="about" id="idm46177494066072"/><a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="collation" data-see="collation" id="idm46177494065112"/><a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="about" id="idm46177494063880"/><a data-type="indexterm" data-primary="database design" data-secondary="collation and character sets" id="idm46177494062920"/>character set and collation used. Character sets, or charsets, define what characters can be stored; for example, you may need to store non-English characters such as ю or ü. A collation defines how strings are ordered, and there are different collations for different languages: for example, the position of the character ü in the alphabet is different in two German orderings, and different again in Swedish and Finnish. Because not everyone wants to store English strings, it’s important that a database server be able to manage non-English characters and different ways of sorting 
<span class="keep-together">characters.</span></p>

<p>We understand that discussion of collations and charsets may feel to be too advanced when you’re just starting out learning MySQL. <a data-type="indexterm" data-primary="strings" data-secondary="comparisons" data-tertiary="about collation and charsets" id="idm46177494060136"/>We also think, however, that these are topics worth covering, as mismatched charsets and collations may result in unexpected situations including loss of data and incorrect query results. If you prefer, you can skip this section and some of the later discussion in this chapter and come back to these topics when you want to learn about them specifically. That won’t affect your understanding of other material in this book.</p>

<p>In our previous string-comparison examples, we ignored the collation and charset issue and just let MySQL use its defaults. <a data-type="indexterm" data-primary="defaults" data-secondary="character set and collation" id="idm46177494057544"/><a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="default" id="idm46177494056600"/><a data-type="indexterm" data-primary="collation of character sets" data-secondary="default" id="idm46177494055640"/><a data-type="indexterm" data-primary="collation of character sets" data-secondary="utf8mb4 charset collation" id="idm46177494054680"/><a data-type="indexterm" data-primary="latin1 character set" id="idm46177494053704"/><a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="latin1 character set" id="idm46177494053032"/><a data-type="indexterm" data-primary="collation of character sets" data-secondary="latin1 charset collation" id="idm46177494052072"/><a data-type="indexterm" data-primary="utf8mb4 character set" id="idm46177494051096"/>In versions of MySQL prior to 8.0, the default character set is <code>latin1</code>, and the default collation is <code>latin1_swedish_ci</code>. MySQL 8.0 changed the defaults, and now the default charset is <code>utf8mb4</code>, and the default collation is <code>utf8mb4_0900_ai_ci</code>. MySQL can be configured to use different character sets and collation orders at the connection, database, table, and column levels. The outputs shown here are from MySQL 8.0.</p>

<p>You can list the character sets available on your<a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="showing available sets" id="idm46177494048136"/><a data-type="indexterm" data-primary="SHOW" data-secondary="CHARACTER SET" id="idm46177494047144"/> server with the <code>SHOW CHARACTER SET</code> command. This shows a short description of each character set, its default collation, and the maximum number of bytes used for each character in that character set:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="k">CHARACTER</code><code> </code><code class="kt">SET</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+----------+---------------------------------+---------------------+--------+
| Charset  | Description                     | Default collation   | Maxlen |
+----------+---------------------------------+---------------------+--------+
| armscii8 | ARMSCII-8 Armenian              | armscii8_general_ci |      1 |
| ascii    | US ASCII                        | ascii_general_ci    |      1 |
| big5     | Big5 Traditional Chinese        | big5_chinese_ci     |      2 |
| binary   | Binary pseudo charset           | binary              |      1 |
| cp1250   | Windows Central European        | cp1250_general_ci   |      1 |
| cp1251   | Windows Cyrillic                | cp1251_general_ci   |      1 |
| ...                                                                       |
| ujis     | EUC-JP Japanese                 | ujis_japanese_ci    |      3 |
| utf16    | UTF-16 Unicode                  | utf16_general_ci    |      4 |
| utf16le  | UTF-16LE Unicode                | utf16le_general_ci  |      4 |
| utf32    | UTF-32 Unicode                  | utf32_general_ci    |      4 |
| utf8     | UTF-8 Unicode                   | utf8_general_ci     |      3 |
| utf8mb4  | UTF-8 Unicode                   | utf8mb4_0900_ai_ci  |      4 |
+----------+---------------------------------+---------------------+--------+
41 rows in set (0.00 sec)</pre>

<p>For example, the <code>latin1</code> character set is actually<a data-type="indexterm" data-primary="case sensitivity" data-secondary="collation for latin1 charset" id="idm46177494034248"/> the Windows code page 1252 character set that supports West European languages. The default collation for this character set is <code>latin1_swedish_ci</code>, which follows Swedish conventions to sort accented characters (English is handled as you’d expect). This collation is case-insensitive, as indicated by the letters <code>ci</code>. Finally, each character takes up 1 byte. By comparison, if you use the default <code>utf8mb4</code> character set, each character will take up to 4 bytes of storage. Sometimes, it makes sense to change the default. For example, there’s no reason to store base64-encoded data (which, by definition, is ASCII) in <code>utf8mb4</code>.</p>

<p>Similarly, you can list the collation orders and the character sets they apply to:<a data-type="indexterm" data-primary="collation of character sets" data-secondary="showing available collations" id="idm46177494030664"/><a data-type="indexterm" data-primary="SHOW" data-secondary="COLLATION" id="idm46177494029752"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="n">COLLATION</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+---------------------+----------+-----+---------+...+---------------+
| Collation           | Charset  | Id  | Default |...| Pad_attribute |
+---------------------+----------+-----+---------+...+---------------+
| armscii8_bin        | armscii8 |  64 |         |...| PAD SPACE     |
| armscii8_general_ci | armscii8 |  32 | Yes     |...| PAD SPACE     |
| ascii_bin           | ascii    |  65 |         |...| PAD SPACE     |
| ascii_general_ci    | ascii    |  11 | Yes     |...| PAD SPACE     |
| ...                                            |...|               |
| utf8mb4_0900_ai_ci  | utf8mb4  | 255 | Yes     |...| NO PAD        |
| utf8mb4_0900_as_ci  | utf8mb4  | 305 |         |...| NO PAD        |
| utf8mb4_0900_as_cs  | utf8mb4  | 278 |         |...| NO PAD        |
| utf8mb4_0900_bin    | utf8mb4  | 309 |         |...| NO PAD        |
| ...                                            |...|               |
| utf8_unicode_ci     | utf8     | 192 |         |...| PAD SPACE     |
| utf8_vietnamese_ci  | utf8     | 215 |         |...| PAD SPACE     |
+---------------------+----------+-----+---------+...+---------------+
272 rows in set (0.02 sec)</pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>The number of character sets and collations available depends<a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="showing available sets" data-tertiary="installation and" id="idm46177494000568"/><a data-type="indexterm" data-primary="collation of character sets" data-secondary="showing available collations" data-tertiary="installation and" id="idm46177493999352"/> on how the MySQL server was built and packaged. The examples we show are from a default MySQL 8.0 installation, and the same numbers can be seen on Linux and Windows. MariaDB 10.5, however, has 322 collations but 40 character sets.</p>
</div>

<p class="pagebreak-before">You can see the current defaults on your server as follows:<a data-type="indexterm" data-primary="system variables" data-secondary="character set and collation defaults" id="idm46177493997032"/><a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="default" data-tertiary="showing server defaults" id="idm46177493996040"/><a data-type="indexterm" data-primary="collation of character sets" data-secondary="default" data-tertiary="showing server defaults" id="idm46177493976232"/><a data-type="indexterm" data-primary="defaults" data-secondary="character set and collation" data-tertiary="showing server defaults" id="idm46177493975032"/><a data-type="indexterm" data-primary="SHOW" data-secondary="VARIABLES" data-tertiary="character set and collation defaults" id="idm46177493973800"/><a data-type="indexterm" data-primary="variables" data-secondary="system variables" data-see="system variables" id="idm46177493972568"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="n">VARIABLES</code><code> </code><code class="k">LIKE</code><code> </code><code class="s1">'c%'</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+--------------------------+--------------------------------+
| Variable_name            | Value                          |
+--------------------------+--------------------------------+
| ...                                                       |
| character_set_client     | utf8mb4                        |
| character_set_connection | utf8mb4                        |
| character_set_database   | utf8mb4                        |
| character_set_filesystem | binary                         |
| character_set_results    | utf8mb4                        |
| character_set_server     | utf8mb4                        |
| character_set_system     | utf8                           |
| character_sets_dir       | /usr/share/mysql-8.0/charsets/ |
| ...                                                       |
| collation_connection     | utf8mb4_0900_ai_ci             |
| collation_database       | utf8mb4_0900_ai_ci             |
| collation_server         | utf8mb4_0900_ai_ci             |
| ...                                                       |
+--------------------------+--------------------------------+
21 rows in set (0.00 sec)</pre>

<p>When you’re creating a database, you can set the default<a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="character set and collation order" id="idm46177493959640"/><a data-type="indexterm" data-primary="defaults" data-secondary="character set and collation" data-tertiary="setting at database creation" id="idm46177493958696"/><a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="default" data-tertiary="setting at database creation" id="idm46177493957544"/><a data-type="indexterm" data-primary="collation of character sets" data-secondary="default" data-tertiary="setting at database creation" id="idm46177493956296"/> character set and sort order for the database and its tables. For example, if you want to use the <code>utf8mb4</code> character set and the <code>utf8mb4_ru_0900_as_cs</code> (case-sensitive) collation order, you would write:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">DATABASE</code><code> </code><code class="n">rose</code><code> </code><code class="k">DEFAULT</code><code> </code><code class="k">CHARACTER</code><code> </code><code class="kt">SET</code><code> </code><code class="n">utf8mb4</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">COLLATE</code><code> </code><code class="n">utf8mb4_ru_0900_as_cs</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<p>Usually, there’s no need to do this if you’ve installed MySQL correctly for your language and region and if you’re not planning on internationalizing your application. With <code>utf8mb4</code> being the default since MySQL 8.0, there’s even less need to change the charset. You can also control the character set and collation for individual tables or columns, but we won’t go into the details of how to do that here. We will discuss how collations affect string types in <a data-type="xref" href="#SEC-STRING-COLUMN-TYPES">“String types”</a>.<a data-type="indexterm" data-startref="ch04-coch" id="idm46177493904472"/></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Other Features"><div class="sect2" id="SEC-MODIFY-CREATE-TABLE-OTHER-FEATURES">
<h2>Other Features</h2>

<p>This section briefly describes other features of the<a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="creating tables" data-tertiary="advanced features" id="ch04advf"/><a data-type="indexterm" data-primary="CREATE TABLE" data-secondary="advanced features" id="ch04advf2"/><a data-type="indexterm" data-primary="sakila example database" data-secondary="creating from scratch" data-tertiary="additional table features" id="ch04advf3"/><a data-type="indexterm" data-primary="tables" data-secondary="creating tables" data-tertiary="advanced features" id="ch04advf4"/> <code>CREATE TABLE</code> statement. It includes an example using the <code>IF NOT EXISTS</code> feature, and a list of advanced features and where to find more about them in this book. The statement shown is the full representation of the table taken from the <code>sakila</code> database, unlike the previous simplified example.</p>

<p>You can use the <code>IF NOT EXISTS</code> keyword phrase when<a data-type="indexterm" data-primary="CREATE TABLE" data-secondary="IF NOT EXISTS" id="idm46177493881576"/><a data-type="indexterm" data-primary="tables" data-secondary="creating tables" data-tertiary="IF NOT EXISTS" id="idm46177493880568"/><a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="IF NOT EXISTS" id="idm46177493879352"/> creating a table, and it works much as it does for databases. Here’s an example that won’t report an error even when the <code>actor</code> table exists:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="k">IF</code><code> </code><code class="k">NOT</code><code> </code><code class="k">EXISTS</code><code> </code><code class="nf">actor</code><code> </code><code class="p">(</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">actor_id</code><code> </code><code class="kt">SMALLINT</code><code> </code><code class="k">UNSIGNED</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code> </code><code class="kp">AUTO_INCREMENT</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">first_name</code><code> </code><code class="kt">VARCHAR</code><code class="p">(</code><code class="mi">45</code><code class="p">)</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">last_name</code><code> </code><code class="kt">VARCHAR</code><code class="p">(</code><code class="mi">45</code><code class="p">)</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">last_update</code><code> </code><code class="kt">TIMESTAMP</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code> </code><code class="k">DEFAULT</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">CURRENT_TIMESTAMP</code><code> </code><code class="k">ON</code><code> </code><code class="k">UPDATE</code><code> </code><code class="k">CURRENT_TIMESTAMP</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">PRIMARY</code><code> </code><code class="k">KEY</code><code>  </code><code class="p">(</code><code class="n">actor_id</code><code class="p">)</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">KEY</code><code> </code><code class="nf">idx_actor_last_name</code><code> </code><code class="p">(</code><code class="n">last_name</code><code class="p">)</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected, 1 warning (0.01 sec)</pre>

<p>You can see that zero rows are affected, and a warning is reported. Let’s take a look:<a data-type="indexterm" data-primary="SHOW" data-secondary="WARNINGS" id="idm46177493773064"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="n">WARNINGS</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+-------+------+------------------------------+
| Level | Code | Message                      |
+-------+------+------------------------------+
| Note  | 1050 | Table 'actor' already exists |
+-------+------+------------------------------+
1 row in set (0.01 sec)</pre>

<p>There are a wide range of additional features you can add to a <code>CREATE TABLE</code> statement, only a few of which are present in this example. Many of these are advanced and aren’t discussed in this book, but you can find more information in the <a data-type="indexterm" data-primary="CREATE TABLE" data-secondary="reference online" id="idm46177493744504"/><a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="creating tables" data-tertiary="reference online" id="idm46177493743528"/><a data-type="indexterm" data-primary="web links in book" data-secondary="CREATE TABLE reference" id="idm46177493742312"/>MySQL Reference Manual in the section on the <a href="https://oreil.ly/ZGQgq"><code>CREATE TABLE</code> statement</a>. These additional features include the following:</p>
<dl>
<dt>The <code>AUTO_INCREMENT</code> feature for numeric columns</dt>
<dd>
<p>This feature allows you to automatically create unique<a data-type="indexterm" data-primary="columns" data-secondary="AUTO_INCREMENT" id="idm46177493737992"/><a data-type="indexterm" data-primary="AUTO_INCREMENT" data-secondary="numeric columns" id="idm46177493737016"/> identifiers for a table. We discuss it in detail in <a data-type="xref" href="#SEC-AUTOINCREMENT">“The AUTO_INCREMENT Feature”</a>.</p>
</dd>
<dt>Column comments</dt>
<dd>
<p>You can add a comment to a column; <a data-type="indexterm" data-primary="columns" data-secondary="comments in" id="idm46177493717416"/><a data-type="indexterm" data-primary="comments" data-secondary="columns containing" id="idm46177493716440"/><a data-type="indexterm" data-primary="SHOW" data-secondary="CREATE TABLE" data-tertiary="column comments" id="idm46177493715496"/>this is displayed when you use the <code>SHOW CREATE TABLE</code> command that we discuss later in this section.</p>
</dd>
<dt>Foreign key constraints</dt>
<dd>
<p>You can tell MySQL to check whether data in one or more<a data-type="indexterm" data-primary="foreign key constraints" data-secondary="CREATE TABLE" id="idm46177493712232"/> columns matches data in another table. For example, the <code>sakila</code> database has a foreign key constraint on the <code>city_id</code> column of the <code>address</code> table, referring to the <code>city</code> table’s <code>city_id</code> column. That means it’s impossible to have an address in a city not present in the <code>city</code> table. We introduced foreign key constraints in <a data-type="xref" href="ch02.xhtml#CH2_DESIGN">Chapter 2</a>, and we’ll take a look at what engines support foreign key constraints in <a data-type="xref" href="ch07.xhtml#ADV2-SEC-STORAGEENGINES">“Alternative Storage Engines”</a>. Not every storage engine in MySQL supports foreign keys.</p>
</dd>
<dt>Creating temporary tables</dt>
<dd>
<p>If you create a table using the keyword phrase<a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="creating tables" data-tertiary="temporary tables" id="idm46177493705880"/><a data-type="indexterm" data-primary="CREATE TABLE" data-secondary="CREATE TEMPORARY TABLE" id="idm46177493704632"/><a data-type="indexterm" data-primary="CREATE TEMPORARY TABLE" id="idm46177493703688"/><a data-type="indexterm" data-primary="DROP TABLE" data-secondary="temporary tables" id="idm46177493703016"/><a data-type="indexterm" data-primary="tables" data-secondary="creating tables" data-tertiary="temporary table" id="idm46177493702072"/> <code>CREATE TEMPORARY TABLE</code>, it’ll be removed (dropped) when the connection is closed. This is useful for copying and reformatting data because you don’t have to remember to clean up. Sometimes temporary tables are also used as an optimization to hold some intermediate data.</p>
</dd>
<dt>Advanced table options</dt>
<dd>
<p>You can control a wide range of features of the table using table options. These include the starting value of <code>AUTO_INCREMENT</code>, the way indexes and rows are stored, and options to override the information that the MySQL query optimizer gathers from the table. It’s also possible to specify <em>generated columns</em>, containing data like sum of two other columns, as well as indexes on such columns.</p>
</dd>
<dt>Control over index structures</dt>
<dd>
<p>Some storage engines in MySQL allow you to specify and control what type of internal structure—such as a B-tree or hash table—MySQL uses for its indexes. You can also tell MySQL that you want a full-text or spatial data index on a column, allowing special types of search.</p>
</dd>
<dt>Partitioning</dt>
<dd>
<p>MySQL supports different partitioning strategies, which you can select at table creation time or later. We will not be covering partitioning in this book.</p>
</dd>
</dl>

<p>You can see the statement used to create a table using the<a data-type="indexterm" data-primary="SHOW" data-secondary="CREATE TABLE" id="idm46177493694152"/> <code>SHOW CREATE TABLE</code> statement introduced in <a data-type="xref" href="ch03.xhtml#CH3_BASICS">Chapter 3</a>. This often shows you output that includes some of the advanced features we’ve just discussed; the output rarely matches what you actually typed to create the table. Here’s an example for the <code>actor</code> table:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">actor</code><code class="err">\</code><code class="n">G</code></strong></pre>

<pre data-type="programlisting">*************************** 1. row ***************************
       Table: actor
Create Table: CREATE TABLE `actor` (
  `actor_id` smallint unsigned NOT NULL AUTO_INCREMENT,
  `first_name` varchar(45) NOT NULL,
  `last_name` varchar(45) NOT NULL,
  `last_update` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP
        ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`actor_id`),
  KEY `idx_actor_last_name` (`last_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4
        COLLATE=utf8mb4_0900_ai_ci
1 row in set (0.00 sec)</pre>

<p class="pagebreak-before">You’ll notice that the output includes content added by MySQL that wasn’t in our original <code>CREATE TABLE</code> statement:</p>

<ul>
<li>
<p>The names of the table and columns are enclosed in backticks. This isn’t necessary, but it does avoid any parsing problems that can be caused by the use of reserved words and special characters, as discussed previously.</p>
</li>
<li>
<p>An additional default <code>ENGINE</code> clause is included, which explicitly states the table type that should be used. The setting in a default installation of MySQL is <code>InnoDB</code>, so it has no effect in this example.</p>
</li>
<li>
<p>An additional <code>DEFAULT CHARSET</code> clause is included, which tells MySQL what character set is used by the columns in the table. Again, this has no effect in a default installation.<a data-type="indexterm" data-startref="ch04advf" id="idm46177493673768"/><a data-type="indexterm" data-startref="ch04advf2" id="idm46177493673064"/><a data-type="indexterm" data-startref="ch04advf3" id="idm46177493672392"/><a data-type="indexterm" data-startref="ch04advf4" id="idm46177493652552"/></p>
</li>
</ul>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Column Types"><div class="sect2" id="SEC-COLUMN-TYPES">
<h2>Column Types</h2>

<p>This section describes the column types you can use in<a data-type="indexterm" data-primary="database structures" data-secondary="columns of tables" data-see="columns" id="idm46177493649816"/> MySQL. It explains when each should be used and any limitations it has. The types are grouped by their purpose. We’ll cover the most widely used data types and mention more advanced or less used types in passing. That doesn’t mean they have no use, but consider learning about them as an exercise. Most likely, you will not remember each of the data types and its particular intricacies, and that’s okay. It’s worth rereading this chapter later and consulting the MySQL documentation on the topic to keep your knowledge up-to-date.</p>










<section data-type="sect3" data-pdf-bookmark="Integer types"><div class="sect3" id="SEC-INTEGER-COLUMN-TYPES">
<h3>Integer types</h3>

<p>We will start with numeric data types, and more specifically with<a data-type="indexterm" data-primary="columns" data-secondary="types of" data-tertiary="integer types" id="idm46177493645976"/><a data-type="indexterm" data-primary="integer numeric columns" id="idm46177493644728"/> integer types, or the types holding specific whole numbers. First, the two most popular integer types:<a data-type="indexterm" data-primary="INT (INTEGER) data type" id="idm46177493643816"/><a data-type="indexterm" data-primary="UNSIGNED argument" data-secondary="integers" id="idm46177493643144"/><a data-type="indexterm" data-primary="INT (INTEGER) data type" data-secondary="UNSIGNED" id="idm46177493642200"/><a data-type="indexterm" data-primary="integer numeric columns" data-secondary="INT (INTEGER)" id="idm46177493641256"/></p>
<dl>
<dt><code>INT[(<em>width</em>)] [UNSIGNED] [ZEROFILL]</code></dt>
<dd>
<p>This is the most commonly used numeric type; it stores integer (whole number) values in the range –2,147,483,648 to 2,147,483,647. If the optional <code>UNSIGNED</code> keyword is added, the range is 0 to 4,294,967,295. The keyword <code>INT</code> is short for <code>INTEGER</code>, and they can be used interchangeably. An <code>INT</code> column requires 4 bytes of storage space.</p>

<p><code>INT</code>, as well as other integer types, has two properties specific<a data-type="indexterm" data-primary="INT (INTEGER) data type" data-secondary="width argument" id="idm46177493635288"/><a data-type="indexterm" data-primary="width argument" data-secondary="integer data types" id="idm46177493634312"/><a data-type="indexterm" data-primary="INT (INTEGER) data type" data-secondary="ZEROFILL argument" id="idm46177493633368"/><a data-type="indexterm" data-primary="ZEROFILL argument" data-secondary="INT (INTEGER)" id="idm46177493632424"/> to MySQL: optional <code><em>width</em></code> and <code>ZEROFILL</code> arguments. They are not part of a SQL standard, and as of MySQL 8.0 are deprecated. Still, you will surely notice them in a lot of codebases, so we will briefly cover both of them.</p>

<p>The <code><em>width</em></code> parameter specifies the display width, which can be read by applications as part of the column metadata. Unlike parameters in a similar position for other data types, this parameter has no effect on the storage characteristics of a particular integer type and does not constrain the usable range of values. <code>INT(4)</code> and <code>INT(32)</code> are the same for the purpose of data storage.</p>

<p><code>ZEROFILL</code> is an additional argument that is used to left-pad the values with zeros up to the length specified by the <code><em>width</em></code> parameter. If you use <code>ZEROFILL</code>, MySQL automatically adds <code>UNSIGNED</code> to the declaration (since zero-filling makes sense only in the context of positive numbers).</p>

<p>In a few applications where <code>ZEROFILL</code> and <code><em>width</em></code> are<a data-type="indexterm" data-primary="LPAD()" id="idm46177493624104"/> useful, the <code>LPAD()</code> function can be used, or numbers can be stored formatted in <code>CHAR</code> columns.</p>
</dd>
<dt><code>BIGINT[(<em>width</em>)] [UNSIGNED] [ZEROFILL]</code></dt>
<dd>
<p>In the world of growing data sizes, having tables with counts of<a data-type="indexterm" data-primary="BIGINT data type" id="idm46177493620232"/><a data-type="indexterm" data-primary="integer numeric columns" data-secondary="BIGINT" id="idm46177493619496"/><a data-type="indexterm" data-primary="numeric columns" data-see="fixed-point numeric columns; floating-point numeric columns; integer numeric columns" id="idm46177493618552"/> rows in the 
<span class="keep-together">billions</span> is getting more common. Even simple <code>id</code>-type columns might need a wider range than a regular <code>INT</code> provides. <code>BIGINT</code> solves that problem. It is a large integer type with a signed range of –9,223,372,036,854,775,808 to 9,223,372,036,854,775,807. An unsigned <code>BIGINT</code> can store numbers from 0 to 18,446,744,073,709,551,615. Columns of this type will require 8 bytes of storage.</p>

<p>Internally, all calculations within MySQL are done using signed<a data-type="indexterm" data-primary="DOUBLE data type" id="idm46177493614552"/><a data-type="indexterm" data-primary="calculation data types" id="idm46177493613848"/> <code>BIGINT</code> or <code>DOUBLE</code> values. The important consequence of that is that you should be very careful when dealing with extremely large numbers. There are two issues to be aware of. First, unsigned big integers larger than 9,223,372,036,854,775,807 should only be used with bit functions. Second, if the result of an arithmetical operation is larger than 9,223,372,036,854,775,807, unexpected results might be observed.</p>

<p>For example:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">test_bigint</code><code> </code><code class="p">(</code><code class="n">id</code><code> </code><code class="kt">BIGINT</code><code> </code><code class="k">UNSIGNED</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.01 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_bigint</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="mi">18446744073709551615</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.01 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_bigint</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="mi">18446744073709551615</code><code class="o">-</code><code class="mi">1</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.01 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_bigint</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="mi">184467440737095516</code><code class="o">*</code><code class="mi">100</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1690 (22003): BIGINT value
is out of range in '(184467440737095516 * 100)'</pre>

<p>Even though 18,446,744,073,709,551,600 is less than 18,446,744,073,709,551,615, since a signed <code>BIGINT</code> is used for multiplication internally, the out-of-range error is observed.</p>
</dd>
</dl>
<div data-type="tip"><h6>Tip</h6>
<p>The <code>SERIAL</code> data type can be used as an<a data-type="indexterm" data-primary="aliases" data-secondary="SERIAL for BIGINT id-like columns" id="idm46177493491688"/><a data-type="indexterm" data-primary="SERIAL data type" id="idm46177493490744"/><a data-type="indexterm" data-primary="BIGINT data type" data-secondary="SERIAL data type as alias" id="idm46177493490072"/><a data-type="indexterm" data-primary="INT (INTEGER) data type" data-secondary="SERIAL data type as alias" id="idm46177493489160"/> alias for <code>BIGINT UNSIGNED NOT NULL AUTO_INCREMENT UNIQUE</code>. Unless you must optimize for data size and performance, consider using <code>SERIAL</code> for your <code>id</code>-like columns. Even the <code>UNSIGNED INT</code> can run out of range much quicker than you’d expect, and often at the worst possible time.</p>
</div>

<p>Keep in mind that although it’s possible to store every integer as a <code>BIGINT</code>, that’s wasteful in terms of storage space. Moreover, as we discussed, the <code><em>width</em></code> parameter doesn’t constrain the range of values. To save space and put constraints on stored values, you should use different integer types:</p>
<dl>
<dt><code>SMALLINT[(<em>width</em>)] [UNSIGNED] [ZEROFILL]</code></dt>
<dd>
<p>Stores small integers, with a range from –32,768 to<a data-type="indexterm" data-primary="integer numeric columns" data-secondary="SMALLINT" id="idm46177493462216"/><a data-type="indexterm" data-primary="SMALLINT data type" id="idm46177493461240"/> 32,767 signed and from 0 to 65,535 unsigned. It takes 2 bytes of storage.</p>
</dd>
<dt><code>TINYINT[(<em>width</em>)] [UNSIGNED] [ZEROFILL]</code></dt>
<dd>
<p>The smallest numeric data type, storing even smaller integers.<a data-type="indexterm" data-primary="integer numeric columns" data-secondary="TINYINT" id="idm46177493458616"/><a data-type="indexterm" data-primary="TINYINT data type" id="idm46177493457640"/> The range of this type is –128 to 127 signed and 0 to 255 unsigned. It takes only 1 byte of storage.</p>
</dd>
<dt><code>BOOL[(<em>width</em>)]</code></dt>
<dd>
<p>Short for <code>BOOLEAN</code>, and a synonym for <code>TINYINT(1)</code>.<a data-type="indexterm" data-primary="BOOL data type" id="idm46177493453368"/><a data-type="indexterm" data-primary="BOOL data type" data-secondary="TINYINT synonym" id="idm46177493452632"/><a data-type="indexterm" data-primary="TINYINT data type" data-secondary="BOOL as synonym" id="idm46177493451688"/> Usually, Boolean types accept only two values: true or false. However, since <code>BOOL</code> in MySQL is an integer type, you can store values from –128 to 127 in a <code>BOOL</code>. <a data-type="indexterm" data-primary="true as 1 value" id="idm46177493449816"/><a data-type="indexterm" data-primary="false as 0 value" id="idm46177493449080"/><a data-type="indexterm" data-primary="0 as false" id="idm46177493448408"/><a data-type="indexterm" data-primary="1 as true" id="idm46177493447736"/><a data-type="indexterm" data-primary="zero (0)" data-secondary="false as" id="idm46177493447064"/><a data-type="indexterm" data-primary="one (1) as true" id="idm46177493446120"/>The value 0 will be treated as false, and all nonzero values as true. It’s also possible to use special <code>true</code> and <code>false</code> aliases for 1 and 0, respectively. Here are some examples:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">test_bool</code><code> </code><code class="p">(</code><code class="n">i</code><code> </code><code class="kt">BOOL</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.04 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_bool</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="no">true</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="no">false</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 2 rows affected (0.00 sec)
Records: 2  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_bool</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="mi">0</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="o">-</code><code class="mi">128</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="mi">127</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 4 rows affected (0.02 sec)
Records: 4  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="n">i</code><code class="p">,</code><code> </code><code class="k">IF</code><code class="p">(</code><code class="n">i</code><code class="p">,</code><code class="s1">'true'</code><code class="p">,</code><code class="s1">'false'</code><code class="p">)</code><code> </code><code class="k">FROM</code><code> </code><code class="n">test_bool</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------+----------------------+
| i    | IF(i,'true','false') |
+------+----------------------+
|    1 | true                 |
|    0 | false                |
|    1 | true                 |
|    0 | false                |
| -128 | true                 |
|  127 | true                 |
+------+----------------------+
6 rows in set (0.01 sec)</pre>
</dd>
<dt><code>MEDIUMINT[(<em>width</em>)] [UNSIGNED] [ZEROFILL]</code></dt>
<dd>
<p>Stores values in the signed range of –8,388,608 to<a data-type="indexterm" data-primary="integer numeric columns" data-secondary="MEDIUMINT" id="idm46177480721352"/><a data-type="indexterm" data-primary="MEDIUMINT data type" id="idm46177480720376"/> 8,388,607 and the unsigned range of 0 to 16,777,215. It takes 3 bytes of storage.</p>
</dd>
<dt><code>BIT[(<em>M</em>)]</code></dt>
<dd>
<p>Special type used to store bit values. <code><em>M</em></code> specifies the<a data-type="indexterm" data-primary="integer numeric columns" data-secondary="BIT" id="idm46177480717144"/><a data-type="indexterm" data-primary="BIT data type" id="idm46177480716168"/> number of bits per value and defaults to 1 if omitted. MySQL uses a <code>b'<em>value</em></code> syntax for binary values.</p>
</dd>
</dl>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Fixed-point types"><div class="sect3" id="SEC-FIXED-COLUMN-TYPES">
<h3>Fixed-point types</h3>

<p>The <code>DECIMAL</code> and <code>NUMERIC</code> data types in MySQL are the<a data-type="indexterm" data-primary="width argument" data-secondary="fixed-point data types" id="idm46177480698744"/><a data-type="indexterm" data-primary="columns" data-secondary="types of" data-tertiary="fixed-point types" id="idm46177480697896"/><a data-type="indexterm" data-primary="fixed-point numeric columns" id="idm46177480696808"/><a data-type="indexterm" data-primary="NUMERIC data type" data-seealso="DECIMAL data type" id="idm46177480696200"/><a data-type="indexterm" data-primary="DECIMAL data type" id="idm46177480695352"/> same, so although we will only describe <code>DECIMAL</code> here, this description also applies to <code>NUMERIC</code>. <a data-type="indexterm" data-primary="floating-point numeric columns" data-secondary="fixed-point versus" id="idm46177480693848"/><a data-type="indexterm" data-primary="fixed-point numeric columns" data-secondary="floating-point versus" id="idm46177480693000"/>The main difference between fixed-point and floating-point types is precision. For fixed-point types, the value retrieved is identical to the value stored; this isn’t always the case with types that contain decimal points, such as the <code>FLOAT</code> and <code>DOUBLE</code> types described later. That is the most important property of the <code>DECIMAL</code> data type, which is a commonly used numeric type in MySQL:<a data-type="indexterm" data-primary="UNSIGNED argument" data-secondary="fixed-point data types" id="idm46177480690616"/><a data-type="indexterm" data-primary="decimals argument" data-secondary="fixed-point data types" id="idm46177480689768"/></p>
<dl>
<dt><code>DECIMAL[(<em>width</em>[,<em>decimals</em>])] [UNSIGNED] [ZEROFILL]</code></dt>
<dd>
<p>Stores a fixed-point number such as a salary or distance, with a total of <code><em>width</em></code> digits of which some smaller number are <code><em>decimals</em></code> that follow a decimal point. For example, a column declared as <code>price DECIMAL(6,2)</code> can be used to store values in the range –9,999.99 to 9,999.99. <code>price DECIMAL(10,4)</code> would allow values like 123,456.1234.</p>

<p>Prior to MySQL 5.7, if you tried to store a value outside this range, it would be stored as the closest value in the allowed range. <a data-type="indexterm" data-primary="STRICT_TRANS_TABLES" data-secondary="DECIMAL values" id="idm46177480684456"/>For example, 100 would be stored as 99.99, and –100 would be stored as –99.99. Starting with version 5.7.5, however, the default SQL mode includes the mode <code>STRICT_TRANS_TABLES</code>, which prohibits this and other unsafe behaviors. Using the old behavior is possible, but could result in data loss.</p>

<p>SQL modes are special settings that control the behavior of MySQL when it comes to queries. For example, they can restrict “unsafe” behavior or affect how queries are interpreted. For the purpose of learning MySQL, we recommend that you stick to the defaults, as they are safe. Changing SQL modes may be required for compatibility with legacy applications across MySQL releases.</p>

<p>The <code><em>width</em></code> parameter is optional, and a value of 10 is assumed when it is omitted. The number of <code><em>decimals</em></code> is also optional, and when omitted, a value of 0 is assumed; the maximum value of <code><em>decimals</em></code> may not exceed the value of <code><em>width</em></code>. The maximum value of <code><em>width</em></code> is 65, and the maximum value of <code><em>decimals</em></code> is 30.</p>

<p>If you’re storing only positive values, you can use the <code>UNSIGNED</code> keyword as described for <code>INT</code>. If you want zero-padding, use the <code>ZEROFILL</code> keyword for the same behavior as described for <code>INT</code>. The keyword <code>DECIMAL</code> has three identical, interchangeable alternatives: <code>DEC</code>, <code>NUMERIC</code>, and <code>FIXED</code>.</p>

<p>Values in <code>DECIMAL</code> columns are stored using a binary format. This format uses 4 bytes for every nine digits.</p>
</dd>
</dl>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Floating-point types"><div class="sect3" id="SEC-FLOATING-COLUMN-TYPES">
<h3>Floating-point types</h3>

<p>In addition to the fixed-point <code>DECIMAL</code> type described in the<a data-type="indexterm" data-primary="floating-point numeric columns" id="idm46177480670952"/><a data-type="indexterm" data-primary="columns" data-secondary="types of" data-tertiary="floating-point types" id="idm46177480670344"/><a data-type="indexterm" data-primary="DOUBLE data type" id="idm46177480669256"/><a data-type="indexterm" data-primary="REAL data type" data-see="DOUBLE data type" id="idm46177480668648"/><a data-type="indexterm" data-primary="FLOAT data type" id="idm46177480667800"/><a data-type="indexterm" data-primary="DECIMAL data type" data-secondary="DOUBLE and FLOAT versus" id="idm46177480667192"/> previous section, there are two other types that support decimal points: <code>DOUBLE</code> (also known as <code>REAL</code>) and <code>FLOAT</code>. They’re designed to store approximate numeric values rather than the exact values stored by <code>DECIMAL</code>.</p>

<p>Why would you want approximate values? The answer is that many numbers with a decimal point are approximations of real quantities. For example, suppose you earn $50,000 per annum and you want to store it as a monthly wage. When you convert this to a per-month amount, it’s $4,166 plus 66 and 2/3 cents. If you store this as $4,166.67, it’s not exact enough to convert to a yearly wage (since 12 multiplied by $4,166.67 is $50,000.04). However, if you store 2/3 with enough decimal places, it’s a closer approximation. You’ll find that it is accurate enough to correctly multiply to obtain the original value in a high-precision environment such as MySQL, using only a bit of rounding. <a data-type="indexterm" data-primary="DOUBLE data type" data-secondary="ROUND()" id="idm46177480663384"/><a data-type="indexterm" data-primary="FLOAT data type" data-secondary="ROUND()" id="idm46177480662536"/>That’s where <code>DOUBLE</code> and <code>FLOAT</code> are useful: they let you store values such as 2/3 or pi with a large number of decimal places, allowing accurate approximate representations of exact quantities. <a data-type="indexterm" data-primary="ROUND()" id="idm46177480660616"/>You can later use the <code>ROUND()</code> function to restore the results to a given precision.</p>

<p>Let’s continue the previous example using <code>DOUBLE</code>. Suppose you create a table as 
<span class="keep-together">follows:</span></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">wage</code><code> </code><code class="p">(</code><code class="n">monthly</code><code> </code><code class="kt">DOUBLE</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.09 sec)</pre>

<p>You can now insert the monthly wage using:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">wage</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="mi">50000</code><code class="o">/</code><code class="mi">12</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<p class="pagebreak-before">And see what’s stored:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">wage</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+----------------+
| monthly        |
+----------------+
| 4166.666666666 |
+----------------+
1 row in set (0.00 sec)</pre>

<p>However, when you multiply it to obtain a yearly value, you get a high-precision approximation:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="n">monthly</code><code class="o">*</code><code class="mi">12</code><code> </code><code class="k">FROM</code><code> </code><code class="n">wage</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+--------------------+
| monthly*12         |
+--------------------+
| 49999.999999992004 |
+--------------------+
1 row in set (0.00 sec)</pre>

<p>To get the original value back, you still need to perform rounding with the desired precision. For example, your business might require precision to five decimal places. In this case, you could restore the original value with:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="nf">ROUND</code><code class="p">(</code><code class="n">monthly</code><code class="o">*</code><code class="mi">12</code><code class="p">,</code><code class="mi">5</code><code class="p">)</code><code> </code><code class="k">FROM</code><code> </code><code class="n">wage</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+---------------------+
| ROUND(monthly*12,5) |
+---------------------+
|         50000.00000 |
+---------------------+
1 row in set (0.00 sec)</pre>

<p>But precision to eight decimal places would not result in the original value:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="nf">ROUND</code><code class="p">(</code><code class="n">monthly</code><code class="o">*</code><code class="mi">12</code><code class="p">,</code><code class="mi">8</code><code class="p">)</code><code> </code><code class="k">FROM</code><code> </code><code class="n">wage</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+---------------------+
| ROUND(monthly*12,8) |
+---------------------+
|      49999.99999999 |
+---------------------+
1 row in set (0.00 sec)</pre>

<p>It’s important to understand the imprecise and approximate nature of floating-point data types.</p>

<p class="pagebreak-before">Here are the details of the <code>FLOAT</code> and <code>DOUBLE</code> types:<a data-type="indexterm" data-primary="FLOAT data type" data-secondary="arguments" id="idm46177480467320"/><a data-type="indexterm" data-primary="width argument" data-secondary="floating-point data types" id="idm46177480466312"/><a data-type="indexterm" data-primary="decimals argument" data-secondary="floating-point data types" id="idm46177480465400"/><a data-type="indexterm" data-primary="UNSIGNED argument" data-secondary="floating-point data types" id="idm46177480464488"/><a data-type="indexterm" data-primary="ZEROFILL argument" data-secondary="floating-point data types" id="idm46177480463576"/><a data-type="indexterm" data-primary="precision argument" id="idm46177480462664"/></p>
<dl>
<dt><code>FLOAT[(<em>width</em>, <em>decimals</em>)] [UNSIGNED] [ZEROFILL]</code> or <code>
<span class="keep-together">FLOAT[(<em>precision</em>)] [UNSIGNED] [ZEROFILL]</span></code></dt>
<dd>
<p>Stores floating-point numbers. It has two optional syntaxes: the first allows an optional number of <code><em>decimals</em></code> and an optional display <code><em>width</em></code>, and the second allows an optional <code><em>precision</em></code> that controls the accuracy of the approximation measured in bits. Without parameters (the typical usage), the type stores small, 4-byte, single-precision floating-point values. When <code><em>precision</em></code> is between 0 and 24, the default behavior occurs. When <code><em>precision</em></code> is between 25 and 53, the type behaves like <code>DOUBLE</code>. The <code><em>width</em></code> parameter has no effect on what is stored, only on what is displayed. The <code>UNSIGNED</code> and <code>ZEROFILL</code> options behave as for <code>INT</code>.<a data-type="indexterm" data-primary="DOUBLE data type" data-secondary="arguments" id="idm46177480440280"/></p>
</dd>
<dt><code>DOUBLE[(<em>width</em>, <em>decimals</em>)] [UNSIGNED] [ZEROFILL]</code></dt>
<dd>
<p>Stores floating-point numbers. It allows specification of an optional number of <code><em>decimals</em></code> and an optional display <code><em>width</em></code>. Without parameters (the typical usage), the type stores normal 8-byte, double-precision floating-point values. The <code><em>width</em></code> parameter has no effect on what is stored, only on what is displayed. The <code>UNSIGNED</code> and <code>ZEROFILL</code> options behave as for <code>INT</code>. The <code>DOUBLE</code> type has two identical synonyms: <code>REAL</code> and <code>DOUBLE PRECISION</code>.</p>
</dd>
</dl>
</div></section>













<section data-type="sect3" data-pdf-bookmark="String types"><div class="sect3" id="SEC-STRING-COLUMN-TYPES">
<h3>String types</h3>

<p>String data types are used to store text and, less obviously,<a data-type="indexterm" data-primary="columns" data-secondary="types of" data-tertiary="string types" id="ch04-cols"/><a data-type="indexterm" data-primary="string types of columns" data-seealso="strings" id="ch04-cols2"/><a data-type="indexterm" data-primary="strings" data-secondary="columns" data-see="string types of columns" id="idm46177480429720"/> binary data. MySQL supports the following string types:<a data-type="indexterm" data-primary="width argument" data-secondary="string data types" id="idm46177480428504"/></p>
<dl>
<dt><code>[NATIONAL] VARCHAR(<em>width</em>) [CHARACTER SET <em>charset_name</em>] 
<span class="keep-together">[COLLATE <em>collation_name</em>]</span></code></dt>
<dd>
<p>Probably the single most commonly used string type,<a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="VARCHAR" id="idm46177480424056"/><a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="VARCHAR" id="idm46177480422120"/><a data-type="indexterm" data-primary="VARCHAR data type" id="idm46177480421032"/> <code>VARCHAR</code> stores variable-length strings up to a maximum <code><em>width</em></code>. The maximum value of <code><em>width</em></code> is 65,535 characters. Most of the information applicable to this type will apply to other string types as well.</p>

<p>The <code>CHAR</code> and <code>VARCHAR</code> types are very similar, but there<a data-type="indexterm" data-primary="VARCHAR data type" data-secondary="CHAR versus" id="idm46177480417512"/><a data-type="indexterm" data-primary="CHAR data type" data-secondary="VARCHAR versus" id="idm46177480416664"/> are a few important distinctions. <code>VARCHAR</code> incurs one or two extra bytes of overhead to store the value of the string, depending on whether the value is smaller or larger than 255 bytes. Note that this size is different from the string length in characters, as certain characters might require up to 4 bytes of space. It might seem obvious, then, that <code>VARCHAR</code> is less efficient. However, that is not always true. As <code>VARCHAR</code> can store strings of arbitrary length (up to the <code><em>width</em></code> defined), shorter strings will require less storage space than a <code>CHAR</code> of similar length.</p>

<p class="less_space pagebreak-before">Another difference between <code>CHAR</code> and <code>VARCHAR</code> is their<a data-type="indexterm" data-primary="VARCHAR data type" data-secondary="trailing spaces" id="idm46177480411816"/><a data-type="indexterm" data-primary="CHAR data type" data-secondary="trailing spaces" id="idm46177480410968"/><a data-type="indexterm" data-primary="trailing spaces" id="idm46177480410120"/> handling of trailing spaces. <code>VARCHAR</code> retains trailing spaces up to the specified column width and will truncate the excess, producing a warning. As will be shown later, <code>CHAR</code> values are right-padded to the column width, and the trailing spaces aren’t preserved. For <code>VARCHAR</code>, trailing spaces are significant unless they are trimmed and will count as unique values. Let’s demonstrate:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">test_varchar_trailing</code><code class="p">(</code><code class="n">d</code><code> </code><code class="kt">VARCHAR</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code><code> </code><code class="k">UNIQUE</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.02 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_varchar_trailing</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'a'</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'a '</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="n">d</code><code class="p">,</code><code> </code><code class="nf">LENGTH</code><code class="p">(</code><code class="n">d</code><code class="p">)</code><code> </code><code class="k">FROM</code><code> </code><code class="n">test_varchar_trailing</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------+-----------+
| d    | LENGTH(d) |
+------+-----------+
| a    |         1 |
| a    |         2 |
+------+-----------+
2 rows in set (0.00 sec)</pre>

<p>The second row we inserted has a trailing space, and since the <code><em>width</em></code> for column <code>d</code> is 2, that space counts toward the uniqueness of a row. If we try inserting a row with two trailing spaces, however:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_varchar_trailing</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'a  '</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1062 (23000): Duplicate entry 'a '
for key 'test_varchar_trailing.d'</pre>

<p>MySQL refuses to accept the new row. <code>VARCHAR(2)</code> implicitly truncates trailing spaces beyond the set <code><em>width</em></code>, so the value stored changes from <code>"a  "</code> (with a double space after <em>a</em>) to <code>"a "</code> (with a single space after <em>a</em>). Since we already have a row with such a value, a duplicate entry error is reported. <a data-type="indexterm" data-primary="TEXT data type" data-secondary="trailing spaces" id="idm46177480278920"/>This behavior for <code>VARCHAR</code> and <code>TEXT</code> can be controlled by changing the column collation. <a data-type="indexterm" data-primary="collation of character sets" data-secondary="PAD SPACE or NO PAD attributes" id="idm46177480277064"/><a data-type="indexterm" data-primary="PAD SPACE attribute" id="idm46177480276152"/><a data-type="indexterm" data-primary="width argument" data-secondary="string data types" data-tertiary="PAD SPACE attribute" id="idm46177480255576"/>Some collations, like <code>latin1_bin</code>, have the <code>PAD SPACE</code> attribute, meaning that upon retrieval they are padded to the <code><em>width</em></code> with spaces. This doesn’t affect storage, but does affect uniqueness checks as well as how the <code>GROUP BY</code> and <code>DISTINCT</code> operators work, which we’ll discuss in <a data-type="xref" href="ch05.xhtml#CH5_ADV1">Chapter 5</a>. You can check whether a <a data-type="indexterm" data-primary="NO PAD attribute" id="idm46177480251464"/><a data-type="indexterm" data-primary="SHOW" data-secondary="COLLATION" data-tertiary="PAD SPACE or NO PAD" id="idm46177480250792"/>collation is <code>PAD SPACE</code> or <code>NO PAD</code> by running the <code>SHOW COLLATION</code> command, as we’ve shown in <a data-type="xref" href="#SEC-COLLATIONS">“Collation and Character Sets”</a>. Let’s see the effect in action by creating a table with a <code>PAD SPACE</code> collation:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">test_varchar_pad_collation</code><code class="p">(</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">data</code><code> </code><code class="kt">VARCHAR</code><code class="p">(</code><code class="mi">5</code><code class="p">)</code><code> </code><code class="k">CHARACTER</code><code> </code><code class="kt">SET</code><code> </code><code class="n">latin1</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">COLLATE</code><code> </code><code class="n">latin1_bin</code><code> </code><code class="k">UNIQUE</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.02 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_varchar_pad_collation</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'a'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_varchar_pad_collation</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'a '</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1062 (23000): Duplicate entry 'a '
for key 'test_varchar_pad_collation.data'</pre>

<p>The <code>NO PAD</code> collation is a new addition of MySQL 8.0. In prior releases of MySQL, which you may still often see in use, every collation implicitly has the <code>PAD SPACE</code> attribute. Therefore, in MySQL 5.7 and prior releases, your only option to preserve trailing spaces is to use a binary type: <code>VARBINARY</code> or <code>BLOB</code>.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Both the <code>CHAR</code> and <code>VARCHAR</code> data types disallow storage<a data-type="indexterm" data-primary="width argument" data-secondary="string data types" data-tertiary="values longer than width" id="idm46177480137416"/><a data-type="indexterm" data-primary="CHAR data type" data-secondary="values longer than width" id="idm46177480136200"/><a data-type="indexterm" data-primary="VARCHAR data type" data-secondary="values longer than width" id="idm46177480135288"/><a data-type="indexterm" data-primary="STRICT_TRANS_TABLES" data-secondary="CHAR and VARCHAR values" id="idm46177480134376"/><a data-type="indexterm" data-primary="STRICT_ALL_TABLES" id="idm46177480133432"/> of values longer than <code><em>width</em></code>, unless strict SQL mode is disabled (i.e., if neither <code>STRICT_ALL_TABLES</code> or <code>STRICT_TRANS_TABLES</code> is enabled). With the protection disabled, values longer than <code><em>width</em></code> are truncated, and a warning is shown. We don’t recommend enabling legacy behavior, as it might result in data loss.</p>
</div>

<p>Sorting and comparison of the <code>VARCHAR</code>, <code>CHAR</code>, and<a data-type="indexterm" data-primary="collation of character sets" data-secondary="string sorting and comparison" id="idm46177480116840"/><a data-type="indexterm" data-primary="strings" data-secondary="collation and character sets" data-tertiary="sorting and comparison" id="idm46177480115992"/><a data-type="indexterm" data-primary="TEXT data type" data-secondary="collation and character sets" data-tertiary="sorting and comparison" id="idm46177480114760"/><a data-type="indexterm" data-primary="VARCHAR data type" data-secondary="collation and character sets" data-tertiary="sorting and comparison" id="idm46177480113528"/><a data-type="indexterm" data-primary="CHAR data type" data-secondary="collation and character sets" id="idm46177480112296"/> <code>TEXT</code> types happens according to the collation of the character set assigned. You can see that it is possible to specify the character set, as well as the collation for each individual string-type column. <a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="binary character set" id="idm46177480110568"/><a data-type="indexterm" data-primary="binary character set" id="idm46177480109576"/><a data-type="indexterm" data-primary="VARCHAR data type" data-secondary="collation and character sets" data-tertiary="binary charset and VARBINARY" id="idm46177480108904"/><a data-type="indexterm" data-primary="VARBINARY data type" data-secondary="binary character set" id="idm46177480107656"/>It’s also possible to specify the <code>binary</code> character set, which effectively converts <code>VARCHAR</code> into <code>VARBINARY</code>. Don’t mistake the <code>binary</code> charset for a <code>BINARY</code> attribute for a charset; the latter is a MySQL-only shorthand to specify a binary (<code>_bin</code>) collation.</p>

<p>What’s more, it’s possible to specify a collation directly in the<a data-type="indexterm" data-primary="ORDER BY" data-secondary="collation specified via" id="idm46177480103608"/><a data-type="indexterm" data-primary="collation of character sets" data-secondary="ORDER BY specifying" id="idm46177480102632"/><a data-type="indexterm" data-primary="strings" data-secondary="collation and character sets" data-tertiary="ORDER BY specifying collation" id="idm46177480101688"/><a data-type="indexterm" data-primary="VARCHAR data type" data-secondary="collation and character sets" data-tertiary="ORDER BY specifying collation" id="idm46177480100440"/><a data-type="indexterm" data-primary="TEXT data type" data-secondary="collation and character sets" data-tertiary="ORDER BY specifying collation" id="idm46177480099192"/> <code>ORDER BY</code> clause. Available collations will depend on the character set of the column. Continuing with the <code>test_varchar_pad_collation</code> table, it’s possible to store an ä symbol there and then see the effect collations make on the string ordering:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_varchar_pad_collation</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'ä'</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'z'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 2 rows affected (0.01 sec)
Records: 2  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">test_varchar_pad_collation</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">ORDER</code><code> </code><code class="k">BY</code><code> </code><code class="n">data</code><code> </code><code class="k">COLLATE</code><code> </code><code class="n">latin1_german1_ci</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting" class="less_space pagebreak-before">+------+
| data |
+------+
| a    |
| ä    |
| z    |
+------+
3 rows in set (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">test_varchar_pad_collation</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">ORDER</code><code> </code><code class="k">BY</code><code> </code><code class="n">data</code><code> </code><code class="k">COLLATE</code><code> </code><code class="n">latin1_swedish_ci</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------+
| data |
+------+
| a    |
| z    |
| ä    |
+------+
3 rows in set (0.00 sec)</pre>

<p>The <code>NATIONAL</code> (or its equivalent short form, <code>NCHAR</code>) attribute<a data-type="indexterm" data-primary="VARCHAR data type" data-secondary="NATIONAL attribute" id="idm46177479988584"/><a data-type="indexterm" data-primary="NATIONAL (NCHAR) attribute" id="idm46177479987576"/><a data-type="indexterm" data-primary="string types of columns" data-secondary="NATIONAL (NCHAR) attribute" id="idm46177479986936"/><a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="NATIONAL (NCHAR) attribute" id="idm46177479986024"/><a data-type="indexterm" data-primary="utf8 character set" id="idm46177479985144"/> is a standard SQL way to specify that a string-type column must use a predefined character set. MySQL uses <code>utf8</code> as this charset. It’s important to note that MySQL 5.7 and 8.0 disagree on what exactly <code>utf8</code> is, however: the former uses it as an alias for <code>utf8mb3</code>, and the latter for <code>utf8mb4</code>. Thus, it is best to not use the <code>NATIONAL</code> attribute, as well as ambiguous aliases. The best practice with any text-related columns and data is to be as unambiguous and specific as possible.</p>
</dd>
<dt><code>[NATIONAL] CHAR(<em>width</em>) [CHARACTER SET <em>charset_name</em>] 
<span class="keep-together">[COLLATE <em>collation_name</em>]</span></code></dt>
<dd>
<p><code>CHAR</code> stores a fixed-length string (such as a name, address,<a data-type="indexterm" data-primary="CHAR data type" data-secondary="arguments" id="idm46177479965448"/><a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="CHAR" id="idm46177479964600"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="CHAR" id="idm46177479963512"/><a data-type="indexterm" data-primary="width argument" data-secondary="string data types" id="idm46177479962424"/> or city) of length <code><em>width</em></code>. If a <code><em>width</em></code> is not provided, <code>CHAR(1)</code> is assumed. The maximum value of <code><em>width</em></code> is 255. As with <code>VARCHAR</code>, values in <code>CHAR</code> columns are always stored at the specified length. A single letter stored in a <code>CHAR(255)</code> column will take 255 bytes (in the <code>latin1</code> charset) and will be padded with spaces. <a data-type="indexterm" data-primary="PAD_CHAR_TO_FULL_LENGTH" id="idm46177479958120"/>The padding is removed when reading the data, unless the <code>PAD_CHAR_TO_FULL_LENGTH</code> SQL mode is enabled. It’s worth mentioning again that this means that strings stored in <code>CHAR</code> columns will lose all of their trailing spaces.</p>

<p>In the past, the <code><em>width</em></code> of a <code>CHAR</code> column was often associated a size in bytes. That’s not always the case now, and it’s definitely not the case by default. Multibyte character sets, such as the default <code>utf8mb4</code> in MySQL 8.0, can result in much larger values. InnoDB will actually encode fixed-length columns as variable-length columns if their maximum size exceeds 768 bytes. Thus, in MySQL 8.0, by default InnoDB will store a <code>CHAR(255)</code> column as it would a <code>VARCHAR</code> column. Here’s an example:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">test_char_length</code><code class="p">(</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code>   </code><strong><code class="n">utf8char</code><code> </code><code class="kt">CHAR</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code><code> </code><code class="k">CHARACTER</code><code> </code><code class="kt">SET</code><code> </code><code class="n">utf8mb4</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">,</code><code> </code><code class="n">asciichar</code><code> </code><code class="kt">CHAR</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code><code> </code><code class="k">CHARACTER</code><code> </code><code class="kt">SET</code><code> </code><code class="k">binary</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.04 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_char_length</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'Plain text'</code><code class="p">,</code><code> </code><code class="s1">'Plain text'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.01 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_char_length</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code></strong><code class="s1">'的開源軟體'</code><strong><code class="p">,</code><code> </code><code class="s1">'Plain text'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="nf">LENGTH</code><code class="p">(</code><code class="n">utf8char</code><code class="p">)</code><code class="p">,</code><code> </code><code class="nf">LENGTH</code><code class="p">(</code><code class="n">asciichar</code><code class="p">)</code><code> </code><code class="k">FROM</code><code> </code><code class="n">test_char_length</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------------------+-------------------+
| LENGTH(utf8char) | LENGTH(asciichar) |
+------------------+-------------------+
|               10 |                10 |
|               15 |                10 |
+------------------+-------------------+
2 rows in set (0.00 sec)</pre>

<p>As the values are left-aligned and right-padded with spaces,<a data-type="indexterm" data-primary="CHAR data type" data-secondary="VARCHAR versus" id="idm46177479791704"/><a data-type="indexterm" data-primary="VARCHAR data type" data-secondary="CHAR versus" id="idm46177479790760"/><a data-type="indexterm" data-primary="strings" data-secondary="comparisons" data-tertiary="CHAR versus VARCHAR" id="idm46177479789816"/> and any trailing spaces aren’t considered for <code>CHAR</code> at all, it’s impossible to compare strings consisting of spaces alone. If you find yourself in a situation in which that’s important, <code>VARCHAR</code> is the data type to use.</p>
</dd>
<dt><code>BINARY[(<em>width</em>)]</code> and <code>VARBINARY(<em>width</em>)</code></dt>
<dd>
<p>These types are very similar to <code>CHAR</code> and <code>VARCHAR</code> but<a data-type="indexterm" data-primary="BINARY data type" id="idm46177479771464"/><a data-type="indexterm" data-primary="VARBINARY data type" id="idm46177479770088"/><a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="BINARY" id="idm46177479769480"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="BINARY" id="idm46177479768392"/><a data-type="indexterm" data-primary="VARCHAR data type" data-secondary="collation and character sets" data-tertiary="binary charset and VARBINARY" id="idm46177479767304"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="VARBINARY" id="idm46177479766216"/><a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="VARBINARY" id="idm46177479765064"/><a data-type="indexterm" data-primary="strings" data-secondary="collation and character sets" data-tertiary="binary strings" id="idm46177479763848"/><a data-type="indexterm" data-primary="collation of character sets" data-secondary="string sorting and comparison" data-tertiary="binary strings" id="idm46177479762664"/><a data-type="indexterm" data-primary="binary character set" id="idm46177479761512"/><a data-type="indexterm" data-primary="character sets (charsets)" data-secondary="binary character set" id="idm46177479760840"/> store binary strings. Binary strings have the special <code>binary</code> character set and collation, and sorting them is dependent on the numeric values of the bytes in the values stored. Instead of character strings, byte strings are stored. In the earlier discussion of <code>VARCHAR</code> we described the <code>binary</code> charset and <code>BINARY</code> attribute. Only the <code>binary</code> charset “converts” a <code>VARCHAR</code> or <code>CHAR</code> into its respective <code>BINARY</code> form. Applying the <code>BINARY</code> attribute to a charset will not change the fact that character strings are stored. <a data-type="indexterm" data-primary="width argument" data-secondary="string data types" data-tertiary="binary strings" id="idm46177479755560"/>Unlike with <code>VARCHAR</code> and <code>CHAR</code>, <code><em>width</em></code> here is exactly the number of bytes. When <code><em>width</em></code> is omitted for <code>BINARY</code>, it defaults to 1.</p>

<p>Like with <code>CHAR</code>, data in the <code>BINARY</code> column is padded on the right. <a data-type="indexterm" data-primary="zero (0)" data-secondary="zero (\0) bytes and data types" id="idm46177479750776"/><a data-type="indexterm" data-primary="VARBINARY data type" data-secondary="data ending in \0 byte" id="idm46177479749736"/><a data-type="indexterm" data-primary="BLOB data type" data-secondary="data ending in \0 byte" id="idm46177479748792"/>However, being a binary data, it’s padded using zero bytes, usually written as <code>0x00</code> or <code>\0</code>. <code>BINARY</code> treats a space as a significant character, not padding. If you need to store data that might end in zero bytes that are significant to you, use the <code>VARBINARY</code> or <code>BLOB</code> types.</p>

<p>It is important to keep the concept of binary strings in mind when working with both of these data types. Even though they’ll accept strings, they aren’t synonyms for data types using text strings. For example, you cannot change the case of the letters stored, as that concept doesn’t really apply to binary data. That becomes quite clear when you consider the actual data stored. Let’s look at an example:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">test_binary_data</code><code> </code><code class="p">(</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code>   </code><strong><code class="n">d1</code><code> </code><code class="k">BINARY</code><code class="p">(</code><code class="mi">16</code><code class="p">)</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">,</code><code> </code><code class="n">d2</code><code> </code><code class="kt">VARBINARY</code><code class="p">(</code><code class="mi">16</code><code class="p">)</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">,</code><code> </code><code class="n">d3</code><code> </code><code class="kt">CHAR</code><code class="p">(</code><code class="mi">16</code><code class="p">)</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">,</code><code> </code><code class="n">d4</code><code> </code><code class="kt">VARCHAR</code><code class="p">(</code><code class="mi">16</code><code class="p">)</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.03 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_binary_data</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code>   </code><strong><code class="s1">'something'</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">,</code><code> </code><code class="s1">'something'</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">,</code><code> </code><code class="s1">'something'</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">,</code><code> </code><code class="s1">'something'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="n">d1</code><code class="p">,</code><code> </code><code class="n">d2</code><code class="p">,</code><code> </code><code class="n">d3</code><code class="p">,</code><code> </code><code class="n">d4</code><code> </code><code class="k">FROM</code><code> </code><code class="n">test_binary_data</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">*************************** 1. row ***************************
d1: 0x736F6D657468696E6700000000000000
d2: 0x736F6D657468696E67
d3: something
d4: something
1 row in set (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="nf">UPPER</code><code class="p">(</code><code class="n">d2</code><code class="p">)</code><code class="p">,</code><code> </code><code class="nf">UPPER</code><code class="p">(</code><code class="n">d4</code><code class="p">)</code><code> </code><code class="k">FROM</code><code> </code><code class="n">test_binary_data</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">*************************** 1. row ***************************
UPPER(d2): 0x736F6D657468696E67
UPPER(d4): SOMETHING
1 row in set (0.01 sec)</pre>

<p>Note how the MySQL command-line client actually shows values of binary types in hex format. We believe that this is much better than the silent conversions that were performed prior to MySQL 8.0, which might’ve resulted in misunderstanding. To get the actual text data back, you have to explicitly cast the binary data to text:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="nf">CAST</code><code class="p">(</code><code class="n">d1</code><code> </code><code class="k">AS</code><code> </code><code class="kt">CHAR</code><code class="p">)</code><code> </code><code class="n">d1t</code><code class="p">,</code><code> </code><code class="nf">CAST</code><code class="p">(</code><code class="n">d2</code><code> </code><code class="k">AS</code><code> </code><code class="kt">CHAR</code><code class="p">)</code><code> </code><code class="n">d2t</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">FROM</code><code> </code><code class="n">test_binary_data</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------------------+-----------+
| d1t              | d2t       |
+------------------+-----------+
| something        | something |
+------------------+-----------+
1 row in set (0.00 sec)</pre>

<p>You can also see that <code>BINARY</code> padding was converted to spaces when casting was performed.</p>
</dd>
<dt><code>BLOB[(<em>width</em>)]</code> and <code>
<span class="keep-together">TEXT[(<em>width</em>)] [CHARACTER SET <em>charset_name</em>] [COLLATE <em>collation_name</em>]</span></code></dt>
<dd>
<p><code>BLOB</code> and <code>TEXT</code> are commonly used data types for storing<a data-type="indexterm" data-primary="BLOB data type" id="idm46177479494440"/><a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="BLOB" id="idm46177479493736"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="BLOB" id="idm46177479492520"/><a data-type="indexterm" data-primary="TEXT data type" id="idm46177479474952"/><a data-type="indexterm" data-primary="width argument" data-secondary="string data types" data-tertiary="BLOB and TEXT" id="idm46177479474344"/> large data. You may think of <code>BLOB</code> as a <code>VARBINARY</code> holding as much data as you like, and the same for <code>TEXT</code> and <code>VARCHAR</code>. The <code>BLOB</code> and <code>TEXT</code> types can store up to 65,535 bytes or characters, respectively. As usual, note that multibyte charsets do exist. The <code><em>width</em></code> attribute is optional, and when it is specified, MySQL actually will change the <code>BLOB</code> or <code>TEXT</code> data type to whatever the smallest type capable of holding that amount of data is. For example, <code>BLOB(128)</code> will result in <code>TINYBLOB</code> being used:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">test_blob</code><code class="p">(</code><code class="n">data</code><code> </code><code class="kt">BLOB</code><code class="p">(</code><code class="mi">128</code><code class="p">)</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.07 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">DESC</code><code> </code><code class="n">test_blob</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+-------+----------+------+-----+---------+-------+
| Field | Type     | Null | Key | Default | Extra |
+-------+----------+------+-----+---------+-------+
| data  | tinyblob | YES  |     | NULL    |       |
+-------+----------+------+-----+---------+-------+
1 row in set (0.00 sec)</pre>

<p>For the <code>BLOB</code> type and related types, data is treated exactly as it would be in the case of <code>VARBINARY</code>. That is, no character set is assumed, and comparison and sorting are based on the numeric values of the actual bytes stored. For <code>TEXT</code>, you may specify the exact desired charset and collation. For both types and their variants, no padding is performed on <code>INSERT</code>, and no trimming is performed on <code>SELECT</code>, making them ideal for storing data exactly as it is. In addition, a <code>DEFAULT</code> clause is not permitted, and when an index is created on a <code>BLOB</code> or <code>TEXT</code> column, a prefix must be defined limiting the length of the indexed values. We talk more about that in <a data-type="xref" href="#SEC-KEYS_AND_INDEXES">“Keys and Indexes”</a>.</p>

<p>One potential difference between <code>BLOB</code> and <code>TEXT</code> is their<a data-type="indexterm" data-primary="BLOB data type" data-secondary="trailing spaces" id="idm46177479417944"/><a data-type="indexterm" data-primary="TEXT data type" data-secondary="trailing spaces" id="idm46177479400120"/> handling of trailing spaces. As we’ve shown already, <code>VARCHAR</code> and <code>TEXT</code> may pad strings depending on the collation used. <code>BLOB</code> and <code>VARBINARY</code> both use the <code>binary</code> character set with a single <code>binary</code> collation with no padding and are impervious to collation mixups and related issues. Sometimes, it can be a good choice to use these types for additional safety. In addition to that, prior to MySQL 8.0, these were the only types that preserved trailing spaces.</p>
</dd>
<dt><code>TINYBLOB</code> and <code>
<span class="keep-together">TINYTEXT [CHARACTER SET <em>charset_name</em>] [COLLATE <em>collation_name</em>]</span></code></dt>
<dd>
<p>These are identical to <code>BLOB</code> and <code>TEXT</code>, respectively, except<a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="TINYBLOB" id="idm46177479393128"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="TINYBLOB" id="idm46177479392040"/><a data-type="indexterm" data-primary="TINYBLOB data type" id="idm46177479390952"/> that a maximum of 255 bytes or characters can be stored.</p>
</dd>
<dt><code>MEDIUMBLOB</code> and <code>
<span class="keep-together">MEDIUMTEXT [CHARACTER SET <em>charset_name</em>] [COLLATE <em>collation_name</em>]</span></code></dt>
<dd>
<p>These are identical to <code>BLOB</code> and <code>TEXT</code>, respectively, except<a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="MEDIUMBLOB" id="idm46177479385688"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="MEDIUMBLOB" id="idm46177479384408"/><a data-type="indexterm" data-primary="MEDIUMBLOB data type" id="idm46177479383192"/><a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="MEDIUMTEXT" id="idm46177479382520"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="MEDIUMTEXT" id="idm46177479381304"/><a data-type="indexterm" data-primary="MEDIUMTEXT data type" id="idm46177479380088"/><a data-type="indexterm" data-primary="LONG data type" id="idm46177479379416"/><a data-type="indexterm" data-primary="LONG VARCHAR data type" id="idm46177479378744"/><a data-type="indexterm" data-primary="VARCHAR data type" data-secondary="LONG VARCHAR" id="idm46177479378072"/> that a maximum of 16,777,215 bytes or characters can be stored. The types <code>LONG</code> and <code>LONG VARCHAR</code> map to the <code>MEDIUMTEXT</code> data type for compatibility.</p>
</dd>
<dt><code>LONGBLOB</code> and <code>
<span class="keep-together">LONGTEXT [CHARACTER SET <em>charset_name</em>] [COLLATE <em>collation_name</em>]</span></code></dt>
<dd>
<p>These are identical to <code>BLOB</code> and <code>TEXT</code>, respectively, except<a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="LONGBLOB" id="idm46177479371480"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="LONGBLOB" id="idm46177479370200"/><a data-type="indexterm" data-primary="LONGBLOB data type" id="idm46177479368984"/><a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="LONGTEXT" id="idm46177479368312"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="LONGTEXT" id="idm46177479367096"/><a data-type="indexterm" data-primary="LONGTEXT data type" id="idm46177479365880"/> that a maximum of 4 GB of data can be stored. Note that this is a hard limit even in case of <code>LONGTEXT</code>, and thus the number of characters in multibyte charsets can be less than 4,294,967,295. The effective maximum size of the data that can be stored by a client will be limited by the amount of available memory as well as the <a data-type="indexterm" data-primary="max_packet_size variable" id="idm46177479364344"/>value of the <code>max_packet_size</code> variable, which defaults to 64 MiB.</p>
</dd>
<dt><code>ENUM(<em><em>value1</em></em>[,<em><em>value2</em></em>[, …]]) [CHARACTER SET <em>charset_name</em>] 
<span class="keep-together">[COLLATE <em>collation_name</em>]</span></code></dt>
<dd>
<p>This type stores a list, or <em>enumeration</em>, of string values. A<a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="ENUM" id="idm46177479357784"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="ENUM" id="idm46177479356536"/><a data-type="indexterm" data-primary="ENUM data type" id="idm46177479355288"/> column of type <code>ENUM</code> can be set to a value from the list <code><em>value1</em></code>, <code><em>value2</em></code>, and so on, up to a maximum of 65,535 different values. While the values are stored and retrieved as strings, what’s stored in the database is an integer representation. The <code>ENUM</code> column can contain <code>NULL</code> values (stored as <code>NULL</code>), the empty string <code>''</code> (stored as <code>0</code>), or any of the valid elements (stored as <code>1</code>, <code>2</code>, <code>3</code>, and so on). <a data-type="indexterm" data-primary="columns" data-secondary="NOT NULL declaration" id="idm46177479349176"/><a data-type="indexterm" data-primary="NULL" data-secondary="NOT NULL columns" data-tertiary="ENUM allowing NULL" id="idm46177479348168"/>You can prevent <code>NULL</code> values from being accepted by declaring the column as <code>NOT NULL</code> when creating the table.</p>

<p>This type offers a compact way of storing values from a list of predefined values, such as state or country names. Consider this example using fruit names; the name can be any one of the predefined values <code>Apple</code>, <code>Orange</code>, or <code>Pear</code> (in addition to <code>NULL</code> and the empty string):</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">fruits_enum</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">(</code><code class="n">fruit_name</code><code> </code><code class="kt">ENUM</code><code class="p">(</code><code class="s1">'Apple'</code><code class="p">,</code><code> </code><code class="s1">'Orange'</code><code class="p">,</code><code> </code><code class="s1">'Pear'</code><code class="p">)</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">fruits_enum</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'Apple'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<p class="pagebreak-before">If you try inserting a value that’s not in the list, MySQL produces an error to tell you that it didn’t store the data you asked:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">fruits_enum</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'Banana'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1265 (01000): Data truncated for column 'fruit_name' at row 1</pre>

<p>A list of several allowed values isn’t accepted either:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">fruits_enum</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'Apple,Orange'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1265 (01000): Data truncated for column 'fruit_name' at row 1</pre>

<p>Displaying the contents of the table, you can see that no invalid values were stored:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">fruits_enum</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------------+
| fruit_name |
+------------+
| Apple      |
+------------+
1 row in set (0.00 sec)</pre>

<p>Earlier versions of MySQL produced a warning instead of an error and stored an empty string in place of an invalid value. That behavior can be enabled by disabling the default strict SQL mode. It’s also possible to specify a default value other than the empty string:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">new_fruits_enum</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">(</code><code class="n">fruit_name</code><code> </code><code class="kt">ENUM</code><code class="p">(</code><code class="s1">'Apple'</code><code class="p">,</code><code> </code><code class="s1">'Orange'</code><code class="p">,</code><code> </code><code class="s1">'Pear'</code><code class="p">)</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">DEFAULT</code><code> </code><code class="s1">'Pear'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.01 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">new_fruits_enum</code><code> </code><code class="k">VALUES</code><code class="p">(</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.02 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">new_fruits_enum</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------------+
| fruit_name |
+------------+
| Pear       |
+------------+
1 row in set (0.00 sec)</pre>

<p>Here, not specifying a value results in the default value <code>Pear</code> being stored.</p>
</dd>
<dt><code>SET( <em>value1</em> [, <em>value2</em> [, …]]) [CHARACTER SET <em>charset_name</em>] 
<span class="keep-together">[COLLATE <em>collation_name</em>]</span></code></dt>
<dd>
<p>This type stores a set of string values. A column of type <code>SET</code> <a data-type="indexterm" data-primary="string types of columns" data-secondary="types of strings" data-tertiary="SET" id="idm46177479071992"/><a data-type="indexterm" data-primary="strings" data-secondary="types of" data-tertiary="SET" id="idm46177479070712"/><a data-type="indexterm" data-primary="SET data type" id="idm46177479050392"/><a data-type="indexterm" data-primary="SET data type" data-secondary="ENUM versus" id="idm46177479049784"/><a data-type="indexterm" data-primary="ENUM data type" data-secondary="SET versus" id="idm46177479048936"/>can be set to zero or more values from the list <code><em>value1</em></code>, <code><em>value2</em></code>, and so on, up to a maximum of 64 different values. While the values are strings, what’s stored in the database is an integer representation. <code>SET</code> differs from <code>ENUM</code> in that each row can store only one <code>ENUM</code> value in a column, but can store multiple <code>SET</code> values. This type is useful for storing a selection of choices from a list, such as user preferences. Consider this example using fruit names; the name can be any combination of the predefined values:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">fruits_set</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">(</code><code> </code><code class="n">fruit_name</code><code> </code><code class="kt">SET</code><code class="p">(</code><code class="s1">'Apple'</code><code class="p">,</code><code> </code><code class="s1">'Orange'</code><code class="p">,</code><code> </code><code class="s1">'Pear'</code><code class="p">)</code><code> </code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.08 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">fruits_set</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'Apple'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">fruits_set</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'Banana'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1265 (01000): Data truncated for column 'fruit_name' at row 1</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">fruits_set</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'Apple,Orange'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">fruits_set</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+--------------+
| fruit_name   |
+--------------+
| Apple        |
| Apple,Orange |
+--------------+
2 rows in set (0.00 sec)</pre>

<p>Again, note that we can store multiple values from the set in a single field and that an empty string is stored for invalid input.</p>
</dd>
</dl>

<p>As with numeric types, we recommend that you always choose<a data-type="indexterm" data-primary="string types of columns" data-secondary="performance and data type" id="idm46177478890968"/><a data-type="indexterm" data-primary="performance" data-secondary="data type and" id="idm46177478890024"/> the smallest possible type to store values. For example, if you’re storing a city name, use <code>CHAR</code> or <code>VARCHAR</code> rather than, say, the <code>TEXT</code> type. Having shorter columns helps keep your table size down, which in turns helps performance when the server has to search through a table.</p>

<p class="pagebreak-before">Using a fixed size with the <code>CHAR</code> type is often faster than using a variable size with <code>VARCHAR</code>, since the MySQL server knows where each row starts and ends and can quickly skip over rows to find the one it needs. However, with fixed-length fields, any space that you don’t use is wasted. For example, if you allow up to 40 characters in a city name, then <code>CHAR(40)</code> will always use up 40 characters, no matter how long the city name actually is. If you declare the city name to be <code>VARCHAR(40)</code>, then you’ll use up only as much space as you need, plus 1 byte to store the name’s length. If the average city name is 10 characters long, this means that using a variable-length field will take up on average 29 fewer bytes per entry. This can make a big difference if you’re storing millions of addresses.</p>

<p>In general, if storage space is at a premium or you expect large variations in the length of strings that are to be stored, use a variable-length field; if performance is a priority, use a fixed-length field.<a data-type="indexterm" data-startref="ch04-cols" id="idm46177478864536"/><a data-type="indexterm" data-startref="ch04-cols2" id="idm46177478863928"/></p>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Date and time types"><div class="sect3" id="SEC-DATETIME-COLUMN-TYPES">
<h3>Date and time types</h3>

<p>These types serve the purpose of storing particular<a data-type="indexterm" data-primary="columns" data-secondary="types of" data-tertiary="date and time" id="ch04-dt"/><a data-type="indexterm" data-primary="date and time columns" id="ch04-dt2"/><a data-type="indexterm" data-primary="time and date columns" id="ch04-dt3"/> timestamps, dates, or time ranges. <a data-type="indexterm" data-primary="date and time columns" data-secondary="time zone cautions" id="idm46177478858344"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="time zone cautions" id="idm46177478857400"/><a data-type="indexterm" data-primary="time zones" data-secondary="cautions about" id="idm46177478856456"/>Particular care should be taken when dealing with time zones. We will try to explain the details, but it’s worth rereading this section and the documentation later, when you need to actually work with time zones. The date and time types in MySQL are:</p>
<dl>
<dt><code>DATE</code></dt>
<dd>
<div class="openblock">
<p>Stores and displays a date in the format <code><em>YYYY-MM-DD</em></code> <a data-type="indexterm" data-primary="date and time columns" data-secondary="DATE data type" id="ch04-dat"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="DATE data type" id="ch04-dat2"/><a data-type="indexterm" data-primary="DATE data type" id="ch04-dat3"/>for the range 1000-01-01 to 9999-12-31. Dates must always be input as year, month, day triples, but the format of the input can vary, as shown in the following examples:</p>
<dl>
<dt><code><em>YYYY-MM-DD</em></code> or <code><em>YY-MM-DD</em></code></dt>
<dd>
<p>It’s optional<a data-type="indexterm" data-primary="date and time columns" data-secondary="YEAR data type" data-tertiary="two or four digits" id="idm46177478844984"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="YEAR data type" data-tertiary="two or four digits" id="idm46177478843704"/><a data-type="indexterm" data-primary="YEAR data type" data-secondary="two or four digits" id="idm46177478842488"/> whether you provide two-digit or four-digit years. We strongly recommend that you use the four-digit version to avoid confusion about the century. In practice, if you use the two-digit version, you’ll find that 70 to 99 are interpreted as 1970 to 1999, and 00 to 69 are interpreted as 2000 to 2069.</p>
</dd>
<dt><code><em>YYYY/MM/DD</em></code>, <code><em>YYYY:MM:DD</em></code>, <code><em>YY-MM-DD</em></code>, or other punctuated formats</dt>
<dd>
<p>MySQL allows any punctuation characters to separate the components of a date. We recommend using dashes and, again, avoiding two-digit years.</p>
</dd>
<dt><code><em>YYYY-M-D</em></code>, <code><em>YYYY-MM-D</em></code>, or <code><em>YYYY-M-DD</em></code></dt>
<dd>
<p>When punctuation is used (again, any punctuation character is allowed), single-digit days and months can be specified as such. For example, February 2, 2006, can be specified as <code>2006-2-2</code>. The two-digit year equivalents are available, but not recommended.</p>
</dd>
<dt><code><em>YYYYMMDD</em></code> or <code><em>YYMMDD</em></code></dt>
<dd>
<p>Punctuation can be omitted in both date styles, but the digit sequences must be six or eight digits in length.</p>
</dd>
</dl>

<p>You can also input a date by providing both a date and time in the formats described later for <code>DATETIME</code> and <code>TIMESTAMP</code>, but only the date component is stored in a <code>DATE</code> column. Regardless of the input type, the storage and display type is always <code><em>YYYY-MM-DD</em></code>. <a data-type="indexterm" data-primary="DATE data type" data-secondary="zero date" id="idm46177478829608"/><a data-type="indexterm" data-primary="date and time columns" data-secondary="DATE data type" data-tertiary="zero date" id="idm46177478828632"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="DATE data type" data-tertiary="zero date" id="idm46177478827416"/><a data-type="indexterm" data-primary="zero date" id="idm46177478826200"/><a data-type="indexterm" data-primary="STRICT_TRANS_TABLES" data-secondary="DATE values" id="idm46177478825528"/>The <em>zero date</em> <code>0000-00-00</code> is allowed in all versions and can be used to represent an unknown or dummy value. If an input date is out of range, the zero date is stored. However, only MySQL versions up to and including 5.6 allow that by default. Both 5.7 and 8.0 by default set SQL modes that prohibit this behavior: <code>STRICT_TRANS_TABLES</code>, <code>NO_ZERO_DATE</code>, and <code>NO_ZERO_IN_DATE</code>.</p>

<p>If you’re using an older version of MySQL, we recommend that you add these modes to your current session:<a data-type="indexterm" data-primary="SET command" data-secondary="sql_mode" id="idm46177478821720"/><a data-type="indexterm" data-primary="sql_mode variable" id="idm46177478820712"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="kt">SET</code><code> </code><code class="n">sql_mode</code><code class="o">=</code><code class="nf">CONCAT</code><code class="p">(</code><code class="o">@</code><code class="o">@</code><code class="n">sql_mode</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="s1">',STRICT_TRANS_TABLES'</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="s1">',NO_ZERO_DATE'</code><code class="p">,</code><code> </code><code class="s1">',NO_ZERO_IN_DATE'</code><code class="p">)</code><code class="p">;</code></strong></pre>
<div data-type="tip"><h6>Tip</h6>
<p>You can also set the <code>sql_mode</code> variable on a global server level and in the configuration file. This variable must list every mode you want to be enabled.</p>
</div>

<p>Here are some examples of inserting dates on a MySQL 8.0 server with default settings:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">testdate</code><code> </code><code class="p">(</code><code class="n">mydate</code><code> </code><code class="kt">DATE</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">testdate</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'2020/02/0'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1292 (22007): Incorrect date value: '2020/02/0'
for column 'mydate' at row 1</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">testdate</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'2020/02/1'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">testdate</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'2020/02/31'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1292 (22007): Incorrect date value: '2020/02/31'
for column 'mydate' at row 1</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">testdate</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="s1">'2020/02/100'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1292 (22007): Incorrect date value: '2020/02/100'
for column 'mydate' at row 1</pre>

<p>Once <code>INSERT</code> statements are executed, the table will have the following data:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">testdate</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------------+
| mydate     |
+------------+
| 2020-02-01 |
+------------+
1 row in set (0.00 sec)</pre>

<p>MySQL protected you from having “bad” data stored in your table. Sometimes you may need to preserve the actual input and manually process it later. You can do that by removing the aforementioned SQL modes from the list of modes in the <code>sql_mode</code> variable. In that case, after running the previous <code>INSERT</code> statements, you would end up with the following data:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">testdate</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------------+
| mydate     |
+------------+
| 2020-02-00 |
| 2020-02-01 |
| 0000-00-00 |
| 0000-00-00 |
+------------+
4 rows in set (0.01 sec)</pre>

<p>Note again that the date is displayed in the <code><em>YYYY-MM-DD</em></code> format, regardless of how it was input.<a data-type="indexterm" data-startref="ch04-dat" id="idm46177478564536"/><a data-type="indexterm" data-startref="ch04-dat2" id="idm46177478563976"/><a data-type="indexterm" data-startref="ch04-dat3" id="idm46177478563304"/></p>
</div>

</dd>
<dt><code>TIME [<em>fraction</em>]</code></dt>
<dd>
<p>Stores a time in the format <code><em>HHH:MM:SS</em></code> for the range<a data-type="indexterm" data-primary="date and time columns" data-secondary="TIME data type" id="ch04-tim"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="TIME data type" id="ch04-tim2"/><a data-type="indexterm" data-primary="TIME data type" id="ch04-tim3"/> –838:59:59 to 838:59:59. This is useful for storing the duration of some activity. The values that can be stored are outside the range of the 24-hour clock to allow large differences between time values (up to 34 days, 22 hours, 59 minutes, and 59 seconds) to be computed and stored. <code><em>fraction</em></code> in <code>TIME</code> and other related data types specifies the fractional seconds precision in the range 0 to 6. The default value is 0, meaning that no fractional seconds are preserved.</p>

<p>Times must always be input in the order <em>days</em>, <em>hours</em>, <em>minutes</em>, <em>seconds</em>, using the following formats:</p>
<dl>
<dt><code><em>DD HH:MM:SS[.fraction]</em></code>, <code><em>HH:MM:SS[.fraction]</em></code>, <code><em>DD HH:MM</em></code>, <code><em>HH:MM</em></code>, <code><em>DD HH</em></code>, or <code><em>SS[.fraction]</em></code></dt>
<dd>
<p><code><em>DD</em></code> represents a one-digit or two-digit value of days in the range 0 to 34. The <code><em>DD</em></code> value is separated from the hour value, <code><em>HH</em></code>, by a space, while the other components are separated by a colon. Note that <code><em>MM:SS</em></code> is not a valid 
<span class="keep-together">combination,</span> since it cannot be disambiguated from <code><em>HH:MM</em></code>. If the <code>TIME</code> definition doesn’t specify <code><em>fraction</em></code> or sets it to 0, inserting fractional seconds will result in values being rounded to the nearest second.</p>

<p>For example, if you insert <code>2 13:25:58.999999</code> into a <code>TIME</code> column with a <code><em>fraction</em></code> of 0, the value <code>61:25:59</code> is stored, since the sum of 2 days (48 hours) and 13 hours is 61 hours. Starting with MySQL 5.7, the default SQL mode set prohibits insertion of incorrect values. However, it is possible to enable the older behavior. Then, if you try inserting a value that’s out of bounds, a warning is generated, and the value is limited to the maximum time available. Similarly, if you try inserting an invalid value, a warning is generated and the value is set to zero. <a data-type="indexterm" data-primary="SHOW" data-secondary="WARNINGS" id="idm46177478521592"/>You can use the <code>SHOW WARNINGS</code> command to report the details of the warning generated by the previous SQL statement. Our recommendation is to stick to the default strict SQL mode. Unlike  with the <code>DATE</code> type, there’s seemingly no benefit to allowing incorrect <code>TIME</code> entries, apart from easier error management on the application side and maintaining legacy behaviors.</p>

<p>Let’s try all these out in practice:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">test_time</code><code class="p">(</code><code class="n">id</code><code> </code><code class="kt">SMALLINT</code><code class="p">,</code><code> </code><code class="n">mytime</code><code> </code><code class="kt">TIME</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_time</code><code> </code><code class="k">VALUES</code><code class="p">(</code><code class="mi">1</code><code class="p">,</code><code> </code><code class="s2">"2 13:25:59"</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_time</code><code> </code><code class="k">VALUES</code><code class="p">(</code><code class="mi">2</code><code class="p">,</code><code> </code><code class="s2">"35 13:25:59"</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1292 (22007): Incorrect time value: '35 13:25:59'
for column 'mytime' at row 1</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">test_time</code><code> </code><code class="k">VALUES</code><code class="p">(</code><code class="mi">3</code><code class="p">,</code><code> </code><code class="s2">"900.32"</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">test_time</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------+----------+
| id   | mytime   |
+------+----------+
|    1 | 61:25:59 |
|    3 | 00:09:00 |
+------+----------+
2 rows in set (0.00 sec)</pre>
</dd>
<dt><code><em>H:M:S</em></code>, and single-, double-, and triple-digit combinations</dt>
<dd>
<p>You can use different combinations of digits when inserting or updating data; MySQL converts them into the internal time format and displays them consistently. For example, <code>1:1:3</code> is equivalent to <code>01:01:03</code>. Different 
<span class="keep-together">numbers</span> of digits can be mixed; for example, <code>1:12:3</code> is equivalent to <code>01:12:03</code>. Consider these examples:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">mytime</code><code> </code><code class="p">(</code><code class="n">testtime</code><code> </code><code class="kt">TIME</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.12 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">mytime</code><code> </code><code class="k">VALUES</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">(</code><code class="s1">'-1:1:1'</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'1:1:1'</code><code class="p">)</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">(</code><code class="s1">'1:23:45'</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'123:4:5'</code><code class="p">)</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">(</code><code class="s1">'123:45:6'</code><code class="p">)</code><code class="p">,</code><code> </code><code class="p">(</code><code class="s1">'-123:45:6'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">mytime</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------------+
| testtime   |
+------------+
|  -01:01:01 |
|   01:01:01 |
|   01:23:45 |
|  123:04:05 |
|  123:45:06 |
| -123:45:06 |
+------------+
5 rows in set (0.01 sec)</pre>

<p>Note that hours are shown with two digits for values within the range –99 to 99.</p>
</dd>
<dt><code><em>HHMMSS</em></code>, <code><em>MMSS</em></code>, and <code><em>SS</em></code></dt>
<dd>
<p>Punctuation can be omitted, but the digit sequences must be two, four, or six digits in length. Note that the rightmost pair of digits is always interpreted as a <code><em>SS</em></code> (seconds) value, the second rightmost pair (if present) as <code><em>MM</em></code> (minutes), and the third rightmost pair (if present) as <code><em>HH</em></code> (hours). The result is that a value such as <code>1222</code> is interpreted as 12 minutes and 22 seconds, not 12 hours and 22 minutes.</p>

<p>You can also input a time by providing both a date and time in the formats described for <code>DATETIME</code> and <code>TIMESTAMP</code>, but only the time component is stored in a <code>TIME</code> column. Regardless of the input type, the storage and display type is always <code><em>HH:MM:SS</em></code>. <a data-type="indexterm" data-primary="TIME data type" data-secondary="zero time" id="idm46177478207192"/><a data-type="indexterm" data-primary="date and time columns" data-secondary="TIME data type" data-tertiary="zero time" id="idm46177478206344"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="TIME data type" data-tertiary="zero time" id="idm46177478205256"/><a data-type="indexterm" data-primary="zero time" id="idm46177478204168"/>The <em>zero time</em> <code>00:00:00</code> can be used to represent an unknown or dummy value.<a data-type="indexterm" data-startref="ch04-tim" id="idm46177478202664"/><a data-type="indexterm" data-startref="ch04-tim2" id="idm46177478202056"/><a data-type="indexterm" data-startref="ch04-tim3" id="idm46177478201448"/></p>
</dd>
</dl>
</dd>
<dt><code>TIMESTAMP[(<em>fraction</em>)]</code></dt>
<dd>
<div class="openblock">
<p>Stores and displays a date and time pair in the format<a data-type="indexterm" data-primary="date and time columns" data-secondary="TIMESTAMP data type" id="idm46177478198472"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="TIMESTAMP data type" id="idm46177478197592"/><a data-type="indexterm" data-primary="TIMESTAMP data type" id="idm46177478196648"/> <code><em>YYYY-MM-DD HH:MM:SS[.fraction][time zone offset]</em></code> for the range 1970-01-01 00:00:01.000000 to <code>2038-01-19 03:14:07.999999</code>. <a data-type="indexterm" data-primary="DATETIME data type" data-secondary="time zones and" id="idm46177478194760"/><a data-type="indexterm" data-primary="TIMESTAMP data type" data-secondary="time zones and" id="idm46177478193912"/><a data-type="indexterm" data-primary="time zones" data-secondary="TIMESTAMP data type" id="idm46177478193064"/>This type is very similar to the <code>DATETIME</code> type, but there are a few differences. Both types accept a time zone modifier to the input value MySQL 8.0, and both types will store and present the data in the same way to any client in the same time zone. However, the values in <code>TIMESTAMP</code> columns are internally always stored in the UTC time zone, making it possible to get a local time zone automatically for clients in different time zones. That on its own is a very important distinction to remember. Arguably, <code>TIMESTAMP</code> is more convenient to use when dealing with different time zones.</p>

<p>Prior to MySQL 5.6, only the <code>TIMESTAMP</code> type supported automatic initialization and update. Moreover, only a single such column per a given table could do that. <a data-type="indexterm" data-primary="DATETIME data type" data-secondary="number of columns" id="idm46177478189656"/>However, starting with 5.6, both <code>TIMESTAMP</code> and <code>DATETIME</code> support the behaviors, and any number of columns can do so.</p>

<p>Values stored in a <code>TIMESTAMP</code> column always match the template <code><em>YYYY-MM-DD HH:MM:SS[.fraction][time zone offset]</em></code>, but the values can be provided in a wide range of formats:</p>
<dl>
<dt><code><em>YYYY-MM-DD HH:MM:SS</em></code> or <code><em>YY-MM-DD HH:MM:SS</em></code></dt>
<dd>
<p>The date and time components follow the same relaxed restrictions as the <code>DATE</code> and <code>TIME</code> components described previously. This includes allowance for any punctuation characters, including (unlike for <code>TIME</code>) flexibility in the punctuation used in the time component. For example, <code>0</code> is valid.</p>
</dd>
<dt><code><em>YYYYMMDDHHMMSS</em></code> or <code><em>YYMMDDHHMMSS</em></code></dt>
<dd>
<p>Punctuation can be omitted, but the string should be either 12 or 14 digits in length. We recommend using only the unambiguous 14-digit version, for the reasons discussed for the <code>DATE</code> type. You can specify values with other lengths without providing separators, but we don’t recommend doing so.</p>
</dd>
</dl>

<p>Let’s look at the automatic-update feature in more detail. You<a data-type="indexterm" data-primary="TIMESTAMP data type" data-secondary="automatic update options" id="idm46177478178024"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="TIMESTAMP data type" data-tertiary="automatic update options" id="idm46177478176952"/><a data-type="indexterm" data-primary="date and time columns" data-secondary="TIMESTAMP data type" data-tertiary="automatic update options" id="idm46177478175720"/><a data-type="indexterm" data-primary="CURRENT_TIMESTAMP" data-secondary="automatic updates of TIMESTAMP" id="idm46177478174488"/> control this by adding the following attributes to the column definition when creating a table, or later, as we’ll explain in <a data-type="xref" href="#MOD-SEC-ALTER">“Altering Structures”</a>:</p>
<ol>
<li>
<p>If you want the timestamp to be set only when a new row is<a data-type="indexterm" data-primary="defaults" data-secondary="DEFAULT value" data-tertiary="CURRENT_TIMESTAMP" id="idm46177478171400"/> inserted into the table, add <code>DEFAULT CURRENT_TIMESTAMP</code> to the end of the column declaration.</p>
</li>
<li>
<p>If you don’t want a default timestamp but would like the<a data-type="indexterm" data-primary="ON UPDATE" data-secondary="CURRENT_TIMESTAMP" id="idm46177478168632"/> current time to be used whenever the data in a row is updated, add <code>ON UPDATE CURRENT_TIMESTAMP</code> to the end of the column declaration.</p>
</li>
<li>
<p>If you want both of the above—that is, you want the timestamp set to the current time in each new row and whenever an existing row is modified—add <code>DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP</code> to the end of the column declaration.</p>
</li>

</ol>

<p>If you do not specify <code>DEFAULT NULL</code> or <code>NULL</code> for a <code>TIMESTAMP</code> column, it will have <code>0</code> as the default value.<a data-type="indexterm" data-primary="defaults" data-secondary="DEFAULT value" data-tertiary="NULL" id="idm46177478162936"/></p>
</div>

</dd>
<dt><code>YEAR[(4)]</code></dt>
<dd>
<p>Stores a four-digit year in the range 1901 to 2155, as well as<a data-type="indexterm" data-primary="date and time columns" data-secondary="YEAR data type" id="idm46177478159992"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="YEAR data type" id="idm46177478158936"/><a data-type="indexterm" data-primary="YEAR data type" id="idm46177478157992"/><a data-type="indexterm" data-primary="YEAR data type" data-secondary="zero year" id="idm46177478157320"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="YEAR data type" data-tertiary="zero year" id="idm46177478156376"/><a data-type="indexterm" data-primary="date and time columns" data-secondary="YEAR data type" data-tertiary="zero year" id="idm46177478155160"/><a data-type="indexterm" data-primary="zero year" id="idm46177478153944"/> the <em>zero year</em>, 0000. Illegal values are converted to the zero year. You can input year values as either strings (such as <code>'2005'</code>) or integers (such as <code>2005</code>). The <code>YEAR</code> type requires 1 byte of storage space.</p>

<p>In earlier versions of MySQL, it was possible to specify the<a data-type="indexterm" data-primary="date and time columns" data-secondary="YEAR data type" data-tertiary="two or four digits" id="idm46177478150808"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="YEAR data type" data-tertiary="two or four digits" id="idm46177478149480"/><a data-type="indexterm" data-primary="YEAR data type" data-secondary="two or four digits" id="idm46177478148232"/> <code><em>digits</em></code> parameter, passing either <code>2</code> or <code>4</code>. The two-digit version stored values from 70 to 69, representing 1970 to 2069. MySQL 8.0 doesn’t support the two-digit <code>YEAR</code> type, and specifying the <code><em>digits</em></code> parameter for display purposes is deprecated.</p>
</dd>
<dt><code>DATETIME[(<em>fraction</em>)]</code></dt>
<dd>
<p>Stores and displays a date and time pair in the format<a data-type="indexterm" data-primary="date and time columns" data-secondary="DATETIME data type" id="idm46177478142760"/><a data-type="indexterm" data-primary="time and date columns" data-secondary="DATETIME data type" id="idm46177478141128"/><a data-type="indexterm" data-primary="DATETIME data type" id="idm46177478140184"/> <code><em>YYYY-MM-DD HH:MM:SS[.fraction][time zone offset]</em></code> for the range <code>1000-01-01</code> <code>00:00:00</code> to <code>9999-12-31 23:59:59</code>. As for <code>TIMESTAMP</code>, the value stored always matches the template <code><em>YYYY-MM-DD HH:MM:SS</em></code>, but the value can be input in the same formats listed in the <code>TIMESTAMP</code> description. If you assign only a date to a <code>DATETIME</code> column, the zero time <code>00:00:00</code> is assumed. If you assign only a time to a <code>DATETIME</code> column, the zero date <code>0000-00-00</code> is assumed. This type has the same automatic update features as <code>TIMESTAMP</code>. Unless the <code>NOT NULL</code> attribute is specified for a <code>DATETIME</code> column, a <code>NULL</code> value is the default; otherwise, the default is <code>0</code>. Unlike for <code>TIMESTAMP</code>, <code>DATETIME</code> values aren’t converted to the UTC time zone for 
<span class="keep-together">storage.</span><a data-type="indexterm" data-startref="ch04-dt" id="idm46177478130248"/><a data-type="indexterm" data-startref="ch04-dt2" id="idm46177478129544"/><a data-type="indexterm" data-startref="ch04-dt3" id="idm46177478128872"/></p>
</dd>
</dl>
</div></section>













<section data-type="sect3" data-pdf-bookmark="Other types"><div class="sect3" id="SEC-OTHER-COLUMN-TYPES">
<h3>Other types</h3>

<p>Currently, as of MySQL 8.0, the spatial and <code>JSON</code> data types<a data-type="indexterm" data-primary="columns" data-secondary="types of" data-tertiary="JSON data type" id="idm46177478126440"/><a data-type="indexterm" data-primary="JSON data type" id="idm46177478125160"/> fall under this broad category. Using these is a quite advanced topic, and we won’t cover them in depth.</p>

<p>Spatial data types are concerned with storing geometrical<a data-type="indexterm" data-primary="columns" data-secondary="types of" data-tertiary="spatial data types" id="idm46177478123848"/><a data-type="indexterm" data-primary="spatial data types" id="idm46177478122520"/> objects, and MySQL has types corresponding to OpenGIS classes. Working with these types is a topic worth a book on its own.</p>

<p>The <code>JSON</code> data type allows native storage of valid JSON documents. Before MySQL 5.7, JSON was usually stored in a <code>TEXT</code> or a similar column. However, that has a lot of disadvantages: for example, documents aren’t validated, and no storage optimization is performed (all JSON is just stored in its text form). With the native <code>JSON</code> type, it’s stored in binary format. If we were to summarize in one sentence: use the <code>JSON</code> data type for JSON, dear reader.</p>
</div></section>



</div></section>













<section data-type="sect2" data-pdf-bookmark="Keys and Indexes"><div class="sect2" id="SEC-KEYS_AND_INDEXES">
<h2>Keys and Indexes</h2>

<p>You’ll find that almost all tables you use will have a <code>PRIMARY KEY</code> clause<a data-type="indexterm" data-primary="keys" id="ch04key"/><a data-type="indexterm" data-primary="indexes" id="ch04key2"/><a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="creating tables" data-tertiary="KEY clauses" id="idm46177478113320"/><a data-type="indexterm" data-primary="primary key" data-secondary="CREATE TABLE clause" id="idm46177478112104"/><a data-type="indexterm" data-primary="keys" data-secondary="CREATE TABLE clauses" id="idm46177478111160"/><a data-type="indexterm" data-primary="CREATE TABLE" data-secondary="KEY clauses" id="idm46177478110216"/><a data-type="indexterm" data-primary="tables" data-secondary="creating tables" data-tertiary="KEY clauses" id="idm46177478109272"/><a data-type="indexterm" data-primary="primary key" data-secondary="PRIMARY KEY clause" id="idm46177478108056"/><a data-type="indexterm" data-primary="database structures" data-secondary="keys" data-see="keys; primary key" id="idm46177478107112"/><a data-type="indexterm" data-primary="database structures" data-secondary="indexes" data-see="indexes" id="idm46177478105896"/> declared in their <code>CREATE TABLE</code> statement, and sometimes multiple <code>KEY</code> clauses. The reasons why you need a primary key and secondary keys were discussed in <a data-type="xref" href="ch02.xhtml#CH2_DESIGN">Chapter 2</a>. This section discusses how primary keys are declared, what happens behind the scenes when you do so, and why you might want to also create other keys and indexes on your data.</p>

<p>A <em>primary key</em> uniquely identifies each row in a table. <a data-type="indexterm" data-primary="primary key" id="idm46177478101576"/><a data-type="indexterm" data-primary="InnoDB" data-secondary="clustered index" data-tertiary="primary key as" id="idm46177478100872"/><a data-type="indexterm" data-primary="primary key" data-secondary="InnoDB clustered index" id="idm46177478099656"/><a data-type="indexterm" data-primary="indexes" data-secondary="InnoDB clustered index" data-tertiary="primary key as" id="idm46177478098712"/><a data-type="indexterm" data-primary="clustered index of InnoDB tables" data-secondary="primary key as" id="idm46177478097496"/><a data-type="indexterm" data-primary="InnoDB" data-secondary="clustered index" id="idm46177478096584"/><a data-type="indexterm" data-primary="clustered index of InnoDB tables" id="idm46177478095640"/>Even more importantly, for the default InnoDB storage engine, a primary key is also used as a <em>clustered index</em>. That means that all of the actual table data is stored in an index structure. <a data-type="indexterm" data-primary="MyISAM" data-secondary="InnoDB clustered index versus" id="idm46177478094376"/>That is different from MyISAM, which stores data and indexes separately. <a data-type="indexterm" data-primary="tables" data-secondary="clustered tables" id="idm46177478093304"/><a data-type="indexterm" data-primary="clustered index of InnoDB tables" data-secondary="clustered tables" id="idm46177478092360"/><a data-type="indexterm" data-primary="InnoDB" data-secondary="clustered index" data-tertiary="clustered tables" id="idm46177478091400"/><a data-type="indexterm" data-primary="indexes" data-secondary="InnoDB clustered index" data-tertiary="clustered tables" id="idm46177478090184"/><a data-type="indexterm" data-primary="rows" data-secondary="clustered tables" id="idm46177478088968"/>When a table is using a clustered index, it’s called a clustered table. As we said, in a clustered table each row is stored within an index, compared to being stored in what’s usually <a data-type="indexterm" data-primary="heap holding rows" id="idm46177478087688"/>called a <em>heap</em>. Clustering a table results in its rows being sorted according to the clustered index ordering and actually physically stored within the leaf pages of that index. There can’t be more than one clustered index per table. For such tables, secondary indexes refer to records in the clustered index instead of the actual table rows. That generally results in improved query performance, though it can be detrimental to writes. InnoDB does not allow you to choose between clustered and nonclustered tables; this is a design decision that you cannot change.</p>

<p>Primary keys are generally a recommended part of any<a data-type="indexterm" data-primary="primary key" data-secondary="database design" id="idm46177478085480"/><a data-type="indexterm" data-primary="InnoDB" data-secondary="primary key required" id="idm46177478084504"/><a data-type="indexterm" data-primary="primary key" data-secondary="InnoDB clustered index" data-tertiary="primary key required" id="idm46177478083560"/><a data-type="indexterm" data-primary="database design" data-secondary="primary key" id="idm46177478082344"/><a data-type="indexterm" data-primary="columns" data-secondary="primary key columns" id="idm46177478081400"/> database design, but for InnoDB they are necessary. In fact, if you do not specify a <code>PRIMARY KEY</code> clause when creating an InnoDB table, MySQL will use the first <code>UNIQUE NOT NULL</code> column as a base for the clustered index. If no such column is available, a hidden clustered index is created, based on ID values assigned by InnoDB to each row.</p>

<p>Given that InnoDB is MySQL’s default storage engine and a de facto standard nowadays, we will concentrate on its behavior in this chapter. Alternative storage engines like MyISAM, MEMORY, or MyRocks will be discussed in <a data-type="xref" href="ch07.xhtml#ADV2-SEC-STORAGEENGINES">“Alternative Storage Engines”</a>.</p>

<p>As mentioned previously, when a primary key is defined, it becomes a clustered index, and all data in the table is stored in the leaf blocks of that index. <a data-type="indexterm" data-primary="indexes" data-secondary="B-trees" id="idm46177478077352"/><a data-type="indexterm" data-primary="InnoDB" data-secondary="B-tree indexes" id="idm46177478076376"/>InnoDB uses B-tree indexes (more specifically, the B+tree variant), with the exception of indexes on spatial data types, which use the R-tree structure. Other storage engines might implement different index types, but when a table’s storage engine is not specified, you can assume that all indexes are B-trees.</p>

<p>Having a clustered index, or in other words having index-organized tables, speeds up queries and sorts involving the primary key columns. <a data-type="indexterm" data-primary="performance" data-secondary="modifying columns in primary key" id="idm46177478074424"/><a data-type="indexterm" data-primary="primary key" data-secondary="InnoDB clustered index" data-tertiary="modifying columns of primary key" id="idm46177478073480"/><a data-type="indexterm" data-primary="primary key" data-secondary="database design" data-tertiary="columns not modified" id="idm46177478072296"/><a data-type="indexterm" data-primary="database design" data-secondary="primary key" data-tertiary="columns not modified" id="idm46177478071080"/>However, a downside is that modifying columns in a primary key is expensive. Thus, a good design will require a primary key based on columns that are frequently used for filtering in queries but are rarely modified. Remember that having no primary key at all will result in InnoDB using an implicit cluster index; thus, if you’re not sure what columns to pick for a primary key, consider using a synthetic <code>id</code>-like column. For example, the <code>SERIAL</code> data type might fit well in that case.</p>

<p>Stepping away from InnoDB’s internal details, when you<a data-type="indexterm" data-primary="database creation" data-see="CREATE DATABASE" id="idm46177478068040"/><a data-type="indexterm" data-primary="CREATE DATABASE" data-secondary="creating tables" data-tertiary="primary key" id="idm46177478066632"/><a data-type="indexterm" data-primary="primary key" id="idm46177478065416"/><a data-type="indexterm" data-primary="tables" data-secondary="creating tables" data-tertiary="primary key" id="idm46177478064744"/><a data-type="indexterm" data-primary="CREATE TABLE" data-secondary="primary key" id="idm46177478063528"/><a data-type="indexterm" data-primary="rows" data-secondary="primary key index" id="idm46177478062584"/><a data-type="indexterm" data-primary="indexes" data-secondary="primary key index" id="idm46177478061640"/><a data-type="indexterm" data-primary="primary key" data-secondary="PRIMARY KEY clause" id="idm46177478060696"/><a data-type="indexterm" data-primary="primary key" data-secondary="primary key index" id="idm46177478059752"/><a data-type="indexterm" data-primary="columns" data-secondary="primary key columns" id="idm46177478058904"/> declare a primary key for a table in MySQL, it creates a structure that stores information about where the data from each row in the table is stored. This information is called an <em>index</em>, and its purpose is to speed up searches that use the primary key. <a data-type="indexterm" data-primary="primary key" data-secondary="sakila example database" id="idm46177478057256"/>For example, when you declare <code>PRIMARY KEY (actor_id)</code> in the <code>actor</code> table in the <code>sakila</code> database, MySQL creates a structure that allows it to find rows that match a specific <code>actor_id</code> (or a range of identifiers) extremely quickly.</p>

<p>This is useful to match actors to films or films to categories, for example. <a data-type="indexterm" data-primary="indexes" data-secondary="SHOW INDEX" id="idm46177478054040"/><a data-type="indexterm" data-primary="SHOW" data-secondary="INDEX" id="idm46177478052968"/>You can display the indexes available on a table using the <code>SHOW INDEX</code> (or <code>SHOW INDEXES</code>) 
<span class="keep-together">command:</span></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="k">INDEX</code><code> </code><code class="k">FROM</code><code> </code><code class="n">category</code><code class="err">\</code><code class="n">G</code></strong></pre>

<pre data-type="programlisting">*************************** 1. row ***************************
        Table: category
   Non_unique: 0
     Key_name: PRIMARY
 Seq_in_index: 1
  Column_name: category_id
    Collation: A
  Cardinality: 16
     Sub_part: NULL
       Packed: NULL
         Null:
   Index_type: BTREE
      Comment:
Index_comment:
      Visible: YES
   Expression: NULL
1 row in set (0.00 sec)</pre>

<p>The <em>cardinality</em> is the number of unique values in the index;<a data-type="indexterm" data-primary="cardinality" data-secondary="SHOW INDEX" id="idm46177478036872"/><a data-type="indexterm" data-primary="rows" data-secondary="primary key index" data-tertiary="cardinality in SHOW INDEX" id="idm46177478036008"/><a data-type="indexterm" data-primary="indexes" data-secondary="primary key index" data-tertiary="cardinality in SHOW INDEX" id="idm46177478034824"/><a data-type="indexterm" data-primary="primary key" data-secondary="primary key index" data-tertiary="cardinality in SHOW INDEX" id="idm46177478033640"/> for an index on a primary key, this is the same as the number of rows in the table.</p>

<p>Note that all columns that are part of a primary key must be<a data-type="indexterm" data-primary="columns" data-secondary="NOT NULL declaration" data-tertiary="primary key columns" id="idm46177478031944"/><a data-type="indexterm" data-primary="columns" data-secondary="primary key columns" data-tertiary="NOT NULL" id="idm46177478011384"/> declared as <code>NOT NULL</code>, since they must have a value for the row to be valid. Without the index, the only way to find rows in the table is to read each one from disk and check whether it matches the <code>category_id</code> you’re searching for. For tables with many rows, this exhaustive, sequential searching is extremely slow. However, you can’t just index everything; we’ll come back to this point at the end of this section.</p>

<p>You can create other indexes on the data in a table. <a data-type="indexterm" data-primary="indexes" data-secondary="about" id="idm46177478008376"/>You do this so that other searches (whether on other columns or combinations of columns) are fast, and to avoid sequential scans. For example, take the <code>actor</code> table again. <a data-type="indexterm" data-primary="keys" data-secondary="secondary key" id="idm46177478006840"/><a data-type="indexterm" data-primary="secondary key" data-secondary="sakila example database" id="idm46177478005896"/>Apart from having a 
<span class="keep-together">primary</span> key on <code>actor_id</code>, it also has a secondary key on <code>last_name</code> to improve searching by an actor’s last name:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">actor</code><code class="err">\</code><code class="n">G</code></strong></pre>

<pre data-type="programlisting">*************************** 1. row ***************************
       Table: actor
Create Table: CREATE TABLE `actor` (
  `actor_id` smallint unsigned NOT NULL AUTO_INCREMENT,
  ...
  `last_name` varchar(45) NOT NULL,
  ...
  PRIMARY KEY (`actor_id`),
  KEY `idx_actor_last_name` (`last_name`)
) ...
1 row in set (0.00 sec)</pre>

<p>You can see the keyword <code>KEY</code> is used to tell MySQL that an extra index is needed. <a data-type="indexterm" data-primary="tables" data-secondary="creating tables" data-tertiary="indexes can be added after" id="idm46177477990408"/><a data-type="indexterm" data-primary="indexes" data-secondary="secondary keys" id="idm46177477989192"/><a data-type="indexterm" data-primary="CREATE TABLE" data-secondary="indexes can be added after" id="idm46177477988248"/>Alternatively, you can use the word <code>INDEX</code> in place of <code>KEY</code>. Following that keyword is an index name, and then the column to index is included in parentheses. You can also add indexes after tables are created—in fact, you can pretty much change anything about a table after its creation. This is discussed in <a data-type="xref" href="#MOD-SEC-ALTER">“Altering Structures”</a>.</p>

<p>You can build an index on more than one column. <a data-type="indexterm" data-primary="indexes" data-secondary="more than one column" id="idm46177477984984"/>For example, consider the following table, which is a modified table from <code>sakila</code>:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">customer_mod</code><code> </code><code class="p">(</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">customer_id</code><code> </code><code class="kt">smallint</code><code> </code><code class="k">unsigned</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code> </code><code class="kp">AUTO_INCREMENT</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">first_name</code><code> </code><code class="kt">varchar</code><code class="p">(</code><code class="mi">45</code><code class="p">)</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">last_name</code><code> </code><code class="kt">varchar</code><code class="p">(</code><code class="mi">45</code><code class="p">)</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">email</code><code> </code><code class="kt">varchar</code><code class="p">(</code><code class="mi">50</code><code class="p">)</code><code> </code><code class="k">DEFAULT</code><code> </code><code class="no">NULL</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">PRIMARY</code><code> </code><code class="k">KEY</code><code> </code><code class="p">(</code><code class="n">customer_id</code><code class="p">)</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">KEY</code><code> </code><code class="nf">idx_names_email</code><code> </code><code class="p">(</code><code class="n">first_name</code><code class="p">,</code><code> </code><code class="n">last_name</code><code class="p">,</code><code> </code><code class="n">email</code><code class="p">)</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.06 sec)</pre>

<p>You can see that we’ve added a primary key index on the <code>customer_id</code> identifier column, and we’ve also added another index—called <code>idx_names_email</code>—that includes the <code>first_name</code>, <code>last_name</code>, and <code>email</code> columns in this order. Let’s now consider how you can use that extra index.</p>

<p>You can use the <code>idx_names_email</code> index for<a data-type="indexterm" data-primary="queries" data-secondary="indexes" data-tertiary="multiple columns" id="idm46177477882568"/> fast searching by combinations of the three name columns. For example, it’s useful in the following query:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">customer_mod</code><code> </code><code class="k">WHERE</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">first_name</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Rose'</code><code> </code><code class="k">AND</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">last_name</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Williams'</code><code> </code><code class="k">AND</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">email</code><code> </code><code class="o">=</code><code> </code><code class="s1">'rose.w@nonexistent.edu'</code><code class="p">;</code></strong></pre>

<p>We know it helps the search, because all the columns listed in the index are used in the query. <a data-type="indexterm" data-primary="EXPLAIN" data-secondary="EXPLAIN SELECT" id="idm46177477804040"/><a data-type="indexterm" data-primary="SELECT" data-secondary="EXPLAIN SELECT" id="idm46177477813112"/><a data-type="indexterm" data-primary="keys" data-secondary="EXPLAIN SELECT" id="idm46177477812376"/><a data-type="indexterm" data-primary="indexes" data-secondary="EXPLAIN SELECT" id="idm46177477811528"/><a data-type="indexterm" data-primary="queries" data-secondary="EXPLAIN" data-tertiary="EXPLAIN SELECT" id="idm46177477810680"/><a data-type="indexterm" data-primary="queries" data-secondary="SELECT" data-see="SELECT" id="idm46177477809592"/>You can use the <code>EXPLAIN</code> statement to check whether what you think should happen is in fact happening:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">EXPLAIN</code><code> </code><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">customer_mod</code><code> </code><code class="k">WHERE</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">first_name</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Rose'</code><code> </code><code class="k">AND</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">last_name</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Williams'</code><code> </code><code class="k">AND</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">email</code><code> </code><code class="o">=</code><code> </code><code class="s1">'rose.w@nonexistent.edu'</code><code class="err">\</code><code class="n">G</code></strong></pre>

<pre data-type="programlisting">*************************** 1. row ***************************
           id: 1
  select_type: SIMPLE
        table: customer_mod
   partitions: NULL
         type: ref
possible_keys: idx_names_email
          key: idx_names_email
      key_len: 567
          ref: const,const,const
         rows: 1
     filtered: 100.00
        Extra: Using index
1 row in set, 1 warning (0.00 sec)</pre>

<p>You can see that MySQL reports that the <code>possible_keys</code> are <code>idx_names_email</code> (meaning that the index could be used for this query) and that the <code>key</code> that it’s decided to use is <code>idx_names_email</code>. So, what you expect and what is happening are the same, and that’s good news! You’ll find out more about the <code>EXPLAIN</code> statement in <a data-type="xref" href="ch07.xhtml#CH7_DOING_MORE">Chapter 7</a>.</p>

<p>The index we’ve created is also useful for queries on only the <code>first_name</code> column. For example, it can be used by the following query:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">customer_mod</code><code> </code><code class="k">WHERE</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">first_name</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Rose'</code><code class="p">;</code></strong></pre>

<p>You can use <code>EXPLAIN</code> again to check whether the index is being used. The reason it can be used is because the <code>first_name</code> column is the first one listed in the index. In practice, this means that the index <em>clusters</em>, or stores together, information about rows for all people with the same first name, and so the index can be used to find anyone with a matching first name.</p>

<p>The index can also be used for searches involving<a data-type="indexterm" data-primary="searches" data-see="queries" id="idm46177477698952"/> combinations of first name and last name, for exactly the same reasons we’ve just discussed. The index clusters together people with the same first name, and it clusters people with identical first names by last name. So, it can be used for this query:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">customer_mod</code><code> </code><code class="k">WHERE</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">first_name</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Rose'</code><code> </code><code class="k">AND</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">last_name</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Williams'</code><code class="p">;</code></strong></pre>

<p>However, the index can’t be used for this query because the leftmost column in the index, <code>first_name</code>, does not appear in the query:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">customer_mod</code><code> </code><code class="k">WHERE</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">last_name</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Williams'</code><code> </code><code class="k">AND</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">email</code><code> </code><code class="o">=</code><code> </code><code class="s1">'rose.w@nonexistent.edu'</code><code class="p">;</code></strong></pre>

<p>The index should help narrow down the set of rows to a smaller set of possible answers. For MySQL to be able to use an index, the query needs to meet both the following conditions:<a data-type="indexterm" data-primary="queries" data-secondary="indexes" data-seealso="indexes" id="ch04-qux"/><a data-type="indexterm" data-primary="indexes" data-secondary="queries and" id="ch04-qux2"/></p>
<ol>
<li>
<p>The leftmost column listed in the <code>KEY</code> (or <code>PRIMARY KEY</code>) clause must be in the query.</p>
</li>
<li>
<p>The query must contain no <code>OR</code> clauses for columns that aren’t indexed.</p>
</li>

</ol>

<p>Again, you can always use the <code>EXPLAIN</code> statement to check whether an index can be used for a particular query.</p>

<p>Before we finish this section, here are a few ideas on how to choose and design indexes.<a data-type="indexterm" data-primary="indexes" data-secondary="about" id="idm46177477587640"/><a data-type="indexterm" data-primary="database design" data-secondary="indexes" id="idm46177477586664"/><a data-type="indexterm" data-primary="indexes" data-secondary="database design" id="idm46177477570136"/><a data-type="indexterm" data-primary="columns" data-secondary="CREATE TABLE" data-tertiary="indexes" id="idm46177477569288"/> When you’re considering adding an index, think about the following:</p>

<ul>
<li>
<p>Indexes cost space on disk, and they need to be updated whenever data changes. If your data changes frequently, or lots of data changes when you do make a change, indexes will slow the process down. However, in practice, since <code>SELECT</code> statements (data reads) are usually much more common than other statements (data modifications), indexes are usually beneficial.</p>
</li>
<li>
<p>Only add an index that’ll be used frequently. Don’t bother indexing columns before you see what queries your users and your applications need. You can always add indexes afterward.</p>
</li>
<li>
<p>If all columns in an index are used in all queries, list the column with the highest number of duplicates at the left of the <code>KEY</code> clause. This minimizes index size.</p>
</li>
<li>
<p>The smaller the index, the faster it’ll be. <a data-type="indexterm" data-primary="performance" data-secondary="index size" id="idm46177477563144"/>If you index large columns, you’ll get a larger index. This is a good reason to ensure your columns are as small as possible when you design your tables.</p>
</li>
<li>
<p>For long columns, you can use only a prefix of the values from a column to create the index. You can do this by adding a value in parentheses after the column definition, such as <code>KEY idx_names_email (first_name(3), last_name(2), email(10))</code>. This means that only the first 3 characters of <code>first_name</code> are indexed, then the first 2 characters of <code>last_name</code>, and then 10 characters from <code>email</code>. This is a significant savings over indexing 140 characters from the three columns! When you do this, your index will be less able to uniquely identify rows, but it’ll be much smaller and still reasonably good at finding matching rows. Using a prefix is mandatory for long types like <code>TEXT</code>.</p>
</li>
</ul>

<p class="pagebreak-before">To wrap up this section, we need to discuss some peculiarities regarding <a data-type="indexterm" data-primary="InnoDB" data-secondary="secondary key bloat" id="idm46177477557720"/><a data-type="indexterm" data-primary="secondary key" data-secondary="InnoDB bloat" id="idm46177477556872"/>secondary keys in InnoDB. Remember that all the table data is stored in the leaves of the clustered index. That means, using the <code>actor</code> example, that if we need to get the <code>first_name</code> data when filtering by <code>last_name</code>, even though we can use <code>idx_actor_last_name</code> for quick filtering, we will need to access the data by the primary key. As a consequence, each secondary key in InnoDB has all of the primary key columns appended to its definition implicitly. Having unnecessarily long primary keys in InnoDB thus results in significantly bloated secondary keys.</p>

<p>This can also be seen in the <code>EXPLAIN</code> output (note the <code>Extra: Using index</code> in the first output of the first command):<a data-type="indexterm" data-primary="EXPLAIN" data-secondary="EXPLAIN SELECT" data-tertiary="InnoDB secondary key" id="idm46177477552872"/><a data-type="indexterm" data-primary="SELECT" data-secondary="EXPLAIN SELECT" data-tertiary="InnoDB secondary key" id="idm46177477551784"/><a data-type="indexterm" data-primary="indexes" data-secondary="EXPLAIN SELECT" data-tertiary="InnoDB secondary key" id="idm46177477550696"/><a data-type="indexterm" data-primary="keys" data-secondary="EXPLAIN SELECT" data-tertiary="InnoDB secondary key" id="idm46177477549608"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">EXPLAIN</code><code> </code><code class="k">SELECT</code><code> </code><code class="n">actor_id</code><code class="p">,</code><code> </code><code class="n">last_name</code><code> </code><code class="k">FROM</code><code> </code><code class="n">actor</code><code> </code><code class="k">WHERE</code><code> </code><code class="n">last_name</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Smith'</code><code class="err">\</code><code class="n">G</code></strong></pre>

<pre data-type="programlisting">*************************** 1. row ***************************
           id: 1
  select_type: SIMPLE
        table: actor
   partitions: NULL
         type: ref
possible_keys: idx_actor_last_name
          key: idx_actor_last_name
      key_len: 182
          ref: const
         rows: 1
     filtered: 100.00
        Extra: Using index
1 row in set, 1 warning (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">EXPLAIN</code><code> </code><code class="k">SELECT</code><code> </code><code class="n">first_name</code><code> </code><code class="k">FROM</code><code> </code><code class="n">actor</code><code> </code><code class="k">WHERE</code><code> </code><code class="n">last_name</code><code> </code><code class="o">=</code><code> </code><code class="s1">'Smith'</code><code class="err">\</code><code class="n">G</code></strong></pre>

<pre data-type="programlisting">*************************** 1. row ***************************
           id: 1
  select_type: SIMPLE
        table: actor
   partitions: NULL
         type: ref
possible_keys: idx_actor_last_name
          key: idx_actor_last_name
      key_len: 182
          ref: const
         rows: 1
     filtered: 100.00
        Extra: NULL
1 row in set, 1 warning (0.00 sec)</pre>

<p>Effectively, <code>idx_actor_last_name</code> is a <em>covering index</em> for the<a data-type="indexterm" data-primary="indexes" data-secondary="covering index" id="idm46177477478936"/><a data-type="indexterm" data-primary="covering index" id="idm46177477477928"/> first query, meaning that InnoDB can extract all the required data from that index alone. However, for the second query, InnoDB will have to do an additional lookup of a clustered index to get the value for the <code>first_name</code> column.<a data-type="indexterm" data-startref="ch04key" id="idm46177477476520"/><a data-type="indexterm" data-startref="ch04key2" id="idm46177477475784"/><a data-type="indexterm" data-startref="ch04-qux" id="idm46177477475112"/><a data-type="indexterm" data-startref="ch04-qux2" id="idm46177477474440"/></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="The AUTO_INCREMENT Feature"><div class="sect2" id="SEC-AUTOINCREMENT">
<h2>The AUTO_INCREMENT Feature</h2>

<p>MySQL’s proprietary <code>AUTO_INCREMENT</code> feature allows you<a data-type="indexterm" data-primary="AUTO_INCREMENT" id="ch04-aui"/><a data-type="indexterm" data-primary="rows" data-secondary="AUTO_INCREMENT unique identifiers" id="ch04-aui2"/> to create a unique identifier for a row without running a <code>SELECT</code> query. Here’s how it works. Let’s take the simplified <code>actor</code> table again:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">actor</code><code> </code><code class="p">(</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">actor_id</code><code> </code><code class="kt">smallint</code><code> </code><code class="k">unsigned</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code> </code><code class="kp">AUTO_INCREMENT</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">first_name</code><code> </code><code class="kt">varchar</code><code class="p">(</code><code class="mi">45</code><code class="p">)</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="n">last_name</code><code> </code><code class="kt">varchar</code><code class="p">(</code><code class="mi">45</code><code class="p">)</code><code> </code><code class="k">NOT</code><code> </code><code class="no">NULL</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">PRIMARY</code><code> </code><code class="k">KEY</code><code> </code><code class="p">(</code><code class="n">actor_id</code><code class="p">)</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.03 sec)</pre>

<p>It’s possible to insert rows into that table without specifying the <code>actor_id</code>:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">actor</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="no">NULL</code><code class="p">,</code><code> </code><code class="s1">'Alexander'</code><code class="p">,</code><code> </code><code class="s1">'Kaidanovsky'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.01 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">actor</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="no">NULL</code><code class="p">,</code><code> </code><code class="s1">'Anatoly'</code><code class="p">,</code><code> </code><code class="s1">'Solonitsyn'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.01 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">actor</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="no">NULL</code><code class="p">,</code><code> </code><code class="s1">'Nikolai'</code><code class="p">,</code><code> </code><code class="s1">'Grinko'</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.00 sec)</pre>

<p>When you view the data in this table, you can see that each row has a value assigned for the <code>actor_id</code> column:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">actor</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+----------+------------+-------------+
| actor_id | first_name | last_name   |
+----------+------------+-------------+
|        1 | Alexander  | Kaidanovsky |
|        2 | Anatoly    | Solonitsyn  |
|        3 | Nikolai    | Grinko      |
+----------+------------+-------------+
3 rows in set (0.00 sec)</pre>

<p>Each time a new row is inserted, a unique value for the <code>actor_id</code> column is created for that new row.</p>

<p>Consider how this feature works. You can see that the <code>actor_id</code> column is declared as an integer with the clauses <code>NOT NULL AUTO_INCREMENT</code>. <code>AUTO_INCREMENT</code> tells MySQL that when a value isn’t provided for this column, the value allocated should be one more than the maximum currently stored in the table. The <code>AUTO_INCREMENT</code> sequence begins at 1 for an empty table.</p>

<p>The <code>NOT NULL</code> clause is required for <code>AUTO_INCREMENT</code> columns;<a data-type="indexterm" data-primary="AUTO_INCREMENT" data-secondary="NOT NULL required" id="idm46177477239688"/><a data-type="indexterm" data-primary="NULL" data-secondary="NOT NULL columns" data-tertiary="AUTO_INCREMENT requiring" id="idm46177477238680"/> when you insert <code>NULL</code> (or 0, though this isn’t recommended), the MySQL server automatically finds the next available identifier and assigns it to the new row. You can manually insert negative values if the column was not defined as <code>UNSIGNED</code>; however, for the next automatic increment, MySQL will simply use the largest (positive) value in the column, or start from 1 if there are no positive values.</p>

<p>The <code>AUTO_INCREMENT</code> feature has the following requirements:</p>

<ul>
<li>
<p>The column it is used on must be indexed.</p>
</li>
<li>
<p>The column it is used on cannot have a <code>DEFAULT</code> value.</p>
</li>
<li>
<p>There can be only one <code>AUTO_INCREMENT</code> column per table.</p>
</li>
</ul>

<p>MySQL supports different storage engines; we’ll talk more about these in <a data-type="xref" href="ch07.xhtml#ADV2-SEC-STORAGEENGINES">“Alternative Storage Engines”</a>. <a data-type="indexterm" data-primary="MyISAM" data-secondary="AUTO_INCREMENT on multiple columns" id="idm46177477211832"/>When using the nondefault MyISAM table type, you can use the <code>AUTO_INCREMENT</code> feature on keys that comprise multiple columns. In effect, you can have multiple independent counters within a single <code>AUTO_INCREMENT</code> column. However, this is not possible with InnoDB.</p>

<p>While the <code>AUTO_INCREMENT</code> feature is useful, it isn’t<a data-type="indexterm" data-primary="portability" data-secondary="AUTO_INCREMENT not portable" id="idm46177477208968"/> portable to other database environments, and it hides the logical steps for creating new identifiers. It can also lead to ambiguity; for example, dropping or truncating a table will reset the counter, but deleting selected rows (with a <code>WHERE</code> clause) doesn’t reset the counter. Moreover, if a row is inserted inside a transaction but then that transaction is rolled back, an identifier will be used up anyway. As an example, let’s create the table <code>count</code> that contains an auto-incrementing field <code>counter</code>:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">count</code><code> </code><code class="p">(</code><code class="n">counter</code><code> </code><code class="kt">INT</code><code> </code><code class="kp">AUTO_INCREMENT</code><code> </code><code class="k">KEY</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.13 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">count</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 6 rows affected (0.01 sec)
Records: 6  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">count</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+---------+
| counter |
+---------+
| 1       |
| 2       |
| 3       |
| 4       |
| 5       |
| 6       |
+---------+
6 rows in set (0.00 sec)</pre>

<p class="pagebreak-before">Inserting several values works as expected. Now, let’s delete a few rows and then add six new rows:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">DELETE</code><code> </code><code class="k">FROM</code><code> </code><code class="n">count</code><code> </code><code class="k">WHERE</code><code> </code><code class="n">counter</code><code> </code><code class="o">&gt;</code><code> </code><code class="mi">4</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 2 rows affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">count</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 6 rows affected (0.00 sec)
Records: 6  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">count</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+---------+
| counter |
+---------+
| 1       |
| 2       |
| 3       |
| 4       |
| 7       |
| 8       |
| 9       |
| 10      |
| 11      |
| 12      |
+---------+
10 rows in set (0.00 sec)</pre>

<p>Here, we see that the counter is not reset and continues from 7. If, however, we truncate the table, thus removing all of the data, the counter is reset to 1:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="n">TRUNCATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">count</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">count</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 6 rows affected (0.01 sec)
Records: 6  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SELECT</code><code> </code><code class="o">*</code><code> </code><code class="k">FROM</code><code> </code><code class="n">count</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+---------+
| counter |
+---------+
| 1       |
| 2       |
| 3       |
| 4       |
| 5       |
| 6       |
+---------+
6 rows in set (0.00 sec)</pre>

<p>To summarize: <code>AUTO_INCREMENT</code> guarantees a sequence of transactional and monotonically increasing values. However, it does not in any way guarantee that each individual identifier provided will exactly follow the previous one. Usually, this behavior of <code>AUTO_INCREMENT</code> is clear enough and should not be a problem. However, if your particular use case requires a counter that guarantees no gaps, you should consider using some kind of workaround. Unfortunately, it’ll likely be implemented on the application side.<a data-type="indexterm" data-startref="ch04-aui" id="idm46177476894648"/><a data-type="indexterm" data-startref="ch04-aui2" id="idm46177476893944"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Altering Structures"><div class="sect1" id="MOD-SEC-ALTER">
<h1>Altering Structures</h1>

<p>We’ve shown you all the basics you need for creating databases, tables, indexes, and columns. In this section, you’ll learn how to add, remove, and change columns, databases, tables, and indexes in structures that already exist.</p>








<section data-type="sect2" data-pdf-bookmark="Adding, Removing, and Changing Columns"><div class="sect2" id="MOD-SEC-ALTERAT">
<h2>Adding, Removing, and Changing Columns</h2>

<p>You can use the <code>ALTER TABLE</code> statement to add new<a data-type="indexterm" data-primary="columns" data-secondary="adding, removing, changing" id="ch04-cola"/><a data-type="indexterm" data-primary="tables" data-secondary="columns added, removed, changed" id="ch04-cola2"/><a data-type="indexterm" data-primary="ALTER TABLE" id="ch04-cola3"/> columns to a table, remove existing columns, and change column names, types, and lengths.</p>

<p>Let’s begin by considering how you modify existing columns. <a data-type="indexterm" data-primary="columns" data-secondary="adding, removing, changing" data-tertiary="renaming column" id="idm46177476865992"/><a data-type="indexterm" data-primary="tables" data-secondary="columns added, removed, changed" data-tertiary="renaming column" id="idm46177476864904"/><a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="RENAME COLUMN" id="idm46177476863816"/>Consider an example in which we rename a table column. The <code>language</code> table has a column called <code>last_update</code> that contains the time the record was modified. To change the name of this column to <code>last_updated_time</code>, you would write:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">RENAME</code><code> </code><code class="k">COLUMN</code><code> </code><code class="n">last_update</code><code> </code><code class="k">TO</code><code> </code><code class="n">last_updated_time</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.03 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<p>This particular example utilizes the <em>online DDL</em> feature<a data-type="indexterm" data-primary="DDL" data-see="data definition language" id="idm46177476837208"/><a data-type="indexterm" data-primary="data definition language (DDL)" data-secondary="online DDL modifying metadata" id="idm46177476836264"/><a data-type="indexterm" data-primary="tables" data-secondary="columns added, removed, changed" data-tertiary="online DDL modifying metadata" id="idm46177476835384"/> of MySQL. What actually happens behind the scenes is that MySQL only modifies metadata and doesn’t need to actually rewrite the table in any way. You can see that by the lack of affected rows. Not all DDL statements can be performed online, so this won’t be the case with many of the changes you make.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>DDL stands for data definition language, and in the <a data-type="indexterm" data-primary="data definition language (DDL)" data-secondary="about" id="idm46177476832760"/><a data-type="indexterm" data-primary="CREATE TABLE" data-secondary="data definition language operation" id="idm46177476831768"/><a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="data definition language operation" id="idm46177476830808"/>context of SQL it’s a subset of syntax and statements used to create, modify, and delete schema objects such as databases, tables, indexes, and columns. <code>CREATE TABLE</code> and <code>ALTER TABLE</code> are both DDL operations, for example.</p>
</div>

<p>Executing DDL statements requires special internal<a data-type="indexterm" data-primary="data definition language (DDL)" data-secondary="metadata locks" id="idm46177476815784"/><a data-type="indexterm" data-primary="metadata locks" data-secondary="DDL statement execution" id="idm46177476815048"/> mechanisms, including special locking—this is a good thing, as you probably wouldn’t like tables changing while your queries are running! These special locks are called metadata locks in MySQL, and we give a detailed overview of how they work in <a data-type="xref" href="ch06.xhtml#CH6_TRANSACTION_LOCKING_METADATA">“Metadata Locks”</a>.</p>

<p>Note that all DDL statements, including those that execute through online DDL, require metadata locks to be obtained. In that sense, online DDL statements are not so “online,” but they won’t lock the target table entirely while they are running. 
<span class="keep-together">Executing</span> DDL statements on a running system under load is a risky venture: even a statement that should execute almost instantaneously may wreak havoc. We recommend that you read carefully about metadata locking in <a data-type="xref" href="ch06.xhtml#CH6_TRANSACTION_LOCKING">Chapter 6</a> and in the <a data-type="indexterm" data-primary="data definition language (DDL)" data-secondary="metadata locks" data-tertiary="documentation online" id="idm46177476810328"/><a data-type="indexterm" data-primary="web links in book" data-secondary="metadata locks documentation" id="idm46177476809064"/>link to <a href="https://oreil.ly/xNZYg">MySQL documentation</a>, and experiment with running different DDL statements with and without concurrent load. That may not be too important while you’re learning MySQL, but we think it’s worth cautioning you up front. With that covered, let’s get back to our <code>ALTER</code> of the <code>language</code> table.</p>

<p>You can check the result with the <code>SHOW COLUMNS</code> statement:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="n">COLUMNS</code><code> </code><code class="k">FROM</code><code> </code><code class="n">language</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+-------------------+------------------+------+-----+-------------------+...
| Field             | Type             | Null | Key | Default           |...
+-------------------+------------------+------+-----+-------------------+...
| language_id       | tinyint unsigned | NO   | PRI | NULL              |...
| name              | char(20)         | NO   |     | NULL              |...
| last_updated_time | timestamp        | NO   |     | CURRENT_TIMESTAMP |...
+-------------------+------------------+------+-----+-------------------+...
3 rows in set (0.01 sec)</pre>

<p>In the previous example we used the <code>ALTER TABLE</code> statement with the <code>RENAME COLUMN</code> keyword. That is a MySQL 8.0 feature. <a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="CHANGE to rename column" id="idm46177476792632"/>We could alternatively use <code>ALTER TABLE</code> with the <code>CHANGE</code> keyword for compatibility:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">CHANGE</code><code> </code><code class="n">last_update</code><code> </code><code class="n">last_updated_time</code><code> </code><code class="kt">TIMESTAMP</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">NOT</code><code> </code><code class="no">NULL</code><code> </code><code class="k">DEFAULT</code><code> </code><code class="k">CURRENT_TIMESTAMP</code><code> </code><code class="k">ON</code><code> </code><code class="k">UPDATE</code><code> </code><code class="k">CURRENT_TIMESTAMP</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.04 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<p>In this example, you can see that we provided four parameters to the <code>ALTER TABLE</code> statement with the <code>CHANGE</code> keyword:</p>
<ol>
<li>
<p>The table name, <code>language</code></p>
</li>
<li>
<p>The original column name, <code>last_update</code></p>
</li>
<li>
<p>The new column name, <code>last_updated_time</code></p>
</li>
<li>
<p>The column type, <code>TIMESTAMP</code>, with a lot of extra attributes, which are necessary to avoid changing the original definition</p>
</li>

</ol>

<p>You must provide all four; that means you need to respecify the type and any clauses that go with it. In this example, as we’re using MySQL 8.0 with the default settings, <code>TIMESTAMP</code> no longer has explicit defaults. As you can see, using <code>RENAME COLUMN</code> is much easier than <code>CHANGE</code>.</p>

<p>If you want to modify the type and clauses of a column, but not its name, you can use the <code>MODIFY</code> keyword:<a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="MODIFY" id="idm46177476713592"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="n">MODIFY</code><code> </code><code class="n">name</code><code> </code><code class="kt">CHAR</code><code class="p">(</code><code class="mi">20</code><code class="p">)</code><code> </code><code class="k">DEFAULT</code><code> </code><code class="s1">'n/a'</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.14 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<p>You can also do this with the <code>CHANGE</code> keyword, but by specifying the same column name twice:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">CHANGE</code><code> </code><code class="n">name</code><code> </code><code class="n">name</code><code> </code><code class="kt">CHAR</code><code class="p">(</code><code class="mi">20</code><code class="p">)</code><code> </code><code class="k">DEFAULT</code><code> </code><code class="s1">'n/a'</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.03 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<p>Be careful when you’re modifying types:<a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="MODIFY" data-tertiary="cautions on modifying types" id="idm46177478038760"/></p>

<ul>
<li>
<p>Don’t use incompatible types, since you’re relying on MySQL to successfully convert data from one format to another (for example, converting an <code>INT</code> column to a <code>DATETIME</code> column isn’t likely to do what you hoped).</p>
</li>
<li>
<p>Don’t truncate the data unless that’s what you want. If you reduce the size of a type, the values will be edited to match the new width, and you can lose data.</p>
</li>
</ul>

<p>Suppose you want to add an extra column to an existing table. Here’s how to do it with the <code>ALTER TABLE</code> statement:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">ADD</code><code> </code><code class="n">native_name</code><code> </code><code class="kt">CHAR</code><code class="p">(</code><code class="mi">20</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.04 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<p>You must supply the <code>ADD</code> keyword, the new column name,<a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="ADD column" id="idm46177476601944"/> and the column type and clauses. This example adds the new column, <code>native_name</code>, as the last column in the table, as shown with the <code>SHOW COLUMNS</code> statement:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="n">COLUMNS</code><code> </code><code class="k">FROM</code><code> </code><code class="n">artist</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+-------------------+------------------+------+-----+-------------------+...
| Field             | Type             | Null | Key | Default           |...
+-------------------+------------------+------+-----+-------------------+...
| language_id       | tinyint unsigned | NO   | PRI | NULL              |...
| name              | char(20)         | YES  |     | n/a               |...
| last_updated_time | timestamp        | NO   |     | CURRENT_TIMESTAMP |...
| native_name       | char(20)         | YES  |     | NULL              |...
+-------------------+------------------+------+-----+-------------------+...
4 rows in set (0.00 sec)</pre>

<p>If you want it to instead be the first column, use the <code>FIRST</code> keyword as follows:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">ADD</code><code> </code><code class="n">native_name</code><code> </code><code class="kt">CHAR</code><code class="p">(</code><code class="mi">20</code><code class="p">)</code><code> </code><code class="n">FIRST</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.08 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="n">COLUMNS</code><code> </code><code class="k">FROM</code><code> </code><code class="n">language</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+-------------------+------------------+------+-----+-------------------+...
| Field             | Type             | Null | Key | Default           |...
+-------------------+------------------+------+-----+-------------------+...
| native_name       | char(20)         | YES  |     | NULL              |...
| language_id       | tinyint unsigned | NO   | PRI | NULL              |...
| name              | char(20)         | YES  |     | n/a               |...
| last_updated_time | timestamp        | NO   |     | CURRENT_TIMESTAMP |...
+-------------------+------------------+------+-----+-------------------+...
4 rows in set (0.01 sec)</pre>

<p>If you want it added in a specific position, use the <code>AFTER</code> keyword:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">ADD</code><code> </code><code class="n">native_name</code><code> </code><code class="kt">CHAR</code><code class="p">(</code><code class="mi">20</code><code class="p">)</code><code> </code><code class="n">AFTER</code><code> </code><code class="n">name</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.08 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="n">COLUMNS</code><code> </code><code class="k">FROM</code><code> </code><code class="n">language</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+-------------------+------------------+------+-----+-------------------+...
| Field             | Type             | Null | Key | Default           |...
+-------------------+------------------+------+-----+-------------------+...
| language_id       | tinyint unsigned | NO   | PRI | NULL              |...
| name              | char(20)         | YES  |     | n/a               |...
| native_name       | char(20)         | YES  |     | NULL              |...
| last_updated_time | timestamp        | NO   |     | CURRENT_TIMESTAMP |...
+-------------------+------------------+------+-----+-------------------+...
4 rows in set (0.00 sec)</pre>

<p>To remove a column, use the <code>DROP</code> keyword followed by the<a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="DROP column" id="idm46177476439928"/> column name. Here’s how to get rid of the newly added <code>native_name</code> column:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">DROP</code><code> </code><code class="n">native_name</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.07 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<p>This removes both the column structure and any data contained in that column. <a data-type="indexterm" data-primary="indexes" data-secondary="DROP column" id="idm46177476407464"/>It also removes the column from any indexes it was in; if it’s the only column in the index, the index is dropped, too. You can’t remove a column if it’s the only one in a table; to do this, you drop the table instead, as explained in <a data-type="xref" href="#MOD-SEC-DELETE">“Deleting Structures”</a>. <a data-type="indexterm" data-primary="INSERT" data-secondary="after dropping a column" id="idm46177476405336"/>Be careful when dropping columns, because when the structure of a table changes, you will generally have to modify any <code>INSERT</code> statements that you use to insert values in a particular order. For more on this, see <a data-type="xref" href="ch03.xhtml#BAS-SEC-INSERT">“The INSERT Statement”</a>.</p>

<p>MySQL allows you to specify multiple alterations in a single<a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="multiple alterations in one statement" id="idm46177476402600"/> <code>ALTER TABLE</code> statement by separating them with commas. Here’s an example that adds a new column and adjusts another:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">ADD</code><code> </code><code class="n">native_name</code><code> </code><code class="kt">CHAR</code><code class="p">(</code><code class="mi">255</code><code class="p">)</code><code class="p">,</code><code> </code><code class="n">MODIFY</code><code> </code><code class="n">name</code><code> </code><code class="kt">CHAR</code><code class="p">(</code><code class="mi">255</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 6 rows affected (0.06 sec)
Records: 6  Duplicates: 0  Warnings: 0</pre>

<p>Note that this time, you can see that six records were changed. In the previous <code>ALTER TABLE</code> commands, MySQL reported that no rows were affected. The difference is that this time, we’re not performing an online DDL operation, because changing any column’s type will always result in a table being rebuilt. <a data-type="indexterm" data-primary="data definition language (DDL)" data-secondary="reference online" id="idm46177476348024"/><a data-type="indexterm" data-primary="web links in book" data-secondary="data definition language documentation" id="idm46177476347080"/>We recommend reading about <a href="https://oreil.ly/EEOw0">online DDL operations</a> in the Reference Manual when planning your changes. Combining online and offline operations will result in an offline operation.</p>

<p>When not using online DDL or when any of the modifications is “offline,” it’s very efficient to join multiple modifications in a single operation. That potentially saves the cost of creating a new table, copying data from the old table to the new table, dropping the old table, and renaming the new table with the name of the old table for each modification individually.<a data-type="indexterm" data-startref="ch04-cola" id="idm46177476344424"/><a data-type="indexterm" data-startref="ch04-cola2" id="idm46177476343720"/><a data-type="indexterm" data-startref="ch04-cola3" id="idm46177476343048"/></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Adding, Removing, and Changing Indexes"><div class="sect2" id="MOD-SEC-ALTERIND">
<h2>Adding, Removing, and Changing Indexes</h2>

<p>As we discussed previously, it’s often hard to know what<a data-type="indexterm" data-primary="indexes" data-secondary="about" id="idm46177476341176"/> indexes are useful before the application you’re building is used. You might find that a particular feature of the application is much more popular than you expected, causing you to evaluate how to improve performance for the associated queries. You’ll therefore find it useful to be able to add, alter, and remove indexes on the fly after your application is deployed. This section shows you how. Note that modifying indexes does not affect the data stored in a table.</p>

<p>We’ll start with adding a new index. Imagine<a data-type="indexterm" data-primary="indexes" data-secondary="adding new index" id="idm46177476326568"/> that the <code>language</code> table is frequently queried using a <code>WHERE</code> clause that specifies the <code>name</code>. To speed up these queries, you’ve decided to add a new index, which you’ve named <code>idx_name</code>. Here’s how you add it after the table is created:<a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="ADD INDEX" id="idm46177476324056"/><a data-type="indexterm" data-primary="keys" data-secondary="adding" id="idm46177476323208"/><a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="ADD KEY" id="idm46177476322360"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">ADD</code><code> </code><code class="k">INDEX</code><code> </code><code class="nf">idx_name</code><code> </code><code class="p">(</code><code class="n">name</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.05 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<p>Again, you can use the terms <code>KEY</code> and <code>INDEX</code> interchangeably. You can check the results with the <code>SHOW CREATE TABLE</code> statement:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code class="err">\</code><code class="n">G</code></strong></pre>

<pre data-type="programlisting">*************************** 1. row ***************************
       Table: language
Create Table: CREATE TABLE `language` (
  `language_id` tinyint unsigned NOT NULL AUTO_INCREMENT,
  `name` char(255) DEFAULT NULL,
  `last_updated_time` timestamp NOT NULL
    DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`language_id`),
  KEY `idx_name` (`name`)
) ENGINE=InnoDB AUTO_INCREMENT=8
    DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci</pre>

<p>As expected, the new index forms part of the table structure. You can also specify a primary key for a table after it’s created:<a data-type="indexterm" data-primary="primary key" data-secondary="adding after table created" id="idm46177476271352"/><a data-type="indexterm" data-primary="keys" data-secondary="primary key" data-see="primary key" id="idm46177476270440"/><a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="ADD PRIMARY KEY" id="idm46177476269224"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">no_pk</code><code> </code><code class="p">(</code><code class="n">id</code><code> </code><code class="kt">INT</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.02 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">INSERT</code><code> </code><code class="k">INTO</code><code> </code><code class="n">no_pk</code><code> </code><code class="k">VALUES</code><code> </code><code class="p">(</code><code class="mi">1</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="mi">2</code><code class="p">)</code><code class="p">,</code><code class="p">(</code><code class="mi">3</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 3 rows affected (0.01 sec)
Records: 3  Duplicates: 0  Warnings: 0</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">no_pk</code><code> </code><code class="k">ADD</code><code> </code><code class="k">PRIMARY</code><code> </code><code class="k">KEY</code><code> </code><code class="p">(</code><code class="n">id</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.13 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<p>Now let’s consider how to remove an index. To remove a non-primary key index, you do the following:<a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="DROP INDEX" id="idm46177476150312"/><a data-type="indexterm" data-primary="indexes" data-secondary="removing index" id="idm46177476149368"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">DROP</code><code> </code><code class="k">INDEX</code><code> </code><code class="n">idx_name</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.08 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<p>You can drop a primary key index as follows:<a data-type="indexterm" data-primary="primary key" data-secondary="removing" id="idm46177476123240"/><a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="DROP PRIMARY KEY" id="idm46177476122296"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">no_pk</code><code> </code><code class="k">DROP</code><code> </code><code class="k">PRIMARY</code><code> </code><code class="k">KEY</code></strong><code class="p">;</code></pre>

<pre data-type="programlisting">Query OK, 3 rows affected (0.07 sec)
Records: 3  Duplicates: 0  Warnings: 0</pre>

<p>MySQL won’t allow you to have multiple primary keys in a table. <a data-type="indexterm" data-primary="primary key" data-secondary="changing" id="idm46177476088712"/><a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="changing primary key" id="idm46177476087768"/>If you want to change the primary key, you’ll have to remove the existing index before adding the new one. However, we know that it’s possible to group DDL operations. Consider this example:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">DROP</code><code> </code><code class="k">PRIMARY</code><code> </code><code class="k">KEY</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">ADD</code><code> </code><code class="k">PRIMARY</code><code> </code><code class="k">KEY</code><code> </code><code class="p">(</code><code class="n">language_id</code><code class="p">,</code><code> </code><code class="n">name</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.09 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>

<p>You can’t modify an index once it’s been created. However,<a data-type="indexterm" data-primary="indexes" data-secondary="changing index" id="idm46177476032440"/><a data-type="indexterm" data-primary="keys" data-secondary="changing" id="idm46177476031496"/><a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="changing keys" id="idm46177476030552"/> sometimes you’ll want to; for example, you might want to reduce the number of characters indexed from a column or add another column to the index. The best method to do this is to drop the index and then create it again with the new specification. For example, suppose you decide that you want the <code>idx_name</code> index to include only the first 10 characters of the <code>artist_name</code>. Simply do the following:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">DROP</code><code> </code><code class="k">INDEX</code><code> </code><code class="n">idx_name</code><code class="p">,</code></strong><code>
    </code><code class="o">-</code><code class="o">&gt;</code><code> </code><strong><code class="k">ADD</code><code> </code><code class="k">INDEX</code><code> </code><code class="nf">idx_name</code><code> </code><code class="p">(</code><code class="nf">name</code><code class="p">(</code><code class="mi">10</code><code class="p">)</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.05 sec)
Records: 0  Duplicates: 0  Warnings: 0</pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Renaming Tables and Altering Other Structures"><div class="sect2" id="MOD-SEC-ALTERTABDB">
<h2>Renaming Tables and Altering Other Structures</h2>

<p>We’ve seen how to modify columns and indexes in a table; now<a data-type="indexterm" data-primary="tables" data-secondary="renaming" id="idm46177475978888"/><a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="RENAME table" id="idm46177475977976"/> let’s see how to modify tables themselves. It’s easy to rename a table. Suppose that you want to rename <code>language</code> to <code>languages</code>. Use the following command:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">ALTER</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">language</code><code> </code><code class="k">RENAME</code><code> </code><code class="k">TO</code><code> </code><code class="n">languages</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.04 sec)</pre>

<p>The <code>TO</code> keyword is optional.</p>

<p>There are several other things you can do with <code>ALTER</code> statements, including:</p>

<ul>
<li>
<p>Change the default character set and collation order for a database, a table, or a column.</p>
</li>
<li>
<p>Manage and change constraints. For example, you can add and remove foreign keys.</p>
</li>
<li>
<p>Add partitioning to a table, or alter the current partitioning definition.</p>
</li>
<li>
<p>Change the storage engine of a table.</p>
</li>
</ul>

<p>You can find more about these operations in the MySQL Reference Manual, in the sections on the<a data-type="indexterm" data-primary="ALTER TABLE" data-secondary="reference online" id="idm46177475942312"/><a data-type="indexterm" data-primary="ALTER DATABASE reference online" id="idm46177475921304"/><a data-type="indexterm" data-primary="web links in book" data-secondary="ALTER TABLE documentation" id="idm46177475920696"/><a data-type="indexterm" data-primary="web links in book" data-secondary="ALTER DATABASE documentation" id="idm46177475919848"/> <a href="https://oreil.ly/2FpoZ"><code>ALTER DATABASE</code></a> and <a href="https://oreil.ly/68PA3"><code>ALTER TABLE</code></a> statements. An alternative shorter notation for the same statement is <code>RENAME TABLE</code>:<a data-type="indexterm" data-primary="RENAME TABLE" id="idm46177475916984"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">RENAME</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">languages</code><code> </code><code class="k">TO</code><code> </code><code class="n">language</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.04 sec)</pre>

<p>One thing that it’s not possible to alter is a name of a particular<a data-type="indexterm" data-primary="renaming a database" id="idm46177475904920"/><a data-type="indexterm" data-primary="database renaming" id="idm46177475904248"/><a data-type="indexterm" data-primary="RENAME TABLE" data-secondary="moving tables between databases" id="idm46177475903576"/><a data-type="indexterm" data-primary="InnoDB" data-secondary="moving tables between databases" id="idm46177475902664"/><a data-type="indexterm" data-primary="tables" data-secondary="InnoDB moving tables between databases" id="idm46177475901752"/> database. However, if you’re using the InnoDB engine, you can use <code>RENAME</code> to move tables between 
<span class="keep-together">databases:</span></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">DATABASE</code><code> </code><code class="n">sakila_new</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 1 row affected (0.05 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">RENAME</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">sakila</code><code class="p">.</code><code class="n">language</code><code> </code><code class="k">TO</code><code> </code><code class="n">sakila_new</code><code class="p">.</code><code class="n">language</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.05 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">USE</code><code> </code><code class="n">sakila</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Database changed</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="kp">TABLES</code><code> </code><code class="k">LIKE</code><code> </code><code class="s1">'lang%'</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Empty set (0.00 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">USE</code><code> </code><code class="n">sakila_new</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Database changed</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="kp">TABLES</code><code> </code><code class="k">LIKE</code><code> </code><code class="s1">'lang%'</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+------------------------------+
| Tables_in_sakila_new (lang%) |
+------------------------------+
| language                     |
+------------------------------+
1 row in set (0.00 sec)</pre>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Deleting Structures"><div class="sect1" id="MOD-SEC-DELETE">
<h1>Deleting Structures</h1>

<p>In the previous section, we showed how you can delete columns and rows from a database; now we’ll describe how to remove databases and tables.</p>








<section data-type="sect2" data-pdf-bookmark="Dropping Databases"><div class="sect2" id="MOD-SEC-DELDB">
<h2>Dropping Databases</h2>

<p>Removing, or <em>dropping</em>, a database is straightforward. Here’s how you drop the <code>sakila</code> database:<a data-type="indexterm" data-primary="DROP DATABASE" id="idm46177475723208"/><a data-type="indexterm" data-primary="removing a database" id="idm46177475722472"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">DROP</code><code> </code><code class="k">DATABASE</code><code> </code><code class="n">sakila</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 25 rows affected (0.16 sec)</pre>

<p>The number of rows returned in the response is the number of tables removed. You should take care when dropping a database, since all its tables, indexes, and columns are deleted, as are all the associated disk-based files and directories that MySQL uses to maintain them.</p>

<p>If a database doesn’t exist, trying to drop it causes MySQL to report an error. Let’s try dropping the <code>sakila</code> database again:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">DROP</code><code> </code><code class="k">DATABASE</code><code> </code><code class="n">sakila</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">ERROR 1008 (HY000): Can't drop database 'sakila'; database doesn't exist</pre>

<p>You can avoid the error, which is useful when including the statement in a script, by using the <code>IF EXISTS</code> phrase:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">DROP</code><code> </code><code class="k">DATABASE</code><code> </code><code class="k">IF</code><code> </code><code class="k">EXISTS</code><code> </code><code class="n">sakila</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected, 1 warning (0.00 sec)</pre>

<p>You can see that a warning is reported since the <code>sakila</code> database has already been dropped.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Removing Tables"><div class="sect2" id="MOD-SEC-DELTABLE">
<h2>Removing Tables</h2>

<p>Removing tables is as easy as removing a database. Let’s create and remove a table from the <code>sakila</code> database:<a data-type="indexterm" data-primary="tables" data-secondary="removing" id="idm46177475630728"/><a data-type="indexterm" data-primary="DROP TABLE" id="idm46177475629720"/></p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">CREATE</code><code> </code><code class="k">TABLE</code><code> </code><code class="nf">temp</code><code> </code><code class="p">(</code><code class="n">id</code><code> </code><code class="n">SERIAL</code><code> </code><code class="k">PRIMARY</code><code> </code><code class="k">KEY</code><code class="p">)</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.05 sec)</pre>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">DROP</code><code> </code><code class="k">TABLE</code><code> </code><code class="n">temp</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected (0.03 sec)</pre>

<p>Don’t worry: the <code>0 rows affected</code> message is misleading. You’ll find the table is definitely gone.</p>

<p>You can use the <code>IF EXISTS</code> phrase to prevent errors. Let’s try dropping the <code>temp</code> table again:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">DROP</code><code> </code><code class="k">TABLE</code><code> </code><code class="k">IF</code><code> </code><code class="k">EXISTS</code><code> </code><code class="n">temp</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected, 1 warning (0.01 sec)</pre>

<p>As usual, you can investigate the warning with the <code>SHOW WARNINGS</code> statement:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">SHOW</code><code> </code><code class="n">WARNINGS</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">+-------+------+-----------------------------+
| Level | Code | Message                     |
+-------+------+-----------------------------+
| Note  | 1051 | Unknown table 'sakila.temp' |
+-------+------+-----------------------------+
1 row in set (0.00 sec)</pre>

<p>You can drop more than one table in a single statement by the separating table names with commas:</p>

<pre data-type="programlisting" data-code-language="mysql"><code class="n">mysql</code><code class="o">&gt;</code><code> </code><strong><code class="k">DROP</code><code> </code><code class="k">TABLE</code><code> </code><code class="k">IF</code><code> </code><code class="k">EXISTS</code><code> </code><code class="n">temp</code><code class="p">,</code><code> </code><code class="n">temp1</code><code class="p">,</code><code> </code><code class="n">temp2</code><code class="p">;</code></strong></pre>

<pre data-type="programlisting">Query OK, 0 rows affected, 3 warnings (0.00 sec)</pre>

<p>In this case there are three warnings because none of these tables existed.</p>
</div></section>





</div></section>







</div></section></div></body></html>