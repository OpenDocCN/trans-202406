<html><head></head><body><div id="sbo-rt-content" class="calibre1"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 9. Accessibility" class="calibre4"><div class="preface" id="chapter09">
<h1 class="calibre9"><span class="label">Chapter 9. </span>Accessibility</h1>


<p class="author1">This was a challenging chapter to write because other than wearing glasses and contact lenses, neither of us needs to use special
accessibility equipment or software. <a data-type="indexterm" data-primary="accessibility" id="ix_acss" class="calibre6"/>We have tried to bring together a collection of tools and techniques in this chapter that will
ideally help you find some of the more obvious accessibility problems in your code.</p>

<p class="author1">We look at how you can use landmarks and ARIA roles, which will add meaning and structure to your pages that would otherwise come only from visual grouping. We then have several recipes that show how to run manual and automated audits on your application,
look for glitches in code with static analysis, and find runtime errors by automating browsers.</p>

<p class="author1">We then look at some of the more technical issues involved in creating custom dialogs (hint: try to use prebuilt ones from
libraries), and finally, we build a simple screen reader.</p>

<p class="author1">For a more in-depth look at accessibility, <a data-type="indexterm" data-primary="Web Context Accessibility Guidelines (WCAG)" id="idm46634391534552" class="calibre6"/>be sure to check the <a href="https://oreil.ly/ie0aT" class="calibre6">Web Content Accessibility Guidelines (WCAG)</a>, which provide three conformance levels: A, AA, and AAA. AAA is the highest level of conformance.</p>

<p class="author1">If you are writing professional software, you will ideally find these recipes helpful. But nothing can replace the experience of
someone who has to live with the issues caused by inaccessible software every day of their lives. Accessible software is simply good
software. It maximizes your market and forces you to think more deeply about design. We would recommend, at the least, having
an accessibility audit run on your code.<a data-type="indexterm" data-primary="accessibility" data-secondary="auditing or tracking down problems with" id="idm46634391532056" class="calibre6"/> You can contact organizations like <a href="https://oreil.ly/N7XkH" class="calibre6">AbilityNet</a> in the UK, or
just search for <em class="calibre7">accessibility software testing</em> wherever you are, and you will find that is the most efficient way to track down
problems with your code.</p>






<section data-type="sect1" data-pdf-bookmark="Use Landmarks" class="calibre4"><div class="preface" id="ch09-01">
<h1 class="calibre17">Use Landmarks</h1>








<section data-type="sect2" data-pdf-bookmark="Problem" class="calibre4"><div class="preface" id="idm46634391528232">
<h2 class="calibre27">Problem</h2>

<p class="author1">Let’s consider the application in <a data-type="xref" href="#ch09_image_1" class="calibre6">Figure 9-1</a>. It’s a simple application for creating and managing tasks.<a data-type="indexterm" data-primary="accessibility" data-secondary="using landmarks" id="ix_acsslndmk" class="calibre6"/></p>

<figure class="calibre29"><div id="ch09_image_1" class="figure">
<img src="Images/recb_0901.png" alt="" class="calibre154"/>
<h6 class="calibre30"><span class="firstname">Figure 9-1. </span>The example <em class="calibre7">tasks</em> application</h6>
</div></figure>

<p class="author1">If someone can see the application, they will easily distinguish between the main content (the tasks) and all of the other stuff
around the edge: the links to other pages, the headings, the copyright, etc.</p>

<p class="author1">Let’s look at the code for the main <code class="calibre21">App</code> component of this application:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">const</code> <code class="nx">App</code> <code class="o">=</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="go">...</code>
  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;&gt;</code>
      <code class="go">&lt;</code><code class="nt">h1</code><code class="go">&gt;</code><code class="nx">Manage</code> <code class="nx">Tasks</code><code class="go">&lt;/</code><code class="nt">h1</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/contacts'</code><code class="go">&gt;</code><code class="nx">Contacts</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
      <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/events'</code><code class="go">&gt;</code><code class="nx">Events</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
      <code class="nx">Tasks</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
      <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/notes'</code><code class="go">&gt;</code><code class="nx">Notes</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
      <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/time'</code><code class="go">&gt;</code><code class="nx">TimeRec</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
      <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/diary'</code><code class="go">&gt;</code><code class="nx">Diary</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
      <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/expenses'</code><code class="go">&gt;</code><code class="nx">Expenses</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
      <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/invoices'</code><code class="go">&gt;</code><code class="nx">Invoices</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">button</code> <code class="na">className</code><code class="o">=</code><code class="s">'addButton'</code>
          <code class="na">onClick</code><code class="o">=</code><code class="go">{()</code> <code class="o">=&gt;</code> <code class="nx">setFormOpen</code><code class="go">(</code><code class="kr">true</code><code class="go">)}&gt;</code><code class="o">+</code><code class="go">&lt;/</code><code class="nt">button</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">TaskContexts</code> <code class="na">...</code><code class="go">/&gt;</code>
      <code class="o">&amp;</code><code class="err">#</code><code class="mi">169</code><code class="go">;</code><code class="mi">2029</code><code class="go">,</code> <code class="nx">Amalgamated</code> <code class="nx">Consultants</code> <code class="nx">Corp</code><code class="go">.</code> <code class="nx">All</code> <code class="nx">Rights</code> <code class="nx">Reserved</code><code class="go">.</code>
      <code class="go">&lt;</code><code class="nt">TaskForm</code> <code class="na">...</code><code class="go">/&gt;</code>
      <code class="go">&lt;</code><code class="nt">ModalQuestion</code> <code class="na">...</code><code class="go">&gt;</code>
        <code class="nx">Are</code> <code class="nx">you</code> <code class="nx">sure</code> <code class="nx">you</code> <code class="nx">want</code> <code class="nx">to</code> <code class="kr">delete</code> <code class="kr">this</code> <code class="nx">task</code><code class="o">?</code>
      <code class="go">&lt;/</code><code class="nt">ModalQuestion</code><code class="go">&gt;</code>
    <code class="go">&lt;/&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">The problem is that if you rely on a device to read the page to you, it can be hard to understand the page’s structure. Which parts
are the navigation links? Where is the main content on the page? The parsing that the human eye performs (see <a data-type="xref" href="#ch09_image_2" class="calibre6">Figure 9-2</a>) is
difficult to replicate if you can’t assess the spatial grouping of the interface.</p>

<p class="author1">So, how can we get around this problem?<a data-type="indexterm" data-primary="vision problems" data-secondary="using landmarks instead of visual grouping for page structure" id="idm46634391558616" class="calibre6"/> What can we use instead of visual grouping to make the structure of a page more
understandable?</p>

<figure class="calibre29"><div id="ch09_image_2" class="figure">
<img src="Images/recb_0902.png" alt="" class="calibre155"/>
<h6 class="calibre30"><span class="firstname">Figure 9-2. </span>Sighted viewers can quickly identify the sections of the page spatially</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Solution" class="calibre4"><div class="preface" id="idm46634391344680">
<h2 class="calibre27">Solution</h2>

<p class="author1">We are going to introduce <em class="calibre7">landmarks</em> to our code.<a data-type="indexterm" data-primary="landmarks" id="ix_lndmk" class="calibre6"/> Landmarks are HTML elements that we can use to group parts of our interface
structurally to mirror how they’re grouped visually.<a data-type="indexterm" data-primary="HTML elements" data-secondary="landmarks" id="idm46634391341192" class="calibre6"/> Landmarks are also helpful when designing a page because they force you to
think about the functions of the various types of page content.</p>

<p class="author1">Let’s begin by highlighting the <em class="calibre7">header</em>. <a data-type="indexterm" data-primary="headings" data-secondary="h1 and lower-level headings on page" id="idm46634391339160" class="calibre6"/>This part of the page identifies what the page is about. We would typically use an
<code class="calibre21">h1</code> heading for this, but we might also include commonly used tools, or perhaps a logo. We can identify the header using the
<code class="calibre21">header</code> tag:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">header</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">h1</code><code class="go">&gt;</code><code class="nx">Manage</code> <code class="nx">Tasks</code><code class="go">&lt;/</code><code class="nt">h1</code><code class="go">&gt;</code>
<code class="go">&lt;/</code><code class="nt">header</code><code class="go">&gt;</code></pre>
<div data-type="note" epub:type="note" class="calibre25">
<p class="author1">We should always have an <code class="calibre21">h1</code> heading on the page, and we should use lower-level headings to structure the content of the rest
of the page without skipping any levels. For example, you should never have an <code class="calibre21">h1</code> heading and an <code class="calibre21">h3</code> heading without an <code class="calibre21">h2</code> heading
somewhere between the two. <a data-type="indexterm" data-primary="screen readers" data-secondary="headings, handy navigation device in" id="idm46634391317144" class="calibre6"/>Headings are a handy navigation device for people using screen readers, including functions that allow
the user to skip backward and forward between headings.</p>
</div>

<p class="author1">Next, we need to think about <em class="calibre7">navigation</em>.<a data-type="indexterm" data-primary="navigation" data-secondary="using nav landmark to identify" id="idm46634391315096" class="calibre6"/> Navigation can come in many forms. It might be a list of links (as here), or it could be
a series of menus or a sidebar.<a data-type="indexterm" data-primary="landmarks" data-secondary="nav, identifying navigation on pages" id="idm46634391313800" class="calibre6"/> The navigation is a block of components that allow you to visit the major parts of a website. You
will almost certainly have other links on the page that are not part of the navigation.</p>

<p class="author1">We can use the <code class="calibre21">nav</code> landmark to identify the navigation of our page:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">nav</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/contacts'</code><code class="go">&gt;</code><code class="nx">Contacts</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/events'</code><code class="go">&gt;</code><code class="nx">Events</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="nx">Tasks</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/notes'</code><code class="go">&gt;</code><code class="nx">Notes</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/time'</code><code class="go">&gt;</code><code class="nx">TimeRec</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/diary'</code><code class="go">&gt;</code><code class="nx">Diary</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/expenses'</code><code class="go">&gt;</code><code class="nx">Expenses</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/invoices'</code><code class="go">&gt;</code><code class="nx">Invoices</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code>
<code class="go">&lt;/</code><code class="nt">nav</code><code class="go">&gt;</code></pre>

<p class="author1">The crucial part of a page is the content. In our tasks application, the content is the collection of tasks.<a data-type="indexterm" data-primary="content" data-secondary="grouping main page content in main landmark" id="idm46634391310040" class="calibre6"/><a data-type="indexterm" data-primary="landmarks" data-secondary="main, grouping main page content" id="idm46634391246280" class="calibre6"/> The main content is
what the user primarily wants to read and interact with on the page. Occasionally, the main content might also include tools—such as
the floating “add” button in the tasks application—but these don’t have to be in the main content, and we can move them to somewhere
in the header.</p>

<p class="author1">We can group together the main content of the page with the <code class="calibre21">main</code> tag:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">main</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">button</code> <code class="na">className</code><code class="o">=</code><code class="s">'addButton'</code>
            <code class="na">onClick</code><code class="o">=</code><code class="go">{()</code> <code class="o">=&gt;</code> <code class="nx">setFormOpen</code><code class="go">(</code><code class="kr">true</code><code class="go">)}&gt;</code><code class="o">+</code><code class="go">&lt;/</code><code class="nt">button</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">TaskContexts</code> <code class="na">contexts</code><code class="o">=</code><code class="go">{</code><code class="nx">contexts</code><code class="go">}</code>
                  <code class="na">tasks</code><code class="o">=</code><code class="go">{</code><code class="nx">tasks</code><code class="go">}</code>
                  <code class="na">onDelete</code><code class="o">=</code><code class="go">{</code><code class="nx">setTaskToRemove</code><code class="go">}</code>
                  <code class="na">onEdit</code><code class="o">=</code><code class="go">{</code><code class="nx">task</code> <code class="o">=&gt;</code> <code class="go">{</code>
                      <code class="nx">setEditTask</code><code class="go">(</code><code class="nx">task</code><code class="go">)</code>
                      <code class="nx">setFormOpen</code><code class="go">(</code><code class="kr">true</code><code class="go">)</code>
                  <code class="go">}}</code>
    <code class="go">/&gt;</code>
<code class="go">&lt;/</code><code class="nt">main</code><code class="go">&gt;</code></pre>

<p class="author1">Finally, we have the web page’s <em class="calibre7">metadata</em>: the data about data.<a data-type="indexterm" data-primary="metadata" id="idm46634390927032" class="calibre6"/><a data-type="indexterm" data-primary="landmarks" data-secondary="metadata, grouped in footer tag" id="idm46634390926536" class="calibre6"/> In the task application, the copyright notice at the bottom of the
page is an example of metadata.<a data-type="indexterm" data-primary="footer tag, page metadata grouped in" id="idm46634390925384" class="calibre6"/> You will often find metadata placed in a group at the bottom of a page, and so it is grouped in a
<code class="calibre21">footer</code> tag:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">footer</code><code class="go">&gt;</code>
    <code class="o">&amp;</code><code class="err">#</code><code class="mi">169</code><code class="go">;</code><code class="mi">2029</code><code class="go">,</code> <code class="nx">Amalgamated</code> <code class="nx">Consultants</code> <code class="nx">Corp</code><code class="go">.</code> <code class="nx">All</code> <code class="nx">Rights</code> <code class="nx">Reserved</code><code class="go">.</code>
<code class="go">&lt;/</code><code class="nt">footer</code><code class="go">&gt;</code></pre>

<p class="author1">There are still <a data-type="indexterm" data-primary="landmarks" data-secondary="TaskForm modal dialog" id="idm46634391058120" class="calibre6"/>a couple things left from our original <code class="calibre21">App</code> component:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">TaskForm</code> <code class="na">...</code><code class="go">/&gt;</code>
<code class="go">&lt;</code><code class="nt">ModalQuestion</code> <code class="na">...</code><code class="go">&gt;</code>
    <code class="nx">Are</code> <code class="nx">you</code> <code class="nx">sure</code> <code class="nx">you</code> <code class="nx">want</code> <code class="nx">to</code> <code class="kr">delete</code> <code class="kr">this</code> <code class="nx">task</code><code class="o">?</code>
<code class="go">&lt;/</code><code class="nt">ModalQuestion</code><code class="go">&gt;</code></pre>

<p class="author1">The <code class="calibre21">TaskForm</code> is a modal dialog <a data-type="indexterm" data-primary="dialogs" data-secondary="TaskForm modal dialog" id="idm46634391045256" class="calibre6"/><a data-type="indexterm" data-primary="forms" data-secondary="TaskForm modal dialog" id="idm46634390879032" class="calibre6"/>that appears when the user wants to create or edit a task (see <a data-type="xref" href="#ch09_image_3" class="calibre6">Figure 9-3</a>).</p>

<figure class="calibre29"><div id="ch09_image_3" class="figure">
<img src="Images/recb_0903.png" alt="" class="calibre156"/>
<h6 class="calibre30"><span class="firstname">Figure 9-3. </span>The <code class="calibre21">TaskForm</code> is a modal dialog that appears above other content</h6>
</div></figure>

<p class="author1">The <code class="calibre21">ModalQuestion</code> is a confirmation box that appears if a user tries to delete a task (see <a data-type="xref" href="#ch09_image_4" class="calibre6">Figure 9-4</a>).<a data-type="indexterm" data-primary="landmarks" data-secondary="ModalQuestion confirmation box" id="idm46634390872744" class="calibre6"/><a data-type="indexterm" data-primary="ModalQuestion confirmation box" id="idm46634390871800" class="calibre6"/><a data-type="indexterm" data-primary="confirmations, modal question box" id="idm46634390871160" class="calibre6"/></p>

<figure class="calibre29"><div id="ch09_image_4" class="figure">
<img src="Images/recb_0904.png" alt="" class="calibre157"/>
<h6 class="calibre30"><span class="firstname">Figure 9-4. </span>A modal question box asks the user to confirm the deletion of a task</h6>
</div></figure>

<p class="author1">These two components will appear only when needed. When the page is in its normal state, the modals will not appear in the page’s
structure, so they don’t have to be included in a landmark. We will see elsewhere in this chapter that there are other ways of
dealing with dynamic content, such as modals, that will make them more accessible to your audience.</p>

<p class="author1">This is what the final form of our <code class="calibre21">App</code> component looks like:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">const</code> <code class="nx">App</code> <code class="o">=</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="go">....</code>
  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;&gt;</code>
      <code class="go">&lt;</code><code class="nt">header</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">h1</code><code class="go">&gt;</code><code class="nx">Manage</code> <code class="nx">Tasks</code><code class="go">&lt;/</code><code class="nt">h1</code><code class="go">&gt;</code>
      <code class="go">&lt;/</code><code class="nt">header</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">nav</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/contacts'</code><code class="go">&gt;</code><code class="nx">Contacts</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
        <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/events'</code><code class="go">&gt;</code><code class="nx">Events</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
        <code class="nx">Tasks</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
        <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/notes'</code><code class="go">&gt;</code><code class="nx">Notes</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
        <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/time'</code><code class="go">&gt;</code><code class="nx">TimeRec</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
        <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/diary'</code><code class="go">&gt;</code><code class="nx">Diary</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
        <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/expenses'</code><code class="go">&gt;</code><code class="nx">Expenses</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
        <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/invoices'</code><code class="go">&gt;</code><code class="nx">Invoices</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code>
      <code class="go">&lt;/</code><code class="nt">nav</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">main</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">button</code> <code class="na">className</code><code class="o">=</code><code class="s">'addButton'</code>
          <code class="na">onClick</code><code class="o">=</code><code class="go">{()</code> <code class="o">=&gt;</code> <code class="nx">setFormOpen</code><code class="go">(</code><code class="kr">true</code><code class="go">)}&gt;</code><code class="o">+</code><code class="go">&lt;/</code><code class="nt">button</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">TaskContexts</code> <code class="na">...</code><code class="go">/&gt;</code>
      <code class="go">&lt;/</code><code class="nt">main</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">footer</code><code class="go">&gt;</code>
        <code class="o">&amp;</code><code class="err">#</code><code class="mi">169</code><code class="go">;</code><code class="mi">2029</code><code class="go">,</code> <code class="nx">Amalgamated</code> <code class="nx">Consultants</code> <code class="nx">Corp</code><code class="go">.</code> <code class="nx">All</code> <code class="nx">Rights</code> <code class="nx">Reserved</code><code class="go">.</code>
      <code class="go">&lt;/</code><code class="nt">footer</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">TaskForm</code> <code class="na">...</code><code class="go">/&gt;</code>
      <code class="go">&lt;</code><code class="nt">ModalQuestion</code> <code class="na">...</code><code class="go">&gt;</code>
        <code class="nx">Are</code> <code class="nx">you</code> <code class="nx">sure</code> <code class="nx">you</code> <code class="nx">want</code> <code class="nx">to</code> <code class="kr">delete</code> <code class="kr">this</code> <code class="nx">task</code><code class="o">?</code>
      <code class="go">&lt;/</code><code class="nt">ModalQuestion</code><code class="go">&gt;</code>
    <code class="go">&lt;/&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Discussion" class="calibre4"><div class="preface" id="idm46634391343736">
<h2 class="calibre27">Discussion</h2>

<p class="author1">Landmarks are part of HTML5 and so are natively supported in browsers.<a data-type="indexterm" data-primary="HTML" data-secondary="landmarks in HTML5" id="idm46634390830184" class="calibre6"/><a data-type="indexterm" data-primary="landmarks" data-secondary="browsers' native support for" id="idm46634390829208" class="calibre6"/><a data-type="indexterm" data-primary="browsers" data-secondary="native support of landmarks" id="idm46634390639096" class="calibre6"/> This means that you can start using them without needing to
add special tooling or support libraries.</p>

<p class="author1">You will find that some automated accessibility tools might complain about landmarks rendered by React applications.<a data-type="indexterm" data-primary="landmarks" data-secondary="rendered by React applications" id="idm46634390637432" class="calibre6"/> The standard
guidelines state that <em class="calibre7">all</em> content in the body of a web page should be inside a landmark.<a data-type="indexterm" data-primary="content" data-secondary="all page body content rendered inside landmarks" id="idm46634390635976" class="calibre6"/> But most React applications render their
content (including any landmarks) inside a single <code class="calibre21">div</code>, which instantly breaks the rules.</p>

<p class="author1">It is probably safe to ignore the issue. So long as the landmarks exist and they are all at the same level, it shouldn’t matter
that they are wrapped in an additional <code class="calibre21">div</code>.</p>

<p class="author1">You can download the source for this recipe
from the [GitHub site].<a data-type="indexterm" data-primary="landmarks" data-startref="ix_lndmk" id="idm46634390632872" class="calibre6"/><a data-type="indexterm" data-primary="accessibility" data-secondary="using landmarks" data-startref="ix_acsslndmk" id="idm46634390631896" class="calibre6"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Apply Roles, Alts, and Titles" class="calibre4"><div class="preface" id="ch09-02">
<h1 class="calibre17">Apply Roles, Alts, and Titles</h1>








<section data-type="sect2" data-pdf-bookmark="Problem" class="calibre4"><div class="preface" id="idm46634390629128">
<h2 class="calibre27">Problem</h2>

<p class="author1">It’s common to have components in applications that behave like buttons, even if they’re not buttons.<a data-type="indexterm" data-primary="accessibility" data-secondary="applying roles, alts, and titles" id="ix_acssRAT" class="calibre6"/> Likewise, you might have
components that look like pop-up dialog boxes without actually being dialog boxes. Or you might have collections of data structurally similar
to lists that don’t use the <code class="calibre21">ol</code> and <code class="calibre21">ul</code> tags.</p>

<p class="author1">Creating components that behave like standard UI elements isn’t a problem if you can see the visual styling of the component.<a data-type="indexterm" data-primary="components" data-secondary="behaving like standard UI elements, creating" id="idm46634390624648" class="calibre6"/> If
something looks like a button to a user, they will treat it as a button, regardless of its implementation.<a data-type="indexterm" data-primary="vision problems" data-secondary="inability to see visual styling of a component" id="idm46634390623384" class="calibre6"/></p>

<p class="author1">But there’s a problem if someone can’t see the visual styling of a component. Instead, you need to describe the purpose of a
component for people who can’t see it.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Solution" class="calibre4"><div class="preface" id="idm46634390621576">
<h2 class="calibre27">Solution</h2>

<p class="author1">We’re going <a data-type="indexterm" data-primary="roles" id="ix_role" class="calibre6"/>to look at using <em class="calibre7">roles</em> within the application. The <em class="calibre7">role</em> describes the meaning of a component: it tells the user what
purpose it serves. Roles are part of the semantics of a web page and so are similar to the semantic landmarks that we discuss in <a data-type="xref" href="#ch09-01" class="calibre6">“Use Landmarks”</a>.</p>

<p class="author1">Here is a <a data-type="indexterm" data-primary="roles" data-secondary="typical roles applied to rendered HTML" id="idm46634390615432" class="calibre6"/>list of some typical roles that you can apply to rendered HTML:</p>
<table class="calibre10">

<thead class="calibre11">
<tr class="calibre12">
<th class="calibre13">Role name</th>
<th class="calibre13">Purpose</th>
</tr>
</thead>
<tbody class="calibre14">
<tr class="calibre12">
<td class="calibre15"><p class="author1">alert</p></td>
<td class="calibre15"><p class="author1">Tells the user that something has happened.</p></td>
</tr>
<tr class="calibre16">
<td class="calibre15"><p class="author1">article</p></td>
<td class="calibre15"><p class="author1">Large block of text content, like a news story.</p></td>
</tr>
<tr class="calibre12">
<td class="calibre15"><p class="author1">button</p></td>
<td class="calibre15"><p class="author1">Something you can click to do something.</p></td>
</tr>
<tr class="calibre16">
<td class="calibre15"><p class="author1">checkbox</p></td>
<td class="calibre15"><p class="author1">A user-selectable true/false value.</p></td>
</tr>
<tr class="calibre12">
<td class="calibre15"><p class="author1">comment</p></td>
<td class="calibre15"><p class="author1">Like a user-submitted comment or reaction.</p></td>
</tr>
<tr class="calibre16">
<td class="calibre15"><p class="author1">complementary</p></td>
<td class="calibre15"><p class="author1">Additional information, perhaps in a sidebar.</p></td>
</tr>
<tr class="calibre12">
<td class="calibre15"><p class="author1">contentinfo</p></td>
<td class="calibre15"><p class="author1">Copyright notices, author names, publication dates.</p></td>
</tr>
<tr class="calibre16">
<td class="calibre15"><p class="author1">dialog</p></td>
<td class="calibre15"><p class="author1">Something floats over the other content. Often modal.</p></td>
</tr>
<tr class="calibre12">
<td class="calibre15"><p class="author1">feed</p></td>
<td class="calibre15"><p class="author1">Common in blogs. It’s a list of articles.</p></td>
</tr>
<tr class="calibre16">
<td class="calibre15"><p class="author1">figure</p></td>
<td class="calibre15"><p class="author1">An illustration.</p></td>
</tr>
<tr class="calibre12">
<td class="calibre15"><p class="author1">list</p></td>
<td class="calibre15"><p class="author1">A sequential group of things.</p></td>
</tr>
<tr class="calibre16">
<td class="calibre15"><p class="author1">listitem</p></td>
<td class="calibre15"><p class="author1">Each of the things in a list.</p></td>
</tr>
<tr class="calibre12">
<td class="calibre15"><p class="author1">search</p></td>
<td class="calibre15"><p class="author1">A search field.</p></td>
</tr>
<tr class="calibre16">
<td class="calibre15"><p class="author1">menu</p></td>
<td class="calibre15"><p class="author1">A sequence of options, typically used for navigation.</p></td>
</tr>
<tr class="calibre12">
<td class="calibre15"><p class="author1">menuitem</p></td>
<td class="calibre15"><p class="author1">An item on a menu.</p></td>
</tr>
</tbody>
</table>

<p class="author1">You apply roles to elements with the <code class="calibre21">role</code> attribute.<a data-type="indexterm" data-primary="roles" data-secondary="applying to elements with role attribute" id="idm46634390586376" class="calibre6"/><a data-type="indexterm" data-primary="HTML elements" data-secondary="applying roles to" id="idm46634390585272" class="calibre6"/> Let’s consider the <code class="calibre21">Task</code> component from the example application in this
chapter. The <code class="calibre21">Task</code> component renders each of the tasks as a small panel, with a Delete button:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="nx">DeleteIcon</code> <code class="nx">from</code> <code class="s">'./delete-24px.svg'</code>
<code class="kr">import</code> <code class="s">'./Task.css'</code>

<code class="kr">const</code> <code class="nx">Task</code> <code class="o">=</code> <code class="go">({</code> <code class="nx">task</code><code class="go">,</code> <code class="nx">onDelete</code><code class="go">,</code> <code class="nx">onEdit</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task"</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task-contents"</code>
          <code class="na">...</code>
        <code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task-details"</code><code class="go">&gt;</code>
          <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task-title"</code><code class="go">&gt;{</code><code class="nx">task</code><code class="go">.</code><code class="nx">title</code><code class="go">}&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
          <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task-description"</code><code class="go">&gt;{</code><code class="nx">task</code><code class="go">.</code><code class="nx">description</code><code class="go">}&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
        <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task-controls"</code><code class="go">&gt;</code>
          <code class="go">&lt;</code><code class="nt">img</code>
            <code class="na">src</code><code class="o">=</code><code class="go">{</code><code class="nx">DeleteIcon</code><code class="go">}</code>
            <code class="na">width</code><code class="o">=</code><code class="go">{</code><code class="mi">24</code><code class="go">}</code>
            <code class="na">height</code><code class="o">=</code><code class="go">{</code><code class="mi">24</code><code class="go">}</code>
            <code class="na">title</code><code class="o">=</code><code class="s">"Delete"</code>
            <code class="na">onClick</code><code class="o">=</code><code class="go">{(</code><code class="nx">evt</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
              <code class="nx">evt</code><code class="go">.</code><code class="nx">stopPropagation</code><code class="go">()</code>
              <code class="nx">onDelete</code><code class="go">()</code>
            <code class="go">}}</code>
            <code class="na">alt</code><code class="o">=</code><code class="s">"Delete icon"</code>
          <code class="go">/&gt;</code>
        <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
      <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">We group tasks on the page under headings that describe the context in which a person would perform the task.<a data-type="indexterm" data-primary="lists" data-secondary="list and listitem roles" id="idm46634390580440" class="calibre6"/><a data-type="indexterm" data-primary="roles" data-secondary="list and listitem" id="idm46634390579592" class="calibre6"/> For example, you might
have a series of tasks grouped under the heading Phone (see <a data-type="xref" href="#ch09_image_5" class="calibre6">Figure 9-5</a>).</p>

<figure class="calibre29"><div id="ch09_image_5" class="figure">
<img src="Images/recb_0901.png" alt="" class="calibre154"/>
<h6 class="calibre30"><span class="firstname">Figure 9-5. </span>Each group contains a list of tasks</h6>
</div></figure>

<p class="author1">So, the tasks appear to match the <code class="calibre21">listitem</code> role. They are things that appear inside an ordered collection. We could therefore add that
role to the first <code class="calibre21">div</code>:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">return</code> <code class="go">&lt;</code><code class="nt">div</code> <code class="na">role</code><code class="o">=</code><code class="s">'listitem'</code> <code class="na">className</code><code class="o">=</code><code class="s">'Task'</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">'Task-details'</code><code class="go">&gt;</code>
        <code class="go">....</code></pre>

<p class="author1">If<a data-type="indexterm" data-primary="roles" data-secondary="rules for" id="idm46634390325224" class="calibre6"/><a data-type="indexterm" data-primary="rules" data-secondary="for roles" data-secondary-sortas="roles" id="idm46634390324344" class="calibre6"/> we stopped there, we would have a problem. <em class="calibre7">Roles have rules</em>. You cannot apply the <code class="calibre21">listitem</code> role to a component unless it
appears inside something with a <code class="calibre21">list</code> role. So if we are going to mark our <code class="calibre21">Task</code> components as <code class="calibre21">listitems</code>, we will also need to
give the <code class="calibre21">TaskList</code> parent a <code class="calibre21">list</code> role:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="nx">Task</code> <code class="nx">from</code> <code class="s">'../Task'</code>
<code class="kr">import</code> <code class="s">'./TaskList.css'</code>

<code class="kr">function</code> <code class="nx">TaskList</code><code class="go">({</code> <code class="nx">tasks</code><code class="go">,</code> <code class="nx">onDelete</code><code class="go">,</code> <code class="nx">onEdit</code> <code class="go">})</code> <code class="go">{</code>
  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">role</code><code class="o">=</code><code class="s">"list"</code> <code class="na">className</code><code class="o">=</code><code class="s">"TaskList"</code><code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">tasks</code><code class="go">.</code><code class="nx">map</code><code class="go">((</code><code class="nx">t</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">(</code>
        <code class="go">&lt;</code><code class="nt">Task</code>
          <code class="na">key</code><code class="o">=</code><code class="go">{</code><code class="nx">t</code><code class="go">.</code><code class="nx">id</code><code class="go">}</code>
          <code class="na">task</code><code class="o">=</code><code class="go">{</code><code class="nx">t</code><code class="go">}</code>
          <code class="na">onDelete</code><code class="o">=</code><code class="go">{()</code> <code class="o">=&gt;</code> <code class="nx">onDelete</code><code class="go">(</code><code class="nx">t</code><code class="go">)}</code>
          <code class="na">onEdit</code><code class="o">=</code><code class="go">{()</code> <code class="o">=&gt;</code> <code class="nx">onEdit</code><code class="go">(</code><code class="nx">t</code><code class="go">)}</code>
        <code class="go">/&gt;</code>
      <code class="go">))}</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code>

<code class="kr">export</code> <code class="kr">default</code> <code class="nx">TaskList</code></pre>

<p class="author1">Using <code class="calibre21">list</code> and <code class="calibre21">listitem</code> roles is perfectly valid. But it is probably far better in practice if we have HTML that behaves like a
list to change the markup and use real <code class="calibre21">ul</code> and <code class="calibre21">li</code> tags.<a data-type="indexterm" data-primary="lists" data-secondary="ul and li tags" id="idm46634390167208" class="calibre6"/> From an accessibility point of view, it probably makes no difference. But
it is always good to avoid filling your HTML with endless <code class="calibre21">div</code> tags. In general, if you can use a real HTML tag instead of a role,
it’s probably best to do so.</p>

<p class="author1">Let’s remove the <code class="calibre21">list</code> role from <code class="calibre21">TaskList</code> and make a real <code class="calibre21">ul</code>:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="nx">Task</code> <code class="nx">from</code> <code class="s">'../Task'</code>
<code class="kr">import</code> <code class="s">'./TaskList.css'</code>

<code class="kr">function</code> <code class="nx">TaskList</code><code class="go">({</code> <code class="nx">tasks</code><code class="go">,</code> <code class="nx">onDelete</code><code class="go">,</code> <code class="nx">onEdit</code> <code class="go">})</code> <code class="go">{</code>
  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">ul</code> <code class="na">className</code><code class="o">=</code><code class="s">"TaskList"</code><code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">tasks</code><code class="go">.</code><code class="nx">map</code><code class="go">((</code><code class="nx">t</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">(</code>
        <code class="go">&lt;</code><code class="nt">Task</code>
          <code class="na">key</code><code class="o">=</code><code class="go">{</code><code class="nx">t</code><code class="go">.</code><code class="nx">id</code><code class="go">}</code>
          <code class="na">task</code><code class="o">=</code><code class="go">{</code><code class="nx">t</code><code class="go">}</code>
          <code class="na">onDelete</code><code class="o">=</code><code class="go">{()</code> <code class="o">=&gt;</code> <code class="nx">onDelete</code><code class="go">(</code><code class="nx">t</code><code class="go">)}</code>
          <code class="na">onEdit</code><code class="o">=</code><code class="go">{()</code> <code class="o">=&gt;</code> <code class="nx">onEdit</code><code class="go">(</code><code class="nx">t</code><code class="go">)}</code>
        <code class="go">/&gt;</code>
      <code class="go">))}</code>
    <code class="go">&lt;/</code><code class="nt">ul</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code>

<code class="kr">export</code> <code class="kr">default</code> <code class="nx">TaskList</code></pre>

<p class="author1">Then we can replace the <code class="calibre21">listitem</code> role in <code class="calibre21">Task</code> with a <code class="calibre21">li</code> tag:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="s">'./Task.css'</code>

<code class="kr">const</code> <code class="nx">Task</code> <code class="o">=</code> <code class="go">({</code> <code class="nx">task</code><code class="go">,</code> <code class="nx">onDelete</code><code class="go">,</code> <code class="nx">onEdit</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">li</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task"</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">div</code>
        <code class="na">className</code><code class="o">=</code><code class="s">"Task-contents"</code>
        <code class="na">...</code>
      <code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task-details"</code><code class="go">&gt;...&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task-controls"</code><code class="go">&gt;...&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
      <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">li</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code>

<code class="kr">export</code> <code class="kr">default</code> <code class="nx">Task</code></pre>

<p class="author1">Using <code class="calibre21">li</code> tags will mean that we have to make a few CSS style changes to remove the list bullet points, but the code will be easier
to read for any developer (and it may be you) who looks at it in the future.</p>

<p class="author1">Next, let’s take a look at the<a data-type="indexterm" data-primary="navigation" data-secondary="links looking like menu of options" id="idm46634389944440" class="calibre6"/><a data-type="indexterm" data-primary="roles" data-secondary="menu and menuitem" id="idm46634389943560" class="calibre6"/><a data-type="indexterm" data-primary="menus" data-secondary="menu and menuitem roles" id="idm46634389942616" class="calibre6"/> navigation section of the example application. It has a series of links that you might almost think
of as a menu of options:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">nav</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/contacts'</code><code class="go">&gt;</code><code class="nx">Contacts</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/events'</code><code class="go">&gt;</code><code class="nx">Events</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="nx">Tasks</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/notes'</code><code class="go">&gt;</code><code class="nx">Notes</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/time'</code><code class="go">&gt;</code><code class="nx">TimeRec</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/diary'</code><code class="go">&gt;</code><code class="nx">Diary</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/expenses'</code><code class="go">&gt;</code><code class="nx">Expenses</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;</code><code class="o">|&amp;</code><code class="nx">nbsp</code><code class="go">;</code>
    <code class="go">&lt;</code><code class="nt">a</code> <code class="na">href</code><code class="o">=</code><code class="s">'/invoices'</code><code class="go">&gt;</code><code class="nx">Invoices</code><code class="go">&lt;/</code><code class="nt">a</code><code class="go">&gt;</code>
<code class="go">&lt;/</code><code class="nt">nav</code><code class="go">&gt;</code></pre>

<p class="author1">So, should you apply the <code class="calibre21">menu</code> and <code class="calibre21">menuitem</code> roles here? The answer to this is: almost certainly <em class="calibre7">no</em>.</p>

<p class="author1">Menus and menu items have expected behavior. A user who arrives at a menu will probably expect it to pop up if they select it. <a data-type="indexterm" data-primary="menus" data-secondary="expected behavior of" id="idm46634389782456" class="calibre6"/>Once
the menu is visible, they will probably use the arrow keys to navigate the options rather than move around with the Tab
key.<sup class="calibre34"><a data-type="noteref" id="idm46634389781320-marker" href="ch09.xhtml#idm46634389781320" class="calibre35">1</a></sup></p>

<p class="author1">Now let’s take a look at the + button in our<a data-type="indexterm" data-primary="buttons" id="idm46634389779624" class="calibre6"/> example application that allows a user to create a new task by displaying a pop-up task
form (see <a data-type="xref" href="#ch09_image_6" class="calibre6">Figure 9-6</a>).</p>

<figure class="calibre29"><div id="ch09_image_6" class="figure">
<img src="Images/recb_0906.png" alt="" class="calibre158"/>
<h6 class="calibre30"><span class="firstname">Figure 9-6. </span>A new task form appears when the user clicks the <em class="calibre7">+</em> button</h6>
</div></figure>

<p class="author1">This is the code for the button:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">button</code> <code class="na">className</code><code class="o">=</code><code class="s">'addButton'</code>
    <code class="na">onClick</code><code class="o">=</code><code class="go">{()</code> <code class="o">=&gt;</code> <code class="nx">setFormOpen</code><code class="go">(</code><code class="kr">true</code><code class="go">)}&gt;</code><code class="o">+</code><code class="go">&lt;/</code><code class="nt">button</code><code class="go">&gt;</code></pre>

<p class="author1">Do we need to apply the <code class="calibre21">button</code> role? No. <a data-type="indexterm" data-primary="buttons" data-secondary="button role and" id="idm46634389767480" class="calibre6"/><a data-type="indexterm" data-primary="roles" data-secondary="button" id="idm46634389766600" class="calibre6"/>The element is already a button. But we can provide some additional information about
what the user can expect to happen if they click the button. A pop-up will appear. <a data-type="indexterm" data-primary="aria-haspopup attribute" id="idm46634389765336" class="calibre6"/><a data-type="indexterm" data-primary="pop-ups" data-secondary="aria-haspopup attribute" id="idm46634389764664" class="calibre6"/><a data-type="indexterm" data-primary="dialogs" data-secondary="aria-haspopup attribute set to dialog" id="idm46634389763720" class="calibre6"/>We can make that explicit in the HTML with the
<code class="calibre21">aria-haspopup</code> attribute:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">button</code> <code class="na">aria</code><code class="err">-</code><code class="na">haspopup</code><code class="o">=</code><code class="s">'dialog'</code> <code class="na">className</code><code class="o">=</code><code class="s">'addButton'</code>
    <code class="na">onClick</code><code class="o">=</code><code class="go">{()</code> <code class="o">=&gt;</code> <code class="nx">setFormOpen</code><code class="go">(</code><code class="kr">true</code><code class="go">)}&gt;</code><code class="o">+</code><code class="go">&lt;/</code><code class="nt">button</code><code class="go">&gt;</code></pre>
<div data-type="note" epub:type="note" class="calibre25">
<p class="author1">The value of the <code class="calibre21">aria-haspopup</code> attribute has to match the role of the component that will appear as a result.<a data-type="indexterm" data-primary="roles" data-secondary="aria-haspopup attribute matching roles of component that appears" id="idm46634389701128" class="calibre6"/> In this case,
we’re going to display a dialog. You can also set the <code class="calibre21">aria-haspopup</code> attribute to the value <code class="calibre21">true</code>. <a data-type="indexterm" data-primary="aria-haspopup attribute" data-secondary="set to true" id="idm46634389699256" class="calibre6"/><a data-type="indexterm" data-primary="menus" data-secondary="aria-haspopup seen as" id="idm46634389698248" class="calibre6"/>Still, a screen reader will
interpret this as a <code class="calibre21">menu</code> because components with associated pop-ups typically are used to open menus.<a data-type="indexterm" data-primary="screen readers" data-secondary="interpreting aria-haspopup as menu" id="idm46634389696792" class="calibre6"/><a data-type="indexterm" data-primary="pop-ups" data-secondary="usually associated with menus" id="idm46634389695848" class="calibre6"/></p>
</div>

<p class="author1">Because we’ve set <code class="calibre21">aria-haspopup</code> to <code class="calibre21">dialog</code>, we will <a data-type="indexterm" data-primary="roles" data-secondary="dialog" id="idm46634389669672" class="calibre6"/><a data-type="indexterm" data-primary="TaskForm" data-secondary="dialog role" id="idm46634389668664" class="calibre6"/>also need to make sure the <code class="calibre21">TaskForm</code> that appears has the role <code class="calibre21">dialog</code>.
This is the current code for the <code class="calibre21">TaskForm</code>:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">const</code> <code class="nx">TaskForm</code> <code class="o">=</code> <code class="go">({</code> <code class="nx">task</code><code class="go">,</code> <code class="nx">contexts</code><code class="go">,</code> <code class="nx">onCreate</code><code class="go">,</code> <code class="nx">onClose</code><code class="go">,</code> <code class="nx">open</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="go">...</code>

  <code class="kr">return</code> <code class="go">&lt;</code><code class="nt">Modal</code> <code class="na">open</code><code class="o">=</code><code class="go">{</code><code class="nx">open</code><code class="go">}</code> <code class="na">onCancel</code><code class="o">=</code><code class="go">{</code><code class="nx">close</code><code class="go">}&gt;</code>
    <code class="go">&lt;</code><code class="nt">form</code><code class="go">&gt;</code>
      <code class="go">....</code>
    <code class="go">&lt;/</code><code class="nt">form</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">ModalFooter</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">button</code> <code class="na">onClick</code><code class="o">=</code><code class="go">{...}&gt;</code><code class="nx">Cancel</code><code class="go">&lt;/</code><code class="nt">button</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">button</code> <code class="na">onClick</code><code class="o">=</code><code class="go">{...}&gt;</code><code class="nx">Save</code><code class="go">&lt;/</code><code class="nt">button</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">ModalFooter</code><code class="go">&gt;</code>
  <code class="go">&lt;/</code><code class="nt">Modal</code><code class="go">&gt;</code>
<code class="go">}</code></pre>

<p class="author1">We will wrap the <code class="calibre21">TaskForm</code> in a <code class="calibre21">Modal</code> component, like <a data-type="indexterm" data-primary="Modal component" id="idm46634389664232" class="calibre6"/>this:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="s">'./Modal.css'</code>

<code class="kr">function</code> <code class="nx">Modal</code><code class="go">({</code> <code class="nx">open</code><code class="go">,</code> <code class="nx">onCancel</code><code class="go">,</code> <code class="nx">children</code> <code class="go">})</code> <code class="go">{</code>
  <code class="kr">if</code> <code class="go">(</code><code class="o">!</code><code class="nx">open</code><code class="go">)</code> <code class="go">{</code>
    <code class="kr">return</code> <code class="kr">null</code>
  <code class="go">}</code>

  <code class="kr">return</code> <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">'Modal'</code>
        <code class="na">...</code>
  <code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">'Modal-dialog'</code>
       <code class="na">...</code>
    <code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
<code class="go">}</code>

<code class="kr">export</code> <code class="kr">default</code> <code class="nx">Modal</code></pre>

<p class="author1">There are two parts to this <code class="calibre21">Modal</code> component:</p>

<ul class="stafflist">
<li class="calibre8">
<p class="author1">An external <code class="calibre21">Modal</code> wrapper, which is there to shade the other content of the page and is a semi-transparent layer</p>
</li>
<li class="calibre8">
<p class="author1">An inner <code class="calibre21">Modal-dialog</code> <code class="calibre21">div</code>, which displays the contents in what looks like a window<a data-type="indexterm" data-primary="Modal-dialog div" id="idm46634389534152" class="calibre6"/></p>
</li>
</ul>

<p class="author1">Because the <code class="calibre21">Modal</code> class is reusable and might be used in things other than <em class="calibre7">dialogs</em> (such as <em class="calibre7">alerts</em>), we will <a data-type="indexterm" data-primary="titles" id="idm46634389477288" class="calibre6"/>give the <code class="calibre21">Modal</code>
class an additional <code class="calibre21">title</code> property, which will be applied to the <code class="calibre21">Modal-dialog</code>.<a data-type="indexterm" data-primary="Modal-dialog div" data-secondary="title property applied to" id="idm46634389475256" class="calibre6"/> The <code class="calibre21">title</code> will make the purpose of the dialog clear to <a data-type="indexterm" data-primary="screen readers" data-secondary="making clear purpose of dialog" id="idm46634389473672" class="calibre6"/>anyone with a
screen reader.</p>

<p class="author1">This gives us our updated <code class="calibre21">Modal</code> component:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="s">'./Modal.css'</code>

<code class="kr">function</code> <code class="nx">Modal</code><code class="go">({</code> <code class="nx">open</code><code class="go">,</code> <code class="nx">onCancel</code><code class="go">,</code> <code class="nx">children</code><code class="go">,</code> <code class="nx">role</code><code class="go">,</code> <code class="nx">title</code> <code class="go">})</code> <code class="go">{</code>
  <code class="kr">if</code> <code class="go">(</code><code class="o">!</code><code class="nx">open</code><code class="go">)</code> <code class="go">{</code>
    <code class="kr">return</code> <code class="kr">null</code>
  <code class="go">}</code>

  <code class="kr">return</code> <code class="go">&lt;</code><code class="nt">div</code> <code class="na">role</code><code class="o">=</code><code class="s">'presentation'</code> <code class="na">className</code><code class="o">=</code><code class="s">'Modal'</code>
        <code class="na">...</code>
  <code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">'Modal-dialog'</code>
       <code class="na">role</code><code class="o">=</code><code class="go">{</code><code class="nx">role</code><code class="go">}</code> <code class="na">title</code><code class="o">=</code><code class="go">{</code><code class="nx">title</code><code class="go">}</code>
       <code class="na">...</code>
    <code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
<code class="go">}</code>

<code class="kr">export</code> <code class="kr">default</code> <code class="nx">Modal</code></pre>

<p class="author1">Here is  <a data-type="indexterm" data-primary="TaskForm" data-secondary="updated component" id="idm46634389470216" class="calibre6"/>our updated <code class="calibre21">TaskForm</code> component:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">const</code> <code class="nx">TaskForm</code> <code class="o">=</code> <code class="go">({</code> <code class="nx">task</code><code class="go">,</code> <code class="nx">contexts</code><code class="go">,</code> <code class="nx">onCreate</code><code class="go">,</code> <code class="nx">onClose</code><code class="go">,</code> <code class="nx">open</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="go">...</code>

  <code class="kr">return</code> <code class="go">&lt;</code><code class="nt">Modal</code> <code class="na">title</code><code class="o">=</code><code class="s">'Create or edit a task'</code>
          <code class="na">role</code><code class="o">=</code><code class="s">'dialog'</code>
          <code class="na">open</code><code class="o">=</code><code class="go">{</code><code class="nx">open</code><code class="go">}</code> <code class="na">onCancel</code><code class="o">=</code><code class="go">{</code><code class="nx">close</code><code class="go">}&gt;</code>
    <code class="go">&lt;</code><code class="nt">form</code><code class="go">&gt;</code>
      <code class="go">....</code>
    <code class="go">&lt;/</code><code class="nt">form</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">ModalFooter</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">button</code> <code class="na">onClick</code><code class="o">=</code><code class="go">{...}&gt;</code><code class="nx">Cancel</code><code class="go">&lt;/</code><code class="nt">button</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">button</code> <code class="na">onClick</code><code class="o">=</code><code class="go">{...}&gt;</code><code class="nx">Save</code><code class="go">&lt;/</code><code class="nt">button</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">ModalFooter</code><code class="go">&gt;</code>
  <code class="go">&lt;/</code><code class="nt">Modal</code><code class="go">&gt;</code>
<code class="go">}</code></pre>

<p class="author1">Finally, let’s<a data-type="indexterm" data-primary="Delete button in TaskForm" id="idm46634389381656" class="calibre6"/> consider the Delete button that appears next to each <code class="calibre21">Task</code> and looks like a small trash can:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">img</code> <code class="na">src</code><code class="o">=</code><code class="go">{</code><code class="nx">DeleteIcon</code><code class="go">}</code>
   <code class="na">width</code><code class="o">=</code><code class="go">{</code><code class="mi">24</code><code class="go">}</code>
   <code class="na">height</code><code class="o">=</code><code class="go">{</code><code class="mi">24</code><code class="go">}</code>
   <code class="na">alt</code><code class="o">=</code><code class="s">'Delete icon'</code>
   <code class="na">aria</code><code class="err">-</code><code class="na">haspopup</code><code class="o">=</code><code class="s">'dialog'</code>
   <code class="na">role</code><code class="o">=</code><code class="s">'button'</code>
   <code class="na">title</code><code class="o">=</code><code class="s">'Delete'</code>
   <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">evt</code> <code class="o">=&gt;</code> <code class="go">{</code>
     <code class="nx">evt</code><code class="go">.</code><code class="nx">stopPropagation</code><code class="go">()</code>
     <code class="nx">evt</code><code class="go">.</code><code class="nx">preventDefault</code><code class="go">()</code>
     <code class="nx">onDelete</code><code class="go">()</code>
   <code class="go">}}</code>
<code class="go">/&gt;</code></pre>

<p class="author1">The trash can icon is working as a button, so we’ve given it that role.<a data-type="indexterm" data-primary="roles" data-secondary="button role for trash can icon" id="idm46634389136472" class="calibre6"/><a data-type="indexterm" data-primary="buttons" data-secondary="button role for trash can icon" id="idm46634389140840" class="calibre6"/> The trash can already has an <code class="calibre21">aria-haspopup</code> because a dialog will ask the user to confirm the 
<span class="firstname">deletion</span>.<a data-type="indexterm" data-primary="aria-haspopup attribute" data-secondary="trash can icon with" id="idm46634389138824" class="calibre6"/></p>

<p class="author1">But just like in the case of the lists and list items, it is often better to implement buttons as buttons.<a data-type="indexterm" data-primary="buttons" data-secondary="implementing as buttons" id="idm46634389137304" class="calibre6"/> We can rewrite this
component as a <code class="calibre21">button</code> wrapping an image:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">button</code>
  <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">evt</code> <code class="o">=&gt;</code> <code class="go">{</code>
    <code class="nx">evt</code><code class="go">.</code><code class="nx">stopPropagation</code><code class="go">()</code>
    <code class="nx">evt</code><code class="go">.</code><code class="nx">preventDefault</code><code class="go">()</code>
    <code class="nx">onDelete</code><code class="go">()</code>
  <code class="go">}}</code>
  <code class="na">title</code><code class="o">=</code><code class="s">'Delete'</code>
  <code class="na">aria</code><code class="err">-</code><code class="na">haspopup</code><code class="o">=</code><code class="s">'dialog'</code>
<code class="go">&gt;</code>
  <code class="go">&lt;</code><code class="nt">img</code> <code class="na">src</code><code class="o">=</code><code class="go">{</code><code class="nx">DeleteIcon</code><code class="go">}</code>
     <code class="na">width</code><code class="o">=</code><code class="go">{</code><code class="mi">24</code><code class="go">}</code>
     <code class="na">height</code><code class="o">=</code><code class="go">{</code><code class="mi">24</code><code class="go">}</code>
     <code class="na">alt</code><code class="o">=</code><code class="s">'Delete icon'</code>
  <code class="go">/&gt;</code>
<code class="go">&lt;/</code><code class="nt">button</code><code class="go">&gt;</code></pre>

<p class="author1">Not only will this be clearer to developers, but it will also be automatically tabbable.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Discussion" class="calibre4"><div class="preface" id="idm46634389227160">
<h2 class="calibre27">Discussion</h2>

<p class="author1">Roles overlap in some ways with landmarks.<a data-type="indexterm" data-primary="roles" data-secondary="versus landmarks" data-secondary-sortas="landmarks" id="idm46634390619016" class="calibre6"/><a data-type="indexterm" data-primary="landmarks" data-secondary="versus roles" data-secondary-sortas="roles" id="idm46634389096200" class="calibre6"/> There are landmark roles available, like <code class="calibre21">main</code> and <code class="calibre21">header</code>. But they serve two
different purposes. Landmarks are, as the name suggests, ways of highlighting major parts of a web page. Roles, in contrast, describe the intended behavior of some part of the interface. In both cases, landmarks and roles are there to provide
additional meaning to a web page.<a data-type="indexterm" data-primary="roles" data-startref="ix_role" id="idm46634389093704" class="calibre6"/></p>

<p class="author1">If your interface contains components that behave like standard HTML elements, such as lists, it is often better to style the
standard HTML markup than re-create the elements with custom code.</p>

<p class="author1">You can download the source for this recipe
from the <a href="https://oreil.ly/0GfgA" class="calibre6">GitHub site</a>.<a data-type="indexterm" data-primary="accessibility" data-secondary="applying roles, alts, and titles" data-startref="ix_acssRAT" id="idm46634389090968" class="calibre6"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Check Accessibility with ESlint" class="calibre4"><div class="preface" id="ch09-03">
<h1 class="calibre17">Check Accessibility with ESlint</h1>








<section data-type="sect2" data-pdf-bookmark="Problem" class="calibre4"><div class="preface" id="idm46634389088040">
<h2 class="calibre27">Problem</h2>

<p class="author1">If you don’t <a data-type="indexterm" data-primary="accessibility" data-secondary="checking with eslint" id="ix_acssckesl" class="calibre6"/><a data-type="indexterm" data-primary="eslint" data-secondary="checking accessibility with" id="ix_eslntckacss" class="calibre6"/>need to use any accessibility equipment, it can be challenging to identify accessibility problems.<sup class="calibre34"><a data-type="noteref" id="idm46634389084008-marker" href="ch09.xhtml#idm46634389084008" class="calibre35">2</a></sup> In the heat of development, it’s also easy to acquire regression issues that break the accessibility of code that
you’ve previously tested.</p>

<p class="author1">What you need is a way to quickly and easily find accessibility problems as you create them. You need a process that is continuously
watching your code as you type and flagging them immediately while you still remember what you did.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Solution" class="calibre4"><div class="preface" id="idm46634389082136">
<h2 class="calibre27">Solution</h2>

<p class="author1">We’re going to see how you can configure the <code class="calibre21">eslint</code> tool to find the more obvious accessibility problems in code.</p>

<p class="author1"><code class="calibre21">eslint</code> is a tool that performs static analysis on your code. It will find unused variables, missing dependencies in <code class="calibre21">useEffect</code>
calls, and so on. If you created your application with <code class="calibre21">create-react-app</code>, you probably have <code class="calibre21">eslint</code> running continuously on your
application. The development server will rerun <code class="calibre21">eslint</code> each time the code needs recompiling, and any <code class="calibre21">eslint</code> errors will appear
in the server window.</p>

<p class="author1">If you don’t already have <code class="calibre21">eslint</code> installed, you can install it with this command:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">$ npm install --save-dev eslint</code></pre>

<p class="author1">Or you can use its <code class="calibre21">yarn</code> equivalent.<a data-type="indexterm" data-primary="eslint" data-secondary="checking accessibility with" data-tertiary="extending eslint with plugins" id="idm46634389010456" class="calibre6"/> <code class="calibre21">eslint</code> can be extended with <em class="calibre7">plugins</em>. A plugin is a collection of rules that <code class="calibre21">eslint</code> will apply to
static code as it is saved. There is a plugin specifically created to check for accessibility problems.<a data-type="indexterm" data-primary="jsx-a11y plugin (eslint)" id="idm46634389072920" class="calibre6"/><a data-type="indexterm" data-primary="eslint" data-secondary="checking accessibility with" data-tertiary="jsx-a11y plugin" id="idm46634389072360" class="calibre6"/> It’s called jsx-a11y, and
you can install it with the following:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">$ npm install --save-dev eslint-plugin-jsx-a11y</code></pre>

<p class="author1">If you want to be able to run <code class="calibre21">eslint</code> manually, you can add a script to your <em class="calibre7">package.json</em> file:<sup class="calibre34"><a data-type="noteref" id="idm46634389065672-marker" href="ch09.xhtml#idm46634389065672" class="calibre35">3</a></sup></p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="s">"scripts"</code><code class="o">:</code> <code class="go">{</code>
  <code class="go">....</code>
  <code class="s">"lint"</code><code class="o">:</code> <code class="s">"eslint src"</code>
<code class="go">},</code></pre>

<p class="author1">Before we can use the jsx-a11y plugin, we will need to configure it.<a data-type="indexterm" data-primary="jsx-a11y plugin (eslint)" data-secondary="configuring" id="idm46634388991816" class="calibre6"/><a data-type="indexterm" data-primary="eslint" data-secondary="checking accessibility with" data-tertiary="configuring jsx-ally plugin" id="idm46634388990968" class="calibre6"/> We can do this by updating the <code class="calibre21">eslintConfig</code> section of
<em class="calibre7">package.json</em>:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="s">"eslintConfig"</code><code class="o">:</code> <code class="go">{</code>
  <code class="s">"extends"</code><code class="o">:</code> <code class="go">[</code>
    <code class="s">"react-app"</code>
    <code class="s">"react-app/jest"</code><code class="go">,</code>
    <code class="s">"plugin:jsx-a11y/recommended"</code>
  <code class="go">],</code>
  <code class="s">"plugins"</code><code class="o">:</code> <code class="go">[</code>
    <code class="s">"jsx-a11y"</code>
  <code class="go">],</code>
  <code class="s">"rules"</code><code class="o">:</code> <code class="go">{}</code>
<code class="go">}</code></pre>

<p class="author1">This configuration will tell <code class="calibre21">eslint</code> to use the new plugin, and it will also enable a set of recommended accessibility rules.<a data-type="indexterm" data-primary="rules" data-secondary="accessibility" data-tertiary="for jsx-ally eslint plugin" id="idm46634388933176" class="calibre6"/><a data-type="indexterm" data-primary="jsx-a11y plugin (eslint)" data-secondary="acccessibility rules" id="idm46634388932088" class="calibre6"/></p>

<p class="author1">You can also, if you choose, configure the way each of the rules works by adding additional configuration to the <code class="calibre21">rules</code> section.
And we’re going to do that now, by disabling one of the rules:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="s">"eslintConfig"</code><code class="o">:</code> <code class="go">{</code>
  <code class="s">"extends"</code><code class="o">:</code> <code class="go">[</code>
    <code class="s">"react-app"</code>
    <code class="s">"react-app/jest"</code><code class="go">,</code>
    <code class="s">"plugin:jsx-a11y/recommended"</code>
  <code class="go">],</code>
  <code class="s">"plugins"</code><code class="o">:</code> <code class="go">[</code>
    <code class="s">"jsx-a11y"</code>
  <code class="go">],</code>
  <code class="s">"rules"</code><code class="o">:</code> <code class="go">{</code>
    <code class="s">"jsx-a11y/no-onchange"</code><code class="o">:</code> <code class="s">"off"</code>
  <code class="go">}</code>
<code class="go">}</code></pre>

<p class="author1">Disabling rules might seem like a bad idea, but there is a reason why you might want to disable the <code class="calibre21">no-onchange</code> rule specifically.</p>

<p class="author1">The jsx-a11y developers created the <code class="calibre21">no-onchange</code> rule because of a problem with<a data-type="indexterm" data-primary="no-onchange rule (jsx-ally)" id="idm46634388884392" class="calibre6"/><a data-type="indexterm" data-primary="browsers" data-secondary="old, no-onchange rule in jsx-ally" id="idm46634388883864" class="calibre6"/> old browsers, which implemented <code class="calibre21">onchange</code> in
disparate ways. Some would generate an <code class="calibre21">onChange</code> event every time the user typed a character into an input field.<a data-type="indexterm" data-primary="onChange events" id="idm46634388881912" class="calibre6"/> Others would
generate the event only when the user left the field. The different behaviors caused a huge number of problems for people using
accessibility tools.</p>

<p class="author1">The solution was to replace all <code class="calibre21">onChange</code> handlers with <code class="calibre21">onBlur</code> handlers, which meant that <em class="calibre7">all</em> browsers would fire field change
events consistently: when the user left the field.<a data-type="indexterm" data-primary="onBlur event handlers" id="idm46634388879320" class="calibre6"/></p>

<p class="author1">But this rule is entirely out-of-date now and is deprecated in the plugin. If you try to replace all of the <code class="calibre21">onChange</code> handlers in
your React code with <code class="calibre21">onBlur</code> handlers, you will change significantly how your application works. You will also be going away from
the standard way React tracks the state of form fields: to use <code class="calibre21">onChange</code>.</p>

<p class="author1">So, in this <em class="calibre7">one</em> case, it is a good idea to disable the rule.</p>

<p class="author1">We can now run <code class="calibre21">eslint</code>, with our <a data-type="indexterm" data-primary="eslint" data-secondary="checking accessibility with" data-tertiary="running with rules enabled" id="idm46634388874808" class="calibre6"/><a data-type="indexterm" data-primary="rules" data-secondary="accessibility" data-tertiary="running eslint with rules enabled" id="idm46634388873448" class="calibre6"/>accessibility rules enabled:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">$ npm run lint</code></pre>

<p class="author1">In an earlier version of the application, <code class="calibre21">eslint</code> found<a data-type="indexterm" data-primary="errors" data-secondary="accessibility, found by eslint" id="idm46634388871416" class="calibre6"/> a number of errors:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">$ npm run lint</code>
<code class="go">&gt; app@0.1.0 lint app</code>
<code class="go">&gt; eslint src</code>
<code class="go">app/src/Task/Task.js</code>
<code class="go">  6:9  error  Visible, non-interactive elements with click handlers</code>
<code class="go">              must have at least one keyboard listener</code>
<code class="go">              jsx-a11y/click-events-have-key-events</code>
<code class="go">  6:9  error  Static HTML elements with event handlers require a role</code>
<code class="go">              jsx-a11y/no-static-element-interactions</code>
<code class="go">✖ 2 problems (2 errors, 0 warnings)</code></pre>

<p class="author1">To see what the cause of these errors, let’s take a look at the <em class="calibre7">Task.js</em> source code:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">li</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task"</code><code class="go">&gt;</code>
  <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task-contents"</code> <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">onEdit</code><code class="go">}&gt;</code>
    <code class="go">....</code>
  <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
<code class="go">&lt;/</code><code class="nt">li</code><code class="go">&gt;</code></pre>

<p class="author1">The <code class="calibre21">Task</code> component displays the details of a task inside a small card panel (see <a data-type="xref" href="#ch09_image_7" class="calibre6">Figure 9-7</a>).</p>

<figure class="calibre29"><div id="ch09_image_7" class="figure">
<img src="Images/recb_0907.png" alt="" class="calibre159"/>
<h6 class="calibre30"><span class="firstname">Figure 9-7. </span>The app displays tasks in separate panels, each with a delete button</h6>
</div></figure>

<p class="author1">If the user clicks a task, they will open a form that will allow them to edit the task’s details. The code that does this is the
<code class="calibre21">onClick</code> handler on the <code class="calibre21">Task-contents</code> <code class="calibre21">div</code>.</p>

<p class="author1">To understand why <code class="calibre21">eslint</code> is unhappy, let’s<a data-type="indexterm" data-primary="eslint" data-secondary="checking accessibility with" data-tertiary="errors found" id="idm46634388753768" class="calibre6"/> first look at this error:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">6:9  error  Static HTML elements with event handlers require a role</code>
<code class="go">            jsx-a11y/no-static-element-interactions</code></pre>

<p class="author1">Elements like
<code class="calibre21">div</code>s are <em class="calibre7">static</em>. They have no built-in interactive behavior. By default, they are just things that layout other things. <code class="calibre21">eslint</code>
is unhappy because the <code class="calibre21">onClick</code> handler suggests that this particular <code class="calibre21">div</code> is actually being used as an <em class="calibre7">active</em> 
<span class="firstname">component</span>. If
someone is using an accessibility device, we will need to tell them the purpose<a data-type="indexterm" data-primary="roles" data-secondary="lacking in eslint accessibility check" id="idm46634388737368" class="calibre6"/> of this component. <code class="calibre21">eslint</code> expects us to do that by
giving the <code class="calibre21">div</code> a <em class="calibre7">role</em>.<sup class="calibre34"><a data-type="noteref" id="idm46634388735016-marker" href="ch09.xhtml#idm46634388735016" class="calibre35">4</a></sup></p>

<p class="author1">We will give this <code class="calibre21">div</code> a role of <code class="calibre21">button</code> to indicate that the user will use the component by clicking it.<a data-type="indexterm" data-primary="buttons" data-secondary="button role and" id="idm46634388732456" class="calibre6"/> When we click a task,
we will display a pop-up edit window, so we will also give the <code class="calibre21">div</code> an <code class="calibre21">aria-haspopup</code> attribute<a data-type="indexterm" data-primary="aria-haspopup attribute" id="idm46634388745080" class="calibre6"/><a data-type="indexterm" data-primary="pop-ups" data-secondary="aria-haspopup attribute" id="idm46634388744344" class="calibre6"/><a data-type="indexterm" data-primary="dialogs" id="idm46634388743400" class="calibre6"/> to tell the user that clicking the
task will open a dialog:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">li</code> <code class="na">className</code><code class="o">=</code><code class="s">'Task'</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">'Task-contents'</code>
             <code class="na">role</code><code class="o">=</code><code class="s">'button'</code>
             <code class="na">aria</code><code class="err">-</code><code class="na">haspopup</code><code class="o">=</code><code class="s">'dialog'</code>
             <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">onEdit</code><code class="go">}</code>
        <code class="go">&gt;</code>
    <code class="go">....</code>
<code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
<code class="go">&lt;/</code><code class="nt">li</code><code class="go">&gt;</code></pre>
<div data-type="note" epub:type="note" class="calibre25">
<p class="author1">It is often better to convert an element to a native <code class="calibre21">button</code> tag rather than use the <code class="calibre21">button</code> role. However, in this case,
the <code class="calibre21">div</code> is wrapping a reasonably large block of HTML text, so it makes more sense to provide a role rather than deal with the
styling consequences of making a gray button look like a card.</p>
</div>

<p class="author1">If we run <code class="calibre21">eslint</code> again, we still have two errors. But one of them is new:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">$ npm run lint</code>
<code class="go">&gt; app@0.1.0 lint app</code>
<code class="go">&gt; eslint src</code>
<code class="go">app/src/Task/Task.js</code>
<code class="go">  6:9  error  Visible, non-interactive elements with click handlers</code>
<code class="go">              must have at least one keyboard listener</code>
<code class="go">              jsx-a11y/click-events-have-key-events</code>
<code class="go">  6:9  error  Elements with the 'button' interactive role must be tabbable</code>
<code class="go">              jsx-a11y/interactive-supports-focus</code>
<code class="go">✖ 2 problems (2 errors, 0 warnings)</code></pre>

<p class="author1">We’ve said that the task behaves like a button.<a data-type="indexterm" data-primary="rules" data-secondary="for roles" data-secondary-sortas="roles" id="idm46634388654824" class="calibre6"/><a data-type="indexterm" data-primary="roles" data-secondary="rules for" id="idm46634388653736" class="calibre6"/> But: roles have rules. If we want something to be treated like a button, it must
behave like a button.<a data-type="indexterm" data-primary="buttons" data-secondary="tabbed to" id="idm46634388652552" class="calibre6"/><a data-type="indexterm" data-primary="keyboard" data-secondary="tabbing to buttons with" id="idm46634388651608" class="calibre6"/><a data-type="indexterm" data-primary="tabIndex attribute" id="idm46634388650664" class="calibre6"/> One thing that buttons can do is be <em class="calibre7">tabbed</em> to. They need to be able to receive focus from the keyboard.<a data-type="indexterm" data-primary="focus" data-secondary="buttons receiving from keyboard" id="idm46634388595800" class="calibre6"/> We
can do that by adding a <code class="calibre21">tabIndex</code> attribute:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">li</code> <code class="na">className</code><code class="o">=</code><code class="s">'Task'</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">'Task-contents'</code>
             <code class="na">role</code><code class="o">=</code><code class="s">'button'</code>
             <code class="na">tabIndex</code><code class="o">=</code><code class="go">{</code><code class="mi">0</code><code class="go">}</code>
             <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">onEdit</code><code class="go">}</code>
        <code class="go">&gt;</code>
    <code class="go">....</code>
<code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
<code class="go">&lt;/</code><code class="nt">li</code><code class="go">&gt;</code></pre>

<p class="author1">Setting <code class="calibre21">tabIndex</code> to <code class="calibre21">0</code> means that our task will become part of the tab sequence of the page.</p>
<div data-type="note" epub:type="note" class="calibre25">
<p class="author1"><code class="calibre21">tabIndex</code> can have several values: –1 means that it can be focused programmatically only; 0 means that it is an ordinary
tabbable component. If an element has a tabbable value greater than 0, it means the focus system should give it a higher priority.
It would be best if you generally avoided values greater than 0, as they can cause accessibility problems.<sup class="calibre41"><a data-type="noteref" id="idm46634388558776-marker" href="ch09.xhtml#idm46634388558776" class="calibre35">5</a></sup></p>
</div>

<p class="author1">If we run <code class="calibre21">eslint</code> again, we have just one error:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">$ npm run lint</code>
<code class="go">&gt; app@0.1.0 lint app</code>
<code class="go">&gt; eslint src</code>
<code class="go">app/src/Task/Task.js</code>
<code class="go">  6:9  error  Visible, non-interactive elements with click handlers</code>
<code class="go">              must have at least one keyboard listener</code>
<code class="go">              jsx-a11y/click-events-have-key-events</code>
<code class="go">1 problems (1 errors, 0 warnings)</code></pre>

<p class="author1">This error means that we have an <code class="calibre21">onClick</code> event to say what happens if someone clicks the task with a mouse, but we have no code to
respond to the keyboard.<a data-type="indexterm" data-primary="click events having no keyboard response" id="idm46634388489304" class="calibre6"/><a data-type="indexterm" data-primary="keyboard" data-secondary="click events handler" id="idm46634388488696" class="calibre6"/> If someone is unable to use the mouse, they will be unable to edit a task.</p>

<p class="author1">So we will need to add some sort of key-event handler. We’ll add code to call the edit event if the user presses the Enter key or
presses the spacebar:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">li</code> <code class="na">className</code><code class="o">=</code><code class="s">"Task"</code><code class="go">&gt;</code>
  <code class="go">&lt;</code><code class="nt">div</code>
    <code class="na">className</code><code class="o">=</code><code class="s">"Task-contents"</code>
    <code class="na">role</code><code class="o">=</code><code class="s">"button"</code>
    <code class="na">tabIndex</code><code class="o">=</code><code class="go">{</code><code class="mi">0</code><code class="go">}</code>
    <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">onEdit</code><code class="go">}</code>
    <code class="na">onKeyDown</code><code class="o">=</code><code class="go">{(</code><code class="nx">evt</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
      <code class="kr">if</code> <code class="go">(</code><code class="nx">evt</code><code class="go">.</code><code class="nx">key</code> <code class="o">===</code> <code class="s">'Enter'</code> <code class="o">||</code> <code class="nx">evt</code><code class="go">.</code><code class="nx">key</code> <code class="o">===</code> <code class="s">' '</code><code class="go">)</code> <code class="go">{</code>
        <code class="nx">evt</code><code class="go">.</code><code class="nx">preventDefault</code><code class="go">()</code>
        <code class="nx">onEdit</code><code class="go">()</code>
      <code class="go">}</code>
    <code class="go">}}</code>
  <code class="go">&gt;</code>
    <code class="go">....</code>
  <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
<code class="go">&lt;/</code><code class="nt">li</code><code class="go">&gt;</code></pre>

<p class="author1">Adding the keyboard handler will fix the remaining error.</p>
<div data-type="tip" class="calibre25">
<p class="author1">Each of the rules in jsx-a11y has an associated <a href="https://oreil.ly/uo7Ry" class="calibre6">page on GitHub</a>, providing more details about why code might break a rule and what you can do to fix it.</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Discussion" class="calibre4"><div class="preface" id="idm46634389080552">
<h2 class="calibre27">Discussion</h2>

<p class="author1">jsx-a11y is probably one of the most useful plugins available for <code class="calibre21">eslint</code>. Often, lint rules will check for good programming
practice and can find a few coding issues.<a data-type="indexterm" data-primary="jsx-a11y plugin (eslint)" data-secondary="benefits of" id="idm46634388411960" class="calibre6"/> But the jsx-a11y plugin can genuinely change the design of your application.</p>

<p class="author1">Making sure your application allows keyboard navigation<a data-type="indexterm" data-primary="navigation" data-secondary="keyboard, importance of" id="idm46634388410504" class="calibre6"/><a data-type="indexterm" data-primary="keyboard" data-secondary="importance of keyboard navigation" id="idm46634388409528" class="calibre6"/> is important not only for people using accessibility tools, but it’s also useful
for people who might use your application frequently. If someone uses an application for a long time, they will often prefer to use
a keyboard instead of a mouse because a keyboard requires less movement and is more precise.</p>

<p class="author1">We’ve also looked at how setting <code class="calibre21">tabIndex</code> can give elements keyboard focus. Some browsers—notably Firefox—provide subtle
indicators to show which elements have keyboard focus.<a data-type="indexterm" data-primary="focus" data-secondary="making clear to users where it is" id="idm46634388407208" class="calibre6"/> If you want to make it clear to users where the focus currently is, consider
adding some top-level <a data-type="indexterm" data-primary="CSS" data-secondary="focus-visible style" id="idm46634388406024" class="calibre6"/>CSS to your application:</p>

<pre data-type="programlisting" data-code-language="css" class="calibre28"><code class="nd">:focus-visible</code> <code class="go">{</code>
    <code class="kr">outline</code><code class="o">:</code> <code class="mi">2px</code> <code class="nb">solid</code> <code class="nb">blue</code><code class="go">;</code>
<code class="go">}</code></pre>

<p class="author1">This style rule will add a discernible outline to any component with keyboard focus. Some users will be more likely to choose
keyboard navigation once they can see it is available.</p>

<p class="author1">You can download the source for this recipe
from the <a href="https://oreil.ly/0GfgA" class="calibre6">GitHub site</a>.<a data-type="indexterm" data-primary="accessibility" data-secondary="checking with eslint" data-startref="ix_acssckesl" id="idm46634388347560" class="calibre6"/><a data-type="indexterm" data-primary="eslint" data-secondary="checking accessibility with" data-startref="ix_eslntckacss" id="idm46634388399512" class="calibre6"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Use Axe DevTools at Runtime" class="calibre4"><div class="preface" id="ch09-04">
<h1 class="calibre17">Use Axe DevTools at Runtime</h1>








<section data-type="sect2" data-pdf-bookmark="Problem" class="calibre4"><div class="preface" id="idm46634388396776">
<h2 class="calibre27">Problem</h2>

<p class="author1">Static code analysis tools, like <code class="calibre21">eslint</code>, can be used to uncover many accessibility problems.<a data-type="indexterm" data-primary="browsers" data-secondary="axe DevTools plugin, accessibility checks with" id="ix_brwsrADT" class="calibre6"/><a data-type="indexterm" data-primary="accessibility" data-secondary="using axe DevTools at runtime" id="ix_acssADT" class="calibre6"/><a data-type="indexterm" data-primary="axe DevTools, checking accessibility at runtime" id="ix_axeDT" class="calibre6"/> But static analysis is limited. It will
often miss errors that occur at runtime.</p>

<p class="author1">Code might dynamically behave in a way that a static analysis tool could not predict. We need to check the accessibility of an
application when it is up and running in a web browser.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Solution" class="calibre4"><div class="preface" id="idm46634388387928">
<h2 class="calibre27">Solution</h2>

<p class="author1">We’re going to install the axe DevTools plugin. This is available for both <a href="https://oreil.ly/S1TcB" class="calibre6">Firefox</a> and <a href="https://oreil.ly/MhiK0" class="calibre6">Chrome</a>.</p>

<p class="author1">Once it’s installed, you will have an additional tab in the browser’s developer console (see <a data-type="xref" href="#ch09_image_8" class="calibre6">Figure 9-8</a>).</p>

<figure class="calibre29"><div id="ch09_image_8" class="figure">
<img src="Images/recb_0908.png" alt="" class="calibre160"/>
<h6 class="calibre30"><span class="firstname">Figure 9-8. </span>The axe DevTools in the developer console</h6>
</div></figure>

<p class="author1">To see how it works, let’s mess up some of the code in the example task application we are using throughout this chapter.</p>

<p class="author1">The application includes a pop-up <code class="calibre21">TaskForm</code> component.<a data-type="indexterm" data-primary="TaskForm" data-secondary="runtime accessibility check with axe DevTools" id="idm46634388379752" class="calibre6"/><a data-type="indexterm" data-primary="dialogs" data-secondary="accessibility errors found with axe DevTools" id="idm46634388378648" class="calibre6"/> This component has been given a <code class="calibre21">dialog</code> role, but we can modify it to have
some invalid value:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">const</code> <code class="nx">TaskForm</code> <code class="o">=</code> <code class="go">({</code> <code class="nx">task</code><code class="go">,</code> <code class="nx">contexts</code><code class="go">,</code> <code class="nx">onCreate</code><code class="go">,</code> <code class="nx">onClose</code><code class="go">,</code> <code class="nx">open</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="go">...</code>
  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">Modal</code>
      <code class="na">title</code><code class="o">=</code><code class="s">"Create or edit a task"</code>
      <code class="na">role</code><code class="o">=</code><code class="s">"fish"</code>
      <code class="na">open</code><code class="o">=</code><code class="go">{</code><code class="nx">open</code><code class="go">}</code>
      <code class="na">onCancel</code><code class="o">=</code><code class="go">{</code><code class="nx">close</code><code class="go">}</code>
    <code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">form</code><code class="go">&gt;...&lt;/</code><code class="nt">form</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">ModalFooter</code><code class="go">&gt;...&lt;/</code><code class="nt">ModalFooter</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">Modal</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">If you open <em class="calibre7">http://localhost:3000</em> and click the button to create a task, you will see the task form (see <a data-type="xref" href="#ch09_image_9" class="calibre6">Figure 9-9</a>).</p>

<figure class="calibre29"><div id="ch09_image_9" class="figure">
<img src="Images/recb_0906.png" alt="" class="calibre158"/>
<h6 class="calibre30"><span class="firstname">Figure 9-9. </span>The new task form appears when you press the <em class="calibre7">+</em> button</h6>
</div></figure>

<p class="author1">If we now open the developer tools window in the browser, switch to the axe DevTools tab, and run an audit on the page, you will see
two errors (see <a data-type="xref" href="#ch09_image_10" class="calibre6">Figure 9-10</a>).</p>

<figure class="calibre29"><div id="ch09_image_10" class="figure">
<img src="Images/recb_0910.png" alt="" class="calibre161"/>
<h6 class="calibre30"><span class="firstname">Figure 9-10. </span>Setting an invalid value in the modal causes two errors</h6>
</div></figure>

<p class="author1">There are <a data-type="indexterm" data-primary="roles" id="idm46634388269992" class="calibre6"/>two errors because, first, the dialog does not contain a valid <em class="calibre7">role</em>. Second, the modal no longer has a <code class="calibre21">dialog</code> role,
which means it no longer acts as a landmark. Some roles, such as <code class="calibre21">dialog</code>, mark an element as a vital landmark element within the
page. Every part of the application must appear inside a landmark.</p>

<p class="author1">If you reset the code and refresh the DevTools audit, the errors will disappear.</p>

<p class="author1">You could imagine that some future static code analysis might include a scan of all code that checks for invalid <code class="calibre21">role</code>
values.<sup class="calibre34"><a data-type="noteref" id="idm46634388266296-marker" href="ch09.xhtml#idm46634388266296" class="calibre35">6</a></sup> However, DevTools can also check for other, more subtle
problems.</p>

<p class="author1">In the example application, edit the <em class="calibre7">App.css</em> file, and add some code to change the color <a data-type="indexterm" data-primary="headings" data-secondary="color contrast accessibility error in" id="idm46634388264712" class="calibre6"/>of the main heading:</p>

<pre data-type="programlisting" data-code-language="css" class="calibre28"><code class="nt">h1</code> <code class="go">{</code>
    <code class="kr">color</code><code class="o">:</code> <code class="mi">#9e9e9e</code><code class="go">;</code>
<code class="go">}</code></pre>

<figure class="calibre29"><div id="ch09_image_11" class="figure">
<img src="Images/recb_0911.png" alt="" class="calibre162"/>
<h6 class="calibre30"><span class="firstname">Figure 9-11. </span>The result of changing the color of the first-level heading</h6>
</div></figure>

<p class="author1">The result <a data-type="indexterm" data-primary="contrast errors (accessibility)" id="idm46634393140824" class="calibre6"/>doesn’t appear to be too drastic (see <a data-type="xref" href="#ch09_image_11" class="calibre6">Figure 9-11</a>), but it does cause DevTools to display this error:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">Elements must have sufficient color contrast</code>

<code class="go">Fix the following:</code>
<code class="go">Element has insufficient color contrast of 2.67 (foreground color: #9e9e9e,</code>
<code class="go">background color: #ffffff, font size: 24.0pt (32px), font weight: bold).</code>
<code class="go">Expected contrast ratio of 3:1</code></pre>

<p class="author1">The Chrome browser makes it relatively easy to fix contrast errors from within the developer console. If you inspect the <code class="calibre21">h1</code>
heading, examine the <code class="calibre21">color</code> style of the element, and then click the small color panel, you will see the contrast problem
reported in <a data-type="xref" href="#ch09_image_12" class="calibre6">Figure 9-12</a>.</p>

<figure class="calibre29"><div id="ch09_image_12" class="figure">
<img src="Images/recb_0912.png" alt="" class="calibre163"/>
<h6 class="calibre30"><span class="firstname">Figure 9-12. </span>View the contrast by clicking the small gray square in the color property</h6>
</div></figure>

<p class="author1">If you now open the Contrast section, you can adjust the color to meet both AA and AAA accessibility standards for contrast (see
<a data-type="xref" href="#ch09_image_13" class="calibre6">Figure 9-13</a>).</p>

<figure class="calibre29"><div id="ch09_image_13" class="figure">
<img src="Images/recb_0913.png" alt="" class="calibre164"/>
<h6 class="calibre30"><span class="firstname">Figure 9-13. </span>Open the contrast ratio to adjust the color to meet accessibility standards</h6>
</div></figure>

<p class="author1">Chrome suggests changing the color from <code class="calibre21">#949494</code> to <code class="calibre21">#767676</code>. The difference is not hugely noticeable for most people but will be
significantly easier to read for the users who are less sensitive to contrast (see <a data-type="xref" href="#ch09_image_14" class="calibre6">Figure 9-14</a>).</p>

<figure class="calibre29"><div id="ch09_image_14" class="figure">
<img src="Images/recb_0914.png" alt="" class="calibre162"/>
<h6 class="calibre30"><span class="firstname">Figure 9-14. </span>The result of changing the contrast to meet the AAA standard</h6>
</div></figure>
<div data-type="warning" epub:type="warning" class="calibre26">
<p class="author1">Sometimes, Chrome will not display the contrast information if it cannot identify a specific background color. You can
avoid this problem by temporarily assigning a <code class="calibre21">backgroundColor</code> to the element you are checking.<a data-type="indexterm" data-primary="backgroundColor for elements" id="idm46634388172968" class="calibre6"/></p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Discussion" class="calibre4"><div class="preface" id="idm46634388386984">
<h2 class="calibre27">Discussion</h2>

<p class="author1">The axe DevTools extension is straightforward to use and can find many issues that a static analysis tool will miss.</p>

<p class="author1">It does rely on the developer manually checking for errors, but we will see in the next chapter that there are ways of automating
browser-based accessibility tests.</p>

<p class="author1">You can download the source for this recipe from the <a href="https://oreil.ly/0GfgA" class="calibre6">GitHub site</a>.<a data-type="indexterm" data-primary="browsers" data-secondary="axe DevTools plugin, accessibility checks with" data-startref="ix_brwsrADT" id="idm46634388169384" class="calibre6"/><a data-type="indexterm" data-primary="axe DevTools, checking accessibility at runtime" data-startref="ix_axeDT" id="idm46634388168008" class="calibre6"/><a data-type="indexterm" data-primary="accessibility" data-secondary="using axe DevTools at runtime" data-startref="ix_acssADT" id="idm46634388167032" class="calibre6"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Automate Browser Testing with Cypress Axe" class="calibre4"><div class="preface" id="ch09-05">
<h1 class="calibre17">Automate Browser Testing with Cypress Axe</h1>








<section data-type="sect2" data-pdf-bookmark="Problem" class="calibre4"><div class="preface" id="idm46634388164168">
<h2 class="calibre27">Problem</h2>

<p class="author1">The previous recipe made clear that some accessibility problems appear only at runtime in a real web browser and so can’t be found
with static analysis.<a data-type="indexterm" data-primary="accessibility" data-secondary="browser testing automation with cypress-axe" id="ix_accssBTACA" class="calibre6"/><a data-type="indexterm" data-primary="browsers" data-secondary="automating accessibility testing with cypress-axe" id="ix_brwsrautoACA" class="calibre6"/><a data-type="indexterm" data-primary="Cypress" data-secondary="cypress-axe plugin, automating browser testing with" id="ix_Cypraxe" class="calibre6"/></p>

<p class="author1">If we rely on manual browser testing, we will likely acquire regression issues. It would be much better to automate the kinds of
manual checks that tools like axe DevTools allow us to perform inside a browser.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Solution" class="calibre4"><div class="preface" id="idm46634388141640">
<h2 class="calibre27">Solution</h2>

<p class="author1">We will examine how to automate browser accessibility testing with a plugin for the Cypress testing framework called <code class="calibre21">cypress-axe</code>.
The <code class="calibre21">cypress-axe</code> plugin uses the same <code class="calibre21">axe-core</code> library <a data-type="indexterm" data-primary="axe-core library" id="idm46634388137992" class="calibre6"/>as axe DevTools. Still, because we can use <code class="calibre21">cypress-axe</code> in browser-level tests,
we can automate the auditing process so that an integration server can instantly find regression errors.</p>

<p class="author1">We will need to have Cypress and the <code class="calibre21">axe-core</code> library installed in our application:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">$ npm install --save-dev cypress axe-core</code></pre>

<p class="author1">We can then install the <code class="calibre21">cypress-axe</code> extension:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">$ npm install --save-dev cypress-axe</code></pre>

<p class="author1">If this is the first time you’ve installed Cypress, you will need to run the Cypress application, which will create the appropriate
directories and initial code that you can use as the basis of your tests. You can start Cypress with this command:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">$ npx cypress open</code></pre>

<p class="author1">We’ll need to configure the <code class="calibre21">cypress-axe</code> plugin.<a data-type="indexterm" data-primary="Cypress" data-secondary="cypress-axe plugin, automating browser testing with" data-tertiary="configuring cypress-axe" id="idm46634388069368" class="calibre6"/> Edit the <em class="calibre7">cypress/support/index.js</em> file, and add this line of code:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="s">'cypress-axe'</code></pre>

<p class="author1">We will also need to add a couple of hooks that will allow us to record errors during a test run. We can do this by editing the
<em class="calibre7">cypress/plugins/index.js</em> file and adding this code:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="nx">module</code><code class="go">.</code><code class="nx">exports</code> <code class="o">=</code> <code class="go">(</code><code class="nx">on</code><code class="go">,</code> <code class="nx">config</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="nx">on</code><code class="go">(</code><code class="s">'task'</code><code class="go">,</code> <code class="go">{</code>
    <code class="nx">log</code><code class="go">(</code><code class="nx">message</code><code class="go">)</code> <code class="go">{</code>
      <code class="nx">console</code><code class="go">.</code><code class="nx">log</code><code class="go">(</code><code class="nx">message</code><code class="go">)</code>
      <code class="kr">return</code> <code class="kr">null</code>
    <code class="go">},</code>
    <code class="nx">table</code><code class="go">(</code><code class="nx">message</code><code class="go">)</code> <code class="go">{</code>
      <code class="nx">console</code><code class="go">.</code><code class="nx">table</code><code class="go">(</code><code class="nx">message</code><code class="go">)</code>
      <code class="kr">return</code> <code class="kr">null</code>
    <code class="go">},</code>
  <code class="go">})</code>
<code class="go">}</code></pre>

<p class="author1">You can then remove all of the example tests from the <em class="calibre7">cypress/integration</em> directory and create a new file called
<em class="calibre7">cypress/integration/accessibility.js</em>:<sup class="calibre34"><a data-type="noteref" id="idm46634387988088-marker" href="ch09.xhtml#idm46634387988088" class="calibre35">7</a></sup></p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">function</code> <code class="nx">terminalLog</code><code class="go">(</code><code class="nx">violations</code><code class="go">)</code> <code class="go">{</code>
  <code class="nx">cy</code><code class="go">.</code><code class="nx">task</code><code class="go">(</code>
    <code class="s">'log'</code><code class="go">,</code>
    <code class="err">`</code><code class="nx">$</code><code class="go">{</code><code class="nx">violations</code><code class="go">.</code><code class="nx">length</code><code class="go">}</code> <code class="nx">accessibility</code> <code class="nx">violation$</code><code class="go">{</code>
      <code class="nx">violations</code><code class="go">.</code><code class="nx">length</code> <code class="o">===</code> <code class="mi">1</code> <code class="o">?</code> <code class="s">''</code> <code class="o">:</code> <code class="s">'s'</code>
    <code class="go">}</code> <code class="nx">$</code><code class="go">{</code><code class="nx">violations</code><code class="go">.</code><code class="nx">length</code> <code class="o">===</code> <code class="mi">1</code> <code class="o">?</code> <code class="s">'was'</code> <code class="o">:</code> <code class="s">'were'</code><code class="go">}</code> <code class="nx">detected</code><code class="err">`</code>
  <code class="go">)</code>
  <code class="kr">const</code> <code class="nx">violationData</code> <code class="o">=</code> <code class="nx">violations</code><code class="go">.</code><code class="nx">map</code><code class="go">(</code>
    <code class="go">({</code> <code class="nx">id</code><code class="go">,</code> <code class="nx">impact</code><code class="go">,</code> <code class="nx">description</code><code class="go">,</code> <code class="nx">nodes</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">({</code>
      <code class="nx">id</code><code class="go">,</code>
      <code class="nx">impact</code><code class="go">,</code>
      <code class="nx">description</code><code class="go">,</code>
      <code class="nx">nodes</code><code class="o">:</code> <code class="nx">nodes</code><code class="go">.</code><code class="nx">length</code><code class="go">,</code>
    <code class="go">})</code>
  <code class="go">)</code>

  <code class="nx">cy</code><code class="go">.</code><code class="nx">task</code><code class="go">(</code><code class="s">'table'</code><code class="go">,</code> <code class="nx">violationData</code><code class="go">)</code>
  <code class="nx">console</code><code class="go">.</code><code class="nx">table</code><code class="go">(</code><code class="nx">violationData</code><code class="go">)</code>
<code class="go">}</code>

<code class="nx">describe</code><code class="go">(</code><code class="s">'can be used'</code><code class="go">,</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="nx">it</code><code class="go">(</code><code class="s">'should be accessible when starting'</code><code class="go">,</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
    <code class="nx">cy</code><code class="go">.</code><code class="nx">visit</code><code class="go">(</code><code class="s">'/'</code><code class="go">)</code>
    <code class="nx">cy</code><code class="go">.</code><code class="nx">injectAxe</code><code class="go">()</code>
    <code class="nx">cy</code><code class="go">.</code><code class="nx">checkA11y</code><code class="go">(</code><code class="kr">null</code><code class="go">,</code> <code class="kr">null</code><code class="go">,</code> <code class="nx">terminalLog</code><code class="go">)</code>
  <code class="go">})</code>
<code class="go">})</code></pre>

<p class="author1">This is based on the <a href="https://oreil.ly/2Exyx" class="calibre6">example code</a> from the <code class="calibre21">cypress-axe</code> repository.</p>

<p class="author1">The test is inside the <code class="calibre21">describe</code> function. The <code class="calibre21">terminalLog</code> function is used to report errors.</p>

<p class="author1">The test has this structure:</p>
<ol class="calibre116">
<li class="calibre8">
<p class="author1">Opens the page at <em class="calibre7">/</em>.</p>
</li>
<li class="calibre8">
<p class="author1">Injects the <code class="calibre21">axe-core</code> library into the page</p>
</li>
<li class="calibre8">
<p class="author1">Runs an audit of the page</p>
</li>

</ol>

<p class="author1">The <code class="calibre21">axe-core</code> library doing most of the work is the same library used by other tools, such as the axe DevTools browser extension.
The <code class="calibre21">axe-core</code> library will examine the current DOM and check it against its rule base.<a data-type="indexterm" data-primary="DOM" data-secondary="checking against rules by axe-core library in cypress-axe" id="idm46634387801720" class="calibre6"/> It will then report
any failures it finds.</p>

<p class="author1">The <code class="calibre21">cypress-axe</code> plugin injects the axe-core library into the browser and uses the <code class="calibre21">checkA11y</code> command to run an audit. It sends the
issues to the <code class="calibre21">terminalLog</code> function.</p>

<p class="author1">If you run this test in Cypress, by double-clicking <em class="calibre7">accessibility.js</em>, it will pass (see <a data-type="xref" href="#ch09_image_15" class="calibre6">Figure 9-15</a>).</p>

<p class="author1">So, let’s create a problem. Let’s add a second test:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="nx">it</code><code class="go">(</code><code class="s">'should be accessible when creating a task'</code><code class="go">,</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="nx">cy</code><code class="go">.</code><code class="nx">visit</code><code class="go">(</code><code class="s">'/'</code><code class="go">)</code>
  <code class="nx">cy</code><code class="go">.</code><code class="nx">injectAxe</code><code class="go">()</code>
  <code class="nx">cy</code><code class="go">.</code><code class="nx">contains</code><code class="go">(</code><code class="s">'+'</code><code class="go">).</code><code class="nx">click</code><code class="go">()</code>
  <code class="nx">cy</code><code class="go">.</code><code class="nx">checkA11y</code><code class="go">(</code><code class="kr">null</code><code class="go">,</code> <code class="kr">null</code><code class="go">,</code> <code class="nx">terminalLog</code><code class="go">)</code>
<code class="go">})</code></pre>

<figure class="calibre29"><div id="ch09_image_15" class="figure">
<img src="Images/recb_0915.png" alt="" class="calibre165"/>
<h6 class="calibre30"><span class="firstname">Figure 9-15. </span>The code passing the accessibility test</h6>
</div></figure>

<p class="author1">The test opens the application, clicks the + button to open the form to create a task, and then performs an audit.</p>

<p class="author1">In its current form, the application will also pass this test. So, let’s modify the <code class="calibre21">TaskForm</code> in the example <a data-type="indexterm" data-primary="TaskForm" data-secondary="accessibility checking with cypress-axe" id="idm46634387761800" class="calibre6"/>application to have an
invalid <code class="calibre21">role</code> value:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">const</code> <code class="nx">TaskForm</code> <code class="o">=</code> <code class="go">({</code> <code class="nx">task</code><code class="go">,</code> <code class="nx">contexts</code><code class="go">,</code> <code class="nx">onCreate</code><code class="go">,</code> <code class="nx">onClose</code><code class="go">,</code> <code class="nx">open</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="go">...</code>
  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">Modal</code>
      <code class="na">title</code><code class="o">=</code><code class="s">"Create or edit a task"</code>
      <code class="na">role</code><code class="o">=</code><code class="s">"hatstand"</code>
      <code class="na">open</code><code class="o">=</code><code class="go">{</code><code class="nx">open</code><code class="go">}</code>
      <code class="na">onCancel</code><code class="o">=</code><code class="go">{</code><code class="nx">close</code><code class="go">}</code>
    <code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">form</code><code class="go">&gt;...&lt;/</code><code class="nt">form</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">ModalFooter</code><code class="go">&gt;...&lt;/</code><code class="nt">ModalFooter</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">Modal</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">If you rerun the test, it will now fail. You need to run the test with the JavaScript console open (see <a data-type="xref" href="#ch09_image_16" class="calibre6">Figure 9-16</a>) to see the
failure inside a console table.</p>

<figure class="calibre29"><div id="ch09_image_16" class="figure">
<img src="Images/recb_0916.png" alt="" class="calibre166"/>
<h6 class="calibre30"><span class="firstname">Figure 9-16. </span>You will find the details of failures if the console is open during the test</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Discussion" class="calibre4"><div class="preface" id="idm46634388140696">
<h2 class="calibre27">Discussion</h2>

<p class="author1">For a great introduction to accessibility audits and cypress-axe testing, see <a href="https://oreil.ly/nS6R2" class="calibre6">Marcy Sutton’s talk</a> at the ReactJS Girls Conference. The talk first introduced us to the plugin, and we’ve been using it ever since.</p>

<p class="author1">You can download the source for this recipe from the <a href="https://oreil.ly/0GfgA" class="calibre6">GitHub site</a>.<a data-type="indexterm" data-primary="accessibility" data-secondary="browser testing automation with cypress-axe" data-startref="ix_accssBTACA" id="idm46634387637608" class="calibre6"/><a data-type="indexterm" data-primary="browsers" data-secondary="automating accessibility testing with cypress-axe" data-startref="ix_brwsrautoACA" id="idm46634387636232" class="calibre6"/><a data-type="indexterm" data-primary="Cypress" data-secondary="cypress-axe plugin, automating browser testing with" data-startref="ix_Cypraxe" id="idm46634387634984" class="calibre6"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Add Skip Buttons" class="calibre4"><div class="preface" id="ch09-06">
<h1 class="calibre17">Add Skip Buttons</h1>








<section data-type="sect2" data-pdf-bookmark="Problem" class="calibre4"><div class="preface" id="idm46634387632056">
<h2 class="calibre27">Problem</h2>

<p class="author1">Pages often have a bunch of content right at the start.<a data-type="indexterm" data-primary="buttons" data-secondary="adding skip buttons for accessibility" id="ix_btnskp" class="calibre6"/><a data-type="indexterm" data-primary="skip buttons" id="ix_skpbt" class="calibre6"/><a data-type="indexterm" data-primary="accessibility" data-secondary="adding skip buttons to pages" id="ix_accssskp" class="calibre6"/> There might navigation links, quick-action menus, links to social media
accounts, search fields, etc. If you can use a mouse and see the page, this won’t be a problem. You will probably mentally filter
them out and start using the main content of the page.</p>

<p class="author1">But if you are using a screen reader, you might have to listen to details of each one of those initial elements on each page you
visit. <a data-type="indexterm" data-primary="screen readers" data-secondary="skipping over content" id="idm46634387626168" class="calibre6"/>Modern screen reader technology often allows users to automatically navigate through sections and headings, but it can still
take some time to figure out where the important things start.</p>

<p class="author1">That’s why many websites include hidden links and button that typically include text like “Skip to content” that allows keyboard
users to get to the critical start of the page.</p>

<p class="author1">One example is YouTube. If you open YouTube and then hit the Tab key a few times, you see a button appear (see <a data-type="xref" href="#ch09_image_17" class="calibre6">Figure 9-17</a>), which
will move the keyboard focus to the main content if you hit the spacebar.</p>

<figure class="calibre29"><div id="ch09_image_17" class="figure">
<img src="Images/recb_0917.png" alt="" class="calibre167"/>
<h6 class="calibre30"><span class="firstname">Figure 9-17. </span>YouTube displays a skip button if you press Tab three times</h6>
</div></figure>

<p class="author1">How do you create a button that appears only when you Tab to it?</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Solution" class="calibre4"><div class="preface" id="idm46634387620456">
<h2 class="calibre27">Solution</h2>

<p class="author1">This recipe contains a reusable <code class="calibre21">SkipButton</code> component that we can include on pretty much any page without breaking the design or
layout.</p>

<p class="author1">It needs to have <a data-type="indexterm" data-primary="skip buttons" data-secondary="SkipButton component, features needed" id="idm46634387617592" class="calibre6"/>several features:</p>

<ul class="stafflist">
<li class="calibre8">
<p class="author1">It needs to be hidden unless we tab into it. We don’t just want a transparent button, just in case the user hits it if they
accidentally click that part of the screen.</p>
</li>
<li class="calibre8">
<p class="author1">It needs to float above the page content so that we don’t need to leave space for it in the layout.</p>
</li>
<li class="calibre8">
<p class="author1">It needs to work as an accessible button. That means it has to be recognized by screen readers and behave how a button behaves.<a data-type="indexterm" data-primary="screen readers" data-secondary="skip button and" id="idm46634387613256" class="calibre6"/> If
we hit the Enter key or spacebar when it’s focused, we want it to work.</p>
</li>
<li class="calibre8">
<p class="author1">It needs to disappear once we’ve used it.</p>
</li>
</ul>

<p class="author1">We’ll add a few other requirements along the way, but this should get us started.</p>

<p class="author1">Let’s start by creating a new component, called <code class="calibre21">SkipButton</code>. We’ll make it return a single <code class="calibre21">div</code> and allow it to include any
children that are passed to it:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">const</code> <code class="nx">SkipButton</code> <code class="o">=</code> <code class="go">(</code><code class="nx">props</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="kr">const</code> <code class="go">{</code> <code class="nx">className</code><code class="go">,</code> <code class="nx">children</code><code class="go">,</code> <code class="go">...</code><code class="nx">others</code> <code class="go">}</code> <code class="o">=</code> <code class="nx">props</code>

  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="go">{</code><code class="err">`</code><code class="nx">SkipButton</code> <code class="nx">$</code><code class="go">{</code><code class="nx">className</code> <code class="o">||</code> <code class="s">''</code><code class="go">}</code><code class="err">`</code><code class="go">}</code> <code class="go">{</code><code class="na">...others</code><code class="go">}&gt;</code>
      <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">The component will also accept a class name and any other properties that a parent might care to pass.</p>

<p class="author1">We want screen readers to see it as an actual <code class="calibre21">button</code>.<a data-type="indexterm" data-primary="roles" data-secondary="button" id="idm46634387531592" class="calibre6"/> We could do this by replacing the <code class="calibre21">div</code> with a <code class="calibre21">button</code>, but we’ll keep it
as a <code class="calibre21">div</code> so that the styling is a little easier to apply. However, we will give it a <code class="calibre21">role</code> of <code class="calibre21">button</code> and—because roles have
rules—we will also give it a <code class="calibre21">tabIndex</code> value of <code class="calibre21">0</code>. <a data-type="indexterm" data-primary="tabIndex attribute" id="idm46634387527608" class="calibre6"/>That’s something that we’d need to do anyway, because we want the user to be
able to Tab to it:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">const</code> <code class="nx">SkipButton</code> <code class="o">=</code> <code class="go">(</code><code class="nx">props</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="kr">const</code> <code class="go">{</code> <code class="nx">className</code><code class="go">,</code> <code class="nx">children</code><code class="go">,</code> <code class="go">...</code><code class="nx">others</code> <code class="go">}</code> <code class="o">=</code> <code class="nx">props</code>

  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code>
      <code class="na">className</code><code class="o">=</code><code class="go">{</code><code class="err">`</code><code class="nx">SkipButton</code> <code class="nx">$</code><code class="go">{</code><code class="nx">className</code> <code class="o">||</code> <code class="s">''</code><code class="go">}</code><code class="err">`</code><code class="go">}</code>
      <code class="na">role</code><code class="o">=</code><code class="s">"button"</code>
      <code class="na">tabIndex</code><code class="o">=</code><code class="go">{</code><code class="mi">0</code><code class="go">}</code>
      <code class="go">{</code><code class="na">...others</code><code class="go">}</code>
    <code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">We need the button to do something when it’s clicked. Or rather, we need it to do something when the user presses the Enter key or
the spacebar.<a data-type="indexterm" data-primary="skip buttons" data-secondary="event handler for keyboard presses" id="idm46634387525432" class="calibre6"/><a data-type="indexterm" data-primary="keyboard" data-secondary="responding to click events" id="idm46634387439096" class="calibre6"/> So, we’ll allow it to accept a property called <code class="calibre21">onClick</code>, but then we’ll attach it to an event handler that will
trigger if the user presses the Enter key or spacebar:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">const</code> <code class="nx">SkipButton</code> <code class="o">=</code> <code class="go">(</code><code class="nx">props</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="kr">const</code> <code class="go">{</code> <code class="nx">className</code><code class="go">,</code> <code class="nx">children</code><code class="go">,</code> <code class="nx">onClick</code><code class="go">,</code> <code class="go">...</code><code class="nx">others</code> <code class="go">}</code> <code class="o">=</code> <code class="nx">props</code>

  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code>
      <code class="na">className</code><code class="o">=</code><code class="go">{</code><code class="err">`</code><code class="nx">SkipButton</code> <code class="nx">$</code><code class="go">{</code><code class="nx">className</code> <code class="o">||</code> <code class="s">''</code><code class="go">}</code><code class="err">`</code><code class="go">}</code>
      <code class="na">role</code><code class="o">=</code><code class="s">"button"</code>
      <code class="na">tabIndex</code><code class="o">=</code><code class="go">{</code><code class="mi">0</code><code class="go">}</code>
      <code class="go">{</code><code class="na">...others</code><code class="go">}</code>
      <code class="na">onKeyDown</code><code class="o">=</code><code class="go">{(</code><code class="nx">evt</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
        <code class="kr">if</code> <code class="go">(</code><code class="nx">evt</code><code class="go">.</code><code class="nx">key</code> <code class="o">===</code> <code class="s">'Enter'</code> <code class="o">||</code> <code class="nx">evt</code><code class="go">.</code><code class="nx">key</code> <code class="o">===</code> <code class="s">' '</code><code class="go">)</code> <code class="go">{</code>
          <code class="nx">evt</code><code class="go">.</code><code class="nx">preventDefault</code><code class="go">()</code>
          <code class="nx">onClick</code><code class="go">(</code><code class="nx">evt</code><code class="go">)</code>
        <code class="go">}</code>
      <code class="go">}}</code>
    <code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">Of course, we could have named this property <code class="calibre21">onKeyDown</code>, but buttons generally have <code class="calibre21">onClicks</code>, and that will likely be easier to
remember when we come to use it.</p>

<p class="author1">There’s one final thing that we’ll do to the component: we’ll allow it to accept a reference, which will be useful when we reuse the
component in the next recipe.</p>

<p class="author1">You can’t pass references in the same way that you’d pass most other properties.<a data-type="indexterm" data-primary="references, components accepting" id="idm46634387297560" class="calibre6"/> The React renderer uses references to keep track of
the generated elements in the DOM.</p>

<p class="author1">If we want a component to accept a reference object, we’ll need to wrap everything in a call to React’s <code class="calibre21">forwardRef</code> function.<a data-type="indexterm" data-primary="skip buttons" data-secondary="wrapping SkipButton in forwardRef function" id="idm46634387295864" class="calibre6"/><a data-type="indexterm" data-primary="forwardRef function" id="idm46634387294760" class="calibre6"/> The
<code class="calibre21">forwardRef</code> function returns a wrapped version of your component, extracting the reference from the parent component and passing it
explicitly to the component it wraps. That sounds a little complicated, but it just means this:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="go">{</code> <code class="nx">forwardRef</code> <code class="go">}</code> <code class="nx">from</code> <code class="s">'react'</code>
<code class="kr">import</code> <code class="s">'./SkipButton.css'</code>

<code class="kr">const</code> <code class="nx">SkipButton</code> <code class="o">=</code> <code class="nx">forwardRef</code><code class="go">((</code><code class="nx">props</code><code class="go">,</code> <code class="nx">ref</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="kr">const</code> <code class="go">{</code> <code class="nx">className</code><code class="go">,</code> <code class="nx">children</code><code class="go">,</code> <code class="nx">onClick</code><code class="go">,</code> <code class="go">...</code><code class="nx">others</code> <code class="go">}</code> <code class="o">=</code> <code class="nx">props</code>

  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code>
      <code class="na">className</code><code class="o">=</code><code class="go">{</code><code class="err">`</code><code class="nx">SkipButton</code> <code class="nx">$</code><code class="go">{</code><code class="nx">className</code> <code class="o">||</code> <code class="s">''</code><code class="go">}</code><code class="err">`</code><code class="go">}</code>
      <code class="na">role</code><code class="o">=</code><code class="s">"button"</code>
      <code class="na">tabIndex</code><code class="o">=</code><code class="go">{</code><code class="mi">0</code><code class="go">}</code>
      <code class="na">ref</code><code class="o">=</code><code class="go">{</code><code class="nx">ref</code><code class="go">}</code>
      <code class="go">{</code><code class="na">...others</code><code class="go">}</code>
      <code class="na">onKeyDown</code><code class="o">=</code><code class="go">{(</code><code class="nx">evt</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
        <code class="kr">if</code> <code class="go">(</code><code class="nx">evt</code><code class="go">.</code><code class="nx">key</code> <code class="o">===</code> <code class="s">'Enter'</code> <code class="o">||</code> <code class="nx">evt</code><code class="go">.</code><code class="nx">key</code> <code class="o">===</code> <code class="s">' '</code><code class="go">)</code> <code class="go">{</code>
          <code class="nx">evt</code><code class="go">.</code><code class="nx">preventDefault</code><code class="go">()</code>
          <code class="nx">onClick</code><code class="go">(</code><code class="nx">evt</code><code class="go">)</code>
        <code class="go">}</code>
      <code class="go">}}</code>
    <code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">})</code></pre>

<p class="author1">That’s our completed <code class="calibre21">SkipButton</code>, complete with an import of some style information. It’s just a button. The rest is down to
styling in the <em class="calibre7">SkipButton.css</em> file.</p>

<p class="author1">We want the button to float above the other content in the page, so we’ll set the <code class="calibre21">z-index</code> to something really high:</p>

<pre data-type="programlisting" data-code-language="css" class="calibre28"><code class="nc">.SkipButton</code> <code class="go">{</code>
    <code class="kr">z-index</code><code class="o">:</code> <code class="mi">10000</code><code class="go">;</code>
<code class="go">}</code></pre>

<p class="author1">We want to hide the button until the user has tabbed into it.<a data-type="indexterm" data-primary="skip buttons" data-secondary="hiding button until user tabs into it" id="idm46634387135176" class="calibre6"/> We could try to make it transparent, but that will have two problems.
First, it might position itself in front of something clickable. It would block the clicks unless we also went to the trouble
of setting <code class="calibre21">pointer-events</code> to <code class="calibre21">none</code>. Second, if the button is transparent but still on the screen, it might be seen as extra
screen clutter for a screen reader to handle. If a screen reader is converting the screen spatially into braille, the user would
hear “Skip to content” in the middle of some other piece of text.</p>

<p class="author1">So instead, we’ll put the button way off screen until we need it:</p>

<pre data-type="programlisting" data-code-language="css" class="calibre28"><code class="nc">.SkipButton</code> <code class="go">{</code>
    <code class="kr">z-index</code><code class="o">:</code> <code class="mi">10000</code><code class="go">;</code>
    <code class="kr">position</code><code class="o">:</code> <code class="nb">absolute</code><code class="go">;</code>
    <code class="kr">left</code><code class="o">:</code> <code class="mi">-1000px</code><code class="go">;</code>
    <code class="kr">top</code><code class="o">:</code> <code class="mi">-1000px</code><code class="go">;</code>
<code class="go">}</code></pre>

<p class="author1">So, what happens when someone tabs into the button?<a data-type="indexterm" data-primary="focus" data-secondary="style for skip button having focus" id="idm46634387129384" class="calibre6"/> We can set styles that are applied only when the button has focus:</p>

<pre data-type="programlisting" data-code-language="css" class="calibre28"><code class="nc">.SkipButton</code> <code class="go">{</code>
    <code class="kr">z-index</code><code class="o">:</code> <code class="mi">10000</code><code class="go">;</code>
    <code class="kr">position</code><code class="o">:</code> <code class="nb">absolute</code><code class="go">;</code>
    <code class="kr">left</code><code class="o">:</code> <code class="mi">-1000px</code><code class="go">;</code>
    <code class="kr">top</code><code class="o">:</code> <code class="mi">-1000px</code><code class="go">;</code>
<code class="go">}</code>

<code class="nc">.SkipButton</code><code class="nd">:focus</code> <code class="go">{</code>
    <code class="kr">top</code><code class="o">:</code> <code class="nb">auto</code><code class="go">;</code>
    <code class="kr">left</code><code class="o">:</code> <code class="nb">auto</code><code class="go">;</code>
<code class="go">}</code></pre>

<p class="author1">Beyond that, we can just add some pure visual styling. It’s important to remember that not everyone using this button is going to be
using a screen reader. <a data-type="indexterm" data-primary="navigation" data-secondary="keyboard" id="idm46634386942216" class="calibre6"/><a data-type="indexterm" data-primary="keyboard" data-secondary="navigation with" id="idm46634386979752" class="calibre6"/>Some will want to use keyboard navigation because they are unable to use a mouse, or else they might just
want to navigate with a keyboard because they find it faster:</p>

<pre data-type="programlisting" data-code-language="css" class="calibre28"><code class="nc">.SkipButton</code> <code class="go">{</code>
    <code class="kr">z-index</code><code class="o">:</code> <code class="mi">10000</code><code class="go">;</code>
    <code class="kr">position</code><code class="o">:</code> <code class="nb">absolute</code><code class="go">;</code>
    <code class="kr">left</code><code class="o">:</code> <code class="mi">-1000px</code><code class="go">;</code>
    <code class="kr">top</code><code class="o">:</code> <code class="mi">-1000px</code><code class="go">;</code>
    <code class="kr">font-size</code><code class="o">:</code> <code class="mi">12px</code><code class="go">;</code>
    <code class="kr">line-height</code><code class="o">:</code> <code class="mi">16px</code><code class="go">;</code>
    <code class="kr">display</code><code class="o">:</code> <code class="nb">inline-block</code><code class="go">;</code>
    <code class="kr">color</code><code class="o">:</code> <code class="nb">black</code><code class="go">;</code>
    <code class="kr">font-family</code><code class="o">:</code> <code class="nb">sans-serif</code><code class="go">;</code>
    <code class="kr">background-color</code><code class="o">:</code> <code class="mi">#ffff88</code><code class="go">;</code>
    <code class="kr">padding</code><code class="o">:</code> <code class="mi">8px</code><code class="go">;</code>
    <code class="kr">margin-left</code><code class="o">:</code> <code class="mi">8px</code><code class="go">;</code>

<code class="go">}</code>

<code class="nc">.SkipButton</code><code class="nd">:focus</code> <code class="go">{</code>
    <code class="kr">top</code><code class="o">:</code> <code class="nb">auto</code><code class="go">;</code>
    <code class="kr">left</code><code class="o">:</code> <code class="nb">auto</code><code class="go">;</code>
<code class="go">}</code></pre>

<p class="author1">We can now insert the <code class="calibre21">SkipButton</code> somewhere near the start of the page.<a data-type="indexterm" data-primary="skip buttons" data-secondary="inserting SkipButton near beginning of page" id="idm46634386975816" class="calibre6"/> It won’t be visible until the user tabs into it, but
positioning does matter. We want it to be within two or three Tabs from the start of the page. We’ll add it to the <code class="calibre21">header</code> section:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="go">&lt;</code><code class="nt">header</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">SkipButton</code> <code class="na">onClick</code><code class="o">=</code><code class="go">{()</code> <code class="o">=&gt;</code> <code class="nb">document</code><code class="go">.</code><code class="nx">querySelector</code><code class="go">(</code><code class="s">'.addButton'</code><code class="go">).</code><code class="nx">focus</code><code class="go">()}&gt;</code>
        <code class="nx">Skip</code> <code class="nx">to</code> <code class="nx">content</code>
    <code class="go">&lt;/</code><code class="nt">SkipButton</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">h1</code><code class="go">&gt;</code><code class="nx">Manage</code> <code class="nx">Tasks</code><code class="go">&lt;/</code><code class="nt">h1</code><code class="go">&gt;</code>
<code class="go">&lt;/</code><code class="nt">header</code><code class="go">&gt;</code></pre>

<p class="author1">We’re just using <code class="calibre21">document.querySelector</code> here to find the element that will receive the focus.<a data-type="indexterm" data-primary="document.querySelector" id="idm46634386770488" class="calibre6"/><a data-type="indexterm" data-primary="focus" data-secondary="finding element receiving with document.querySelector" id="idm46634386769992" class="calibre6"/><a data-type="indexterm" data-primary="skip buttons" data-secondary="document.querySelector to find element receiving focus" id="idm46634386768952" class="calibre6"/> You could choose to reference the
element you want to skip to or else navigate to a location. In practice, we’ve found that a simple <code class="calibre21">document.querySelector</code> is the most
straightforward approach. It allows you to easily refer to elements that might not be in the current component. And it doesn’t rely
on navigating to an anchor within a page, which might break if the application changes its routing method.</p>

<p class="author1">If you open the example application in a browser and then press Tab, you will see the <code class="calibre21">SkipButton</code> (see <a data-type="xref" href="#ch09_image_18" class="calibre6">Figure 9-18</a>).</p>

<figure class="calibre29"><div id="ch09_image_18" class="figure">
<img src="Images/recb_0918.png" alt="" class="calibre168"/>
<h6 class="calibre30"><span class="firstname">Figure 9-18. </span>The skip button appears over the main heading if you press the Tab key</h6>
</div></figure>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Discussion" class="calibre4"><div class="preface" id="idm46634387619512">
<h2 class="calibre27">Discussion</h2>

<p class="author1">It’s a good idea to place the <code class="calibre21">SkipButton</code> within three Tabs of the start of the page, and it’s helpful if the number of <em class="calibre7">Tabs</em>
needed is the same on every page in your application. The user will then soon learn how to skip to the critical part of each page.
We’ve found that <code class="calibre21">SkipButton</code>s are also popular with people who find using a keyboard more productive.</p>

<p class="author1">You could create a standard <code class="calibre21">SkipButton</code> for each page that also moved the focus to the first tabbable item on the <code class="calibre21">main</code> section
of the page.<sup class="calibre34"><a data-type="noteref" id="idm46634386852088-marker" href="ch09.xhtml#idm46634386852088" class="calibre35">8</a></sup></p>

<p class="author1">You can download the source for this recipe from the <a href="https://oreil.ly/0GfgA" class="calibre6">GitHub site</a>.<a data-type="indexterm" data-primary="buttons" data-secondary="adding skip buttons for accessibility" data-startref="ix_btnskp" id="idm46634386849048" class="calibre6"/><a data-type="indexterm" data-primary="accessibility" data-secondary="adding skip buttons to pages" data-startref="ix_accssskp" id="idm46634386847800" class="calibre6"/><a data-type="indexterm" data-primary="skip buttons" data-startref="ix_skpbt" id="idm46634386846616" class="calibre6"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Add Skip Regions" class="calibre4"><div class="preface" id="ch09-07">
<h1 class="calibre17">Add Skip Regions</h1>








<section data-type="sect2" data-pdf-bookmark="Problem" class="calibre4"><div class="preface" id="idm46634386843992">
<h2 class="calibre27">Problem</h2>

<p class="author1">We saw in the previous recipe that <em class="calibre7">skip buttons</em> are helpful if a user wants to quickly get past all of the headers and navigation
at the start of a page and get into the main content.<a data-type="indexterm" data-primary="accessibility" data-secondary="adding skip-regions to pages" id="ix_accssskprg" class="calibre6"/><a data-type="indexterm" data-primary="skip-regions, adding" id="ix_skpreg" class="calibre6"/></p>

<p class="author1">However, even within the main content, there may be times where it would be helpful for a user to skip past a set of components.
Consider the example tasks application that we are using throughout this chapter. A user can create a reasonably large number of
tasks in different groups (see <a data-type="xref" href="#ch09_image_19" class="calibre6">Figure 9-19</a>).</p>

<figure class="calibre29"><div id="ch09_image_19" class="figure">
<img src="Images/recb_0901.png" alt="" class="calibre154"/>
<h6 class="calibre30"><span class="firstname">Figure 9-19. </span>The example application displays a set of tasks, broken into groups</h6>
</div></figure>

<p class="author1">If they want to get to the <code class="calibre21">Shopping</code> tasks, they would potentially have to skip past 14 other tasks. And each one of those tasks
would have two focus points: the task itself and the task’s delete button. That means skipping past 28 focus points, even after
getting into the content of the page.</p>

<p class="author1">What can we do to make it easier for a user to skip past a collection of components?</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Solution" class="calibre4"><div class="preface" id="idm46634386834504">
<h2 class="calibre27">Solution</h2>

<p class="author1">We’re going to use the <code class="calibre21">SkipButton</code> component we created in the previous recipe to create skip-regions.</p>

<p class="author1">If we tab forward into some section of the main content of the page, such as the Office tasks, we want a button to<a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="SkipButton appearing when user tabs to/away from section of main content" id="idm46634386831624" class="calibre6"/> appear that
allows the user to skip past the Office tasks entirely (see <a data-type="xref" href="#ch09_image_20" class="calibre6">Figure 9-20</a>).</p>

<figure class="calibre29"><div id="ch09_image_20" class="figure">
<img src="Images/recb_0920.png" alt="" class="calibre169"/>
<h6 class="calibre30"><span class="firstname">Figure 9-20. </span>We want a skip button to appear when we tab forward into a group</h6>
</div></figure>

<p class="author1">Conversely, if they are tabbing backward into the Office section, we want a button to appear that allows them to skip before the
Office tasks (see <a data-type="xref" href="#ch09_image_21" class="calibre6">Figure 9-21</a>).</p>

<p class="author1">We only want these buttons to appear when entering a region and not when we’re leaving. That means the Skip Office button appears only when we tab forward, and the Skip before Office appears only when we tab backward.</p>

<figure class="calibre29"><div id="ch09_image_21" class="figure">
<img src="Images/recb_0921.png" alt="" class="calibre170"/>
<h6 class="calibre30"><span class="firstname">Figure 9-21. </span>A skip button should also appear when we tab back into a group</h6>
</div></figure>

<p class="author1">Before looking at the implementation, let’s look at how we will use a skip-region before getting into the gory details of the
implementation.<a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="how skip-region will be used" id="idm46634386822824" class="calibre6"/> Our task application renders <a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="context or group of tasks" id="idm46634386744584" class="calibre6"/>a series of groups of tasks using the <code class="calibre21">TasksContexts</code> component:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="nx">TaskList</code> <code class="nx">from</code> <code class="s">'../TaskList'</code>
<code class="kr">import</code> <code class="s">'./TaskContexts.css'</code>

<code class="kr">function</code> <code class="nx">TaskContexts</code><code class="go">({</code> <code class="nx">contexts</code><code class="go">,</code> <code class="nx">tasks</code><code class="go">,</code> <code class="nx">onDelete</code><code class="go">,</code> <code class="nx">onEdit</code> <code class="go">})</code> <code class="go">{</code>
  <code class="kr">return</code> <code class="nx">contexts</code><code class="go">.</code><code class="nx">map</code><code class="go">((</code><code class="nx">c</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
    <code class="kr">const</code> <code class="nx">tasksForContext</code> <code class="o">=</code> <code class="nx">tasks</code><code class="go">.</code><code class="nx">filter</code><code class="go">((</code><code class="nx">t</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="nx">t</code><code class="go">.</code><code class="nx">context</code> <code class="o">===</code> <code class="nx">c</code><code class="go">.</code><code class="nx">value</code><code class="go">)</code>
    <code class="kr">if</code> <code class="go">(</code><code class="nx">tasksForContext</code><code class="go">.</code><code class="nx">length</code> <code class="o">===</code> <code class="mi">0</code><code class="go">)</code> <code class="go">{</code>
      <code class="kr">return</code> <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"TaskContexts-context"</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
    <code class="go">}</code>
    <code class="kr">return</code> <code class="go">(</code>
      <code class="go">&lt;</code><code class="nt">div</code> <code class="na">key</code><code class="o">=</code><code class="go">{</code><code class="nx">c</code><code class="go">.</code><code class="nx">value</code><code class="go">}</code> <code class="na">className</code><code class="o">=</code><code class="s">"TaskContexts-context"</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">h2</code><code class="go">&gt;{</code><code class="nx">c</code><code class="go">.</code><code class="nx">name</code><code class="go">}&lt;/</code><code class="nt">h2</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">TaskList</code>
          <code class="na">tasks</code><code class="o">=</code><code class="go">{</code><code class="nx">tasksForContext</code><code class="go">}</code>
          <code class="na">onDelete</code><code class="o">=</code><code class="go">{</code><code class="nx">onDelete</code><code class="go">}</code>
          <code class="na">onEdit</code><code class="o">=</code><code class="go">{</code><code class="nx">onEdit</code><code class="go">}</code>
        <code class="go">/&gt;</code>
      <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
    <code class="go">)</code>
  <code class="go">})</code>
<code class="go">}</code>

<code class="kr">export</code> <code class="kr">default</code> <code class="nx">TaskContexts</code></pre>

<p class="author1">Each “context” (group of tasks, for shopping, office, research, etc.) has a heading and a list of tasks. We want the user to be able
to skip over each of the groups.<a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="wrapping groups of tasks in Skip component" id="idm46634386740072" class="calibre6"/> We’ll wrap each of the task-groups in a new component called <code class="calibre21">Skip</code>, like this:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="nx">TaskList</code> <code class="nx">from</code> <code class="s">'../TaskList'</code>
<code class="kr">import</code> <code class="nx">Skip</code> <code class="nx">from</code> <code class="s">'../Skip'</code>
<code class="kr">import</code> <code class="s">'./TaskContexts.css'</code>

<code class="kr">function</code> <code class="nx">TaskContexts</code><code class="go">({</code> <code class="nx">contexts</code><code class="go">,</code> <code class="nx">tasks</code><code class="go">,</code> <code class="nx">onDelete</code><code class="go">,</code> <code class="nx">onEdit</code> <code class="go">})</code> <code class="go">{</code>
  <code class="kr">return</code> <code class="nx">contexts</code><code class="go">.</code><code class="nx">map</code><code class="go">((</code><code class="nx">c</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
    <code class="kr">const</code> <code class="nx">tasksForContext</code> <code class="o">=</code> <code class="nx">tasks</code><code class="go">.</code><code class="nx">filter</code><code class="go">((</code><code class="nx">t</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="nx">t</code><code class="go">.</code><code class="nx">context</code> <code class="o">===</code> <code class="nx">c</code><code class="go">.</code><code class="nx">value</code><code class="go">)</code>
    <code class="kr">if</code> <code class="go">(</code><code class="nx">tasksForContext</code><code class="go">.</code><code class="nx">length</code> <code class="o">===</code> <code class="mi">0</code><code class="go">)</code> <code class="go">{</code>
      <code class="kr">return</code> <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"TaskContexts-context"</code><code class="go">&gt;</code><code class="o">&amp;</code><code class="nx">nbsp</code><code class="go">;&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
    <code class="go">}</code>
    <code class="kr">return</code> <code class="go">(</code>
      <code class="go">&lt;</code><code class="nt">div</code> <code class="na">key</code><code class="o">=</code><code class="go">{</code><code class="nx">c</code><code class="go">.</code><code class="nx">value</code><code class="go">}</code> <code class="na">className</code><code class="o">=</code><code class="s">"TaskContexts-context"</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">Skip</code> <code class="na">name</code><code class="o">=</code><code class="go">{</code><code class="nx">c</code><code class="go">.</code><code class="nx">name</code><code class="go">}&gt;</code>
          <code class="go">&lt;</code><code class="nt">h2</code><code class="go">&gt;{</code><code class="nx">c</code><code class="go">.</code><code class="nx">name</code><code class="go">}&lt;/</code><code class="nt">h2</code><code class="go">&gt;</code>
          <code class="go">&lt;</code><code class="nt">TaskList</code>
            <code class="na">tasks</code><code class="o">=</code><code class="go">{</code><code class="nx">tasksForContext</code><code class="go">}</code>
            <code class="na">onDelete</code><code class="o">=</code><code class="go">{</code><code class="nx">onDelete</code><code class="go">}</code>
            <code class="na">onEdit</code><code class="o">=</code><code class="go">{</code><code class="nx">onEdit</code><code class="go">}</code>
          <code class="go">/&gt;</code>
        <code class="go">&lt;/</code><code class="nt">Skip</code><code class="go">&gt;</code>
      <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
    <code class="go">)</code>
  <code class="go">})</code>
<code class="go">}</code>

<code class="kr">export</code> <code class="kr">default</code> <code class="nx">TaskContexts</code></pre>

<p class="author1">If we wrap some tasks in our (as yet nonexistent) <code class="calibre21">Skip</code> component, the user will see the <code class="calibre21">SkipButtons</code> magically appear and
disappear each time they enter the group of tasks.</p>

<p class="author1">All we need to pass to the <code class="calibre21">Skip</code> component is a name, which it will use in the “Skip…” and “Skip before…” text.</p>

<p class="author1">Now, to create the <code class="calibre21">Skip</code> component, let’s begin with a simple component that renders two <code class="calibre21">SkipButtons</code> and <a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="Skip component that renders two SkipButtons" id="idm46634386464168" class="calibre6"/>any child components
it’s been given:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="go">{</code> <code class="nx">useRef</code> <code class="go">}</code> <code class="nx">from</code> <code class="s">'react'</code>
<code class="kr">import</code> <code class="nx">SkipButton</code> <code class="nx">from</code> <code class="s">'../SkipButton'</code>
<code class="kr">import</code> <code class="s">'./Skip.css'</code>

<code class="kr">const</code> <code class="nx">Skip</code> <code class="o">=</code> <code class="go">({</code> <code class="nx">children</code><code class="go">,</code> <code class="nx">name</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="kr">const</code> <code class="nx">startButton</code> <code class="o">=</code> <code class="nx">useRef</code><code class="go">()</code>
  <code class="kr">const</code> <code class="nx">endButton</code> <code class="o">=</code> <code class="nx">useRef</code><code class="go">()</code>

  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Skip"</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">SkipButton</code> <code class="na">ref</code><code class="o">=</code><code class="go">{</code><code class="nx">startButton</code><code class="go">}&gt;</code><code class="nx">Skip</code> <code class="go">{</code><code class="nx">name</code><code class="go">}&lt;/</code><code class="nt">SkipButton</code><code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
      <code class="go">&lt;</code><code class="nt">SkipButton</code> <code class="na">ref</code><code class="o">=</code><code class="go">{</code><code class="nx">endButton</code><code class="go">}&gt;</code><code class="nx">Skip</code> <code class="nx">before</code> <code class="go">{</code><code class="nx">name</code><code class="go">}&lt;/</code><code class="nt">SkipButton</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">We have created two references that will allow us to keep track of each of the buttons.<a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="references allowing tracking of SkipButtons" id="idm46634386461352" class="calibre6"/><a data-type="indexterm" data-primary="focus" data-secondary="SkipButtons in Skip component" id="idm46634386460488" class="calibre6"/> When a user clicks the <code class="calibre21">startButton</code>, the
focus will skip to the <code class="calibre21">endButton</code>, and vice versa:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="go">{</code> <code class="nx">useRef</code><code class="go">,</code> <code class="nx">useState</code> <code class="go">}</code> <code class="nx">from</code> <code class="s">'react'</code>
<code class="kr">import</code> <code class="nx">SkipButton</code> <code class="nx">from</code> <code class="s">'../SkipButton'</code>
<code class="kr">import</code> <code class="s">'./Skip.css'</code>

<code class="kr">const</code> <code class="nx">Skip</code> <code class="o">=</code> <code class="go">({</code> <code class="nx">children</code><code class="go">,</code> <code class="nx">name</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="kr">const</code> <code class="nx">startButton</code> <code class="o">=</code> <code class="nx">useRef</code><code class="go">()</code>
  <code class="kr">const</code> <code class="nx">endButton</code> <code class="o">=</code> <code class="nx">useRef</code><code class="go">()</code>

  <code class="kr">const</code> <code class="nx">skipAfter</code> <code class="o">=</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
    <code class="kr">if</code> <code class="go">(</code><code class="nx">endButton</code><code class="go">.</code><code class="nx">current</code><code class="go">)</code> <code class="go">{</code>
      <code class="nx">endButton</code><code class="go">.</code><code class="nx">current</code><code class="go">.</code><code class="nx">focus</code><code class="go">()</code>
    <code class="go">}</code>
  <code class="go">}</code>
  <code class="kr">const</code> <code class="nx">skipBefore</code> <code class="o">=</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
    <code class="kr">if</code> <code class="go">(</code><code class="nx">startButton</code><code class="go">.</code><code class="nx">current</code><code class="go">)</code> <code class="go">{</code>
      <code class="nx">startButton</code><code class="go">.</code><code class="nx">current</code><code class="go">.</code><code class="nx">focus</code><code class="go">()</code>
    <code class="go">}</code>
  <code class="go">}</code>

  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Skip"</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">SkipButton</code> <code class="na">ref</code><code class="o">=</code><code class="go">{</code><code class="nx">startButton</code><code class="go">}</code> <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">skipAfter</code><code class="go">}&gt;</code>
        <code class="nx">Skip</code> <code class="go">{</code><code class="nx">name</code><code class="go">}</code>
      <code class="go">&lt;/</code><code class="nt">SkipButton</code><code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
      <code class="go">&lt;</code><code class="nt">SkipButton</code> <code class="na">ref</code><code class="o">=</code><code class="go">{</code><code class="nx">endButton</code><code class="go">}</code> <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">skipBefore</code><code class="go">}&gt;</code>
        <code class="nx">Skip</code> <code class="nx">before</code> <code class="go">{</code><code class="nx">name</code><code class="go">}</code>
      <code class="go">&lt;/</code><code class="nt">SkipButton</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">If we run this code, we will see the <code class="calibre21">SkipButton</code> when we enter a set of tasks, and we click Enter, the focus will shift to the
<code class="calibre21">SkipButton</code> at the end of the list of tasks.</p>

<p class="author1">However, instead of jumping to the <code class="calibre21">endButton</code>, we want to focus on whatever comes <em class="calibre7">after</em> the <code class="calibre21">endButton</code>. It’s as if we want to
jump to the button at the end of the list and then immediately press Tab to get to the next thing.<a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="function to perform Tab operation" id="idm46634386100488" class="calibre6"/><a data-type="indexterm" data-primary="Tab operation, function performing" id="idm46634386099512" class="calibre6"/><a data-type="indexterm" data-primary="focus" data-secondary="function performing Tab operation" id="idm46634386098872" class="calibre6"/> And we can do that if we create a function that will programmatically perform a Tab operation:<sup class="calibre34"><a data-type="noteref" id="idm46634386097672-marker" href="ch09.xhtml#idm46634386097672" class="calibre35">9</a></sup></p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">const</code> <code class="nx">focusableSelector</code> <code class="o">=</code> <code class="s">'a[href], ..., *[contenteditable]'</code>

<code class="kr">function</code> <code class="nx">focusNextElement</code><code class="go">()</code> <code class="go">{</code>
  <code class="kr">var</code> <code class="nx">focusables</code> <code class="o">=</code> <code class="nb">document</code><code class="go">.</code><code class="nx">querySelectorAll</code><code class="go">(</code><code class="nx">focusableSelector</code><code class="go">)</code>
  <code class="kr">var</code> <code class="nx">current</code> <code class="o">=</code> <code class="nb">document</code><code class="go">.</code><code class="nx">querySelectorAll</code><code class="go">(</code><code class="s">':focus'</code><code class="go">)</code>
  <code class="kr">var</code> <code class="nx">nextIndex</code> <code class="o">=</code> <code class="mi">0</code>
  <code class="kr">if</code> <code class="go">(</code><code class="nx">current</code><code class="go">.</code><code class="nx">length</code> <code class="o">===</code> <code class="mi">1</code><code class="go">)</code> <code class="go">{</code>
    <code class="kr">var</code> <code class="nx">currentIndex</code> <code class="o">=</code> <code class="nb">Array</code><code class="go">.</code><code class="nx">prototype</code><code class="go">.</code><code class="nx">indexOf</code><code class="go">.</code><code class="nx">call</code><code class="go">(</code>
      <code class="nx">focusables</code><code class="go">,</code>
      <code class="nx">current</code><code class="go">[</code><code class="mi">0</code><code class="go">]</code>
    <code class="go">)</code>
    <code class="kr">if</code> <code class="go">(</code><code class="nx">currentIndex</code> <code class="o">+</code> <code class="mi">1</code> <code class="o">&lt;</code> <code class="nx">focusables</code><code class="go">.</code><code class="nx">length</code><code class="go">)</code> <code class="go">{</code>
      <code class="nx">nextIndex</code> <code class="o">=</code> <code class="nx">currentIndex</code> <code class="o">+</code> <code class="mi">1</code>
    <code class="go">}</code>
  <code class="go">}</code>

  <code class="nx">focusables</code><code class="go">[</code><code class="nx">nextIndex</code><code class="go">].</code><code class="nx">focus</code><code class="go">()</code>
<code class="go">}</code></pre>

<p class="author1">This code finds all of the elements in the DOM that we can navigate to with the Tab key. It then searches through
the list until it finds the element that currently has focus, and then it sets the focus to the next element.<a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="function performing back-Tab operation" id="idm46634386092744" class="calibre6"/></p>

<p class="author1">We can write a similar function called <code class="calibre21">focusPreviousElement</code>, which programmatically performs a back-Tab.<a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="Skip component code" id="idm46634386055256" class="calibre6"/> We can then add our
<code class="calibre21">Skip</code> component:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="go">{</code> <code class="nx">useRef</code><code class="go">,</code> <code class="nx">useState</code> <code class="go">}</code> <code class="nx">from</code> <code class="s">'react'</code>
<code class="kr">import</code> <code class="go">{</code>
  <code class="nx">focusNextElement</code><code class="go">,</code>
  <code class="nx">focusPreviousElement</code><code class="go">,</code>
<code class="go">}</code> <code class="nx">from</code> <code class="s">'./focusNextElement'</code>
<code class="kr">import</code> <code class="nx">SkipButton</code> <code class="nx">from</code> <code class="s">'../SkipButton'</code>
<code class="kr">import</code> <code class="s">'./Skip.css'</code>

<code class="kr">const</code> <code class="nx">Skip</code> <code class="o">=</code> <code class="go">({</code> <code class="nx">children</code><code class="go">,</code> <code class="nx">name</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="kr">const</code> <code class="nx">startButton</code> <code class="o">=</code> <code class="nx">useRef</code><code class="go">()</code>
  <code class="kr">const</code> <code class="nx">endButton</code> <code class="o">=</code> <code class="nx">useRef</code><code class="go">()</code>

  <code class="kr">const</code> <code class="nx">skipAfter</code> <code class="o">=</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
    <code class="kr">if</code> <code class="go">(</code><code class="nx">endButton</code><code class="go">.</code><code class="nx">current</code><code class="go">)</code> <code class="go">{</code>
      <code class="nx">endButton</code><code class="go">.</code><code class="nx">current</code><code class="go">.</code><code class="nx">focus</code><code class="go">()</code>
      <code class="nx">focusNextElement</code><code class="go">()</code>
    <code class="go">}</code>
  <code class="go">}</code>
  <code class="kr">const</code> <code class="nx">skipBefore</code> <code class="o">=</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
    <code class="kr">if</code> <code class="go">(</code><code class="nx">startButton</code><code class="go">.</code><code class="nx">current</code><code class="go">)</code> <code class="go">{</code>
      <code class="nx">startButton</code><code class="go">.</code><code class="nx">current</code><code class="go">.</code><code class="nx">focus</code><code class="go">()</code>
      <code class="nx">focusPreviousElement</code><code class="go">()</code>
    <code class="go">}</code>
  <code class="go">}</code>

  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Skip"</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">SkipButton</code> <code class="na">ref</code><code class="o">=</code><code class="go">{</code><code class="nx">startButton</code><code class="go">}</code> <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">skipAfter</code><code class="go">}&gt;</code>
        <code class="nx">Skip</code> <code class="go">{</code><code class="nx">name</code><code class="go">}</code>
      <code class="go">&lt;/</code><code class="nt">SkipButton</code><code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
      <code class="go">&lt;</code><code class="nt">SkipButton</code> <code class="na">ref</code><code class="o">=</code><code class="go">{</code><code class="nx">endButton</code><code class="go">}</code> <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">skipBefore</code><code class="go">}&gt;</code>
        <code class="nx">Skip</code> <code class="nx">before</code> <code class="go">{</code><code class="nx">name</code><code class="go">}</code>
      <code class="go">&lt;/</code><code class="nt">SkipButton</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">When we enter a group of tasks—such as Office—we see a <code class="calibre21">SkipButton</code>, which will let us skip past the group entirely, onto whatever
follows.</p>

<p class="author1">We have just one more feature to add. We only want the <code class="calibre21">SkipButton</code>s to appear when we are entering a skip-region, not when
we’re leaving one.<a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="SkipButton only appearing when entering skip-region" id="idm46634386051144" class="calibre6"/> We can do this by keeping a state variable called <code class="calibre21">inside</code> updated with whether the focus is currently inside or
outside the current component:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="go">{</code> <code class="nx">useRef</code><code class="go">,</code> <code class="nx">useState</code> <code class="go">}</code> <code class="nx">from</code> <code class="s">'react'</code>
<code class="kr">import</code> <code class="go">{</code>
  <code class="nx">focusNextElement</code><code class="go">,</code>
  <code class="nx">focusPreviousElement</code><code class="go">,</code>
<code class="go">}</code> <code class="nx">from</code> <code class="s">'./focusNextElement'</code>
<code class="kr">import</code> <code class="nx">SkipButton</code> <code class="nx">from</code> <code class="s">'../SkipButton'</code>
<code class="kr">import</code> <code class="s">'./Skip.css'</code>

<code class="kr">const</code> <code class="nx">Skip</code> <code class="o">=</code> <code class="go">({</code> <code class="nx">children</code><code class="go">,</code> <code class="nx">name</code> <code class="go">})</code> <code class="o">=&gt;</code> <code class="go">{</code>
  <code class="kr">const</code> <code class="nx">startButton</code> <code class="o">=</code> <code class="nx">useRef</code><code class="go">()</code>
  <code class="kr">const</code> <code class="nx">endButton</code> <code class="o">=</code> <code class="nx">useRef</code><code class="go">()</code>
  <code class="kr">const</code> <code class="go">[</code><code class="nx">inside</code><code class="go">,</code> <code class="nx">setInside</code><code class="go">]</code> <code class="o">=</code> <code class="nx">useState</code><code class="go">(</code><code class="kr">false</code><code class="go">)</code>

  <code class="kr">const</code> <code class="nx">skipAfter</code> <code class="o">=</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
    <code class="kr">if</code> <code class="go">(</code><code class="nx">endButton</code><code class="go">.</code><code class="nx">current</code><code class="go">)</code> <code class="go">{</code>
      <code class="nx">endButton</code><code class="go">.</code><code class="nx">current</code><code class="go">.</code><code class="nx">focus</code><code class="go">()</code>
      <code class="nx">focusNextElement</code><code class="go">()</code>
    <code class="go">}</code>
  <code class="go">}</code>
  <code class="kr">const</code> <code class="nx">skipBefore</code> <code class="o">=</code> <code class="go">()</code> <code class="o">=&gt;</code> <code class="go">{</code>
    <code class="kr">if</code> <code class="go">(</code><code class="nx">startButton</code><code class="go">.</code><code class="nx">current</code><code class="go">)</code> <code class="go">{</code>
      <code class="nx">startButton</code><code class="go">.</code><code class="nx">current</code><code class="go">.</code><code class="nx">focus</code><code class="go">()</code>
      <code class="nx">focusPreviousElement</code><code class="go">()</code>
    <code class="go">}</code>
  <code class="go">}</code>

  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code>
      <code class="na">className</code><code class="o">=</code><code class="s">"Skip"</code>
      <code class="na">onFocus</code><code class="o">=</code><code class="go">{(</code><code class="nx">evt</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
        <code class="kr">if</code> <code class="go">(</code>
          <code class="nx">evt</code><code class="go">.</code><code class="nx">target</code> <code class="o">!==</code> <code class="nx">startButton</code><code class="go">.</code><code class="nx">current</code> <code class="o">&amp;&amp;</code>
          <code class="nx">evt</code><code class="go">.</code><code class="nx">target</code> <code class="o">!==</code> <code class="nx">endButton</code><code class="go">.</code><code class="nx">current</code>
        <code class="go">)</code> <code class="go">{</code>
          <code class="nx">setInside</code><code class="go">(</code><code class="kr">true</code><code class="go">)</code>
        <code class="go">}</code>
      <code class="go">}}</code>
      <code class="na">onBlur</code><code class="o">=</code><code class="go">{(</code><code class="nx">evt</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
        <code class="kr">if</code> <code class="go">(</code>
          <code class="nx">evt</code><code class="go">.</code><code class="nx">target</code> <code class="o">!==</code> <code class="nx">startButton</code><code class="go">.</code><code class="nx">current</code> <code class="o">&amp;&amp;</code>
          <code class="nx">evt</code><code class="go">.</code><code class="nx">target</code> <code class="o">!==</code> <code class="nx">endButton</code><code class="go">.</code><code class="nx">current</code>
        <code class="go">)</code> <code class="go">{</code>
          <code class="nx">setInside</code><code class="go">(</code><code class="kr">false</code><code class="go">)</code>
        <code class="go">}</code>
      <code class="go">}}</code>
    <code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">SkipButton</code>
        <code class="na">ref</code><code class="o">=</code><code class="go">{</code><code class="nx">startButton</code><code class="go">}</code>
        <code class="na">tabIndex</code><code class="o">=</code><code class="go">{</code><code class="nx">inside</code> <code class="o">?</code> <code class="o">-</code><code class="mi">1</code> <code class="o">:</code> <code class="mi">0</code><code class="go">}</code>
        <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">skipAfter</code><code class="go">}</code>
      <code class="go">&gt;</code>
        <code class="nx">Skip</code> <code class="go">{</code><code class="nx">name</code><code class="go">}</code>
      <code class="go">&lt;/</code><code class="nt">SkipButton</code><code class="go">&gt;</code>
      <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
      <code class="go">&lt;</code><code class="nt">SkipButton</code>
        <code class="na">ref</code><code class="o">=</code><code class="go">{</code><code class="nx">endButton</code><code class="go">}</code>
        <code class="na">tabIndex</code><code class="o">=</code><code class="go">{</code><code class="nx">inside</code> <code class="o">?</code> <code class="o">-</code><code class="mi">1</code> <code class="o">:</code> <code class="mi">0</code><code class="go">}</code>
        <code class="na">onClick</code><code class="o">=</code><code class="go">{</code><code class="nx">skipBefore</code><code class="go">}</code>
      <code class="go">&gt;</code>
        <code class="nx">Skip</code> <code class="nx">before</code> <code class="go">{</code><code class="nx">name</code><code class="go">}</code>
      <code class="go">&lt;/</code><code class="nt">SkipButton</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">Our skip-region is now complete. If a user tabs into a group of tasks, a <code class="calibre21">SkipButton</code> appears. They can use the button to skip past
that group and on to the next.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Discussion" class="calibre4"><div class="preface" id="idm46634386833560">
<h2 class="calibre27">Discussion</h2>

<p class="author1">It would help if you were careful about applying skip-regions too often.<a data-type="indexterm" data-primary="skip-regions, adding" data-secondary="not adding too many" id="idm46634385747688" class="calibre6"/> They are best used to skip past many components that
the user would otherwise need to tab through.</p>

<p class="author1">There are other approaches you can take. For example, suppose your page contains a series of headings and subheadings.<a data-type="indexterm" data-primary="headings" data-secondary="SkipButtons allowing user to skip" id="idm46634385745688" class="calibre6"/> In that
case, you might consider adding <code class="calibre21">SkipBut⁠tons</code> that allow the user to skip to the next heading (if they are tabbing forward) or the
previous heading (if they are tabbing backward).</p>

<p class="author1">Some users will have accessibility software that allows them to skip past groups and sections of components without any additional
code required in the application. In those cases, the <code class="calibre21">SkipButton</code>s will not appear on the page, and the user will ignore them
entirely.</p>

<p class="author1">You can download the source for this recipe
from the <a href="https://oreil.ly/0GfgA" class="calibre6">GitHub site</a>.<a data-type="indexterm" data-primary="accessibility" data-secondary="adding skip-regions to pages" data-startref="ix_accssskprg" id="idm46634385481400" class="calibre6"/><a data-type="indexterm" data-primary="skip-regions, adding" data-startref=" ix_skpreg" id="idm46634385480152" class="calibre6"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Capture Scope in Modals" class="calibre4"><div class="preface" id="ch09-08">
<h1 class="calibre17">Capture Scope in Modals</h1>








<section data-type="sect2" data-pdf-bookmark="Problem" class="calibre4"><div class="preface" id="idm46634385477656">
<h2 class="calibre27">Problem</h2>

<p class="author1">React applications frequently display pop-ups.<a data-type="indexterm" data-primary="accessibility" data-secondary="capturing scope in modals" id="ix_accssscpmod" class="calibre6"/><a data-type="indexterm" data-primary="modals, capturing scope in" id="ix_modscp" class="calibre6"/><a data-type="indexterm" data-primary="pop-ups" data-secondary="dialogs" id="idm46634385473928" class="calibre6"/> For example, the example tasks application used in this chapter displays a pop-up
dialog box when you click a task. The dialog box allows the user to edit the task’s details (see <a data-type="xref" href="#ch09_image_22" class="calibre6">Figure 9-22</a>).</p>

<figure class="calibre29"><div id="ch09_image_22" class="figure">
<img src="Images/recb_0922.png" alt="" class="calibre171"/>
<h6 class="calibre30"><span class="firstname">Figure 9-22. </span>A edit dialog appears when the user clicks a task</h6>
</div></figure>

<p class="author1">These pop-ups are frequently <em class="calibre7">modal</em>, which means we will either interact with them or dismiss them before returning to the rest of
the application.<a data-type="indexterm" data-primary="pop-ups" data-secondary="modal" id="idm46634385468840" class="calibre6"/> However, there can be a problem with custom modal dialogs: the focus can escape from them.<a data-type="indexterm" data-primary="focus" data-secondary="escaping from custom modal dialogs" id="idm46634385467624" class="calibre6"/><a data-type="indexterm" data-primary="dialogs" data-secondary="custom modal dialogs, focus escaping from" id="idm46634385466712" class="calibre6"/></p>

<p class="author1">Let’s look at the task form from the example application. An earlier version of the code suffered from this leaky-focus problem. If
the user clicked a task, they would see the task form, and the first field would instantly grab the focus. But if the user then
pressed back-Tab, the focus would shift into the other items in the background (see <a data-type="xref" href="#ch09_image_23" class="calibre6">Figure 9-23</a>).</p>

<figure class="calibre29"><div id="ch09_image_23" class="figure">
<img src="Images/recb_0923.png" alt="" class="calibre172"/>
<h6 class="calibre30"><span class="firstname">Figure 9-23. </span>Pressing back-Tab moves the focus out of the dialog and on to the <em class="calibre7">Charts</em> task</h6>
</div></figure>

<p class="author1">If you can see where the focus has gone, then this is a slightly odd feature. But this would be a significant source of confusion
for anyone using accessibility software, who might be completely unaware that the modal dialog is still on the screen. If someone
can see the screen but cannot use a mouse, the experience might be even stranger. The user might be able to focus on a component
that is hidden by the dialog.</p>

<p class="author1">We need a way of trapping the focus within a set of components so that the user cannot accidentally move into components that are
supposed to be out of reach.<a data-type="indexterm" data-primary="focus" data-secondary="trapping within small subset of components" id="ix_fcstrp" class="calibre6"/></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Solution" class="calibre4"><div class="preface" id="idm46634385458856">
<h2 class="calibre27">Solution</h2>

<p class="author1">We will install the React Focus Lock library, which will trap the focus into a small subset of components.<a data-type="indexterm" data-primary="dialogs" data-secondary="custom modal dialogs, trapping focus in" id="idm46634385457160" class="calibre6"/><a data-type="indexterm" data-primary="React Focus Lock library" id="ix_ReFocLk" class="calibre6"/> We will install it with
this command:</p>

<pre data-type="programlisting" data-code-language="shell-session" class="calibre28"><code class="go">$ npm install react-focus-lock</code></pre>

<p class="author1">The React Focus Lock library works by wrapping a set of components inside a 
<span class="firstname"><code class="calibre21">ReactFocusLock</code></span>, which will watch the focus, waiting
for it to move outside of itself. If that happens, it will immediately move the focus back inside.</p>

<p class="author1">The modal in our example application is created with the <code class="calibre21">Modal</code> component:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="s">'./Modal.css'</code>

<code class="kr">function</code> <code class="nx">Modal</code><code class="go">({</code> <code class="nx">open</code><code class="go">,</code> <code class="nx">onCancel</code><code class="go">,</code> <code class="nx">children</code><code class="go">,</code> <code class="nx">role</code><code class="go">,</code> <code class="nx">title</code> <code class="go">})</code> <code class="go">{</code>
  <code class="kr">if</code> <code class="go">(</code><code class="o">!</code><code class="nx">open</code><code class="go">)</code> <code class="go">{</code>
    <code class="kr">return</code> <code class="kr">null</code>
  <code class="go">}</code>

  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">role</code><code class="o">=</code><code class="s">"presentation"</code> <code class="na">className</code><code class="o">=</code><code class="s">"Modal"</code> <code class="na">...</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Modal-dialog"</code> <code class="na">role</code><code class="o">=</code><code class="go">{</code><code class="nx">role</code><code class="go">}</code> <code class="na">title</code><code class="o">=</code><code class="go">{</code><code class="nx">title</code><code class="go">}</code> <code class="na">...</code><code class="go">&gt;</code>
        <code class="go">{</code><code class="nx">children</code><code class="go">}</code>
      <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">We pass the entire contents of the modal as child components. We can use the React Focus Lock library to trap the focus within those
child components by wrapping them in a <code class="calibre21">ReactFocusLock</code>:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="nx">ReactFocusLock</code> <code class="nx">from</code> <code class="s">'react-focus-lock'</code>
<code class="kr">import</code> <code class="s">'./Modal.css'</code>

<code class="kr">function</code> <code class="nx">Modal</code><code class="go">({</code> <code class="nx">open</code><code class="go">,</code> <code class="nx">onCancel</code><code class="go">,</code> <code class="nx">children</code><code class="go">,</code> <code class="nx">role</code><code class="go">,</code> <code class="nx">title</code> <code class="go">})</code> <code class="go">{</code>
  <code class="kr">if</code> <code class="go">(</code><code class="o">!</code><code class="nx">open</code><code class="go">)</code> <code class="go">{</code>
    <code class="kr">return</code> <code class="kr">null</code>
  <code class="go">}</code>

  <code class="kr">return</code> <code class="go">(</code>
    <code class="go">&lt;</code><code class="nt">div</code> <code class="na">role</code><code class="o">=</code><code class="s">"presentation"</code> <code class="na">className</code><code class="o">=</code><code class="s">"Modal"</code> <code class="na">...</code><code class="go">&gt;</code>
      <code class="go">&lt;</code><code class="nt">div</code> <code class="na">className</code><code class="o">=</code><code class="s">"Modal-dialog"</code> <code class="na">role</code><code class="o">=</code><code class="go">{</code><code class="nx">role</code><code class="go">}</code> <code class="na">title</code><code class="o">=</code><code class="go">{</code><code class="nx">title</code><code class="go">}</code> <code class="na">...</code><code class="go">&gt;</code>
        <code class="go">&lt;</code><code class="nt">ReactFocusLock</code><code class="go">&gt;{</code><code class="nx">children</code><code class="go">}&lt;/</code><code class="nt">ReactFocusLock</code><code class="go">&gt;</code>
      <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
    <code class="go">&lt;/</code><code class="nt">div</code><code class="go">&gt;</code>
  <code class="go">)</code>
<code class="go">}</code></pre>

<p class="author1">Now, if a user opens the <code class="calibre21">TaskForm</code> and starts hitting the Tab key, they will cycle through the buttons and fields within the dialog
box. If they Tab past the last button, they will move to the first field, and vice versa.</p>
<div data-type="warning" epub:type="warning" class="calibre26">
<p class="author1">The library works by creating a<a data-type="indexterm" data-primary="tabIndex attribute" data-secondary="possible problem in Focus Lock library" id="idm46634385112968" class="calibre6"/> hidden button with <code class="calibre21">tabIndex</code> set to 1, breaking the tabindex rule in axe-core, stating
that no tabindex should be greater than 0. If this causes a problem, then you can disable the tabindex rule. For example, in
cypress-axe, you can run <code class="calibre21">cy.configureAxe({rules: [{ id: 'tabindex', enabled: false }]})</code> before performing an audit on the page.</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Discussion" class="calibre4"><div class="preface" id="idm46634385458264">
<h2 class="calibre27">Discussion</h2>

<p class="author1">Our example application uses a custom-mode dialog box and, in so doing, demonstrates why that is often a bad idea. If you use dialog
boxes and other components from libraries like Material UI, you will often get many accessibility features for free. Also, libraries
will often create floating elements outside of the “root” <code class="calibre21">div</code> of the React application.<a data-type="indexterm" data-primary="aria-hidden attribute" id="idm46634385108424" class="calibre6"/> They will then set the <code class="calibre21">aria-hidden</code>
attribute of the entire “root” <code class="calibre21">div</code> to <code class="calibre21">true</code>, which effectively hides the whole rest of the application from screen readers and
other accessibility software.</p>

<p class="author1">For an excellent example of an accessible modal, take a look at <a href="https://oreil.ly/2nI5x" class="calibre6">React Modal</a> from the ReactJS
team.<a data-type="indexterm" data-primary="React Modal" id="idm46634385105240" class="calibre6"/></p>

<p class="author1">You can download the source for this recipe
from the <a href="https://oreil.ly/0GfgA" class="calibre6">GitHub site</a>.<a data-type="indexterm" data-primary="React Focus Lock library" data-startref="ix_ReFocLk" id="idm46634385103432" class="calibre6"/><a data-type="indexterm" data-primary="focus" data-secondary="trapping within small subset of components" data-startref="ix_fcstrp" id="idm46634385102408" class="calibre6"/><a data-type="indexterm" data-primary="modals, capturing scope in" data-startref="ix_modscp" id="idm46634385101160" class="calibre6"/><a data-type="indexterm" data-primary="accessibility" data-secondary="capturing scope in modals" data-startref="ix_accssscpmod" id="idm46634385100200" class="calibre6"/></p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Create a Page Reader with the Speech API" class="calibre4"><div class="preface" id="ch09-09">
<h1 class="calibre17">Create a Page Reader with the Speech API</h1>








<section data-type="sect2" data-pdf-bookmark="Problem" class="calibre4"><div class="preface" id="idm46634385097288">
<h2 class="calibre27">Problem</h2>

<p class="author1">You can use many tools to check for accessibility, but it is hard to get a feel for what it is like for a person with particular
needs to use your application.<a data-type="indexterm" data-primary="screen readers" data-secondary="creating page reader with Speech API" id="ix_scrnrdcr" class="calibre6"/><a data-type="indexterm" data-primary="accessibility" data-secondary="creating page reader with Speech API" id="ix_accsspgrd" class="calibre6"/><a data-type="indexterm" data-primary="Speech API, creating page reader with" id="ix_Spch" class="calibre6"/> That is why the best way to create an accessible application is to involve people who have to
use accessibility devices to build and test your code.</p>

<p class="author1">For the rest of us, getting a “feel” for the experience of using the application with accessibility software is still helpful. But
there are problems. Braille readers rely on the ability of the user to read Braille. Software that reads out your application is a
good option, but most screen readers are pretty expensive. The Mac comes with a built-in screen reader called VoiceOver, which has a
whole host of features that allow you to skip around a screen. But not everyone uses a Mac.</p>

<p class="author1">Chrome has an extension called ChromeVox, which works well, but it’s available only for Chrome and no longer appears to be actively
developed.</p>

<p class="author1">In addition to all of those issues, screen readers will want to tell you about <em class="calibre7">everything</em>. You might want to use the screen reader
to see what some part of your application is like to use, but it will continue to read to you when you switch back to your IDE or
some reference material in another browser tab.</p>

<p class="author1">Even with all of those issues, it is still worth trying to experience an audio version of your application. If nothing else, it will
give you some sense of what a poor job most of us do at writing software that people can use.</p>

<p class="author1">What can we do to try our application with a screen reader?</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Solution" class="calibre4"><div class="preface" id="idm46634385088104">
<h2 class="calibre27">Solution</h2>

<p class="author1">We’re going to create a simple screen reader—a very, <em class="calibre7">very</em> simple screen reader.<a data-type="indexterm" data-primary="talkToMe screen reader example" id="ix_Tlkto" class="calibre6"/> It won’t be professional quality, but it will
provide some sense of using our application with only a keyboard and audio feedback. It will also work on our local React
application and won’t affect our machine’s other pages or desktop applications. It’s called TalkToMe.<sup class="calibre34"><a data-type="noteref" id="idm46634385084376-marker" href="ch09.xhtml#idm46634385084376" class="calibre35">10</a></sup></p>

<p class="author1">We will add a small amount of code to the example tasks application we are using throughout this chapter. We don’t want the screen
reader code to be included in the production version of our code, so we’ll begin by adding a file called <em class="calibre7">talkToMe.js</em> to the main
source folder:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">function</code> <code class="nx">talkToMe</code><code class="go">()</code> <code class="go">{</code>
  <code class="kr">if</code> <code class="go">(</code>
    <code class="nx">process</code><code class="go">.</code><code class="nx">env</code><code class="go">.</code><code class="nx">NODE_ENV</code> <code class="o">!==</code> <code class="s">'production'</code> <code class="o">&amp;&amp;</code>
    <code class="nx">sessionStorage</code><code class="go">.</code><code class="nx">getItem</code><code class="go">(</code><code class="s">'talkToMe'</code><code class="go">)</code> <code class="o">===</code> <code class="s">'true'</code>
  <code class="go">)</code> <code class="go">{</code>
    <code class="go">...</code>
  <code class="go">}</code>
<code class="go">}</code></pre>

<p class="author1">By checking the <code class="calibre21">NODE_ENV</code> value, we can limit the code to our development environment. We’re also checking for the session-storage
variable called <code class="calibre21">talkToMe</code>. We will run the screen reader only if this exists and has the value <code class="calibre21">"true"</code>.</p>

<p class="author1">We need the code to read out the details of the current element that has the focus. Focus events don’t bubble, which means we cannot
simply attach an <code class="calibre21">onFocus</code> event handler to a high-level element and start tracking focus.</p>

<p class="author1">However, we <em class="calibre7">can</em> listen to <code class="calibre21">focusin</code> events.<a data-type="indexterm" data-primary="focus" data-secondary="listener for focusin events" id="idm46634385046072" class="calibre6"/> We can attach a <code class="calibre21">focusin</code> listener to the <code class="calibre21">document</code> object, and it will be called
every time the user moves to a new component:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">function</code> <code class="nx">talkToMe</code><code class="go">()</code> <code class="go">{</code>
  <code class="kr">if</code> <code class="go">(</code>
    <code class="nx">process</code><code class="go">.</code><code class="nx">env</code><code class="go">.</code><code class="nx">NODE_ENV</code> <code class="o">!==</code> <code class="s">'production'</code> <code class="o">&amp;&amp;</code>
    <code class="nx">sessionStorage</code><code class="go">.</code><code class="nx">getItem</code><code class="go">(</code><code class="s">'talkToMe'</code><code class="go">)</code> <code class="o">===</code> <code class="s">'true'</code>
  <code class="go">)</code> <code class="go">{</code>
    <code class="nb">document</code><code class="go">.</code><code class="nx">addEventListener</code><code class="go">(</code><code class="s">'focusin'</code><code class="go">,</code> <code class="go">(</code><code class="nx">evt</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
      <code class="kr">if</code> <code class="go">(</code><code class="nx">sessionStorage</code><code class="go">.</code><code class="nx">getItem</code><code class="go">(</code><code class="s">'talkToMe'</code><code class="go">)</code> <code class="o">===</code> <code class="s">'true'</code><code class="go">)</code> <code class="go">{</code>
        <code class="go">....</code>
      <code class="go">}</code>
    <code class="go">})</code>
  <code class="go">}</code>
<code class="go">}</code></pre>

<p class="author1">Notice that we do an additional check for the <code class="calibre21">talkToMe</code> item, just in case the user has switched it off while using the
application.</p>

<p class="author1">We need some way of describing the currently focused element.<a data-type="indexterm" data-primary="focus" data-secondary="describing currently focused elemet in screen reader" id="idm46634384924488" class="calibre6"/> This function will provide a rough description of the current element,
based upon its name, its role, and so on:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">function</code> <code class="nx">getDescription</code><code class="go">(</code><code class="nx">element</code><code class="go">)</code> <code class="go">{</code>
  <code class="kr">const</code> <code class="nx">nodeName</code> <code class="o">=</code> <code class="nx">element</code><code class="go">.</code><code class="nx">nodeName</code><code class="go">.</code><code class="nx">toUpperCase</code><code class="go">()</code>
  <code class="kr">const</code> <code class="nx">role</code> <code class="o">=</code> <code class="nx">element</code><code class="go">.</code><code class="nx">role</code>
    <code class="o">?</code> <code class="nx">element</code><code class="go">.</code><code class="nx">role</code>
    <code class="o">:</code> <code class="nx">nodeName</code> <code class="o">===</code> <code class="s">'BUTTON'</code>
    <code class="o">?</code> <code class="s">'button'</code>
    <code class="o">:</code> <code class="nx">nodeName</code> <code class="o">===</code> <code class="s">'INPUT'</code> <code class="o">||</code> <code class="nx">nodeName</code> <code class="o">===</code> <code class="s">'TEXTAREA'</code>
    <code class="o">?</code> <code class="s">'text field '</code> <code class="o">+</code> <code class="nx">element</code><code class="go">.</code><code class="nx">value</code>
    <code class="o">:</code> <code class="nx">nodeName</code> <code class="o">===</code> <code class="s">'SELECT'</code>
    <code class="o">?</code> <code class="s">'select field '</code> <code class="o">+</code> <code class="nx">element</code><code class="go">.</code><code class="nx">value</code>
    <code class="o">:</code> <code class="nx">element</code><code class="go">.</code><code class="nx">getAttribute</code><code class="go">(</code><code class="s">'role'</code><code class="go">)</code> <code class="o">||</code> <code class="s">'group'</code>
  <code class="kr">const</code> <code class="nx">title</code> <code class="o">=</code> <code class="nx">element</code><code class="go">.</code><code class="nx">title</code> <code class="o">||</code> <code class="nx">element</code><code class="go">.</code><code class="nx">textContent</code>
  <code class="kr">const</code> <code class="nx">extraInstructions</code> <code class="o">=</code>
    <code class="nx">nodeName</code> <code class="o">===</code> <code class="s">'INPUT'</code> <code class="o">||</code> <code class="nx">nodeName</code> <code class="o">===</code> <code class="s">'TEXTAREA'</code>
      <code class="o">?</code> <code class="s">'You are currently in a text field. To enter text, type.'</code>
      <code class="o">:</code> <code class="s">''</code>
  <code class="kr">return</code> <code class="nx">role</code> <code class="o">+</code> <code class="s">'. '</code> <code class="o">+</code> <code class="nx">title</code> <code class="o">+</code> <code class="s">'. '</code> <code class="o">+</code> <code class="nx">extraInstructions</code>
<code class="go">}</code></pre>

<p class="author1">We can get now get a description of the currently focused element:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">function</code> <code class="nx">talkToMe</code><code class="go">()</code> <code class="go">{</code>
  <code class="kr">if</code> <code class="go">(</code>
    <code class="nx">process</code><code class="go">.</code><code class="nx">env</code><code class="go">.</code><code class="nx">NODE_ENV</code> <code class="o">!==</code> <code class="s">'production'</code> <code class="o">&amp;&amp;</code>
    <code class="nx">sessionStorage</code><code class="go">.</code><code class="nx">getItem</code><code class="go">(</code><code class="s">'talkToMe'</code><code class="go">)</code> <code class="o">===</code> <code class="s">'true'</code>
  <code class="go">)</code> <code class="go">{</code>
    <code class="nb">document</code><code class="go">.</code><code class="nx">addEventListener</code><code class="go">(</code><code class="s">'focusin'</code><code class="go">,</code> <code class="go">(</code><code class="nx">evt</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
      <code class="kr">if</code> <code class="go">(</code><code class="nx">sessionStorage</code><code class="go">.</code><code class="nx">getItem</code><code class="go">(</code><code class="s">'talkToMe'</code><code class="go">)</code> <code class="o">===</code> <code class="s">'true'</code><code class="go">)</code> <code class="go">{</code>
        <code class="kr">const</code> <code class="nx">description</code> <code class="o">=</code> <code class="nx">getDescription</code><code class="go">(</code><code class="nx">evt</code><code class="go">.</code><code class="nx">target</code><code class="go">)</code>
        <code class="go">....</code>
      <code class="go">}</code>
    <code class="go">})</code>
  <code class="go">}</code>
<code class="go">}</code></pre>

<p class="author1">Now we need to convert the text of the description into speech.<a data-type="indexterm" data-primary="text, converting to speech" id="idm46634384792136" class="calibre6"/><a data-type="indexterm" data-primary="Web Speech API" id="idm46634384791528" class="calibre6"/> For this, we can use the Web Speech API, which most browsers now
include.<a data-type="indexterm" data-primary="utterances" id="idm46634384728488" class="calibre6"/> The speech synthesizer accepts an object called an <em class="calibre7">utterance</em>:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="nb">window</code><code class="go">.</code><code class="nx">speechSynthesis</code><code class="go">.</code><code class="nx">speak</code><code class="go">(</code>
  <code class="kr">new</code> <code class="nx">SpeechSynthesisUtterance</code><code class="go">(</code><code class="nx">description</code><code class="go">)</code>
<code class="go">)</code></pre>

<p class="author1">Before we start to read out a piece of text, we first need to check if we are already in the process of reading something else. If
we are, we will cancel the old utterance and begin the new one, which will allow the user to quickly skip from component to
component as soon as they have heard enough information:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">if</code> <code class="go">(</code><code class="nb">window</code><code class="go">.</code><code class="nx">speechSynthesis</code><code class="go">.</code><code class="nx">speaking</code><code class="go">)</code> <code class="go">{</code>
  <code class="nb">window</code><code class="go">.</code><code class="nx">speechSynthesis</code><code class="go">.</code><code class="nx">cancel</code><code class="go">()</code>
<code class="go">}</code>
<code class="nb">window</code><code class="go">.</code><code class="nx">speechSynthesis</code><code class="go">.</code><code class="nx">speak</code><code class="go">(</code>
  <code class="kr">new</code> <code class="nx">SpeechSynthesisUtterance</code><code class="go">(</code><code class="nx">description</code><code class="go">)</code>
<code class="go">)</code></pre>

<p class="author1">This gives us the final version of <code class="calibre21">talkToMe</code>:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">function</code> <code class="nx">talkToMe</code><code class="go">()</code> <code class="go">{</code>
  <code class="kr">if</code> <code class="go">(</code>
    <code class="nx">process</code><code class="go">.</code><code class="nx">env</code><code class="go">.</code><code class="nx">NODE_ENV</code> <code class="o">!==</code> <code class="s">'production'</code> <code class="o">&amp;&amp;</code>
    <code class="nx">sessionStorage</code><code class="go">.</code><code class="nx">getItem</code><code class="go">(</code><code class="s">'talkToMe'</code><code class="go">)</code> <code class="o">===</code> <code class="s">'true'</code>
  <code class="go">)</code> <code class="go">{</code>
    <code class="nb">document</code><code class="go">.</code><code class="nx">addEventListener</code><code class="go">(</code><code class="s">'focusin'</code><code class="go">,</code> <code class="go">(</code><code class="nx">evt</code><code class="go">)</code> <code class="o">=&gt;</code> <code class="go">{</code>
      <code class="kr">if</code> <code class="go">(</code><code class="nx">sessionStorage</code><code class="go">.</code><code class="nx">getItem</code><code class="go">(</code><code class="s">'talkToMe'</code><code class="go">)</code> <code class="o">===</code> <code class="s">'true'</code><code class="go">)</code> <code class="go">{</code>
        <code class="kr">const</code> <code class="nx">description</code> <code class="o">=</code> <code class="nx">getDescription</code><code class="go">(</code><code class="nx">evt</code><code class="go">.</code><code class="nx">target</code><code class="go">)</code>
        <code class="kr">if</code> <code class="go">(</code><code class="nb">window</code><code class="go">.</code><code class="nx">speechSynthesis</code><code class="go">.</code><code class="nx">speaking</code><code class="go">)</code> <code class="go">{</code>
          <code class="nb">window</code><code class="go">.</code><code class="nx">speechSynthesis</code><code class="go">.</code><code class="nx">cancel</code><code class="go">()</code>
        <code class="go">}</code>
        <code class="nb">window</code><code class="go">.</code><code class="nx">speechSynthesis</code><code class="go">.</code><code class="nx">speak</code><code class="go">(</code>
          <code class="kr">new</code> <code class="nx">SpeechSynthesisUtterance</code><code class="go">(</code><code class="nx">description</code><code class="go">)</code>
        <code class="go">)</code>
      <code class="go">}</code>
    <code class="go">})</code>
  <code class="go">}</code>
<code class="go">}</code></pre>

<p class="author1">We can now add <code class="calibre21">talkToMe</code> to our application, by calling it from the <em class="calibre7">index.js</em> file at the top of our application:</p>

<pre data-type="programlisting" data-code-language="jsx" class="calibre28"><code class="kr">import</code> <code class="nx">React</code> <code class="nx">from</code> <code class="s">'react'</code>
<code class="kr">import</code> <code class="nx">ReactDOM</code> <code class="nx">from</code> <code class="s">'react-dom'</code>
<code class="kr">import</code> <code class="s">'./index.css'</code>
<code class="kr">import</code> <code class="nx">App</code> <code class="nx">from</code> <code class="s">'./App'</code>
<code class="kr">import</code> <code class="nx">reportWebVitals</code> <code class="nx">from</code> <code class="s">'./reportWebVitals'</code>
<code class="kr">import</code> <code class="nx">talkToMe</code> <code class="nx">from</code> <code class="s">'./talkToMe'</code>

<code class="nx">talkToMe</code><code class="go">()</code>

<code class="nx">ReactDOM</code><code class="go">.</code><code class="nx">render</code><code class="go">(</code>
  <code class="go">&lt;</code><code class="nt">React</code><code class="go">.</code><code class="na">StrictMode</code><code class="go">&gt;</code>
    <code class="go">&lt;</code><code class="nt">App</code> <code class="go">/&gt;</code>
  <code class="go">&lt;/</code><code class="nt">React</code><code class="go">.</code><code class="na">StrictMode</code><code class="go">&gt;,</code>
  <code class="nb">document</code><code class="go">.</code><code class="nx">getElementById</code><code class="go">(</code><code class="s">'root'</code><code class="go">)</code>
<code class="go">)</code>

<code class="c">// If you want to start measuring performance in your app, pass a function</code>
<code class="c">// to log results (for example: reportWebVitals(console.log))</code>
<code class="c">// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals</code>
<code class="nx">reportWebVitals</code><code class="go">()</code></pre>

<p class="author1">If you now open your application in a browser, open the developer console, and create a new session-storage variable called
<code class="calibre21">talkToMe</code> set to the string “true,” you should now hear elements described as you Tab between them.<a data-type="indexterm" data-primary="browsers" data-secondary="hearing elements described while tabbing between them" id="idm46634384443048" class="calibre6"/></p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Discussion" class="calibre4"><div class="preface" id="idm46634385087160">
<h2 class="calibre27">Discussion</h2>

<p class="author1">The <em class="calibre7">talkToMe</em> screen reader is little more than a toy, but it will help you create concise titles and other metadata in your code,
stressing how important it is to “front-load” information in descriptions. The sooner the user can decide that an element is not
what they’re looking for, the sooner they can move on. It will also make it abundantly clear which parts of your application are
challenging to navigate and allow you to try your application without looking at the screen.</p>

<p class="author1">You can download the source for this recipe from the <a href="https://oreil.ly/0GfgA" class="calibre6">GitHub site</a>.<a data-type="indexterm" data-primary="talkToMe screen reader example" data-startref="ix_Tlkto" id="idm46634384329128" class="calibre6"/><a data-type="indexterm" data-primary="accessibility" data-secondary="creating page reader with Speech API" data-startref="ix_accsspgrd" id="idm46634384328152" class="calibre6"/><a data-type="indexterm" data-primary="Speech API, creating page reader with" data-startref="ix_Spch" id="idm46634384326968" class="calibre6"/><a data-type="indexterm" data-primary="accessibility" data-startref="ix_acss" id="idm46634384326056" class="calibre6"/></p>
</div></section>





</div></section>







<div data-type="footnotes" class="calibre49"><p data-type="footnote" id="idm46634389781320" class="calibre50"><sup class="calibre51"><a href="ch09.xhtml#idm46634389781320-marker" class="calibre35">1</a></sup> For an interesting discussion on the issues surrounding menus and menu items, see <a href="https://oreil.ly/i8AMI" class="calibre6">this article</a> by Adrian Roselli.</p><p data-type="footnote" id="idm46634389084008" class="calibre50"><sup class="calibre51"><a href="ch09.xhtml#idm46634389084008-marker" class="calibre35">2</a></sup> We found this ourselves while writing this chapter. As a result, we have undoubtedly missed many, many accessibility issues in the example application.</p><p data-type="footnote" id="idm46634389065672" class="calibre50"><sup class="calibre51"><a href="ch09.xhtml#idm46634389065672-marker" class="calibre35">3</a></sup> Particularly useful if you want to check your code in pre-commit Git hooks or on an integration server.</p><p data-type="footnote" id="idm46634388735016" class="calibre50"><sup class="calibre51"><a href="ch09.xhtml#idm46634388735016-marker" class="calibre35">4</a></sup> See <a data-type="xref" href="#ch09-02" class="calibre6">“Apply Roles, Alts, and Titles”</a> for details on roles and their uses.</p><p data-type="footnote" id="idm46634388558776" class="calibre50"><sup class="calibre51"><a href="ch09.xhtml#idm46634388558776-marker" class="calibre35">5</a></sup> See the issues involving values greater than zero in <a data-type="xref" href="#ch09-08" class="calibre6">“Capture Scope in Modals”</a>.</p><p data-type="footnote" id="idm46634388266296" class="calibre50"><sup class="calibre51"><a href="ch09.xhtml#idm46634388266296-marker" class="calibre35">6</a></sup> By the time you read this book, such a rule might exist.</p><p data-type="footnote" id="idm46634387988088" class="calibre50"><sup class="calibre51"><a href="ch09.xhtml#idm46634387988088-marker" class="calibre35">7</a></sup> You can call this file whatever you like, so long as it has a <em class="calibre7">.js</em> extension and is inside the integration directory.</p><p data-type="footnote" id="idm46634386852088" class="calibre50"><sup class="calibre51"><a href="ch09.xhtml#idm46634386852088-marker" class="calibre35">8</a></sup> See <a data-type="xref" href="#ch09-01" class="calibre6">“Use Landmarks”</a> for more information about <code class="calibre21">main</code> sections.</p><p data-type="footnote" id="idm46634386097672" class="calibre50"><sup class="calibre51"><a href="ch09.xhtml#idm46634386097672-marker" class="calibre35">9</a></sup> This is based on an answer to a question on <a href="https://oreil.ly/Li5sB" class="calibre6">StackOverflow</a> by user <a href="https://oreil.ly/5p8nS" class="calibre6">Radek</a>.</p><p data-type="footnote" id="idm46634385084376" class="calibre50"><sup class="calibre51"><a href="ch09.xhtml#idm46634385084376-marker" class="calibre35">10</a></sup> Thanks to Terry Tibbs for his help in writing this tool.</p></div></div></section></div></body></html>