<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:epub="http://www.idpf.org/2007/ops" lang="en" xml:lang="en" xsi:schemaLocation="http://www.w3.org/2002/06/xhtml2/ http://www.w3.org/MarkUp/SCHEMA/xhtml2.xsd">
  <head>
    <title>Unknown</title>
    <link rel="stylesheet" type="text/css" href="../stylesheet.css"/>
    <link rel="stylesheet" type="text/css" href="../page_styles.css"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  </head>
  <body class="calibre"><div id="sbo-rt-content" class="calibre1"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 9. Labels and Annotations" class="praise"><div class="dedication" id="labels_annotations">
<h1 class="calibre14"><span class="keep-together">Chapter 9. </span>Labels and Annotations</h1>


<p class="author1">The exam curriculum doesn’t explicitly mention the concept of labels; however, it’s an important one for understanding how certain Kubernetes primitives function internally. To avoid confusing labels with annotations, we’ll also discuss the commonalities and differences among those concepts.</p>

<p class="author1">Labels are an essential tool for querying, filtering, and sorting Kubernetes objects. Annotations represent descriptive metadata for Kubernetes objects but can’t be used for queries. In this chapter, you will learn how to assign and use both concepts.</p>
<aside data-type="sidebar" epub:type="sidebar" class="calibre48"><div class="sidebar" id="id478">
<h1 class="calibre49">Coverage of Curriculum Objectives</h1>
<p class="author1">The curriculum doesn’t explicitly mention coverage of labels and annotations. It’s important to understand labels because primitives like the Deployment, Service, and NetworkPolicy can’t function without them.</p>
</div></aside>






<section data-type="sect1" data-pdf-bookmark="Working with Labels" class="praise"><div class="dedication" id="id233">
<h1 class="calibre17">Working with Labels</h1>

<p class="author1">Kubernetes lets you assign key-value pairs to objects so that you can use them later within a search query. Those key-value pairs are called <em class="calibre3">labels</em>. To draw an analogy, you can think of labels as tags for a blog post.</p>

<p class="author1">A label describes a Kubernetes object in distinct terms (e.g., a category like “frontend” or “backend”), but it is not meant for elaborate, multi-word descriptions of its functionality. As part of the specification, Kubernetes limits the length of a label to a maximum of 63 characters and a range of allowed alphanumeric and separator characters.</p>

<p class="author1"><a data-type="xref" href="#pod_labels" class="calibre10">Figure 9-1</a> shows the Pods named <code class="calibre15">frontend</code>, <code class="calibre15">backend</code>, and <code class="calibre15">database</code>. Each of the Pods declares a unique set of labels.</p>

<figure class="calibre35"><div id="pod_labels" class="figure">
<img src="Images/ckd2_0901.png" alt="ckd2 0901" class="calibre81"/>
<h6 class="calibre32"><span class="keep-together">Figure 9-1. </span>Pods with labels</h6>
</div></figure>

<p class="author1">It’s common practice to assign one or many labels to an object at creation time; however, you can modify them as needed for a live object. When you see labels for the first time, they might seem insignificant—but their importance cannot be overstated. They’re essential for understanding the runtime behavior of more advanced Kubernetes objects like a Deployment and a Service. Later in this chapter, we’ll see the significance of labels in practice when learning about Deployments in more detail.</p>








<section data-type="sect2" data-pdf-bookmark="Declaring Labels" class="praise"><div class="dedication" id="id234">
<h2 class="calibre33">Declaring Labels</h2>

<p class="author1">You can declare labels imperatively with the <code class="calibre15">run</code> command or declaratively in the <code class="calibre15">metadata.labels</code> section in the YAML manifest. The command-line option <code class="calibre15">--labels</code> (or <code class="calibre15">-l</code> in its short form) defines a comma-separated list of labels when creating a Pod. The following command creates a new Pod with two labels from the command line:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl run labeled-pod --image=nginx:1.25.1 \
  --labels=tier=backend,env=dev</strong>
pod/labeled-pod created
</pre>

<p class="author1">Assigning labels to Kubernetes objects by editing the manifest requires a change to the <code class="calibre15">metadata</code> section. <a data-type="xref" href="#pod_metadata_labels" class="calibre10">Example 9-1</a> shows the Pod definition from the previous command if we were to start with the YAML manifest.</p>
<div id="pod_metadata_labels" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 9-1. </span>A Pod defining two labels</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">v1</code><code class="w"></code>
<code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">Pod</code><code class="w"></code>
<code class="nt">metadata</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">labeled-pod</code><code class="w"></code>
<code class="w">  </code><code class="nt">labels</code><code class="p">:</code><code class="w"></code>
<code class="w">    </code><code class="nt">env</code><code class="p">:</code><code class="w"> </code><code class="calibre15">dev</code><code class="w"></code>
<code class="w">    </code><code class="nt">tier</code><code class="p">:</code><code class="w"> </code><code class="calibre15">backend</code><code class="w"></code>
<code class="nt">spec</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">containers</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">image</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx:1.25.1</code><code class="w"></code>
<code class="w">    </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx</code><code class="w"></code></pre></div>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Inspecting Labels" class="praise"><div class="dedication" id="id235">
<h2 class="calibre33">Inspecting Labels</h2>

<p class="author1">You can inspect the labels assigned to a Kubernetes object from different angles. Here, we’ll want to look at the most common ways to identify the labels of a Pod. As with any other runtime information, you can use the <code class="calibre15">describe</code> or <code class="calibre15">get</code> commands to retrieve the labels:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl describe pod labeled-pod | grep -C 2 Labels:</strong>
...
Labels:       env=dev
              tier=backend
...
<strong class="calibre38">$ kubectl get pod labeled-pod -o yaml | grep -C 1 labels:</strong>
metadata:
  labels:
    env: dev
    tier: backend
...
</pre>

<p class="author1">If you want to list the labels for all object types or a specific object type, use the <code class="calibre15">--show-labels</code> command-line option. This option is convenient if you need to sift through a longer list of objects. The output automatically adds a new column named <code class="calibre15">LABELS</code>:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl get pods --show-labels</strong>
NAME          READY   STATUS    RESTARTS   AGE   LABELS
labeled-pod   1/1     Running   0          38m   env=dev,tier=backend
</pre>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Modifying Labels for a Live Object" class="praise"><div class="dedication" id="id236">
<h2 class="calibre33">Modifying Labels for a Live Object</h2>

<p class="author1">You can add or remove a label from an existing Kubernetes object, or simply modify an existing label at any time. One way to achieve this is by editing the live object and changing the label definition in the <code class="calibre15">metadata.labels</code> section. The other option, which offers a slightly faster turnaround, is the <code class="calibre15">label</code> command. The following commands add a new label, change the value of the label, and then remove the label with the minus character:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl label pod labeled-pod region=eu</strong>
pod/labeled-pod labeled
<strong class="calibre38">$ kubectl get pod labeled-pod --show-labels</strong>
NAME          READY   STATUS    RESTARTS   AGE   LABELS
labeled-pod   1/1     Running   0          22h   env=dev,region=eu,tier=backend
<strong class="calibre38">$ kubectl label pod labeled-pod region=us --overwrite</strong>
pod/labeled-pod labeled
<strong class="calibre38">$ kubectl get pod labeled-pod --show-labels</strong>
NAME          READY   STATUS    RESTARTS   AGE   LABELS
labeled-pod   1/1     Running   0          22h   env=dev,region=us,tier=backend
<strong class="calibre38">$ kubectl label pod labeled-pod region-</strong>
pod/labeled-pod labeled
<strong class="calibre38">$ kubectl get pod labeled-pod --show-labels</strong>
NAME          READY   STATUS    RESTARTS   AGE   LABELS
labeled-pod   1/1     Running   0          22h   env=dev,tier=backend
</pre>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Using Label Selectors" class="praise"><div class="dedication" id="id237">
<h2 class="calibre33">Using Label Selectors</h2>

<p class="author1">Labels become meaningful only when combined with the selection feature. A label selector uses a set of criteria to query for Kubernetes objects. For example, you could use a label selector to express “select all Pods with the label assignment <code class="calibre15">env=dev</code>, <code class="calibre15">tier=frontend</code>, and have a label with the key <code class="calibre15">version</code> independent of the assigned value,” as shown in <a data-type="xref" href="#label_selection" class="calibre10">Figure 9-2</a>.</p>

<figure class="calibre35"><div id="label_selection" class="figure">
<img src="Images/ckd2_0902.png" alt="ckd2 0902" class="calibre81"/>
<h6 class="calibre32"><span class="keep-together">Figure 9-2. </span>Selecting Pods by label criteria</h6>
</div></figure>

<p class="author1">Kubernetes offers two ways to select objects by labels: from the command line and within a manifest. Let’s talk about both options.</p>










<section data-type="sect3" data-pdf-bookmark="Label selection from the command line" class="praise"><div class="dedication" id="id238">
<h3 class="calibre44">Label selection from the command line</h3>

<p class="author1">On the command line, you can select objects by label using the <code class="calibre15">--selector</code> option (<code class="calibre15">-l</code> in its short-form notation). You can express a filter by providing an equality-based requirement or a set-based requirement. Both requirement types can be combined in a single query.</p>

<p class="author1">An <em class="calibre3">equality-based requirement</em> can use the operators <code class="calibre15">=</code>, <code class="calibre15">==</code>, or <code class="calibre15">!=</code>. You can separate multiple filter terms with a comma and then combine them with a boolean <code class="calibre15">AND</code>. At this time, equality-based label selection cannot express a boolean <code class="calibre15">OR</code> operation. A typical expression could say, “select all Pods with the label assignment <code class="calibre15">env=prod</code>.”</p>

<p class="author1">A <em class="calibre3">set-based requirement</em> can filter objects based on a set of values using the operators <code class="calibre15">in</code>, <code class="calibre15">notin</code>, and <code class="calibre15">exists</code>. The <code class="calibre15">in</code> and <code class="calibre15">notin</code> operators work based on a boolean <code class="calibre15">OR</code>. A typical expression could say, “select all Pods with the label key <code class="calibre15">env</code> and the value <code class="calibre15">prod</code> or <code class="calibre15">dev</code>.”</p>

<p class="author1">To demonstrate the functionality, we’ll start by setting up three different Pods with labels. All <code class="calibre15">kubectl</code> commands use the command-line option <code class="calibre15">--show-labels</code> to compare the results with our expectations. The <code class="calibre15">--show-labels</code> option is not needed for label selection:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl run frontend --image=nginx:1.25.1 --labels=env=prod,team=shiny</strong>
pod/frontend created
<strong class="calibre38">$ kubectl run backend --image=nginx:1.25.1 --labels=env=prod,team=legacy,\
app=v1.2.4</strong>
pod/backend created
<strong class="calibre38">$ kubectl run database --image=nginx:1.25.1 --labels=env=prod,team=storage</strong>
pod/database created
<strong class="calibre38">$ kubectl get pods --show-labels</strong>
NAME       READY   STATUS    RESTARTS   AGE   LABELS
backend    1/1     Running   0          37s   app=v1.2.4,env=prod,team=legacy
database   1/1     Running   0          32s   env=prod,team=storage
frontend   1/1     Running   0          42s   env=prod,team=shiny
</pre>

<p class="author1">We’ll start by filtering the Pods with an equality-based requirement. Here, we are looking for all Pods with the label assignment <code class="calibre15">env=prod</code>. The result returns all three Pods:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl get pods -l env=prod --show-labels</strong>
NAME       READY   STATUS    RESTARTS   AGE   LABELS
backend    1/1     Running   0          37s   app=v1.2.4,env=prod,team=legacy
database   1/1     Running   0          32s   env=prod,team=storage
frontend   1/1     Running   0          42s   env=prod,team=shiny
</pre>

<p class="author1">The next filter operation uses a set-based requirement. We are asking for all Pods that have the label key <code class="calibre15">team</code> with the values <code class="calibre15">storage</code> or <code class="calibre15">shiny</code>. The result returns only the Pods named <code class="calibre15">backend</code> and <code class="calibre15">frontend</code>:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl get pods -l 'team in (shiny, legacy)' --show-labels</strong>
NAME       READY   STATUS    RESTARTS   AGE   LABELS
backend    1/1     Running   0          19m   app=v1.2.4,env=prod,team=legacy
frontend   1/1     Running   0          20m   env=prod,team=shiny
</pre>

<p class="author1">Finally, we’ll combine an equality-based requirement with a set-based requirement. The result returns only the <code class="calibre15">backend</code> Pod:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl get pods -l 'team in (shiny, legacy)',app=v1.2.4 --show-labels</strong>
NAME      READY   STATUS    RESTARTS   AGE   LABELS
backend   1/1     Running   0          29m   app=v1.2.4,env=prod,team=legacy
</pre>
</div></section>










<section data-type="sect3" data-pdf-bookmark="Label selection in a manifest" class="praise"><div class="dedication" id="id239">
<h3 class="calibre44">Label selection in a manifest</h3>

<p class="author1">Some advanced Kubernetes objects such as Deployments, Services, or network policies act as configuration proxies for Pods. They usually select a set of Pods by labels and then provide added value. For example, a network policy controls network traffic from and to a set of Pods. Only the Pods with matching labels will apply the network rules. <a data-type="xref" href="#network_policy_pod_label_selection" class="calibre10">Example 9-2</a> applies the network policy to Pods with the equality-based requirement <code class="calibre15">tier=frontend</code>. For more details on network policies, see <a data-type="xref" href="ch23.xhtml#network_policies" class="calibre10">Chapter 23</a>.</p>
<div id="network_policy_pod_label_selection" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 9-2. </span>Label selection as part of the network policy API</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">networking.k8s.io/v1</code><code class="w"></code>
<code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">NetworkPolicy</code><code class="w"></code>
<code class="nt">metadata</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">frontend-network-policy</code><code class="w"></code>
<code class="nt">spec</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">podSelector</code><code class="p">:</code><code class="w"></code>
<code class="w">    </code><code class="nt">matchLabels</code><code class="p">:</code><code class="w"></code>
<code class="w">      </code><code class="nt">tier</code><code class="p">:</code><code class="w"> </code><code class="calibre15">frontend</code><code class="w"></code>
<code class="p">...</code><code class="w"></code></pre></div>

<p class="author1">The way you define label selection in a manifest is based on the API version of the Kubernetes resources and may differ between types. The content that follows in later chapters will use label selection heavily.</p>
</div></section>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Recommended Labels" class="praise"><div class="dedication" id="id240">
<h2 class="calibre33">Recommended Labels</h2>

<p class="author1">As you continue working with labels, you will likely find common key-value pairs you want to assign to objects. Many of those labels evolve around metadata for an application, for example, the name of the component you are deploying with a Pod, or its version.</p>

<p class="author1">Kubernetes proposes a list of <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels/" class="calibre10">recommended labels</a>, all of which start with the key prefix <code class="calibre15">app.kubernetes.io</code>. <a data-type="xref" href="#recommended_labels_pod" class="calibre10">Example 9-3</a> shows the assignment of version and component labels in a Pod definition.</p>
<div id="recommended_labels_pod" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 9-3. </span>A Pod using recommended labels</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">v1</code><code class="w"></code>
<code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">Pod</code><code class="w"></code>
<code class="nt">metadata</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx</code><code class="w"></code>
<code class="w">  </code><code class="nt">labels</code><code class="p">:</code><code class="w"></code>
<code class="w">    </code><code class="nt">app.kubernetes.io/version</code><code class="p">:</code><code class="w"> </code><code class="s">"1.25.1"</code><code class="w"></code>
<code class="w">    </code><code class="nt">app.kubernetes.io/component</code><code class="p">:</code><code class="w"> </code><code class="calibre15">server</code><code class="w"></code>
<code class="nt">spec</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">containers</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx</code><code class="w"></code>
<code class="w">    </code><code class="nt">image</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx:1.25.1</code><code class="w"></code></pre></div>

<p class="author1">Familiarize yourself with these recommended labels so you can use them across all objects you are managing. This provides the benefit of enabling tooling in the Kubernetes ecosystem to use the same terminology and enabling developers to use the same “language” when referring to application meta information.</p>
</div></section>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Working with Annotations" class="praise"><div class="dedication" id="id241">
<h1 class="calibre17">Working with Annotations</h1>

<p class="author1">Annotations are declared similarly to labels, but they serve a different purpose. They represent key-value pairs for providing descriptive metadata. The most important differentiator is that annotations cannot be used for querying or selecting objects. Typical examples of annotations may include SCM commit hash IDs, release information, or contact details for teams operating the object. Make sure to put the value of an annotation into single quotes or double quotes if it contains special characters or spaces. <a data-type="xref" href="#pod_annotations" class="calibre10">Figure 9-3</a> illustrates a Pod with three annotations.</p>

<figure class="calibre35"><div id="pod_annotations" class="figure">
<img src="Images/ckd2_0903.png" alt="ckd2 0903" class="calibre82"/>
<h6 class="calibre32"><span class="keep-together">Figure 9-3. </span>Pod with annotations</h6>
</div></figure>

<p class="author1">Kubernetes defines a list of reserved annotations that it will evaluate at runtime to control the runtime behavior of the object. You can find more information at <a data-type="xref" href="#reserved_annotation" class="calibre10">“Reserved Annotations”</a>.</p>








<section data-type="sect2" data-pdf-bookmark="Declaring Annotations" class="praise"><div class="dedication" id="id242">
<h2 class="calibre33">Declaring Annotations</h2>

<p class="author1">The <code class="calibre15">kubectl run</code> command does not provide a command-line option for defining annotations that’s similar to the one for labels. You will have to start by writing a YAML manifest and adding the desired annotations under <code class="calibre15">metadata.annotations</code>, as shown in <a data-type="xref" href="#pod_metadata_annotations" class="calibre10">Example 9-4</a>.</p>
<div id="pod_metadata_annotations" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 9-4. </span>A Pod defining three annotations</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">v1</code><code class="w"></code>
<code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">Pod</code><code class="w"></code>
<code class="nt">metadata</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">annotated-pod</code><code class="w"></code>
<code class="w">  </code><code class="nt">annotations</code><code class="p">:</code><code class="w"></code>
<code class="w">    </code><code class="nt">commit</code><code class="p">:</code><code class="w"> </code><code class="calibre15">866a8dc</code><code class="w"></code>
<code class="w">    </code><code class="nt">author</code><code class="p">:</code><code class="w"> </code><code class="s">'Benjamin</code><code class="nv"> </code><code class="s">Muschko'</code><code class="w"></code>
<code class="w">    </code><code class="nt">branch</code><code class="p">:</code><code class="w"> </code><code class="s">'bm/bugfix'</code><code class="w"></code>
<code class="nt">spec</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">containers</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="calibre15">-</code><code class="w"> </code><code class="nt">image</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx:1.25.1</code><code class="w"></code>
<code class="w">    </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">nginx</code><code class="w"></code></pre></div>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Inspecting Annotations" class="praise"><div class="dedication" id="id243">
<h2 class="calibre33">Inspecting Annotations</h2>

<p class="author1">Similar to labels, you can use the <code class="calibre15">describe</code> or <code class="calibre15">get</code> commands to retrieve the assigned annotations:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl describe pod annotated-pod | grep -C 2 Annotations:</strong>
...
Annotations:  author: Benjamin Muschko
              branch: bm/bugfix
              commit: 866a8dc
...
<strong class="calibre38">$ kubectl get pod annotated-pod -o yaml | grep -C 3 annotations:</strong>
metadata:
  annotations:
    author: Benjamin Muschko
    branch: bm/bugfix
    commit: 866a8dc
...
</pre>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Modifying Annotations for a Live Object" class="praise"><div class="dedication" id="id244">
<h2 class="calibre33">Modifying Annotations for a Live Object</h2>

<p class="author1">The <code class="calibre15">annotate</code> command is the counterpart of the <code class="calibre15">labels</code> command but used for annotations. As you can see in the following examples, the usage pattern is the same:</p>
<pre data-type="programlisting" class="calibre37">
<strong class="calibre38">$ kubectl annotate pod annotated-pod oncall='800-555-1212'</strong>
pod/annotated-pod annotated
<strong class="calibre38">$ kubectl annotate pod annotated-pod oncall='800-555-2000' --overwrite</strong>
pod/annotated-pod annotated
<strong class="calibre38">$ kubectl annotate pod annotated-pod oncall-</strong>
pod/annotated-pod annotated
</pre>
</div></section>








<section data-type="sect2" data-pdf-bookmark="Reserved Annotations" class="praise"><div class="dedication" id="reserved_annotation">
<h2 class="calibre33">Reserved Annotations</h2>

<p class="author1">Kubernetes itself and extensions to Kubernetes use the concept of annotations to configure runtime behavior for an object. For example, you can assign the reserved annotation <code class="calibre15">pod-security.kubernetes.io/enforce: "baseline"</code> to a namespace object to enforce <a href="https://kubernetes.io/docs/concepts/security/pod-security-standards/" class="calibre10">security standards</a> for all Pods that live in the namespace. <a data-type="xref" href="#reserved_annotation_namespace" class="calibre10">Example 9-5</a> shows a namespace definition that assigns the annotation.</p>
<div id="reserved_annotation_namespace" data-type="example" class="calibre45">
<h5 class="calibre46"><span class="keep-together">Example 9-5. </span>A Pod using a reserved annotation</h5>

<pre data-type="programlisting" data-code-language="yaml" class="calibre47"><code class="nt">apiVersion</code><code class="p">:</code><code class="w"> </code><code class="calibre15">v1</code><code class="w"></code>
<code class="nt">kind</code><code class="p">:</code><code class="w"> </code><code class="calibre15">Namespace</code><code class="w"></code>
<code class="nt">metadata</code><code class="p">:</code><code class="w"></code>
<code class="w">  </code><code class="nt">name</code><code class="p">:</code><code class="w"> </code><code class="calibre15">secured</code><code class="w"></code>
<code class="w">  </code><code class="nt">annotations</code><code class="p">:</code><code class="w"></code>
<code class="w">    </code><code class="nt">pod-security.kubernetes.io/enforce</code><code class="p">:</code><code class="w"> </code><code class="s">"baseline"</code><code class="w"></code></pre></div>

<p class="author1">See the <a href="https://kubernetes.io/docs/reference/labels-annotations-taints/" class="calibre10">Kubernetes documentation</a> for a full list of reserved annotations in 
<span class="keep-together">Kubernetes.</span></p>
</div></section>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Summary" class="praise"><div class="dedication" id="id246">
<h1 class="calibre17">Summary</h1>

<p class="author1">Labels are a central concept for controlling the runtime behavior of more advanced Kubernetes objects. For example, in the context of a Deployment, Kubernetes requires you to use label selection to <em class="calibre3">select</em> the Pods the Deployment manages. You can use labels to select objects based on a query from the command line or within a manifest if supported by the primitive’s API. Kubernetes suggests label keys for commonly used application metadata.</p>

<p class="author1">Annotations serve a different purpose; they provide human-readable, informative metadata. You cannot use annotations for querying objects. Kubernetes introduced reserved annotations as a means of flagging objects for special runtime treatment.</p>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Exam Essentials" class="praise"><div class="dedication" id="id247">
<h1 class="calibre17">Exam Essentials</h1>
<dl class="calibre18">
<dt class="calibre19">Practice labels declaration and selection</dt>
<dd class="calibre20">
<p class="calibre21">Labels are an extremely important concept in Kubernetes, as many other primitives work with label selection. Practice how to declare labels for different objects, and use the <code class="calibre15">-l</code> command-line option to query for them based on equality-based and set-based requirements. Label selection in a YAML manifest might look slightly different depending on the API version of the spec. Extensively practice label selection for primitives that use them heavily.</p>
</dd>
<dt class="calibre19">Understand the difference between labels and annotations</dt>
<dd class="calibre20">
<p class="calibre21">All you need to know about annotations is their declaration from the command line and in a YAML manifest. Be aware that annotations are meant only for assigning metadata to objects and they cannot be queried for.</p>
</dd>
</dl>
</div></section>






<section data-type="sect1" data-pdf-bookmark="Sample Exercises" class="praise"><div class="dedication" id="id248">
<h1 class="calibre17">Sample Exercises</h1>

<p class="author1">Solutions to these exercises are available in <a href="app01_split_005.xhtml#appendix_a_labels_annotations" class="calibre10">Appendix A</a>.</p>
<ol class="calibre55">
<li class="calibre56">
<p class="author1">Create three Pods that use the image <code class="calibre15">nginx:1.25.1</code>. The names of the Pods should be <code class="calibre15">pod-1</code>, <code class="calibre15">pod-2</code>, and <code class="calibre15">pod-3</code>.</p>

<p class="author1">Assign the label <code class="calibre15">tier=frontend</code> to <code class="calibre15">pod-1</code> and the label <code class="calibre15">tier=backend</code> to <code class="calibre15">pod-2</code> and <code class="calibre15">pod-3</code>. All pods should also assign the label <code class="calibre15">team=artemidis</code>.</p>

<p class="author1">Assign the annotation with the key <code class="calibre15">deployer</code> to <code class="calibre15">pod-1</code> and <code class="calibre15">pod-3</code>. Use your own name as the value.</p>

<p class="author1">From the command line, use label selection to find all Pods with the team 
<span class="keep-together"><code class="calibre15">artemidis</code></span> or <code class="calibre15">aircontrol</code> and that are considered a backend service.</p>
</li>
<li class="calibre56">
<p class="author1">Create a Pod with the image <code class="calibre15">nginx:1.25.1</code> that assigns two recommended labels: one for defining the application name with the value <code class="calibre15">F5-nginx</code>, and one for defining the tool used to manage the application named <code class="calibre15">helm</code>.</p>

<p class="author1">Render the assigned labels of the Pod object.</p>
</li>

</ol>
</div></section>
</div></section></div></body>
</html>