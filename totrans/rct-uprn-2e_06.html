<!DOCTYPE html>
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.w3.org/2002/06/xhtml2/ http://www.w3.org/MarkUp/SCHEMA/xhtml2.xsd" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<link href="Styles/Style00.css" rel="stylesheet" type="text/css" />
<link href="Styles/Style01.css" rel="stylesheet" type="text/css" />

<style type="text/css">body{margin:1em;background-color:transparent!important;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}</style></head>
<body><div id="sbo-rt-content"><section data-type="chapter" epub:type="chapter" data-pdf-bookmark="Chapter 6. Setting Up for App Development"><div class="chapter" id="ch6">
<h1><span class="label">Chapter 6. </span>Setting Up for App Development</h1>


<p>Now that you know a lot about React, JSX, and state management in both class-based and function components, it’s time to <a data-type="indexterm" data-primary="React app" data-secondary="beginning setup for" id="ch6_term3"/>move on to creating and deploying a real-world app. Chapter 7 will start this process, but there are a few requirements you need to take care of first.</p>

<p>For any serious <a data-type="indexterm" data-primary="JavaScript" data-secondary="for app development" data-secondary-sortas="app development" id="idm45779435709360"/><a data-type="indexterm" data-primary="JSX (JavaScript XML)" data-secondary="for app development" data-secondary-sortas="app development" id="idm45779435708080"/>development and deployment outside of prototyping or testing JSX, you need to set up a build process. The goals are to use JSX and any other modern JavaScript without waiting on browsers to implement them. You need to set up a transformation that runs in the background as you’re developing. The transformation process should produce code that is as close to the code your end-users will run on the live site (meaning no more client-side transforms). The process should also be as unobtrusive as possible so you don’t need to switch between developing and building contexts.</p>

<p>The JavaScript community and ecosystem offers plenty of options when it comes to development and build processes. One of the easiest, most common approaches is to use the Create React App (CRA) utility (which has <a href="https://create-react-app.dev">great documentation</a>), so let’s go with that.</p>






<section data-type="sect1" data-pdf-bookmark="Create React App"><div class="sect1" id="idm45779435704704">
<h1>Create React App</h1>

<p>CRA is a <a data-type="indexterm" data-primary="Node.js, installation of" id="idm45779435703200"/><a data-type="indexterm" data-primary="Create React App (CRA)" id="ch6_term1"/><a data-type="indexterm" data-primary="React app" data-secondary="Create React App (CRA) for" id="ch6_term2"/>set of Node.js scripts and their dependencies that take the burden of setting up everything you require to get off the ground. So first you need to install Node.js.</p>








<section data-type="sect2" class="pagebreak-before less_space" data-pdf-bookmark="Node.js"><div class="sect2" id="idm45779435699792">
<h2>Node.js</h2>

<p>To install Node.js, go to <a href="https://nodejs.org"><em class="hyperlink">https://nodejs.org</em></a> and grab the installer for your operating system. Follow the instructions of the installer and it’s all done. Now you can avail yourself of the <a data-type="indexterm" data-primary="Node package manager (npm)" id="idm45779435696752"/>services provided by the command-line Node package manager (<code>npm</code>) utility.</p>

<p>Even if you have Node.js installed, it’s a good idea to make sure you have the latest version.</p>

<p>To verify, type <a data-type="indexterm" data-primary="$ as cue for terminal commands" id="idm45779435694528"/><a data-type="indexterm" data-primary="terminal (command prompt)" id="idm45779435693776"/><a data-type="indexterm" data-primary="command prompt (terminal)" id="idm45779435693088"/>this in your terminal:</p>
<pre data-type="programlisting">
$ <strong>npm --version</strong></pre>

<p>If you don’t have experience using a terminal (a command prompt), now is a great time to start! On Mac OS X, click the Spotlight search (the magnifying glass icon <span class="keep-together">at the top-right</span> corner) and type <strong><code>Terminal</code></strong>. On Windows, find the Start menu (<span class="keep-together">right-click</span> the windows icon at the bottom left of the screen), select Run, and type <strong><code>powershell</code></strong>.</p>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>In this book, all the commands you type in your terminal are prefixed with <code>$</code> as a cue to differentiate them from regular code. You omit the <code>$</code> when typing in your terminal.</p>
</div>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Hello CRA"><div class="sect2" id="idm45779435686000">
<h2>Hello CRA</h2>

<p>You can install CRA and have it available locally for future projects. But that means updating it every once in a while. An <a data-type="indexterm" data-primary="npx utility, Node.js" id="idm45779435684192"/>even more convenient approach is to use the <code>npx</code> utility that comes with Node.js. It allows you to execute (hence the “x”) Node package scripts. You can run the CRA script once: it downloads and executes the last version, sets up your app, and it’s gone. Next time you need to start another project, you run it again without worrying about updates.</p>

<p>To get started, <a data-type="indexterm" data-primary="directories, creating" id="idm45779435682176"/>create a temporary directory and execute CRA:</p>
<pre data-type="programlisting">
$ <strong>mkdir ~/reactbook/test</strong>
$ <strong>cd ~/reactbook/test</strong>
$ <strong>npx create-react-app hello</strong></pre>

<p>Give it a minute or two to complete the process and you’ll be greeted with the <span class="keep-together">success/welcome</span> message:</p>

<pre data-type="programlisting">Success! Created hello at /[...snip...]/reactbook/hello
Inside that directory, you can run several commands:

  npm start
    Starts the development server.

  npm run build
    Bundles the app into static files for production.

  npm test
    Starts the test runner.

  npm run eject
    Removes this tool and copies build dependencies, configuration files
    and scripts into the app directory. If you do this, you can’t go back!

We suggest that you begin by typing:

  cd hello
  npm start

Happy hacking!</pre>

<p>As the screen says, type:</p>
<pre data-type="programlisting">
$ <strong>cd hello</strong>
$ <strong>npm start</strong></pre>

<p>This opens your browser and points it to <em>http://localhost:3000/</em> where you can see a working React application (as shown in <a data-type="xref" href="#FIG0601">Figure 6-1</a>).</p>

<figure><div id="FIG0601" class="figure">
<img src="Images/rur2_0601.png" alt="rur2 0601" width="600" height="316"/>
<h6><span class="label">Figure 6-1. </span>A new React app</h6>
</div></figure>

<p>Now you <a data-type="indexterm" data-primary="App.js" id="idm45779435670992"/>can open <em>~/reactbook/test/hello/src/App.js</em> and make a small change. As soon as you save the changes, the browser will update with the new changes.</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Build and Deploy"><div class="sect2" id="idm45779435685408">
<h2>Build and Deploy</h2>

<p>Let’s say you’re happy with the changes and you’re ready to unleash the new app into the world. Go to the terminal/console window and press Ctrl + C. This kills the process and further changes will not auto-update in the browser. You’re ready. Type the following:</p>
<pre data-type="programlisting">
$ <strong>npm run build</strong></pre>

<p>This is the process of building and packaging the app, ready to be deployed. The build is found in a <em>/build</em> folder (as shown in <a data-type="xref" href="#FIG0602">Figure 6-2</a>).</p>

<figure><div id="FIG0602" class="figure">
<img src="Images/rur2_0602.png" alt="rur2 0602" width="600" height="497"/>
<h6><span class="label">Figure 6-2. </span>A new build of the React app</h6>
</div></figure>

<p>Copy the contents of this folder to a web server—even a simple shared hosting will <span class="keep-together">do—</span>and you’re ready to announce the new app. When you want to make a change, repeat the process:</p>
<pre data-type="programlisting">
$ <strong>npm start</strong>
// work, work, work...
// Ctrl+C
$ <strong>npm run build</strong></pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="Mistakes Were Made"><div class="sect2" id="idm45779435660112">
<h2>Mistakes Were Made</h2>

<p>When you save a file with an error in it (maybe you forgot to close a JSX tag), the ongoing build fails and you get an error message in both the console and the browser (see <a data-type="xref" href="#FIG0603">Figure 6-3</a> for an example).</p>

<figure><div id="FIG0603" class="figure">
<img src="Images/rur2_0603.png" alt="rur2 0603" width="600" height="319"/>
<h6><span class="label">Figure 6-3. </span>An error</h6>
</div></figure>

<p>This is great! You get immediate feedback. To quote John C. Maxwell, “Fail early, fail often, but always fail forward.” Wise words to live by.</p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="package.json and node_modules"><div class="sect1" id="idm45779435654832">
<h1>package.json and node_modules</h1>

<p>The file <em>package.json</em> found <a data-type="indexterm" data-primary="package.json" id="idm45779435652688"/><a data-type="indexterm" data-primary="React app" data-secondary="package.json for" id="idm45779435651952"/>in the root directory of the app contains various configurations for the app (<a href="https://create-react-app.dev">CRA</a> has extensive documentation). One of the <a data-type="indexterm" data-primary="dependencies" data-secondary="node_modules as" id="idm45779435650192"/><a data-type="indexterm" data-primary="node_modules" id="idm45779435649216"/><a data-type="indexterm" data-primary="React app" data-secondary="node_modules for" id="idm45779435648544"/>configuration pieces deals with dependencies, such as React and React-DOM. These dependencies are installed in the <em>node_modules</em> folder in the root of the app.</p>

<p>The dependencies there are for developing and building the app, not for deployment. And they should not be included if you share the code of your app with friends, <span class="keep-together">coworkers</span> or the open-source community. For example, if you’re to share this app on GitHub, you do not include <em>node_modules</em>. When someone else wants to contribute or you want to contribute to another app, you install the dependencies locally.</p>

<p>Give this a try. Delete the whole <em>node_modules</em> folder. Then go to the root of the app and type:</p>
<pre data-type="programlisting">
$ <strong>npm i</strong></pre>

<p>The <code>i</code> is for “install.” This way all the dependencies listed in your <em>package.json</em> (and their dependencies) are installed in a <a data-type="indexterm" data-primary="directories, creating" id="idm45779435641664"/><a data-type="indexterm" data-startref="ch6_term1" id="idm45779435640960"/><a data-type="indexterm" data-startref="ch6_term2" id="idm45779435640288"/>newly created <em>node_modules</em> directory.</p>
</div></section>













<section data-type="sect1" data-pdf-bookmark="Poking Around the Code"><div class="sect1" id="idm45779435639072">
<h1>Poking Around the Code</h1>

<p>Let’s take a look <a data-type="indexterm" data-primary="index.html" id="idm45779435637568"/><a data-type="indexterm" data-primary="index.js" id="idm45779435636832"/>around the code generated by CRA and note a few specifics regarding the app’s entry points (<em>index.html</em> and <em>index.js</em>) and its handling of JavaScript and CSS dependencies.</p>








<section data-type="sect2" data-pdf-bookmark="Indices"><div class="sect2" id="idm45779435634896">
<h2>Indices</h2>

<p>In <em>public/index.html</em> you’ll find the <a data-type="indexterm" data-primary="public/index.html" id="idm45779435633024"/><a data-type="indexterm" data-primary="HTML" data-secondary="index page for" id="idm45779435632288"/>old school HTML index page, the root of everything rendered by the browser. This is where <code>&lt;div id="root"&gt;</code> is defined and where React will render your top level component and all its children.</p>

<p>The file <em>src/index.js</em> is the <a data-type="indexterm" data-primary="JavaScript" data-secondary="index page/root for" id="idm45779435629760"/><a data-type="indexterm" data-primary="React app" data-secondary="entry points for" id="idm45779435628752"/><a data-type="indexterm" data-primary="src/index.js" id="idm45779435627808"/>main entry for the app as far as React is concerned. Note the top part:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kr">import</code> <code class="nx">React</code> <code class="nx">from</code> <code class="s1">'react'</code><code class="p">;</code>
<code class="kr">import</code> <code class="nx">ReactDOM</code> <code class="nx">from</code> <code class="s1">'react-dom'</code><code class="p">;</code>
<code class="kr">import</code> <code class="s1">'./index.css'</code><code class="p">;</code>
<code class="kr">import</code> <code class="nx">App</code> <code class="nx">from</code> <code class="s1">'./App'</code><code class="p">;</code></pre>
</div></section>













<section data-type="sect2" data-pdf-bookmark="JavaScript: Modernized"><div class="sect2" id="idm45779435621408">
<h2>JavaScript: Modernized</h2>

<p>The examples in the book so far worked only with simple components and <a data-type="indexterm" data-primary="global variables" id="idm45779435609936"/>made sure <code>React</code> and <code>ReactDOM</code> were available as <em>global variables</em>. As you move toward more complicated apps with multiple components, you need a plan for better organization. Sprinkling globals is dangerous (they tend to cause naming collisions) and relying on globals to always be present is flaky at best.</p>

<p>You need <em>modules</em>. Modules <a data-type="indexterm" data-primary="components" data-secondary="module template for" id="idm45779435606672"/><a data-type="indexterm" data-primary="modules" data-secondary="template for" id="idm45779435605664"/><a data-type="indexterm" data-primary="React" data-secondary="modules with" id="idm45779435604720"/><a data-type="indexterm" data-primary="React app" data-secondary="modules for" id="idm45779435603776"/><a data-type="indexterm" data-primary="template for modules" id="idm45779435602832"/> split up the different pieces of functionality that make up your app into small, manageable files. In general, you should have a separate module for each concern; modules and concerns have a one-to-one relationship. Some modules can be individual React components; some can simply be utilities related, or unrelated to React entirely—for example, a reducer, a custom hook, or a library that deals with formatting dates or currencies.</p>

<p>The general template for a module is: declare requirements up top, export at the bottom, implement the “meat” in between. In other words, these <a data-type="indexterm" data-primary="APIs with React" id="idm45779435572320"/><a data-type="indexterm" data-primary="dependencies" data-secondary="in modules" data-secondary-sortas="modules" id="idm45779435571712"/>three tasks:</p>
<ol>
<li>
<p>Require/import dependencies</p>
</li>
<li>
<p>Provide an API in the form of a function/class/object</p>
</li>
<li>
<p>Export the API</p>
</li>

</ol>

<p class="pagebreak-before">For a React component, the template could look like:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kr">import</code> <code class="nx">React</code> <code class="nx">from</code> <code class="s1">'react'</code><code class="p">;</code>
<code class="kr">import</code> <code class="nx">MyOtherComponent</code> <code class="nx">from</code> <code class="s1">'./MyOtherComponent'</code><code class="p">;</code>

<code class="kd">function</code> <code class="nx">MyComponent</code><code class="p">()</code> <code class="p">{</code>
  <code class="k">return</code> <code class="o">&lt;</code><code class="nx">div</code><code class="o">&gt;</code><code class="nx">Hello</code><code class="o">&lt;</code><code class="err">/div&gt;;</code>
<code class="p">}</code>

<code class="kr">export</code> <code class="k">default</code> <code class="nx">MyComponent</code><code class="p">;</code></pre>
<div data-type="note" epub:type="note"><h6>Note</h6>
<p>Again, a convention that can prove helpful is: one module exports one React component.</p>
</div>

<p>Did you notice the difference in importing React versus <code>MyOtherComponent</code>: <code>from 'react'</code> and <code>from './MyOtherComponent'</code>? The latter is a directory path—you’re telling the module to pull the dependency from a file location relative to the module, whereas the former is pulling a dependency from a shared place (<em>node_modules</em>).</p>
</div></section>













<section data-type="sect2" data-pdf-bookmark="CSS"><div class="sect2" id="idm45779435541872">
<h2>CSS</h2>

<p>In <code>src/index.js</code> you can <a data-type="indexterm" data-primary="React app" data-secondary="CSS for" id="idm45779435539824"/><a data-type="indexterm" data-primary="CSS" data-secondary="for React components" data-secondary-sortas="React components" id="idm45779435506592"/><a data-type="indexterm" data-primary="src/index.js" id="idm45779435505504"/><a data-type="indexterm" data-primary="index.js" id="idm45779435504864"/>see how CSS is treated just like another module:</p>

<pre data-type="programlisting" data-code-language="javascript"><code class="kr">import</code> <code class="s1">'./index.css'</code><code class="p">;</code></pre>

<p>The <em>src/index.css</em> should contain general styles, such as <code>body</code>, <code>html</code>, and so on, that are applicable to the whole page.</p>

<p>Other than the app-wide styles, you need specific styles for each component. Under the convention of having one CSS file (and one JS file) per React component, it’s a good idea to have <em>MyComponent.css</em> containing the styles related only to <em>MyComponent.js</em> and nothing else. Also a good idea could be to prefix all class names used in <em>MyComponent.js</em> with <em>MyComponent-</em>. For example:</p>

<pre data-type="programlisting" data-code-language="css"><code class="nc">.MyComponent-table</code> <code class="p">{</code>
  <code class="k">border</code><code class="o">:</code> <code class="m">1px</code> <code class="nb">solid</code> <code class="nb">black</code><code class="p">;</code>
<code class="p">}</code>

<code class="nc">.MyComponent-table-heading</code> <code class="p">{</code>
  <code class="k">border</code><code class="o">:</code> <code class="m">1px</code> <code class="nb">solid</code> <code class="nb">black</code><code class="p">;</code>
<code class="p">}</code></pre>

<p>While there are many other ways to author CSS, let’s keep it simple and old-school: anything that will run just in the browser without <a data-type="indexterm" data-startref="ch6_term3" id="idm45779435456672"/>any transpilation.</p>
</div></section>





</div></section>













<section data-type="sect1" data-pdf-bookmark="Moving On"><div class="sect1" id="idm45779435455808">
<h1>Moving On</h1>

<p>Now you have an example of a simple writing, building, and deployment pipeline. With all this behind you it’s time to move on to more entertaining topics: building and testing a real app while taking advantage of the many features modern JavaScript has to offer.</p>

<p>At this point you can <a data-type="indexterm" data-primary="Hello World app" id="idm45779435453808"/>delete the <code>hello</code> app or keep it around for exploration and <span class="keep-together">trying out ideas</span>.</p>
</div></section>







</div></section></div></body>
</html>