# 附录 B. 资源

# 一般

## 参考资料

+   官方的 [Kubernetes 文档](https://oreil.ly/lo9ml)

+   Kubernetes 社区在 [GitHub](https://oreil.ly/wMDRF)

## Books

+   [*容器安全*](https://oreil.ly/LIf6h) 由 Liz Rice（O’Reilly）撰写

+   [*Kubernetes: Up and Running*](https://oreil.ly/fbCyP) 由 Kelsey Hightower、Brendan Burns 和 Joe Beda（O’Reilly）撰写

+   [*Cloud Native DevOps with Kubernetes*](https://oreil.ly/pRHof) 由 John Arundel 和 Justin Domingus（O’Reilly）撰写

+   [*管理 Kubernetes*](https://oreil.ly/54ANb) 由 Brendan Burns 和 Craig Tracey（O’Reilly）撰写

+   [*Kubernetes Cookbook*](https://oreil.ly/PK7jz) 由 Sébastien Goasguen 和 Michael Hausenblas（O’Reilly）撰写

+   [*使用 bash 进行网络安全运营*](https://oreil.ly/GST5s) 由 Paul Troncone 和 Carl Albing（O’Reilly）撰写

# 按章节进一步阅读

## 介绍

对于第一章，我们建议使用以下资源：

+   [威胁建模宣言](https://oreil.ly/CfPMy)

+   [*开源情报方法和工具：在线情报的实用指南*](https://oreil.ly/DGWCf) 由 Nihad Hassan 和 Rami Hijazi（Apress）撰写

+   [*开源情报的道*](https://oreil.ly/WzyOq) 由 Stewart Bertram（IT Governance Publishing）撰写

+   [“SANS SEC487：开源情报（OSINT）收集与分析”](https://oreil.ly/j4oUF)

## Pods

对于第二章，我们建议使用以下资源：

+   [Awesome Kubernetes 安全](https://oreil.ly/AqYzG)

+   [“我的云原生（安全）工具库”](https://oreil.ly/3BIq0)

+   [“5 个必备的 Kubernetes 安全工具”](https://oreil.ly/7VeGa)

+   [Kubernetes YAML 生成器](https://k8syaml.com)

+   [Google Cloud 的“为什么容器安全对您的业务至关重要”](https://oreil.ly/YLtap)

+   [全面的 Kubernetes FAQ](https://oreil.ly/JdULC)

+   [“通过您的网络管道攻击 Kubernetes 集群”](https://oreil.ly/ND7cC)

+   [*Kubernetes 卷指南*](https://oreil.ly/5mmvf)

此外，在这个上下文中相关的工具：

+   [云容器攻击工具（CCAT）](https://oreil.ly/zwJrn)

+   [Peirates（Kubernetes 渗透测试工具）](https://oreil.ly/8aPrg)

+   [在 Kubernetes 集群中寻找安全弱点](https://oreil.ly/i0TWY)

+   [用于渗透测试和工程师的容器分析和利用工具](https://oreil.ly/WFRCa)

+   [Docker 枚举、权限提升和容器逃逸](https://oreil.ly/4JSIZ)

+   [Ed 用于识别和利用可访问的 UNIX 域套接字的工具](https://oreil.ly/XqSM5)

+   [RedNix：可黑客化的 NixOS 容器](https://oreil.ly/18562)

## 供应链

对于第四章，我们建议使用以下资源：

+   [“开源软件核心初步报告和第二次人口普查的漏洞”](https://oreil.ly/uR6Eh)

+   [CII 最佳实践徽章计划](https://oreil.ly/J2lXM)

+   [SPDX 规范](https://oreil.ly/f5UXZ)

+   [OWASP 依赖跟踪](https://oreil.ly/1ZIEM)

+   [带证书约束支持的 in-toto 的 Go 实现](https://oreil.ly/VWEds)

+   [“通过验证来减轻供应链攻击的供应链安全”](https://oreil.ly/wKvL5)

+   [“代码签名的安全考虑”](https://oreil.ly/4UHrg)

+   [NCSC 的“供应链安全指南”](https://oreil.ly/9RV9p)

+   [MITRE 的“供应链攻击框架和攻击模式”](https://oreil.ly/gmGRd)

+   [Microsoft 供应链完整性模型 (SCIM)](https://oreil.ly/WC3Av)

此外，在这个背景下相关的工具：

+   [OWASP Packman](https://oreil.ly/WnIIs)

+   [安全评分卡](https://oreil.ly/kO9pX)

+   [开源项目关键性评分 (Beta)](https://oreil.ly/VQ0b5)

+   [开源软件审查工具包 (ORT)](https://oreil.ly/T3nEl)

+   [Google 二进制授权/SLSA](https://oreil.ly/mbo5X)

+   [syft：从容器镜像生成软件材料清单 (SBOM)](https://oreil.ly/J7cbb)

+   [Rekor](https://oreil.ly/sYSwp)

+   [Ploigos 软件工厂操作员](https://oreil.ly/s4dwJ)

+   [in-toto：确保软件供应链完整性的框架](https://in-toto.io)

+   [sigstore](https://oreil.ly/iaC05)

## 网络

对于 第五章，我们建议以下资源：

+   [“在 Kubernetes 中使用 NGINX App Protect 安全保护应用程序”](https://oreil.ly/qOm7p)

+   [“使用 AWS ALB Ingress 控制器在 Kubernetes Ingress 中实现 Kubernetes”](https://oreil.ly/H9mbx)

+   [“探索 Kubernetes 中的网络策略”](https://oreil.ly/41rMt)

+   [“Kubernetes 网络策略的最佳实践”](https://oreil.ly/SxaSV)

+   [“保护 Kubernetes 集群网络安全”](https://oreil.ly/ud2sv)

+   [NIST 800-204A 特别出版物：“使用服务网格架构构建安全的基于微服务的应用程序”](https://oreil.ly/9aFZD)

+   [“如何在 Istio 和 Linkerd2 等服务网格中保护容器的安全性”](https://oreil.ly/nBj5A)

+   [“Istio 安全：在零信任网络上运行微服务”](https://oreil.ly/SfO22)

+   [App Mesh TLS](https://oreil.ly/bTETs)

此外，在这个背景下相关的工具：

+   [CNCF Falco](https://oreil.ly/EdQxb)

+   [Sysdig Secure](https://oreil.ly/IlFdt)

+   [NeuVector](https://oreil.ly/eCOk3)

+   [Snyk 容器](https://oreil.ly/oPamy)

+   [Prisma Cloud](https://oreil.ly/9pd6S)

+   [StackRox](https://oreil.ly/jWwva)

+   [Aqua Security](https://oreil.ly/as2dO)

+   [AccuKnox](https://oreil.ly/wha3I)

## 策略

对于 第八章，我们建议以下资源：

+   [“有效的 RBAC” - Jordan Liggitt](https://oreil.ly/5Z54y)

+   [“在您的 Kubernetes 集群中配置 RBAC”](https://oreil.ly/doIvy)

+   [“测试 Kubernetes RBAC”](https://oreil.ly/X8uFu)

+   [“Kubernetes RBAC 的三种现实方法”](https://oreil.ly/F6R13)

+   [“使用 OPA 和 Gatekeeper 在 Kubernetes 中执行政策即代码”](https://oreil.ly/rwZZz)

+   [“Rego 单元测试”](https://oreil.ly/CLR5l)

+   [OPA, oso, oh no!](https://oreil.ly/0nOcS)

+   [“记录 AWS API 调用以改进 IAM 策略”](https://oreil.ly/N0SMF)

此外，在这个背景下相关的工具：

+   [Krane：简化 Kubernetes RBAC 分析](https://oreil.ly/Z2Fsa)

+   [audit2rbac](https://oreil.ly/qVeLA)

+   [RBAC 视图](https://oreil.ly/883g7)

+   [rback](https://oreil.ly/gAuBs)

+   [权限管理器](https://oreil.ly/6l7CR)

# 显著 CVE

###### 注记

除非特别说明，这些 CVE 已经修补，并且仅作为历史参考。

CVE-2017-1002101

子路径卷挂载处理不当。使用任何卷类型（包括非特权 pod，受文件权限控制）的容器可以访问卷之外的文件/目录，包括主机的文件系统。

CVE-2017-1002102

下行 API 主机文件系统删除。使用 Secret、ConfigMap、projected 或 downwardAPI 卷的容器可以触发在其运行的节点上删除任意文件/目录。

CVE-2017-5638

（非 Kubernetes）Apache Struts 无效的`Content-Type`标头解析失败，允许任意代码执行。在 Jakarta 多部分解析器中的错误导致将输入注册为 OGNL 代码，转换为可执行文件，并将其移动到服务器的临时目录中。

CVE-2018-1002105

API 服务器 websocket TLS 隧道错误处理不当。在`kube-apiserver`中对代理升级请求的错误响应处理不正确，允许特制请求通过 Kubernetes API 服务器与后端服务器建立连接。随后在相同连接上的任意请求直接通过与 Kubernetes API 服务器 TLS 凭据认证的后端传输。

[CVE-2019-16884](https://oreil.ly/4It2O)

`runc`恶意镜像 AppArmor 绕过。允许 AppArmor 限制绕过，因为`libcontainer/rootfs_linux.go`错误地检查挂载目标，因此恶意的 Docker 镜像可以在`/proc`目录上挂载。

[CVE-2019-5736](https://oreil.ly/4aaXw)

`runc` */proc/self/exe*。`runc`允许攻击者通过利用作为根用户执行命令的能力来重写主机上的`runc`二进制文件（从而获取主机的根访问权限），这是由于文件描述符处理不当，涉及*/proc/self/exe*。

[CVE-2019-11249](https://oreil.ly/79ROq)

`kubectl cp` `scp` 反向写。为了从容器中复制文件，Kubernetes 在容器内部运行`tar`创建一个 Tar 存档，并通过网络将其复制到用户的计算机上，`kubectl`在用户的机器上解压它。如果容器中的`tar`二进制文件是恶意的，它可以运行任何代码并输出意外的恶意结果。攻击者可以利用此功能在调用`kubectl cp`时将文件写入用户计算机上的任何路径，仅限于本地用户的系统权限。

CVE-2018-18264

在 v1.10.1 之前的 Kubernetes 仪表板允许攻击者绕过身份验证，并使用仪表板的 ServiceAccount 读取集群内的 Secrets。

CVE-2019-1002100

API 服务器 JSON 补丁拒绝服务。被授权向 Kubernetes API 服务器发出 HTTP `PATCH`请求的用户可以发送一种特制的“json-patch”补丁（例如，`kubectl patch --type json`或`"Content-Type: application/json-patch+json"`），在处理过程中消耗过多资源。

[CVE-2018-1002100](https://oreil.ly/bN0Fh)

原始`kubectl cp`。`kubectl` cp 命令不安全地处理从容器返回的`tar`数据，并可能导致覆盖任意本地文件。

CVE-2019-1002101

与`CVE-2019-11249`类似，但扩展了`untar`函数可以创建并跟随符号链接。

CVE-2019-11245

`mustRunAsNonRoot: true`绕过。对于未指定显式`runAsUser`的 Pod 的容器，在容器重新启动时，或者如果镜像先前被拉到节点上，会尝试以 uid 0（root）运行。

CVE-2019-11247

集群 RBAC 处理错误。Kubernetes `kube-apiserver`错误地允许访问集群范围的自定义资源，如果请求被视为命名空间资源。以这种方式访问的资源的授权是通过命名空间内的角色和角色绑定来执行的，这意味着只有对一个命名空间中的资源有访问权限的用户可以创建、查看、更新或删除集群范围的资源（根据其命名空间角色权限）。

CVE-2019-11248

`kubelet` */debug/pprof*信息泄露和拒绝服务。调试端点*/debug/pprof*暴露在未经身份验证的`kubelet` `healthz healthcheck endpoint`端口上，可能泄露敏感信息，如内部 Kubelet 内存地址和配置，或造成有限的拒绝服务。

CVE-2019-11250

侧信道信息泄露。Kubernetes `client-go`库在 7 或更高的详细级别记录请求头。这可能通过日志或命令输出向未经授权的用户披露凭据。使用基本或持有者令牌身份验证并以高详细级别运行的 Kubernetes 组件（如`kube-apiserver`）受到影响。

[CVE-2020-8558](https://oreil.ly/9tLAP)

`kube-proxy`意外地使本地绑定的主机服务在网络上可用。

CVE-2020-14386

来自“loopback”（或本地主机）网络接口的原始数据包整数溢出。使用`sysctl -w kernel.unprivileged_userns_clone=0`移除或拒绝`CAP_NET_RAW`可以保护未打补丁的内核免受利用。

CVE-2021-22555

Linux Netfilter 本地提权漏洞。在处理`setsockopt IPT_SO_SET_REPLACE`（或`IP6T_SO_SET_REPLACE`）时，本地用户可能利用内存损坏来获取权限或通过用户命名空间造成 DoS。使用`CONFIG_USER_NS`和`CONFIG_NET_NS`编译的内核允许非特权用户提升权限。

[CVE-2021-25740](https://oreil.ly/srPzW)（未打补丁）

端点和端点片段权限允许跨命名空间转发。用户通过混淆代理攻击可以将网络流量发送到本来无权访问的位置。

CVE-2021-31440

Linux 内核 eBPF 验证器中的错误边界计算。通过绕过验证器，可以利用越界访问内核来逃逸，原始概念证明设置 UID 和 GID 为 0，并获得 `CAP_SYS_MODULE` 来加载容器外的任意内核。

[CVE-2021-25741](https://oreil.ly/irhM8)

符号链接交换可能允许主机文件系统访问。用户可能能够创建一个包含子路径卷挂载的容器，以访问卷之外的文件和目录，包括主机文件系统上的内容。
